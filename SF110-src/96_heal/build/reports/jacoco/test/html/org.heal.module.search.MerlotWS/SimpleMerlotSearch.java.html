<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SimpleMerlotSearch.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">96_heal</a> &gt; <a href="index.source.html" class="el_package">org.heal.module.search.MerlotWS</a> &gt; <span class="el_source">SimpleMerlotSearch.java</span></div><h1>SimpleMerlotSearch.java</h1><pre class="source lang-java linenums">package org.heal.module.search.MerlotWS;

import java.rmi.RemoteException;
import javax.xml.rpc.ServiceException;
import org.merlot.fedsearch.wsdl.*;
import org.heal.module.metadata.ShortMetadataBean;
import org.heal.module.search.SearchResultBean;
import org.heal.module.search.ShortMetadataResultBean;

/**
 * This class is used to call Merlot's search web services.
 * @author Jason Varghese
 */

<span class="nc" id="L15">public  class SimpleMerlotSearch{</span>
    private final static int MAX_RESULTS = 10;
    
    public SearchResultBean doSimpleMerlotSearch(String keywords, int start, int stop){
<span class="nc" id="L19">        SearchResultBean srb = new SearchResultBean();</span>
        try{
<span class="nc" id="L21">            org.merlot.fedsearch.type.SearchResult searchResult = new org.merlot.fedsearch.type.SearchResult();</span>
<span class="nc" id="L22">            org.merlot.fedsearch.type.SearchResultElement[] sre = new org.merlot.fedsearch.type.SearchResultElement[MAX_RESULTS];</span>
<span class="nc" id="L23">            MerlotSearch ims2 = new MerlotSearchLocator();</span>
<span class="nc" id="L24">            SearchService ims = ims2.getSearchServicePort();</span>
            //searchResult = ims.doSearch(&quot;ulOPDbfh0RN6PWKw&quot;,keywords,1,25);
<span class="nc" id="L26">            searchResult = ims.doSearch(&quot;YoFt9llu056hvtZC&quot;,keywords,1,25);</span>
<span class="nc" id="L27">            sre = searchResult.getResultElements();</span>
<span class="nc" id="L28">            int count = searchResult.getTotalResultsCount();</span>
<span class="nc bnc" id="L29" title="All 2 branches missed.">            if (count &lt; stop)</span>
<span class="nc" id="L30">                stop = count;</span>
<span class="nc" id="L31">            ShortMetadataResultBean[] smrb = new ShortMetadataResultBean[stop-start+1]; </span>
<span class="nc" id="L32">            srb.setKeywords(keywords);</span>
<span class="nc" id="L33">            srb.setSimple(true);  </span>
<span class="nc" id="L34">            ShortMetadataBean currentMeta = null;</span>
<span class="nc bnc" id="L35" title="All 2 branches missed.">            if (sre==null){</span>
<span class="nc" id="L36">                return null;</span>
            }  
<span class="nc bnc" id="L38" title="All 2 branches missed.">            for (int a=0;a&lt;sre.length;a++){			</span>
<span class="nc bnc" id="L39" title="All 2 branches missed.">                if (smrb[a]==null)</span>
<span class="nc" id="L40">                    smrb[a]=new ShortMetadataResultBean();</span>
<span class="nc" id="L41">                    currentMeta = smrb[a].getShortMetadata();</span>
<span class="nc bnc" id="L42" title="All 2 branches missed.">                    if(currentMeta==null)</span>
<span class="nc" id="L43">                        currentMeta=new ShortMetadataBean();</span>
<span class="nc" id="L44">                    currentMeta.setTitle(sre[a].getTitle());</span>
<span class="nc" id="L45">                    currentMeta.setDescription(sre[a].getDescription());</span>
<span class="nc" id="L46">                    currentMeta.setLocation(sre[a].getDetailURL());</span>
<span class="nc" id="L47">                    currentMeta.setSourceCollection(&quot;MERLOT&quot;);</span>
<span class="nc" id="L48">                    currentMeta.setFormat(sre[a].getItemType());</span>
<span class="nc" id="L49">                    currentMeta.setThumbnail(currentMeta.getThumbnail());</span>
<span class="nc" id="L50">                    smrb[a].setShortMetadata(currentMeta);			</span>
                }
<span class="nc" id="L52">            srb.setShortRecords(smrb);</span>
        }
<span class="nc" id="L54">        catch (RemoteException re){</span>
<span class="nc" id="L55">            re.printStackTrace();</span>
        }
<span class="nc" id="L57">        catch (ServiceException se){</span>
<span class="nc" id="L58">            se.printStackTrace();</span>
<span class="nc" id="L59">        }    </span>
<span class="nc" id="L60">        return srb;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>