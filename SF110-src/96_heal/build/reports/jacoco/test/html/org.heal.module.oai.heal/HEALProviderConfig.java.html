<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>HEALProviderConfig.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">96_heal</a> &gt; <a href="index.source.html" class="el_package">org.heal.module.oai.heal</a> &gt; <span class="el_source">HEALProviderConfig.java</span></div><h1>HEALProviderConfig.java</h1><pre class="source lang-java linenums">/*
 * Created on Dec 1, 2004
 * 
 */
package org.heal.module.oai.heal;

import java.text.ParseException;
import java.util.Date;
import java.util.HashMap;

import org.heal.module.oai.provider.OAIGranularity;
import org.heal.module.oai.provider.OAIMetadataFormat;
import org.heal.module.oai.provider.OAIProviderConfig;
import org.heal.util.FileLocator;

/**
 * @author Seth Wright
 *
 */
public class HEALProviderConfig implements OAIProviderConfig {
	private static final boolean debug = true;

	private final OAIMetadataFormat[] metadataFormats;
<span class="fc" id="L24">	private final HashMap formatMap = new HashMap();</span>
	private Date earliest;
<span class="fc" id="L26">	private String idPrefix = &quot;oai:org.heal:&quot;;</span>
<span class="fc" id="L27">	private int resumptionThreshold = 5;</span>
<span class="fc" id="L28">	private String coverage = &quot;health-sciences&quot;;</span>
<span class="fc" id="L29">	private String metametadataRole = &quot;primary&quot;;</span>
<span class="fc" id="L30">	private OAIGranularity granularity = OAIGranularity.yearMonthDayHourMinuteSecond;</span>
<span class="fc" id="L31">	private String[] adminEmails = {&quot;info@healcentral.org&quot;};</span>
<span class="fc" id="L32">	private String[] descriptions = {&quot;The Health Education Assets Library (HEAL) is a digital library of freely accessible, web-based multimedia teaching materials that meet the needs of today's health sciences educators and learners. The HEAL collection currently contains a number of collections of multimedia resources for health sciences undergraduate and professional education, as well as resources for patient and consumer health.&quot;};</span>
<span class="fc" id="L33">	private String healVCard = &quot;begin:vcard\nn:Health Education Assets Library (HEAL)\nurl:http://www.healcentral.org\nemail;type=internet:info@healcentral.org\nfn:Health Education Assets Library (HEAL)\nend:vcard&quot;;</span>
<span class="fc" id="L34">	private String[] allowedCollections = {&quot;Peer Review Pending&quot;,&quot;HEAL Reviewed Collection&quot;};</span>
<span class="fc" id="L35">	private String repositoryName = &quot;Health Education Assets Library&quot;;</span>
<span class="fc" id="L36">	private String baseURL = &quot;http://www.healcentral.org/heal/oaiprovider&quot;;</span>
<span class="fc" id="L37">	private String contentPrefix = &quot;http://www.healcentral.org/content&quot;;</span>

	public HEALProviderConfig(String idPrefix,
							  int resumptionThreshold,
							  String coverage,
							  String metametadataRole,
							  String granularity,
							  String[] descriptions,
							  String[] adminEmails,
							  String healVCard,
							  String[] allowedCollections,
							  String repositoryName,
							  String baseURL,
							  OAIMetadataFormat[] formats,
<span class="fc" id="L51">							  String contentPrefix) {</span>
<span class="fc" id="L52">		metadataFormats = formats;</span>
<span class="fc bfc" id="L53" title="All 2 branches covered.">		for (int i=0;i&lt;formats.length;i++) {</span>
<span class="fc" id="L54">			formatMap.put(formats[i].getPrefix(),formats[i]);</span>
		}
<span class="pc bpc" id="L56" title="1 of 2 branches missed.">		if (idPrefix != null) {</span>
<span class="nc" id="L57">			this.idPrefix = idPrefix;</span>
		}
<span class="fc" id="L59">		this.resumptionThreshold = resumptionThreshold;</span>
<span class="pc bpc" id="L60" title="1 of 2 branches missed.">		if (coverage != null) {</span>
<span class="nc" id="L61">			this.coverage = coverage;</span>
		}
<span class="pc bpc" id="L63" title="1 of 2 branches missed.">		if (metametadataRole != null) {</span>
<span class="nc" id="L64">			this.metametadataRole = metametadataRole;			</span>
		}
<span class="pc bpc" id="L66" title="1 of 2 branches missed.">		if (granularity != null) {</span>
<span class="nc" id="L67">			this.granularity = OAIGranularity.getGranularity(granularity);</span>
<span class="nc bnc" id="L68" title="All 2 branches missed.">			if (this.granularity == null) {</span>
<span class="nc" id="L69">				throw new IllegalArgumentException(&quot;'&quot;+granularity + &quot;' is not a valid granularity setting.&quot;);</span>
			}
		}
<span class="pc bpc" id="L72" title="1 of 2 branches missed.">		if (descriptions != null) {</span>
<span class="nc" id="L73">			this.descriptions = descriptions;</span>
		}
<span class="pc bpc" id="L75" title="1 of 2 branches missed.">		if (adminEmails != null) {</span>
<span class="nc" id="L76">			this.adminEmails = adminEmails;</span>
		}
<span class="pc bpc" id="L78" title="1 of 2 branches missed.">		if (healVCard != null) {</span>
<span class="nc" id="L79">			this.healVCard = healVCard;</span>
		}
<span class="pc bpc" id="L81" title="1 of 2 branches missed.">		if (repositoryName != null) {</span>
<span class="nc" id="L82">			this.repositoryName = repositoryName;</span>
		}
<span class="pc bpc" id="L84" title="1 of 2 branches missed.">		if (baseURL != null) {</span>
<span class="nc" id="L85">			this.baseURL = baseURL;</span>
		}
		try {
<span class="fc" id="L88">			earliest = OAIGranularity.yearMonthDayHourMinuteSecond.parse(&quot;2000-09-01T0:00:00Z&quot;);</span>
<span class="nc" id="L89">		} catch (ParseException ex) {</span>
			//DISPLAY CONFIG ERROR SOMEHOW
			//default to earliest java date available, January 1, 1970
<span class="nc" id="L92">			earliest = new Date(0);</span>
<span class="fc" id="L93">		}</span>
<span class="fc" id="L94">		this.contentPrefix = contentPrefix;</span>
<span class="fc" id="L95">	}</span>

	/* Constructs a date from the given string using the granularity
	 * of this provider
	 * Returns null if the parsing fails
	 */
	public Date getDateFromString(String dateStr) {
<span class="nc" id="L102">		Date result = null;</span>
		try {
<span class="nc" id="L104">			result = granularity.parse(dateStr);		</span>
<span class="nc" id="L105">		} catch (ParseException ex) {</span>
			if (HEALProviderConfig.debug) {
<span class="nc" id="L107">				System.out.println(&quot;*******************************************&quot;);</span>
<span class="nc" id="L108">				System.out.println(&quot;Error occured getting date:&quot;);</span>
<span class="nc" id="L109">				ex.printStackTrace();</span>
<span class="nc" id="L110">				System.out.println(&quot;*******************************************&quot;);</span>
			}
<span class="nc" id="L112">		}</span>
<span class="nc" id="L113">		return result;</span>
	}
	
	/* Constructs a date from the given string using the granularity
	 * of this provider
	 * Returns null if an error occurs
	 */
	public String getStringFromDate(Date dateDate) {
<span class="nc" id="L121">		return granularity.format(dateDate);		</span>
	}

	//These two are for the HEALDataAccessor
	/*
	 * returns the maximum number of records the provider should return before
	 * issuing a resumption tokens.
	 * a return value of -1 means that the provider doesn't stop until the
	 * end of the query has been reached and no resumption tokens will be
	 * given.
	 */
	public int getResumptionThreshold() {
<span class="nc" id="L133">		return resumptionThreshold;		</span>
	}

	/* The prefix tacked onto the beginning of the GlobalIDs to 
	 * create the OAI identifier
	 */
	public String getIDPrefix() {
<span class="nc" id="L140">		return idPrefix;</span>
	}	
	
	public String[] getAllowedCollections() {
<span class="nc" id="L144">		return allowedCollections;</span>
	}
	//These are for the HEALOAIDCAdapter
	public String getHEALVCard() {
<span class="nc" id="L148">		return healVCard;</span>
	}
	public String getMetametadataRole() {
<span class="nc" id="L151">		return metametadataRole;</span>
	}
	public String getCoverage() {
<span class="nc" id="L154">		return coverage;	</span>
	}
	
	/* All of the metadata formats supported by the server.
	 * This should at the least contain the oai_dc format.
	 * This returns an ArrayList of string identifiers.
	 */
	public OAIMetadataFormat[] getAllMetadataFormats() {
<span class="nc" id="L162">		return metadataFormats;</span>
	}

	/* (non-Javadoc)
	 * @see org.heal.module.oai.provider.OAIProviderConfig#getRepositoryName()
	 */
	public String getRepositoryName() {
<span class="nc" id="L169">		return repositoryName;</span>
	}

	/* (non-Javadoc)
	 * @see org.heal.module.oai.provider.OAIProviderConfig#getBaseURL()
	 */
	public String getBaseURL() {
<span class="nc" id="L176">		return baseURL;</span>
	}

	/* (non-Javadoc)
	 * @see org.heal.module.oai.provider.OAIProviderConfig#getAdminEmails()
	 */
	public String[] getAdminEmails() {
<span class="nc" id="L183">		return adminEmails;</span>
	}

	/* (non-Javadoc)
	 * @see org.heal.module.oai.provider.OAIProviderConfig#getEarliestDatestamp()
	 */
	public Date getEarliestDatestamp() {
		//HEAL didn't receive funding until September of 2000...
		//this should be configurable in a config file.
<span class="nc" id="L192">		return earliest;</span>
	}

	/* (non-Javadoc)
	 * @see org.heal.module.oai.provider.OAIProviderConfig#getDeletedRecord()
	 */
	public String getDeletedRecord() {
<span class="nc" id="L199">		return &quot;no&quot;;</span>
	}

	/* (non-Javadoc)
	 * @see org.heal.module.oai.provider.OAIProviderConfig#getGranularity()
	 */
	public OAIGranularity getGranularity() {
<span class="nc" id="L206">		return granularity;</span>
	}

	/* (non-Javadoc)
	 * @see org.heal.module.oai.provider.OAIProviderConfig#getCompressions()
	 */
	public String[] getCompressions() {
<span class="nc" id="L213">		return null;</span>
	}

	/* (non-Javadoc)
	 * @see org.heal.module.oai.provider.OAIProviderConfig#getDescriptions()
	 */
	public String[] getDescriptions() {
<span class="nc" id="L220">		return descriptions;</span>
	}

	/* (non-Javadoc)
	 * @see org.heal.module.oai.provider.OAIProviderConfig#getMetadataFormat(java.lang.String)
	 */
	public OAIMetadataFormat getMetadataFormat(final String prefix) {
<span class="nc" id="L227">		return (OAIMetadataFormat)formatMap.get(prefix);</span>
	}

	/* (non-Javadoc)
	 * @see org.heal.module.oai.provider.OAIProviderConfig#getRepositoryIdentifier()
	 */
	public String getRepositoryIdentifier() {
		// TODO Auto-generated method stub
<span class="nc" id="L235">		return null;</span>
	}

	/* (non-Javadoc)
	 * @see org.heal.module.oai.provider.OAIProviderConfig#getIdentifierDelimiter()
	 */
	public String getIdentifierDelimiter() {
		// TODO Auto-generated method stub
<span class="nc" id="L243">		return null;</span>
	}

	/* (non-Javadoc)
	 * @see org.heal.module.oai.provider.OAIProviderConfig#getSampleIdentifier()
	 */
	public String getSampleIdentifier() {
		// TODO Auto-generated method stub
<span class="nc" id="L251">		return null;</span>
	}
	
	public String getContentPrefix() {
<span class="nc" id="L255">		return contentPrefix;</span>
	}
	
	//Below are the HEAL specific configuration options:
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>