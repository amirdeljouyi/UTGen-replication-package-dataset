<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DownloadQueueBean.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">96_heal</a> &gt; <a href="index.source.html" class="el_package">org.heal.module.download</a> &gt; <span class="el_source">DownloadQueueBean.java</span></div><h1>DownloadQueueBean.java</h1><pre class="source lang-java linenums">package org.heal.module.download;

import java.io.File;
import java.io.Serializable;
import java.util.Collection;
import java.util.TreeSet;

/**
 * Stores a list of contentIds and a package file location and url.
 *
 * @author Seth Wright
 * @version 0.1
 */
<span class="nc" id="L14">public class DownloadQueueBean implements Serializable {</span>
<span class="nc" id="L15">    TreeSet contentSet = new TreeSet();</span>
<span class="nc" id="L16">    String packageFileLocation = null;</span>
<span class="nc" id="L17">    String packageURL = null;</span>
<span class="nc" id="L18">    boolean packageModifiedSinceFileCreated = true;</span>
<span class="nc" id="L19">    int packageFormat = -1;</span>

    /**
     * Get a collection of content Ids.
     */
    public Collection getContentIds() {
<span class="nc" id="L25">        return contentSet;</span>
    }

    /**
     * Returns true if the package has not been modified,
     * the package file location is not null, the
     * package URL is set, and the format of the
     * package is the same as that provided and
     * the package file exists on disk.
     */
    public boolean isPackageFileUpToDate(int format) {
<span class="nc bnc" id="L36" title="All 8 branches missed.">        if(packageModifiedSinceFileCreated ||</span>
                packageFileLocation == null ||
                packageURL == null ||
                format != packageFormat ||
<span class="nc bnc" id="L40" title="All 2 branches missed.">                !(new File(packageFileLocation)).exists()) {</span>
<span class="nc" id="L41">            return false;</span>
        }
<span class="nc" id="L43">        return true;</span>
    }

    /**
     * Returns the format for the package associated with this queue.
     * The value will be one of the static values defined in
     * DownloadServicesBean (ZIPFORMAT, GZIPFORMAT), or -1 if there
     * is no package associated with this queue.
     */
    public int getPackageFormat() {
<span class="nc" id="L53">        return packageFormat;</span>
    }

    /**
     * Sets the format for the package associated with this queue.
     * This value should be one of the static values defined in
     * DownloadServicesBean (ZIPFORMAT, GZIPFORMAT), or -1 if there
     * is no package associated with this queue.
     */
    public void setPackageFormat(int newPackageFormat) {
<span class="nc" id="L63">        packageFormat = newPackageFormat;</span>
<span class="nc" id="L64">    }</span>

    /**
     * Returns the file path to be used to access the package for this queue.
     */
    public String getPackageFileLocation() {
<span class="nc" id="L70">        return packageFileLocation;</span>
    }

    public void setPackageFileLocation(String newPackageFileLocation) {
<span class="nc" id="L74">        packageFileLocation = newPackageFileLocation;</span>
<span class="nc" id="L75">    }</span>

    /**
     * Returns the URL to be used to access the package for this queue.
     */
    public String getPackageURL() {
<span class="nc" id="L81">        return packageURL;</span>
    }

    /**
     * Sets the url used to access this package file.
     */
    public void setPackageURL(String newPackageURL) {
<span class="nc" id="L88">        packageURL = newPackageURL;</span>
<span class="nc" id="L89">    }</span>

    /**
     * call this method right after the package file is created.
     * This is used to track whether or not the queue has been modified
     * since the last time the associated file was created.
     */
    public void setPackageFileCreated() {
<span class="nc" id="L97">        packageModifiedSinceFileCreated = false;</span>
<span class="nc" id="L98">    }</span>

    /**
     * Checks whether or not the queue has changed since the last time
     * the package was generated.  If the queue has had metadata entries
     * added or removed since the last time the package has been
     * generated or the package has not yet been generated yet, then this
     * method will return true
     * otherwise, it will return false
     */
    public boolean isPackageModified() {
<span class="nc" id="L109">        return packageModifiedSinceFileCreated;</span>
    }

    /**
     * Adds a metadata id to the list of content to include in the package
     * generated for this queue.
     */
    public boolean addToQueue(String contentId) {
<span class="nc" id="L117">        packageModifiedSinceFileCreated = true;</span>
<span class="nc" id="L118">        contentSet.add(contentId);</span>
<span class="nc" id="L119">        return true;</span>
    }

    /**
     * Removes a metadata id from the list of content to include in the package
     * generated for this queue.
     */
    public boolean removeFromQueue(String contentId) {
<span class="nc" id="L127">        packageModifiedSinceFileCreated = true;</span>
<span class="nc" id="L128">        return contentSet.remove(contentId);</span>
    }

    /**
     * Removes all metadata id from the list of content to include in the
     * package generated for this queue.
     */
    public boolean removeAllFromQueue() {
<span class="nc" id="L136">        packageModifiedSinceFileCreated = true;</span>
<span class="nc" id="L137">        contentSet.clear();</span>
<span class="nc" id="L138">        return true;</span>
    }

    /**
     * Deletes all package file settings (last modified, location, url)
     * but leaves the queue of id's intact.
     * Returns true on success.
     */
    public boolean clearPackageFileSettings() {
<span class="nc" id="L147">        packageFileLocation = null;</span>
<span class="nc" id="L148">        packageURL = null;</span>
<span class="nc" id="L149">        packageModifiedSinceFileCreated = true;</span>
<span class="nc" id="L150">        packageFormat = -1;</span>
<span class="nc" id="L151">        return true;</span>
    }

    /**
     * Returns true if the specified metadataId is already in the queue.
     * Otherwise, it returns false.
     */
    public boolean isQueuedAlready(String contentId) {
<span class="nc" id="L159">        return contentSet.contains(contentId);</span>
    }

    /**
     * Returns the number of items queued for download.
     */
    public int getNumEntries() {
<span class="nc" id="L166">        return contentSet.size();</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>