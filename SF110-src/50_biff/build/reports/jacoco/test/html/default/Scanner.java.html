<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Scanner.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">50_biff</a> &gt; <a href="index.source.html" class="el_package">default</a> &gt; <span class="el_source">Scanner.java</span></div><h1>Scanner.java</h1><pre class="source lang-java linenums">/*&quot;Pascal interpreter written in Java&quot; jest przeznaczony do 
 interpretacji kodu napisanego w j�zyku Pascal.
Copyright (C) 2004/2005 Bartyna Waldemar, Faderewski Marek,
Fedorczyk �ukasz, Iwanowski Wojciech.
Niniejszy program jest wolnym oprogramowaniem; mo�esz go 
rozprowadza� dalej i/lub modyfikowa� na warunkach Powszechnej
Licencji Publicznej GNU, wydanej przez Fundacj� Wolnego
Oprogramowania - wed�ug wersji 2-giej tej Licencji lub kt�rej�
z p�niejszych wersji. 

Niniejszy program rozpowszechniany jest z nadziej�, i� b�dzie on 
u�yteczny - jednak BEZ JAKIEJKOLWIEK GWARANCJI, nawet domy�lnej 
gwarancji PRZYDATNO�CI HANDLOWEJ albo PRZYDATNO�CI DO OKRE�LONYCH 
ZASTOSOWA�. W celu uzyskania bli�szych informacji - Powszechna 
Licencja Publiczna GNU. 

Z pewno�ci� wraz z niniejszym programem otrzyma�e� te� egzemplarz 
Powszechnej Licencji Publicznej GNU (GNU General Public License);
je�li nie - napisz do Free Software Foundation, Inc., 675 Mass Ave,
Cambridge, MA 02139, USA.
*/

import java.io.*;
import java.util.ArrayList;

public class Scanner {

<span class="fc" id="L28">	public ArrayList lexems = new ArrayList();</span>

	// variables for validation process
<span class="fc" id="L31">	ArrayList vars = new ArrayList();</span>
<span class="fc" id="L32">	ArrayList var_types = new ArrayList();</span>
<span class="fc" id="L33">	ArrayList var_vals = new ArrayList();</span>
	// position in Advenced Lexems Array
<span class="fc" id="L35">	private int pos = 0;</span>
	// position during instruction evaluating
<span class="fc" id="L37">	private int place = 0;</span>
<span class="fc" id="L38">	private int main_begin = 0;</span>

<span class="fc" id="L40">	public Scanner(String filename) throws Exception {</span>

<span class="fc" id="L42">		File file = new File(filename);</span>
<span class="nc" id="L43">		FileInputStream filein = new FileInputStream(file);</span>

		// array of 'lexem' objects
<span class="nc" id="L46">		lexems = new ArrayList();</span>

		// current lexem
<span class="nc" id="L49">		StringBuffer value = new StringBuffer();</span>

		// current type of lexem
<span class="nc" id="L52">		byte type = 0;</span>

		// current line
<span class="nc" id="L55">		int line = 1;</span>

		// current column
<span class="nc" id="L58">		int column = 1;</span>

		// where the lexem began
<span class="nc" id="L61">		int began = 1;</span>
		
		// where the String began
<span class="nc" id="L64">		int sline = 1;</span>

<span class="nc" id="L66">		int bite = filein.read();</span>
<span class="nc bnc" id="L67" title="All 2 branches missed.">		while (bite != -1) {</span>
			// if bite is a quotation mark
<span class="nc bnc" id="L69" title="All 2 branches missed.">			if (bite == 34) {</span>
<span class="nc bnc" id="L70" title="All 2 branches missed.">				if (type != 0) {</span>
<span class="nc" id="L71">					lexems.add(new Lexem(value, type, line, began));</span>
<span class="nc" id="L72">					value = new StringBuffer();</span>
				}
<span class="nc bnc" id="L74" title="All 2 branches missed.">				if (type != 5) {</span>
<span class="nc" id="L75">					type = 5;</span>
<span class="nc" id="L76">					began = column;</span>
<span class="nc" id="L77">					sline = line;</span>
				}
				else
<span class="nc" id="L80">					type = 0;</span>
			}
<span class="nc bnc" id="L82" title="All 2 branches missed.">			else if (type == 5) {</span>
<span class="nc" id="L83">				value.append((char)bite);</span>
<span class="nc bnc" id="L84" title="All 2 branches missed.">				if (bite == 13) {</span>
<span class="nc" id="L85">					line ++;</span>
<span class="nc" id="L86">					column = -1;</span>
				}
			}
			// if bite is a digit
<span class="nc bnc" id="L90" title="All 4 branches missed.">			else if ((bite &gt;= 48) &amp;&amp; (bite &lt;= 57)) {</span>
<span class="nc bnc" id="L91" title="All 2 branches missed.">				if (type == 0) {</span>
<span class="nc" id="L92">					type = 1;</span>
<span class="nc" id="L93">					began = column;</span>
				}
<span class="nc" id="L95">				value.append((char)bite);</span>
			}
			else
				// if bite is a letter
<span class="nc bnc" id="L99" title="All 8 branches missed.">				if (((bite &gt;= 65) &amp;&amp; (bite &lt;= 90)) ||</span>
					((bite &gt;= 97) &amp;&amp; (bite &lt;= 122))) {
<span class="nc bnc" id="L101" title="All 2 branches missed.">					if (type == 0) {</span>
<span class="nc" id="L102">						type = 3;</span>
<span class="nc" id="L103">						began = column;</span>
<span class="nc" id="L104">						value.append((char)bite);</span>
					}
					else
<span class="nc bnc" id="L107" title="All 2 branches missed.">						if (type == 3)</span>
<span class="nc" id="L108">							value.append((char)bite);</span>
						else {
<span class="nc" id="L110">							type = 7;</span>
<span class="nc" id="L111">							break;</span>
						}
				}
				else
					// if bite is a sign
<span class="nc bnc" id="L116" title="All 10 branches missed.">					if (((bite &gt;= 40) &amp;&amp; (bite &lt;= 45)) ||</span>
						 (bite == 47) ||
						((bite &gt;= 58) &amp;&amp; (bite &lt;= 62))) {
<span class="nc bnc" id="L119" title="All 2 branches missed.">						if (type != 0) {</span>
<span class="nc" id="L120">							lexems.add(new Lexem(value, type, line, began));</span>
<span class="nc" id="L121">							type = 0;</span>
<span class="nc" id="L122">							value = new StringBuffer();</span>
						}
<span class="nc" id="L124">						lexems.add(new Lexem(bite, 4, line, column));</span>
					}
					else
						// if bite is a dot
<span class="nc bnc" id="L128" title="All 2 branches missed.">						if (bite == 46)</span>
<span class="nc bnc" id="L129" title="All 2 branches missed.">							if (type != 0)</span>
<span class="nc bnc" id="L130" title="All 2 branches missed.">								if (type == 3)</span>
<span class="nc" id="L131">									if (((value.toString())</span>
<span class="nc bnc" id="L132" title="All 2 branches missed.">										  .toUpperCase()).equals(&quot;END&quot;)) {</span>
<span class="nc" id="L133">										lexems.add(new Lexem(&quot;END.&quot;,</span>
												   (byte)3, line, began));
<span class="nc" id="L135">										type = 0;</span>
<span class="nc" id="L136">										value = new StringBuffer();</span>
									}
									else {
<span class="nc" id="L139">										type = 8;</span>
<span class="nc" id="L140">										break;</span>
									}
								else
<span class="nc bnc" id="L143" title="All 2 branches missed.">									if (type == 1) {</span>
<span class="nc" id="L144">										type = 2;</span>
<span class="nc" id="L145">										value.append('.');</span>
									}
									else {
<span class="nc" id="L148">										type = 8;</span>
<span class="nc" id="L149">										break;</span>
									}
							else {
<span class="nc" id="L152">								type = 8;</span>
<span class="nc" id="L153">								break;</span>
							}
						else
							// if bite is a separator
<span class="nc bnc" id="L157" title="All 8 branches missed.">							if ((bite ==  9) || (bite == 32) ||</span>
								(bite == 13) || (bite == 10)) {
<span class="nc bnc" id="L159" title="All 2 branches missed.">									if (type != 0) {</span>
<span class="nc" id="L160">										lexems.add(new Lexem(value,</span>
												   type, line, began));
<span class="nc" id="L162">										type = 0;</span>
<span class="nc" id="L163">										value = new StringBuffer();</span>
									}
<span class="nc bnc" id="L165" title="All 2 branches missed.">									if (bite == 13) {</span>
<span class="nc" id="L166">										line ++;</span>
<span class="nc" id="L167">										column = -1;</span>
									}
								}
							// bite is not allowed character
							else {
<span class="nc" id="L172">								type = 9;</span>
<span class="nc" id="L173">								break;</span>
							}
<span class="nc" id="L175">			bite = filein.read();</span>
<span class="nc bnc" id="L176" title="All 4 branches missed.">			if ((bite == -1) &amp;&amp; (type == 5))</span>
<span class="nc" id="L177">				type = 6;</span>
<span class="nc bnc" id="L178" title="All 2 branches missed.">			else if (bite == -1) </span>
<span class="nc bnc" id="L179" title="All 2 branches missed.">				if (type != 0) {</span>
<span class="nc" id="L180">					lexems.add(new Lexem(value, type, line, began));</span>
<span class="nc" id="L181">					type = 0;</span>
<span class="nc" id="L182">					value = new StringBuffer();</span>
				}
<span class="nc" id="L184">			column ++;</span>
		}

		// error handling
<span class="nc bnc" id="L188" title="All 2 branches missed.">		if (type == 6)</span>
<span class="nc" id="L189">			System.out.println(&quot;ERROR: String not closed ! &quot;</span>
				+ &quot;line: &quot; + sline + &quot;, column: &quot; + began);
<span class="nc bnc" id="L191" title="All 2 branches missed.">		else if (type == 7)</span>
<span class="nc" id="L192">			System.out.println(&quot;ERROR: letter joined with number ! &quot;</span>
				+ &quot;line: &quot; + line + &quot;, column: &quot; + column);
		else
<span class="nc bnc" id="L195" title="All 2 branches missed.">			if (type == 8)</span>
<span class="nc" id="L196">				System.out.println(&quot;ERROR: dot in wrong place ! &quot;</span>
			  		+ &quot;line: &quot; + line + &quot;, column: &quot; + column);
			else
<span class="nc bnc" id="L199" title="All 2 branches missed.">				if (type == 9)</span>
<span class="nc" id="L200">					System.out.println(&quot;ERROR: illegal character !: &quot;</span>
						+ (char)bite
			  			+ &quot; line: &quot; + line + &quot;, column: &quot; + column);
				else {
					// if everything is OK
//					printLexems(lexems);
					// advenced scunning (father, deeper clasification)
<span class="nc" id="L207">					ArrayList AdvL = advScanning(lexems);</span>
//                	printAdvLexems(AdvL);
					// validation process
<span class="nc" id="L210">                	String tmp_result = checkStructure(AdvL);</span>
<span class="nc" id="L211">         			System.out.println(tmp_result);</span>
<span class="nc bnc" id="L212" title="All 2 branches missed.">          			if (tmp_result.equals(&quot;No errors !&quot;)) {</span>
<span class="nc" id="L213">          				System.out.println(&quot;===================&quot;);</span>
          				// variables initialization
<span class="nc" id="L215">          				initializeVars();</span>
<span class="nc" id="L216">          				pos = main_begin;</span>
          				// interpretation process
<span class="nc" id="L218">          				ArrayList ExecL = interBody(AdvL);</span>
          				// execution
<span class="nc" id="L220">          				execute(ExecL);</span>
          				
          			
/*    
	System.out.println(&quot;IAL Size = &quot; + ExecL.size());  
	for (int i = 0; i &lt; ExecL.size(); i++) {
		System.out.println(((ExecLexem)ExecL.get(i)).type);
		System.out.println(((ExecLexem)ExecL.get(i)).variable);
		System.out.println(&quot;If TRUE SIZE = &quot; + ((ExecLexem)ExecL.get(i)).
															iftrue.size());
		for (int j = 0; j &lt; ((ExecLexem)ExecL.get(i)).lexems.length; j++)
			System.out.println(((ExecLexem)ExecL.get(i)).lexems[j].value);
	} 	*/
	
}
				}
<span class="nc" id="L236">	}// Scanner()</span>

	public void printLexems(ArrayList lex) {
<span class="nc" id="L239">		System.out.println(&quot;\nLEXEMS: &quot; + lex.size());</span>
<span class="nc" id="L240">		System.out.println(&quot;VALUE   TYPE   LINE   COLUMN&quot;);</span>
<span class="nc" id="L241">		Object[] lexems = lex.toArray();</span>
<span class="nc bnc" id="L242" title="All 2 branches missed.">		for (int i = 0; i &lt; lexems.length; i ++) {</span>
<span class="nc" id="L243">			Lexem lexem = (Lexem)lexems[i];</span>
<span class="nc" id="L244">			System.out.println(lexem.value + &quot;   &quot; + lexem.type + &quot;   &quot;</span>
							 + lexem.line + &quot;   &quot; + lexem.column);
		}
<span class="nc" id="L247">		System.out.println();</span>
<span class="nc" id="L248">	}// printLexems(ArrayList)</span>
	
	public void printAdvLexems(ArrayList AdvLex) {
<span class="nc" id="L251">		System.out.println(&quot;\nLEXEMS: &quot; + AdvLex.size());</span>
<span class="nc" id="L252">		System.out.println(&quot;VALUE   CODE   LCATEGORY   &quot;</span>
						 + &quot;HCATEGORY   LINE   COLUMN&quot;);
<span class="nc" id="L254">		Object[] AdvLexems = AdvLex.toArray();</span>
<span class="nc bnc" id="L255" title="All 2 branches missed.">		for (int i = 0; i &lt; AdvLexems.length; i ++) {</span>
<span class="nc" id="L256">			AdvLexem advlexem = (AdvLexem)AdvLexems[i];</span>
<span class="nc" id="L257">			System.out.println(advlexem.value + &quot;   &quot; + advlexem.code + &quot;   &quot;</span>
							 + advlexem.lcategory + &quot;   &quot; 
							 + advlexem.hcategory + &quot;   &quot;
							 + advlexem.line + &quot;   &quot; + advlexem.column);
		}
<span class="nc" id="L262">		System.out.println();</span>
<span class="nc" id="L263">	}// printLexems(ArrayList)</span>

	public ArrayList advScanning(ArrayList lexems) {
<span class="nc" id="L266">		ArrayList AdvLexems = new ArrayList();</span>
<span class="nc" id="L267">		String value = &quot;&quot;;</span>
<span class="nc" id="L268">		Codes codes = new Codes();</span>
<span class="nc" id="L269">		codes.fillLists();</span>
<span class="nc" id="L270">		Lexem lexem = null;</span>
<span class="nc" id="L271">		byte code = 0;</span>
<span class="nc" id="L272">		byte lcategory = 0;</span>
<span class="nc" id="L273">		byte hcategory = 0;</span>
		
<span class="nc" id="L275">		int size = lexems.size();</span>
<span class="nc" id="L276">		int i = 0;</span>
<span class="nc bnc" id="L277" title="All 2 branches missed.">		while (i &lt; size) {</span>
<span class="nc" id="L278">			lexem = (Lexem)lexems.get(i);</span>
			
			// if lexem is a word
<span class="nc bnc" id="L281" title="All 2 branches missed.">			if (lexem.type == codes.STRING)</span>
<span class="nc" id="L282">				AdvLexems.add(new AdvLexem(lexem.value, codes.STRING,</span>
							  codes.STRING, codes.STRING,
							  lexem.line, lexem.column));
<span class="nc bnc" id="L285" title="All 2 branches missed.">			else if (lexem.type == codes.WORD) {</span>
<span class="nc" id="L286">				hcategory = codes.WORD;</span>
<span class="nc" id="L287">				code = codes.getKeywordCode(lexem.value);</span>

<span class="nc bnc" id="L289" title="All 2 branches missed.">				if (code == codes.VARIABLE)</span>
<span class="nc" id="L290">					lcategory = codes.VARIABLE;</span>
<span class="nc bnc" id="L291" title="All 4 branches missed.">				else if ((code &gt;= codes.AND) &amp;&amp; (code &lt;= codes.OR))</span>
<span class="nc" id="L292">					lcategory = codes.LOPERATOR;</span>
<span class="nc bnc" id="L293" title="All 4 branches missed.">				else if ((code &gt;= codes.INTEGER) &amp;&amp; (code &lt;= codes.BOOLEAN))</span>
<span class="nc" id="L294">					lcategory = codes.VTYPE;					</span>
				else
<span class="nc" id="L296">					lcategory = codes.KEYWORD;</span>
				
<span class="nc" id="L298">				AdvLexems.add(new AdvLexem(lexem.value, code,</span>
							  lcategory, hcategory,
							  lexem.line, lexem.column));
			}
			
			// if lexem is a sign
<span class="nc bnc" id="L304" title="All 2 branches missed.">			else if (lexem.type == codes.SIGN) {</span>
<span class="nc" id="L305">				value = lexem.value;;</span>
<span class="nc" id="L306">				hcategory = codes.SIGN;</span>
<span class="nc" id="L307">				code = codes.getSignCode(lexem.value);</span>
				
<span class="nc bnc" id="L309" title="All 4 branches missed.">				if ((code &gt;= codes.COLON) &amp;&amp; (code &lt;= codes.QUOTATION)) {</span>
<span class="nc" id="L310">					lcategory = codes.OOPERATOR;</span>
<span class="nc bnc" id="L311" title="All 2 branches missed.">					if (lexem.value.equals(&quot;:&quot;))</span>
<span class="nc bnc" id="L312" title="All 2 branches missed.">						if ((i + 1) &lt; size)</span>
<span class="nc bnc" id="L313" title="All 2 branches missed.">							if (((Lexem)lexems.get(i + 1)).value.equals(&quot;=&quot;)) {</span>
<span class="nc" id="L314">								code = codes.ASOCIATE;</span>
<span class="nc" id="L315">								value = &quot;:=&quot;;</span>
<span class="nc" id="L316">								i ++;</span>
							}
				}
<span class="nc bnc" id="L319" title="All 4 branches missed.">				else if ((code &gt;= codes.E) &amp;&amp; (code &lt;= codes.LE)) {</span>
<span class="nc" id="L320">					lcategory = codes.ROPERATOR;</span>
<span class="nc bnc" id="L321" title="All 2 branches missed.">					if (lexem.value.equals(&quot;&lt;&quot;))</span>
<span class="nc bnc" id="L322" title="All 2 branches missed.">						if ((i + 1) &lt; size) {</span>
<span class="nc bnc" id="L323" title="All 2 branches missed.">							if (((Lexem)lexems.get(i + 1)).value.equals(&quot;=&quot;)) {</span>
<span class="nc" id="L324">								code = codes.LE;</span>
<span class="nc" id="L325">								value = &quot;&lt;=&quot;;</span>
<span class="nc" id="L326">								i ++;</span>
							}
<span class="nc bnc" id="L328" title="All 2 branches missed.">							if (((Lexem)lexems.get(i + 1)).value.equals(&quot;&gt;&quot;)) {</span>
<span class="nc" id="L329">								code = codes.NE;</span>
<span class="nc" id="L330">								value = &quot;&lt;&gt;&quot;;</span>
<span class="nc" id="L331">								i ++;</span>
							}
						}
<span class="nc bnc" id="L334" title="All 2 branches missed.">					else if (lexem.value.equals(&quot;&gt;&quot;))</span>
<span class="nc bnc" id="L335" title="All 2 branches missed.">						if ((i + 1) &lt; size)</span>
<span class="nc bnc" id="L336" title="All 2 branches missed.">							if (((Lexem)lexems.get(i + 1)).value.equals(&quot;=&quot;)) {</span>
<span class="nc" id="L337">								code = codes.GE;</span>
<span class="nc" id="L338">								value = &quot;&gt;=&quot;;</span>
<span class="nc" id="L339">								i ++;</span>
							}
				}
<span class="nc bnc" id="L342" title="All 4 branches missed.">				else if ((code &gt;= codes.PLUS) &amp;&amp; (code &lt;= codes.DIV)) {</span>
<span class="nc" id="L343">					lcategory = codes.AOPERATOR;</span>
				}
<span class="nc" id="L345">				AdvLexems.add(new AdvLexem(value, code,</span>
							  lcategory, hcategory,
							  lexem.line, lexem.column));
			}
			else
<span class="nc" id="L350">				AdvLexems.add(new AdvLexem(lexem.value, lexem.type,</span>
							  codes.NUMBER, codes.WORD,
							  lexem.line, lexem.column));
<span class="nc" id="L353">			i ++;</span>
		}
<span class="nc" id="L355">		return AdvLexems;</span>
	}// advScanning()

	private String errorMess(String expected, AdvLexem found) {
<span class="nc" id="L359">		return (&quot;expected: &quot; + expected</span>
			 + &quot;\n   found: &quot; + found.value
			 + &quot;\n   line: &quot; + found.line
			 + &quot;\n   column: &quot; + found.column);
	}// errorMess()

	private String errorMess(String expected) {
<span class="nc" id="L366">		return (&quot;expected: &quot; + expected</span>
			 + &quot;   nothing found&quot;);
	}// errorMess()
	
	
	// checks if there is a lexem of given Code
	private String checkC(String s, byte code, ArrayList AL) {
<span class="nc bnc" id="L373" title="All 2 branches missed.">		if (pos &lt; AL.size()) {</span>
<span class="nc" id="L374">			AdvLexem al = (AdvLexem)AL.get(pos);</span>
<span class="nc bnc" id="L375" title="All 2 branches missed.">			if (al.code != code)</span>
<span class="nc" id="L376">				return errorMess(s, al);</span>
<span class="nc" id="L377">		}</span>
		else
<span class="nc" id="L379">			return errorMess(s);</span>
<span class="nc" id="L380">		return &quot;&quot;;</span>
	}// checkC()

	private String checkC(String s, byte code, ArrayList AL, int which) {
<span class="nc bnc" id="L384" title="All 2 branches missed.">		if (which &lt; AL.size()) {</span>
<span class="nc" id="L385">			AdvLexem al = (AdvLexem)AL.get(which);</span>
<span class="nc bnc" id="L386" title="All 2 branches missed.">			if (al.code != code)</span>
<span class="nc" id="L387">				return errorMess(s, al);</span>
<span class="nc" id="L388">		}</span>
		else
<span class="nc" id="L390">			return errorMess(s);</span>
<span class="nc" id="L391">		return &quot;&quot;;</span>
	}// checkC()
	
	// checks if there is a lexem of given Lower category
	private String checkL(String s, byte code, ArrayList AL) {
<span class="nc bnc" id="L396" title="All 2 branches missed.">		if (pos &lt; AL.size()) {</span>
<span class="nc" id="L397">			AdvLexem al = (AdvLexem)AL.get(pos);</span>
<span class="nc bnc" id="L398" title="All 2 branches missed.">			if (al.lcategory != code)</span>
<span class="nc" id="L399">				return errorMess(s, al);</span>
<span class="nc" id="L400">		}</span>
		else
<span class="nc" id="L402">			return errorMess(s);</span>
<span class="nc" id="L403">		return &quot;&quot;;</span>
	}// checkL()
	
// mmmmmmmmmmmmmmmmmmm	VALIDATION	mmmmmmmmmmmmmmmmmmmmmmmmmmm
	
	public String checkStructure(ArrayList AL) {		
<span class="nc" id="L409">		Codes codes = new Codes();</span>
<span class="nc" id="L410">		codes.fillLists();</span>
<span class="nc" id="L411">		String result = &quot;&quot;;</span>
		AdvLexem al;
<span class="nc" id="L413">		int size = AL.size();</span>
<span class="nc" id="L414">		result = checkC(&quot;PROGRAM&quot;, codes.PROGRAM, AL);</span>
<span class="nc bnc" id="L415" title="All 2 branches missed.">		if (!(result.equals(&quot;&quot;)))</span>
<span class="nc" id="L416">			return result;</span>
<span class="nc" id="L417">		pos ++;</span>
<span class="nc" id="L418">		result = checkC(&quot;VARIABLE&quot;, codes.VARIABLE, AL);</span>
<span class="nc bnc" id="L419" title="All 2 branches missed.">		if (!(result.equals(&quot;&quot;)))</span>
<span class="nc" id="L420">			return result;</span>
<span class="nc" id="L421">		pos ++;</span>
<span class="nc" id="L422">		result = checkC(&quot;SEMICOLON&quot;, codes.SEMICOLON, AL);</span>
<span class="nc bnc" id="L423" title="All 2 branches missed.">		if (!(result.equals(&quot;&quot;)))</span>
<span class="nc" id="L424">			return result;</span>
<span class="nc" id="L425">		pos ++;</span>
<span class="nc" id="L426">		result = checkC(&quot;VAR&quot;, codes.VAR, AL);</span>
<span class="nc bnc" id="L427" title="All 2 branches missed.">		if (!(result.equals(&quot;&quot;))) {</span>
<span class="nc" id="L428">			result = checkC(&quot;VAR or BEGIN&quot;, codes.BEGIN, AL);</span>
<span class="nc bnc" id="L429" title="All 2 branches missed.">			if (!(result.equals(&quot;&quot;)))</span>
<span class="nc" id="L430">				return result;</span>
		}
<span class="nc bnc" id="L432" title="All 2 branches missed.">		if ((((AdvLexem)AL.get(pos)).value).equals(&quot;VAR&quot;)) {</span>
<span class="nc" id="L433">			pos ++;</span>
<span class="nc" id="L434">			result = checkVAR(AL);</span>
<span class="nc bnc" id="L435" title="All 2 branches missed.">			if (!(result.equals(&quot;&quot;)))</span>
<span class="nc" id="L436">				return result;</span>
		}

		// now we check if there is END. at the end of the program
<span class="nc bnc" id="L440" title="All 2 branches missed.">		if (AL.size() - 1 &gt; pos) {</span>
<span class="nc" id="L441">			result = checkC(&quot;END.&quot;, Codes.END_DOT, AL, AL.size() - 1);</span>
<span class="nc bnc" id="L442" title="All 2 branches missed.">			if (!(result.equals(&quot;&quot;)))</span>
<span class="nc" id="L443">				return result;</span>
		}
		else
<span class="nc" id="L446">			return &quot;expected: END. at the end of program&quot;;</span>

		// now we check if all VARIABLES are declared
<span class="nc bnc" id="L449" title="All 2 branches missed.">		for (int i = pos + 1; i &lt; AL.size() - 2; i ++) {</span>
<span class="nc" id="L450">			al = (AdvLexem)(AL.get(i));</span>
<span class="nc bnc" id="L451" title="All 2 branches missed.">			if (al.code == Codes.VARIABLE)</span>
<span class="nc bnc" id="L452" title="All 2 branches missed.">				if (!(vars.contains(al.value)))</span>
<span class="nc" id="L453">					return &quot;cannot resolve symbol variable &quot; + al.value</span>
						 + &quot;\n   line: &quot; + al.line
						 + &quot;\n   column: &quot; + al.column;
		}
		
<span class="nc" id="L458">		pos ++;</span>
<span class="nc" id="L459">		main_begin = pos;</span>
<span class="nc" id="L460">		result = checkBody(AL);</span>

/*
//testing...
System.out.println(&quot;Position = &quot; + pos);
al = (AdvLexem)AL.get(pos);
System.out.println(&quot;Lexem value = &quot; + al.value);
*/
		
<span class="nc bnc" id="L469" title="All 2 branches missed.">		if (!(result.equals(&quot;&quot;)))</span>
<span class="nc" id="L470">			return result;</span>

<span class="nc" id="L472">		return &quot;No errors !&quot;;</span>
	}// checkStructure

	private String checkVAR(ArrayList AL) {
<span class="nc" id="L476">		byte var_count = 0;</span>
<span class="nc" id="L477">		String result = &quot;&quot;;</span>
<span class="nc" id="L478">		AdvLexem al = null;</span>
		// if BEGIN appears changes to TRUE
<span class="nc" id="L480">		boolean finish_b = false;</span>
		// if there is no COMMA changes to TRUE
<span class="nc" id="L482">		boolean finish_c = false;</span>

<span class="nc bnc" id="L484" title="All 2 branches missed.">		while (!finish_b) {</span>
<span class="nc" id="L485">			result = checkC(&quot;BEGIN&quot;, Codes.BEGIN, AL);</span>
			// if there is no BEGIN yet
<span class="nc bnc" id="L487" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L488">				result = checkC(&quot;VARIABLE&quot;, Codes.VARIABLE, AL);</span>
				// if there is a VARIABLE
<span class="nc bnc" id="L490" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L491">					return result;</span>
<span class="nc" id="L492">				al = (AdvLexem)AL.get(pos);</span>
<span class="nc bnc" id="L493" title="All 2 branches missed.">				if ((((AdvLexem)AL.get(1)).value).equals(al.value))</span>
<span class="nc" id="L494">					return &quot;VARIABLE is already used as a neme of the program&quot;</span>
						 + &quot;\n   line: &quot; + al.line
						 + &quot;\n   column: &quot; + al.column;
<span class="nc bnc" id="L497" title="All 2 branches missed.">				if (vars.contains(al.value))</span>
<span class="nc" id="L498">					return (&quot;VARIABLE already declared: &quot; + al.value</span>
						 + &quot;\n   line: &quot; + al.line
						 + &quot;\n   column: &quot; + al.column);
<span class="nc" id="L501">				vars.add(al.value);</span>
<span class="nc" id="L502">				var_count ++;</span>
<span class="nc" id="L503">				finish_c = false;</span>
<span class="nc bnc" id="L504" title="All 2 branches missed.">				while (!finish_c) {</span>
<span class="nc" id="L505">					pos ++;</span>
<span class="nc" id="L506">					result = checkC(&quot;COMMA&quot;, Codes.COMMA, AL);</span>
<span class="nc bnc" id="L507" title="All 2 branches missed.">					if (result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L508">						pos ++;</span>
<span class="nc" id="L509">						result = checkC(&quot;VARIABLE&quot;, Codes.VARIABLE, AL);</span>
<span class="nc bnc" id="L510" title="All 2 branches missed.">						if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L511">							return result;</span>
<span class="nc" id="L512">						al = (AdvLexem)AL.get(pos);</span>
<span class="nc bnc" id="L513" title="All 2 branches missed.">						if ((((AdvLexem)AL.get(1)).value).equals(al.value))</span>
<span class="nc" id="L514">							return &quot;VARIABLE is already used as a neme &quot;</span>
							     + &quot;of the program&quot;
								 + &quot;\n   line: &quot; + al.line
								 + &quot;\n   column: &quot; + al.column;
<span class="nc bnc" id="L518" title="All 2 branches missed.">						if (vars.contains(al.value))</span>
<span class="nc" id="L519">							return (&quot;VARIABLE already declared: &quot; + al.value</span>
								 + &quot;\n   line: &quot; + al.line
								 + &quot;\n   column: &quot; + al.column);
<span class="nc" id="L522">						vars.add(al.value);</span>
<span class="nc" id="L523">						var_count ++;</span>
					}
					else
<span class="nc" id="L526">						finish_c = true;</span>
				}// while
<span class="nc" id="L528">				result = checkC(&quot;COLON&quot;, Codes.COLON, AL);</span>
<span class="nc bnc" id="L529" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L530">					return result;</span>
<span class="nc" id="L531">				pos ++;</span>
<span class="nc" id="L532">				result = checkL(&quot;VARIABLE TYPE&quot;, Codes.VTYPE, AL);</span>
<span class="nc bnc" id="L533" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L534">					return result;</span>

<span class="nc" id="L536">				byte code = ((AdvLexem)AL.get(pos)).code;</span>
<span class="nc bnc" id="L537" title="All 2 branches missed.">				for (byte i = 0; i &lt; var_count; i ++)</span>
<span class="nc" id="L538">					var_types.add(new Integer(code));</span>
<span class="nc" id="L539">				var_count = 0;</span>
				
<span class="nc" id="L541">				pos ++;</span>
<span class="nc" id="L542">				result = checkC(&quot;SEMICOLON&quot;, Codes.SEMICOLON, AL);</span>
<span class="nc bnc" id="L543" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L544">					return result;	</span>
<span class="nc" id="L545">				pos ++;	</span>
<span class="nc" id="L546">			}</span>
			else 
<span class="nc" id="L548">				finish_b = true;</span>
		}// while
<span class="nc" id="L550">		return &quot;&quot;;</span>
	}// checkVAR()

	private String checkIASSOC(ArrayList AL) {
<span class="nc" id="L554">		String result = &quot;&quot;;</span>
<span class="nc" id="L555">		AdvLexem al = null;</span>
<span class="nc" id="L556">		byte b_count = 0; // brackets count</span>
<span class="nc" id="L557">		boolean finish_b = false; // finish if no more brackets</span>

<span class="nc bnc" id="L559" title="All 2 branches missed.">		while (!finish_b) {</span>
<span class="nc" id="L560">			result = checkC(&quot;VALUE&quot;, Codes.LBRACKET, AL);</span>
<span class="nc bnc" id="L561" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L562">				finish_b = true;</span>
			else {
<span class="nc" id="L564">				b_count ++;</span>
<span class="nc" id="L565">				pos ++;</span>
			}
		}
<span class="nc" id="L568">		result = checkC(&quot;VALUE&quot;, Codes.MINUS, AL);</span>
<span class="nc bnc" id="L569" title="All 2 branches missed.">		if (result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L570">			pos ++;</span>
<span class="nc" id="L571">			result = checkC(&quot;INTEGER NUMBER&quot;, Codes.INUMBER, AL);</span>
<span class="nc bnc" id="L572" title="All 2 branches missed.">			if (result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L573">				al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L574">				AL.set(pos - 1, new AdvLexem(&quot;-&quot; + al.value, al.code,</span>
											  al.lcategory, al.hcategory,
											  al.line, al.column));
<span class="nc" id="L577">				AL.remove(pos);</span>
			}
			else
<span class="nc" id="L580">				return result;</span>
		}
		else {
<span class="nc" id="L583">			result = checkC(&quot;INTEGER VALUE&quot;, Codes.INUMBER, AL);</span>
<span class="nc bnc" id="L584" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L585">				result = checkC(&quot;INTEGER VARIABLE&quot;, Codes.VARIABLE, AL);</span>
<span class="nc bnc" id="L586" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L587">					return result;			</span>
				else {
<span class="nc" id="L589">					al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L590">					int tmp = vars.indexOf(al.value);</span>
<span class="nc bnc" id="L591" title="All 2 branches missed.">					if (!(((Integer)var_types.get(tmp)).equals(</span>
										new Integer(Codes.INTEGER)))) {
<span class="nc" id="L593">						al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L594">						return &quot;INTEGER VARIABLE expected &quot;</span>
							 + &quot;\n   found: &quot; + al.value
							 + &quot;\n   line: &quot; + al.line
							 + &quot;\n   column: &quot; + al.column;
					}
					else
<span class="nc" id="L600">						pos++;</span>
<span class="nc" id="L601">				}</span>
			}
			else
<span class="nc" id="L604">				pos ++;</span>
		}
<span class="nc" id="L606">		finish_b = false;</span>
<span class="nc bnc" id="L607" title="All 2 branches missed.">		while (!finish_b) {</span>
<span class="nc" id="L608">			result = checkC(&quot;OPERATOR&quot;, Codes.RBRACKET, AL);</span>
<span class="nc bnc" id="L609" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L610">				finish_b = true;</span>
			else {
<span class="nc bnc" id="L612" title="All 2 branches missed.">				if (b_count &gt; 0) {</span>
<span class="nc" id="L613">					b_count --;</span>
<span class="nc" id="L614">					pos ++;</span>
				}
				else {
<span class="nc" id="L617">					al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L618">					return &quot;RIGHT BRACKET not opened&quot;</span>
							 + &quot;\n   line: &quot; + al.line
							 + &quot;\n   column: &quot; + al.column;
				}
			}
		}
<span class="nc" id="L624">		boolean finish_o = false; // if there is no operator</span>
<span class="nc bnc" id="L625" title="All 2 branches missed.">		while (!finish_o){</span>
<span class="nc" id="L626">			result = checkL(&quot;ARITHMETIC OPERATOR&quot;, Codes.AOPERATOR, AL);</span>
<span class="nc bnc" id="L627" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L628">				finish_o = true;</span>
			else {
<span class="nc" id="L630">				pos ++;</span>
<span class="nc" id="L631">				finish_b = false;</span>
<span class="nc bnc" id="L632" title="All 2 branches missed.">				while (!finish_b) {</span>
<span class="nc" id="L633">					result = checkC(&quot;VALUE&quot;, Codes.LBRACKET, AL);</span>
<span class="nc bnc" id="L634" title="All 2 branches missed.">					if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L635">						finish_b = true;</span>
					else {
<span class="nc" id="L637">						b_count ++;</span>
<span class="nc" id="L638">						pos ++;</span>
					}
				}
<span class="nc" id="L641">				result = checkC(&quot;VALUE&quot;, Codes.MINUS, AL);</span>
<span class="nc bnc" id="L642" title="All 2 branches missed.">				if (result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L643">					pos ++;</span>
<span class="nc" id="L644">					result = checkC(&quot;INTEGER NUMBER&quot;, Codes.INUMBER, AL);</span>
<span class="nc bnc" id="L645" title="All 2 branches missed.">					if (result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L646">						al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L647">						AL.set(pos - 1, new AdvLexem(&quot;-&quot; + al.value, al.code,</span>
													  al.lcategory,
													  al.hcategory,
													  al.line, al.column));
<span class="nc" id="L651">						AL.remove(pos);</span>
					}
					else
<span class="nc" id="L654">						return result;</span>
				}
				else {
<span class="nc" id="L657">					result = checkC(&quot;INTEGER VALUE&quot;, Codes.INUMBER, AL);</span>
<span class="nc bnc" id="L658" title="All 2 branches missed.">					if (!result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L659">						result = checkC(&quot;INTEGER VARIABLE&quot;, Codes.VARIABLE, AL);</span>
<span class="nc bnc" id="L660" title="All 2 branches missed.">						if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L661">							return result;			</span>
						else {
<span class="nc" id="L663">							al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L664">							int tmp = vars.indexOf(al.value);</span>
<span class="nc bnc" id="L665" title="All 2 branches missed.">							if (!(((Integer)var_types.get(tmp)).equals(</span>
												new Integer(Codes.INTEGER)))) {
<span class="nc" id="L667">								al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L668">								return &quot;INTEGER VARIABLE expected &quot;</span>
									 + &quot;\n   found: &quot; + al.value
									 + &quot;\n   line: &quot; + al.line
									 + &quot;\n   column: &quot; + al.column;
							}
							else
<span class="nc" id="L674">								pos++;</span>
<span class="nc" id="L675">						}</span>
					}
					else
<span class="nc" id="L678">						pos ++;</span>
				}
<span class="nc" id="L680">				finish_b = false;</span>
<span class="nc bnc" id="L681" title="All 2 branches missed.">				while (!finish_b) {</span>
<span class="nc" id="L682">					result = checkC(&quot;OPERATOR&quot;, Codes.RBRACKET, AL);</span>
<span class="nc bnc" id="L683" title="All 2 branches missed.">					if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L684">						finish_b = true;</span>
					else {
<span class="nc bnc" id="L686" title="All 2 branches missed.">						if (b_count &gt; 0) {</span>
<span class="nc" id="L687">							b_count --;</span>
<span class="nc" id="L688">							pos ++;</span>
						}
						else {
<span class="nc" id="L691">							al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L692">							return &quot;RIGHT BRACKET not opened&quot;</span>
									 + &quot;\n   line: &quot; + al.line
									 + &quot;\n   column: &quot; + al.column;
						}
					}
				}				
			}
		}
		
<span class="nc" id="L701">		return &quot;&quot;;</span>
	}// checkIASSOC()
	
	private String checkRASSOC(ArrayList AL) {
<span class="nc" id="L705">		String result = &quot;&quot;;</span>
<span class="nc" id="L706">		AdvLexem al = null;</span>
<span class="nc" id="L707">		byte b_count = 0; // brackets count</span>
<span class="nc" id="L708">		boolean finish_b = false; // finish if no more brackets</span>

<span class="nc bnc" id="L710" title="All 2 branches missed.">		while (!finish_b) {</span>
<span class="nc" id="L711">			result = checkC(&quot;VALUE&quot;, Codes.LBRACKET, AL);</span>
<span class="nc bnc" id="L712" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L713">				finish_b = true;</span>
			else {
<span class="nc" id="L715">				b_count ++;</span>
<span class="nc" id="L716">				pos ++;</span>
			}
		}
<span class="nc" id="L719">		result = checkC(&quot;VALUE&quot;, Codes.MINUS, AL);</span>
<span class="nc bnc" id="L720" title="All 2 branches missed.">		if (result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L721">			pos ++;</span>
<span class="nc" id="L722">			result = checkC(&quot;INTEGER OR REAL NUMBER&quot;, Codes.INUMBER, AL);</span>
<span class="nc bnc" id="L723" title="All 2 branches missed.">			if ((result.equals(&quot;&quot;)) ||</span>
<span class="nc bnc" id="L724" title="All 2 branches missed.">				(checkC(&quot;&quot;, Codes.RNUMBER, AL).equals(&quot;&quot;))) {</span>
<span class="nc" id="L725">				al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L726">				AL.set(pos - 1, new AdvLexem(&quot;-&quot; + al.value, al.code,</span>
											  al.lcategory, al.hcategory,
											  al.line, al.column));
<span class="nc" id="L729">				AL.remove(pos);</span>
			}
			else
<span class="nc" id="L732">				return result;</span>
		}
		else {
<span class="nc" id="L735">			result = checkC(&quot;&quot;, Codes.INUMBER, AL);</span>
<span class="nc bnc" id="L736" title="All 2 branches missed.">			if (!((result.equals(&quot;&quot;)) ||</span>
<span class="nc bnc" id="L737" title="All 2 branches missed.">				(checkC(&quot;&quot;, Codes.RNUMBER, AL).equals(&quot;&quot;)))) {</span>
<span class="nc" id="L738">				result = checkC(&quot;INTEGER OR REAL VARIABLE&quot;,</span>
								 Codes.VARIABLE, AL);
<span class="nc bnc" id="L740" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L741">					return result;</span>
				else {
<span class="nc" id="L743">					al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L744">					int tmp = vars.indexOf(al.value);</span>
<span class="nc" id="L745">					int type = ((Integer)var_types.get(tmp)).intValue();</span>
<span class="nc bnc" id="L746" title="All 4 branches missed.">					if (!((type == Codes.INTEGER) || (type == Codes.REAL))) {</span>
<span class="nc" id="L747">						al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L748">						return &quot;INTEGER OR REAL VARIABLE expected &quot;</span>
							 + &quot;\n   found: &quot; + al.value
							 + &quot;\n   line: &quot; + al.line
							 + &quot;\n   column: &quot; + al.column;
					}
					else
<span class="nc" id="L754">						pos++;</span>
<span class="nc" id="L755">				}</span>
			}
			else
<span class="nc" id="L758">				pos ++;</span>
		}
<span class="nc" id="L760">		finish_b = false;</span>
<span class="nc bnc" id="L761" title="All 2 branches missed.">		while (!finish_b) {</span>
<span class="nc" id="L762">			result = checkC(&quot;OPERATOR&quot;, Codes.RBRACKET, AL);</span>
<span class="nc bnc" id="L763" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L764">				finish_b = true;</span>
			else {
<span class="nc bnc" id="L766" title="All 2 branches missed.">				if (b_count &gt; 0) {</span>
<span class="nc" id="L767">					b_count --;</span>
<span class="nc" id="L768">					pos ++;</span>
				}
				else {
<span class="nc" id="L771">					al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L772">					return &quot;RIGHT BRACKET not opened&quot;</span>
							 + &quot;\n   line: &quot; + al.line
							 + &quot;\n   column: &quot; + al.column;
				}
			}
		}
<span class="nc" id="L778">		boolean finish_o = false; // if there is no operator</span>
<span class="nc bnc" id="L779" title="All 2 branches missed.">		while (!finish_o){</span>
<span class="nc" id="L780">			result = checkL(&quot;closing BRACKET&quot;, Codes.AOPERATOR, AL);</span>
<span class="nc bnc" id="L781" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L782">				finish_o = true;</span>
<span class="nc bnc" id="L783" title="All 2 branches missed.">				if (b_count &gt; 0)</span>
<span class="nc" id="L784">				return result;</span>
			}
			else {
<span class="nc" id="L787">				pos ++;</span>
<span class="nc" id="L788">				finish_b = false;</span>
<span class="nc bnc" id="L789" title="All 2 branches missed.">				while (!finish_b) {</span>
<span class="nc" id="L790">					result = checkC(&quot;VALUE&quot;, Codes.LBRACKET, AL);</span>
<span class="nc bnc" id="L791" title="All 2 branches missed.">					if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L792">						finish_b = true;</span>
					else {
<span class="nc" id="L794">						b_count ++;</span>
<span class="nc" id="L795">						pos ++;</span>
					}
				}
<span class="nc" id="L798">				result = checkC(&quot;VALUE&quot;, Codes.MINUS, AL);</span>
<span class="nc bnc" id="L799" title="All 2 branches missed.">				if (result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L800">					pos ++;</span>
<span class="nc" id="L801">					result = checkC(&quot;INTEGER OR REAL NUMBER&quot;,</span>
									 Codes.INUMBER, AL);
<span class="nc bnc" id="L803" title="All 2 branches missed.">					if ((result.equals(&quot;&quot;)) ||</span>
<span class="nc bnc" id="L804" title="All 2 branches missed.">						(checkC(&quot;&quot;, Codes.RNUMBER, AL).equals(&quot;&quot;))) {</span>
<span class="nc" id="L805">						al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L806">						AL.set(pos - 1, new AdvLexem(&quot;-&quot; + al.value, al.code,</span>
													  al.lcategory,
													  al.hcategory,
													  al.line, al.column));
<span class="nc" id="L810">						AL.remove(pos);</span>
					}
					else
<span class="nc" id="L813">						return result;</span>
				}
				else {
<span class="nc" id="L816">					result = checkC(&quot;&quot;, Codes.INUMBER, AL);</span>
<span class="nc bnc" id="L817" title="All 2 branches missed.">					if (!((result.equals(&quot;&quot;)) ||</span>
<span class="nc bnc" id="L818" title="All 2 branches missed.">						(checkC(&quot;&quot;, Codes.RNUMBER, AL).equals(&quot;&quot;)))) {</span>
<span class="nc" id="L819">						result = checkC(&quot;INTEGER OR REAL VARIABLE&quot;,</span>
										 Codes.VARIABLE, AL);
<span class="nc bnc" id="L821" title="All 2 branches missed.">						if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L822">							return result;			</span>
						else {
<span class="nc" id="L824">							al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L825">							int tmp = vars.indexOf(al.value);</span>
<span class="nc" id="L826">							int type = ((Integer)var_types.get(tmp))</span>
<span class="nc" id="L827">																.intValue();</span>
<span class="nc bnc" id="L828" title="All 4 branches missed.">							if (!((type == Codes.INTEGER) ||</span>
								 (type == Codes.REAL))) {
<span class="nc" id="L830">								al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L831">								return &quot;INTEGER OR REAL VARIABLE expected &quot;</span>
									 + &quot;\n   found: &quot; + al.value
									 + &quot;\n   line: &quot; + al.line
									 + &quot;\n   column: &quot; + al.column;
							}
							else
<span class="nc" id="L837">								pos++;</span>
<span class="nc" id="L838">						}</span>
					}
					else
<span class="nc" id="L841">						pos ++;</span>
				}
<span class="nc" id="L843">				finish_b = false;</span>
<span class="nc bnc" id="L844" title="All 2 branches missed.">				while (!finish_b) {</span>
<span class="nc" id="L845">					result = checkC(&quot;OPERATOR&quot;, Codes.RBRACKET, AL);</span>
<span class="nc bnc" id="L846" title="All 2 branches missed.">					if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L847">						finish_b = true;</span>
					else {
<span class="nc bnc" id="L849" title="All 2 branches missed.">						if (b_count &gt; 0) {</span>
<span class="nc" id="L850">							b_count --;</span>
<span class="nc" id="L851">							pos ++;</span>
						}
						else {
<span class="nc" id="L854">							al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L855">							return &quot;RIGHT BRACKET not opened&quot;</span>
									 + &quot;\n   line: &quot; + al.line
									 + &quot;\n   column: &quot; + al.column;
						}
					}
				}				
			}
		}		
<span class="nc" id="L863">		return &quot;&quot;;</span>
	}// checkRASSOC()

	private String checkLEXPR(ArrayList AL) {
<span class="nc" id="L867">		String result = &quot;&quot;;</span>
<span class="nc" id="L868">		AdvLexem al = null;</span>
<span class="nc" id="L869">		byte b_count = 0; // brackets count</span>
<span class="nc" id="L870">		boolean finish_o = false;</span>
<span class="nc" id="L871">		boolean finish_n = false;</span>
<span class="nc" id="L872">		boolean finish_b = false;		</span>

<span class="nc bnc" id="L874" title="All 2 branches missed.">		while (!finish_n) {</span>
<span class="nc" id="L875">			finish_b = false;</span>
<span class="nc bnc" id="L876" title="All 2 branches missed.">			while (!finish_b) {</span>
<span class="nc" id="L877">				result = checkC(&quot;VALUE&quot;, Codes.LBRACKET, AL);</span>
<span class="nc bnc" id="L878" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L879">					finish_b = true;</span>
				else {
<span class="nc" id="L881">					b_count ++;</span>
<span class="nc" id="L882">					pos ++;</span>
				}
			}
<span class="nc" id="L885">			result = checkC(&quot;NOT&quot;, Codes.NOT, AL);</span>
<span class="nc bnc" id="L886" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L887">				finish_n = true;</span>
			else
<span class="nc" id="L889">				pos ++;</span>
		}
<span class="nc" id="L891">		result = checkLEXPRNElem(AL);</span>
<span class="nc bnc" id="L892" title="All 2 branches missed.">		if (result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L893">			result = checkL(&quot;RELATION OPERATOR&quot;,</span>
							 Codes.ROPERATOR, AL);
<span class="nc bnc" id="L895" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L896">				return result;</span>
			else {
<span class="nc" id="L898">				pos ++;</span>
<span class="nc" id="L899">				result = checkLEXPRNElem(AL);</span>
<span class="nc bnc" id="L900" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L901">					return result;</span>
			}
		}
		else {
<span class="nc" id="L905">			result = checkLEXPRLElem(AL);</span>
<span class="nc bnc" id="L906" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L907">				return result;</span>
		}
<span class="nc" id="L909">		finish_b = false;</span>
<span class="nc bnc" id="L910" title="All 2 branches missed.">		while (!finish_b) {</span>
<span class="nc" id="L911">			result = checkC(&quot;OPERATOR&quot;, Codes.RBRACKET, AL);</span>
<span class="nc bnc" id="L912" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L913">				finish_b = true;</span>
			else {
<span class="nc bnc" id="L915" title="All 2 branches missed.">				if (b_count &gt; 0) {</span>
<span class="nc" id="L916">					b_count --;</span>
<span class="nc" id="L917">					pos ++;</span>
				}
				else {
<span class="nc" id="L920">					al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L921">					return &quot;RIGHT BRACKET not opened&quot;</span>
							 + &quot;\n   line: &quot; + al.line
							 + &quot;\n   column: &quot; + al.column;
				}
			}
		}
<span class="nc" id="L927">		finish_o = false;</span>
<span class="nc bnc" id="L928" title="All 2 branches missed.">		while (!finish_o){</span>
<span class="nc" id="L929">			result = checkL(&quot;closing BRACKET&quot;, Codes.LOPERATOR, AL);</span>
<span class="nc bnc" id="L930" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L931">				finish_o = true;</span>
<span class="nc bnc" id="L932" title="All 2 branches missed.">				if (b_count &gt; 0)</span>
<span class="nc" id="L933">				return result;</span>
			}
			else {
<span class="nc" id="L936">				pos ++;</span>
<span class="nc" id="L937">				finish_n = false;</span>
<span class="nc bnc" id="L938" title="All 2 branches missed.">				while (!finish_n) {</span>
<span class="nc" id="L939">					finish_b = false;</span>
<span class="nc bnc" id="L940" title="All 2 branches missed.">					while (!finish_b) {</span>
<span class="nc" id="L941">						result = checkC(&quot;VALUE&quot;, Codes.LBRACKET, AL);</span>
<span class="nc bnc" id="L942" title="All 2 branches missed.">						if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L943">							finish_b = true;</span>
						else {
<span class="nc" id="L945">							b_count ++;</span>
<span class="nc" id="L946">							pos ++;</span>
						}
					}
<span class="nc" id="L949">					result = checkC(&quot;NOT&quot;, Codes.NOT, AL);</span>
<span class="nc bnc" id="L950" title="All 2 branches missed.">					if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L951">						finish_n = true;</span>
					else
<span class="nc" id="L953">						pos ++;</span>
				}
<span class="nc" id="L955">				result = checkLEXPRNElem(AL);</span>
<span class="nc bnc" id="L956" title="All 2 branches missed.">				if (result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L957">					result = checkL(&quot;RELATION OPERATOR&quot;,</span>
									 Codes.ROPERATOR, AL);
<span class="nc bnc" id="L959" title="All 2 branches missed.">					if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L960">						return result;</span>
					else {
<span class="nc" id="L962">						pos ++;</span>
<span class="nc" id="L963">						result = checkLEXPRNElem(AL);</span>
<span class="nc bnc" id="L964" title="All 2 branches missed.">						if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L965">							return result;</span>
					}
				}
				else {
<span class="nc" id="L969">					result = checkLEXPRLElem(AL);</span>
<span class="nc bnc" id="L970" title="All 2 branches missed.">					if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L971">						return result;</span>
				}
<span class="nc" id="L973">				finish_b = false;</span>
<span class="nc bnc" id="L974" title="All 2 branches missed.">				while (!finish_b) {</span>
<span class="nc" id="L975">					result = checkC(&quot;OPERATOR&quot;, Codes.RBRACKET, AL);</span>
<span class="nc bnc" id="L976" title="All 2 branches missed.">					if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L977">						finish_b = true;</span>
					else {
<span class="nc bnc" id="L979" title="All 2 branches missed.">						if (b_count &gt; 0) {</span>
<span class="nc" id="L980">							b_count --;</span>
<span class="nc" id="L981">							pos ++;</span>
						}
						else {
<span class="nc" id="L984">							al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L985">							return &quot;RIGHT BRACKET not opened&quot;</span>
									 + &quot;\n   line: &quot; + al.line
									 + &quot;\n   column: &quot; + al.column;
						}
					}
				}
			}
		}
<span class="nc" id="L993">		return &quot;&quot;;</span>
	}// checkLEXPR()
	
	private String checkWRITE(ArrayList AL) {
<span class="nc" id="L997">		String result = &quot;&quot;;</span>
<span class="nc" id="L998">		AdvLexem al = null;</span>
<span class="nc" id="L999">		result = checkC(&quot;LEFT BRACKET&quot;, Codes.LBRACKET, AL);</span>
<span class="nc bnc" id="L1000" title="All 2 branches missed.">		if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1001">			return result;</span>
<span class="nc" id="L1002">		pos ++;</span>
<span class="nc" id="L1003">		result = checkC(&quot;STRING or VARIABLE&quot;, Codes.STRING, AL);</span>
<span class="nc bnc" id="L1004" title="All 2 branches missed.">		if (!(result.equals(&quot;&quot;) ||</span>
<span class="nc bnc" id="L1005" title="All 2 branches missed.">			(checkC(&quot;&quot;, Codes.VARIABLE, AL)).equals(&quot;&quot;)))</span>
<span class="nc" id="L1006">			return result;</span>
<span class="nc" id="L1007">		pos ++;</span>
<span class="nc" id="L1008">		boolean finish_c = false;</span>
<span class="nc bnc" id="L1009" title="All 2 branches missed.">		while (!finish_c) {</span>
<span class="nc" id="L1010">			result = checkC(&quot;COMMA&quot;, Codes.COMMA, AL);</span>
<span class="nc bnc" id="L1011" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1012">				finish_c = true;</span>
			else {
<span class="nc" id="L1014">				pos ++;</span>
<span class="nc" id="L1015">				result = checkC(&quot;STRING or VARIABLE&quot;, Codes.STRING, AL);</span>
<span class="nc bnc" id="L1016" title="All 2 branches missed.">				if (!(result.equals(&quot;&quot;) ||</span>
<span class="nc bnc" id="L1017" title="All 2 branches missed.">					(checkC(&quot;&quot;, Codes.VARIABLE, AL)).equals(&quot;&quot;)))</span>
<span class="nc" id="L1018">					return result;</span>
				else
<span class="nc" id="L1020">					pos ++;			</span>
			}
		}
<span class="nc" id="L1023">		result = checkC(&quot;RIGHT BRACKET&quot;, Codes.RBRACKET, AL);</span>
<span class="nc bnc" id="L1024" title="All 2 branches missed.">		if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1025">			return result;</span>
<span class="nc" id="L1026">		pos ++;</span>
<span class="nc" id="L1027">		return &quot;&quot;;</span>
	}// checkWRITE()
	
	private String checkREAD(ArrayList AL) {
<span class="nc" id="L1031">		String result = &quot;&quot;;</span>
<span class="nc" id="L1032">		AdvLexem al = null;</span>
<span class="nc" id="L1033">		result = checkC(&quot;LEFT BRACKET&quot;, Codes.LBRACKET, AL);</span>
<span class="nc bnc" id="L1034" title="All 2 branches missed.">		if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1035">			return result;</span>
<span class="nc" id="L1036">		pos ++;</span>
<span class="nc" id="L1037">		result = checkC(&quot;VARIABLE&quot;, Codes.VARIABLE, AL);		</span>
<span class="nc bnc" id="L1038" title="All 2 branches missed.">		if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1039">			return result;</span>
<span class="nc" id="L1040">		pos ++;</span>
<span class="nc" id="L1041">		result = checkC(&quot;RIGHT BRACKET&quot;, Codes.RBRACKET, AL);</span>
<span class="nc bnc" id="L1042" title="All 2 branches missed.">		if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1043">			return result;</span>
<span class="nc" id="L1044">		pos ++;		</span>
<span class="nc" id="L1045">		return &quot;&quot;;</span>
	}// checkREAD()


//mmmmmmmmmmmmmmmmmm	MAIN VALIDATOR   mmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
	
	private String checkBody(ArrayList AL) {
<span class="nc" id="L1052">		String result = &quot;&quot;;</span>
<span class="nc" id="L1053">		AdvLexem al = null;</span>
<span class="nc" id="L1054">		int begins = 0;</span>

		while (true) {
<span class="nc" id="L1057">			al = (AdvLexem)AL.get(pos);</span>
<span class="nc bnc" id="L1058" title="All 2 branches missed.">			if (al.code == Codes.VARIABLE) {</span>
<span class="nc" id="L1059">				pos ++;</span>
<span class="nc" id="L1060">				result = checkC(&quot;ASSOCIATE MARK&quot;, Codes.ASOCIATE, AL);</span>
<span class="nc bnc" id="L1061" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1062">					return result;</span>
<span class="nc" id="L1063">				pos ++;</span>
<span class="nc" id="L1064">				int tmp = vars.indexOf(al.value);</span>
<span class="nc" id="L1065">				int type = ((Integer)var_types.get(tmp)).intValue();</span>
<span class="nc bnc" id="L1066" title="All 2 branches missed.">				if (type == Codes.INTEGER) {</span>
<span class="nc" id="L1067">					result = checkIASSOC(AL);</span>
<span class="nc bnc" id="L1068" title="All 2 branches missed.">					if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1069">						return result;</span>
				}
<span class="nc bnc" id="L1071" title="All 2 branches missed.">				else if (type == Codes.REAL) {</span>
<span class="nc" id="L1072">					result = checkRASSOC(AL);</span>
<span class="nc bnc" id="L1073" title="All 2 branches missed.">					if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1074">						return result;</span>
				}
<span class="nc bnc" id="L1076" title="All 2 branches missed.">				else if (type == Codes.BOOLEAN) {</span>
<span class="nc" id="L1077">					result = checkLEXPR(AL);</span>
<span class="nc bnc" id="L1078" title="All 2 branches missed.">					if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1079">						return result;</span>
				}
<span class="nc" id="L1081">				result = checkEnding(AL);</span>
<span class="nc bnc" id="L1082" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1083">					return result;</span>
<span class="nc" id="L1084">			}</span>
<span class="nc bnc" id="L1085" title="All 2 branches missed.">			else if (al.code == Codes.WRITELN) {</span>
<span class="nc" id="L1086">				pos ++;</span>
<span class="nc" id="L1087">				result = checkWRITE(AL);</span>
<span class="nc bnc" id="L1088" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1089">					return result;</span>
<span class="nc" id="L1090">				result = checkEnding(AL);</span>
<span class="nc bnc" id="L1091" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1092">					return result;</span>
			}
<span class="nc bnc" id="L1094" title="All 2 branches missed.">			else if (al.code == Codes.READLN) {</span>
<span class="nc" id="L1095">				pos ++;</span>
<span class="nc" id="L1096">				result = checkREAD(AL);</span>
<span class="nc bnc" id="L1097" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1098">					return result;</span>
<span class="nc" id="L1099">				result = checkEnding(AL);</span>
<span class="nc bnc" id="L1100" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1101">					return result;</span>
			}
<span class="nc bnc" id="L1103" title="All 2 branches missed.">			else if (al.code == Codes.WHILE) {</span>
<span class="nc" id="L1104">				pos ++;</span>
<span class="nc" id="L1105">				result = checkLEXPR(AL);</span>
<span class="nc bnc" id="L1106" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1107">					return result;</span>
<span class="nc" id="L1108">				result = checkC(&quot;keyword DO&quot;, Codes.DO, AL);</span>
<span class="nc bnc" id="L1109" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1110">					return result;</span>
<span class="nc" id="L1111">				pos ++;</span>
<span class="nc" id="L1112">				result = checkOne(AL);</span>
<span class="nc bnc" id="L1113" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1114">					return result;				</span>
			}
<span class="nc bnc" id="L1116" title="All 2 branches missed.">			else if (al.code == Codes.IF) {</span>
<span class="nc" id="L1117">				pos ++;</span>
<span class="nc" id="L1118">				result = checkLEXPR(AL);</span>
<span class="nc bnc" id="L1119" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1120">					return result;</span>
<span class="nc" id="L1121">				result = checkC(&quot;keyword THEN&quot;, Codes.THEN, AL);</span>
<span class="nc bnc" id="L1122" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1123">					return result;</span>
<span class="nc" id="L1124">				pos ++;</span>
<span class="nc" id="L1125">				result = checkOne(AL);</span>
<span class="nc bnc" id="L1126" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1127">					return result;</span>
<span class="nc" id="L1128">				result = checkC(&quot;keyword ELSE&quot;, Codes.ELSE, AL);</span>
<span class="nc bnc" id="L1129" title="All 2 branches missed.">				if (result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L1130">					pos ++;</span>
<span class="nc" id="L1131">					result = checkOne(AL);</span>
<span class="nc bnc" id="L1132" title="All 2 branches missed.">					if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1133">						return result;</span>
				}
			}
<span class="nc bnc" id="L1136" title="All 2 branches missed.">			else if (al.code == Codes.BEGIN) {</span>
<span class="nc" id="L1137">				AL.remove(pos);</span>
<span class="nc" id="L1138">				result = checkBlock(AL);</span>
<span class="nc bnc" id="L1139" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1140">					return result;</span>
				else {
<span class="nc" id="L1142">					pos --;</span>
<span class="nc" id="L1143">					result = checkC(&quot;SEMICOLON&quot;, Codes.SEMICOLON, AL);</span>
<span class="nc bnc" id="L1144" title="All 2 branches missed.">					if (result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L1145">						AL.remove(pos);</span>
<span class="nc" id="L1146">						pos --;</span>
					}
<span class="nc" id="L1148">					AL.remove(pos);</span>

				}
			}
<span class="nc bnc" id="L1152" title="All 2 branches missed.">			else if (al.code == Codes.END) {</span>
<span class="nc" id="L1153">				return &quot;END without coresponding BEGIN&quot;</span>
					 + &quot;\n   found: &quot; + al.value
					 + &quot;\n   line: &quot; + al.line
					 + &quot;\n   column: &quot; + al.column;	
			}
<span class="nc bnc" id="L1158" title="All 2 branches missed.">			else if (al.code == Codes.END_DOT) {</span>
<span class="nc" id="L1159">				return &quot;&quot;;</span>
			}
			else
<span class="nc" id="L1162">				return &quot;Not a statement&quot;</span>
					 + &quot;\n   found: &quot; + al.value
					 + &quot;\n   line: &quot; + al.line
					 + &quot;\n   column: &quot; + al.column;
		}
	}// checkBODY()	

	private String checkBlock(ArrayList AL) {
<span class="nc" id="L1170">		String result = &quot;&quot;;</span>
<span class="nc" id="L1171">		AdvLexem al = null;</span>
<span class="nc" id="L1172">		int begins = 0;</span>

		while (true) {
<span class="nc" id="L1175">			al = (AdvLexem)AL.get(pos);</span>
<span class="nc bnc" id="L1176" title="All 2 branches missed.">			if (al.code == Codes.VARIABLE) {</span>
<span class="nc" id="L1177">				pos ++;</span>
<span class="nc" id="L1178">				result = checkC(&quot;ASSOCIATE MARK&quot;, Codes.ASOCIATE, AL);</span>
<span class="nc bnc" id="L1179" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1180">					return result;</span>
<span class="nc" id="L1181">				pos ++;</span>
<span class="nc" id="L1182">				int tmp = vars.indexOf(al.value);</span>
<span class="nc" id="L1183">				int type = ((Integer)var_types.get(tmp)).intValue();</span>
<span class="nc bnc" id="L1184" title="All 2 branches missed.">				if (type == Codes.INTEGER) {</span>
<span class="nc" id="L1185">					result = checkIASSOC(AL);</span>
<span class="nc bnc" id="L1186" title="All 2 branches missed.">					if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1187">						return result;</span>
				}
<span class="nc bnc" id="L1189" title="All 2 branches missed.">				else if (type == Codes.REAL) {</span>
<span class="nc" id="L1190">					result = checkRASSOC(AL);</span>
<span class="nc bnc" id="L1191" title="All 2 branches missed.">					if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1192">						return result;</span>
				}
<span class="nc bnc" id="L1194" title="All 2 branches missed.">				else if (type == Codes.BOOLEAN) {</span>
<span class="nc" id="L1195">					result = checkLEXPR(AL);</span>
<span class="nc bnc" id="L1196" title="All 2 branches missed.">					if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1197">						return result;</span>
				}
<span class="nc" id="L1199">				result = checkEnding(AL);</span>
<span class="nc bnc" id="L1200" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1201">					return result;</span>
<span class="nc" id="L1202">			}</span>
<span class="nc bnc" id="L1203" title="All 2 branches missed.">			else if (al.code == Codes.WRITELN) {</span>
<span class="nc" id="L1204">				pos ++;</span>
<span class="nc" id="L1205">				result = checkWRITE(AL);</span>
<span class="nc bnc" id="L1206" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1207">					return result;</span>
<span class="nc" id="L1208">				result = checkEnding(AL);</span>
<span class="nc bnc" id="L1209" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1210">					return result;</span>
			}
<span class="nc bnc" id="L1212" title="All 2 branches missed.">			else if (al.code == Codes.READLN) {</span>
<span class="nc" id="L1213">				pos ++;</span>
<span class="nc" id="L1214">				result = checkREAD(AL);</span>
<span class="nc bnc" id="L1215" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1216">					return result;</span>
<span class="nc" id="L1217">				result = checkEnding(AL);</span>
<span class="nc bnc" id="L1218" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1219">					return result;</span>
			}
<span class="nc bnc" id="L1221" title="All 2 branches missed.">			else if (al.code == Codes.WHILE) {</span>
<span class="nc" id="L1222">				pos ++;</span>
<span class="nc" id="L1223">				result = checkLEXPR(AL);</span>
<span class="nc bnc" id="L1224" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1225">					return result;</span>
<span class="nc" id="L1226">				result = checkC(&quot;keyword DO&quot;, Codes.DO, AL);</span>
<span class="nc bnc" id="L1227" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1228">					return result;</span>
<span class="nc" id="L1229">				pos ++;</span>
<span class="nc" id="L1230">				result = checkOne(AL);</span>
<span class="nc bnc" id="L1231" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1232">					return result;				</span>
			}
<span class="nc bnc" id="L1234" title="All 2 branches missed.">			else if (al.code == Codes.IF) {</span>
<span class="nc" id="L1235">				pos ++;</span>
<span class="nc" id="L1236">				result = checkLEXPR(AL);</span>
<span class="nc bnc" id="L1237" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1238">					return result;</span>
<span class="nc" id="L1239">				result = checkC(&quot;keyword THEN&quot;, Codes.THEN, AL);</span>
<span class="nc bnc" id="L1240" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1241">					return result;</span>
<span class="nc" id="L1242">				pos ++;</span>
<span class="nc" id="L1243">				result = checkOne(AL);</span>
<span class="nc bnc" id="L1244" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1245">					return result;</span>
<span class="nc" id="L1246">				result = checkC(&quot;keyword ELSE&quot;, Codes.ELSE, AL);</span>
<span class="nc bnc" id="L1247" title="All 2 branches missed.">				if (result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L1248">					pos ++;</span>
<span class="nc" id="L1249">					result = checkOne(AL);</span>
<span class="nc bnc" id="L1250" title="All 2 branches missed.">					if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1251">						return result;</span>
				}
			}
<span class="nc bnc" id="L1254" title="All 2 branches missed.">			else if (al.code == Codes.BEGIN) {</span>
<span class="nc" id="L1255">				pos ++;</span>
<span class="nc" id="L1256">				result = checkBlock(AL);</span>
<span class="nc bnc" id="L1257" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1258">					return result;</span>
			}
<span class="nc bnc" id="L1260" title="All 2 branches missed.">			else if (al.code == Codes.END) {</span>
<span class="nc" id="L1261">				pos ++;</span>
<span class="nc" id="L1262">				result = checkEnding(AL);</span>
<span class="nc bnc" id="L1263" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1264">					return result;</span>
				else
<span class="nc" id="L1266">					return &quot;&quot;;</span>
			}
<span class="nc bnc" id="L1268" title="All 2 branches missed.">			else if (al.code == Codes.END_DOT) {</span>
<span class="nc" id="L1269">				return &quot;END expected&quot;</span>
					 + &quot;\n   line: &quot; + al.line
					 + &quot;\n   column: &quot; + al.column;
			}
			else
<span class="nc" id="L1274">				return &quot;Not a statement&quot;</span>
					 + &quot;\n   found: &quot; + al.value
					 + &quot;\n   line: &quot; + al.line
					 + &quot;\n   column: &quot; + al.column;
		}
	}// checkBlock()

	private String checkOne(ArrayList AL) {
<span class="nc" id="L1282">		String result = &quot;&quot;;</span>
<span class="nc" id="L1283">		AdvLexem al = null;</span>
<span class="nc" id="L1284">		int begins = 0;</span>
<span class="nc" id="L1285">		al = (AdvLexem)AL.get(pos);</span>
<span class="nc bnc" id="L1286" title="All 2 branches missed.">		if (al.code == Codes.VARIABLE) {</span>

<span class="nc" id="L1288">			pos ++;</span>
<span class="nc" id="L1289">			result = checkC(&quot;ASSOCIATE MARK&quot;, Codes.ASOCIATE, AL);</span>
<span class="nc bnc" id="L1290" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1291">				return result;</span>
<span class="nc" id="L1292">			pos ++;</span>
<span class="nc" id="L1293">			int tmp = vars.indexOf(al.value);</span>
<span class="nc" id="L1294">			int type = ((Integer)var_types.get(tmp)).intValue();</span>

<span class="nc bnc" id="L1296" title="All 2 branches missed.">			if (type == Codes.INTEGER) {</span>
<span class="nc" id="L1297">				result = checkIASSOC(AL);</span>
<span class="nc bnc" id="L1298" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1299">					return result;</span>
			}
<span class="nc bnc" id="L1301" title="All 2 branches missed.">			else if (type == Codes.REAL) {</span>
<span class="nc" id="L1302">				result = checkRASSOC(AL);</span>
<span class="nc bnc" id="L1303" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1304">					return result;</span>
			}
<span class="nc bnc" id="L1306" title="All 2 branches missed.">			else if (type == Codes.BOOLEAN) {</span>
<span class="nc" id="L1307">				result = checkLEXPR(AL);</span>
<span class="nc bnc" id="L1308" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1309">					return result;</span>
			}
<span class="nc" id="L1311">			return checkEnding(AL);</span>
		}
<span class="nc bnc" id="L1313" title="All 2 branches missed.">		else if (al.code == Codes.WRITELN) {</span>
<span class="nc" id="L1314">			pos ++;</span>
<span class="nc" id="L1315">			result = checkWRITE(AL);</span>
<span class="nc bnc" id="L1316" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1317">				return result;</span>
<span class="nc" id="L1318">			return checkEnding(AL);</span>
		}
<span class="nc bnc" id="L1320" title="All 2 branches missed.">		else if (al.code == Codes.READLN) {</span>
<span class="nc" id="L1321">			pos ++;</span>
<span class="nc" id="L1322">			result = checkREAD(AL);</span>
<span class="nc bnc" id="L1323" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1324">				return result;</span>
<span class="nc" id="L1325">			return checkEnding(AL);</span>
		}
<span class="nc bnc" id="L1327" title="All 2 branches missed.">		else if (al.code == Codes.WHILE) {</span>
<span class="nc" id="L1328">			pos ++;</span>
<span class="nc" id="L1329">			result = checkLEXPR(AL);</span>
<span class="nc bnc" id="L1330" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1331">				return result;</span>
<span class="nc" id="L1332">			result = checkC(&quot;keyword DO&quot;, Codes.DO, AL);</span>
<span class="nc bnc" id="L1333" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1334">				return result;</span>
<span class="nc" id="L1335">			pos ++;</span>
<span class="nc" id="L1336">			return checkOne(AL);</span>
		}
<span class="nc bnc" id="L1338" title="All 2 branches missed.">		else if (al.code == Codes.IF) { </span>
<span class="nc" id="L1339">			pos ++;</span>
<span class="nc" id="L1340">			result = checkLEXPR(AL);</span>
<span class="nc bnc" id="L1341" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1342">				return result;</span>
<span class="nc" id="L1343">			result = checkC(&quot;keyword THEN&quot;, Codes.THEN, AL);</span>
<span class="nc bnc" id="L1344" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1345">				return result;</span>
<span class="nc" id="L1346">			pos ++;</span>

<span class="nc" id="L1348">			result = checkOne(AL);</span>
<span class="nc bnc" id="L1349" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1350">				return result;</span>
<span class="nc" id="L1351">			result = checkC(&quot;keyword ELSE&quot;, Codes.ELSE, AL);</span>
<span class="nc bnc" id="L1352" title="All 2 branches missed.">			if (result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L1353">				pos ++;</span>
<span class="nc" id="L1354">				return checkOne(AL);</span>
			}
			else
<span class="nc" id="L1357">				return &quot;&quot;;</span>
		}
<span class="nc bnc" id="L1359" title="All 2 branches missed.">		else if (al.code == Codes.BEGIN) {</span>
<span class="nc" id="L1360">			pos ++;</span>

<span class="nc" id="L1362">			return checkBlock(AL);</span>
		}
<span class="nc bnc" id="L1364" title="All 2 branches missed.">		else if (al.code == Codes.END) {</span>
<span class="nc" id="L1365">				return &quot;END without coresponding BEGIN&quot;</span>
					 + &quot;\n   found: &quot; + al.value
					 + &quot;\n   line: &quot; + al.line
					 + &quot;\n   column: &quot; + al.column;					
		}
<span class="nc bnc" id="L1370" title="All 4 branches missed.">		else if ((al.code == Codes.END_DOT) || </span>
				 (al.code == Codes.ELSE)) {
<span class="nc" id="L1372">			return &quot;INSTRUCTION expected&quot;</span>
				 + &quot;\n   line: &quot; + al.line
				 + &quot;\n   column: &quot; + al.column;
		}
		else
<span class="nc" id="L1377">			return &quot;Not a statement&quot;</span>
				 + &quot;\n   found: &quot; + al.value
				 + &quot;\n   line: &quot; + al.line
				 + &quot;\n   column: &quot; + al.column;
	}// checkOne()

	private String checkEnding(ArrayList AL) {
<span class="nc" id="L1384">		String result = &quot;&quot;;</span>
		
<span class="nc" id="L1386">		result = checkC(&quot;SEMICOLON&quot;, Codes.SEMICOLON, AL);</span>
<span class="nc bnc" id="L1387" title="All 2 branches missed.">		if (!result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L1388">			result = checkC(&quot;SEMICOLON&quot;, Codes.END, AL);</span>
<span class="nc bnc" id="L1389" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L1390">				result = checkC(&quot;SEMICOLON&quot;, Codes.ELSE, AL);</span>
<span class="nc bnc" id="L1391" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L1392">					result = checkC(&quot;SEMICOLON&quot;, Codes.END_DOT, AL);</span>
<span class="nc bnc" id="L1393" title="All 2 branches missed.">					if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1394">						return result;</span>
				}
			}
		}
		else
<span class="nc" id="L1399">			pos ++;</span>
<span class="nc" id="L1400">		return &quot;&quot;;</span>
		
	}// checkEnding()

	// checks Logical EXPRexion Number Element
	private String checkLEXPRNElem(ArrayList AL) {
<span class="nc" id="L1406">		String result = &quot;&quot;;</span>
<span class="nc" id="L1407">		AdvLexem al = null;</span>
		
<span class="nc" id="L1409">		result = checkC(&quot;VALUE&quot;, Codes.MINUS, AL);</span>
<span class="nc bnc" id="L1410" title="All 2 branches missed.">		if (result.equals(&quot;&quot;)) {</span>
<span class="nc" id="L1411">			pos ++;</span>
<span class="nc" id="L1412">			result = checkC(&quot;INTEGER OR REAL NUMBER&quot;,</span>
							 Codes.INUMBER, AL);
<span class="nc bnc" id="L1414" title="All 2 branches missed.">			if ((result.equals(&quot;&quot;)) ||</span>
<span class="nc bnc" id="L1415" title="All 2 branches missed.">				(checkC(&quot;&quot;, Codes.RNUMBER, AL).equals(&quot;&quot;))) {</span>
<span class="nc" id="L1416">				al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L1417">				AL.set(pos - 1, new AdvLexem(&quot;-&quot; + al.value, al.code,</span>
											  al.lcategory,
											  al.hcategory,
											  al.line, al.column));
<span class="nc" id="L1421">				AL.remove(pos);</span>
<span class="nc" id="L1422">				return &quot;&quot;;</span>
			}
			else
<span class="nc" id="L1425">				return result;</span>
		}
		else {
<span class="nc" id="L1428">			result = checkC(&quot;&quot;, Codes.INUMBER, AL);</span>
<span class="nc bnc" id="L1429" title="All 2 branches missed.">			if (!((result.equals(&quot;&quot;)) ||</span>
<span class="nc bnc" id="L1430" title="All 2 branches missed.">				(checkC(&quot;&quot;, Codes.RNUMBER, AL).equals(&quot;&quot;)))) {</span>
<span class="nc" id="L1431">				result = checkC(&quot;INTEGER OR REAL VARIABLE&quot;,</span>
								 Codes.VARIABLE, AL);
<span class="nc bnc" id="L1433" title="All 2 branches missed.">				if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1434">					return result;</span>
				else {
<span class="nc" id="L1436">					al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L1437">					int tmp = vars.indexOf(al.value);</span>
<span class="nc" id="L1438">					int type = ((Integer)var_types.get(tmp)).intValue();</span>
<span class="nc bnc" id="L1439" title="All 4 branches missed.">					if (!((type == Codes.INTEGER) || (type == Codes.REAL))) {</span>
<span class="nc" id="L1440">						al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L1441">						return &quot;INTEGER OR REAL VARIABLE expected &quot;</span>
							 + &quot;\n   found: &quot; + al.value
							 + &quot;\n   line: &quot; + al.line
							 + &quot;\n   column: &quot; + al.column;
					}
					else {
<span class="nc" id="L1447">						pos++;</span>
<span class="nc" id="L1448">						return &quot;&quot;;</span>
					}
				}
			}
			else {
<span class="nc" id="L1453">				pos ++;</span>
<span class="nc" id="L1454">				return &quot;&quot;;</span>
			}
		}
	}// checkLEXPRNElem()
	
	// checks Logical EXPRexion Logic Element
	private String checkLEXPRLElem(ArrayList AL) {
<span class="nc" id="L1461">		String result = &quot;&quot;;</span>
<span class="nc" id="L1462">		AdvLexem al = null;</span>
<span class="nc" id="L1463">		result = checkC(&quot;&quot;, Codes.TRUE, AL);</span>
<span class="nc bnc" id="L1464" title="All 2 branches missed.">		if (!((result.equals(&quot;&quot;)) ||</span>
<span class="nc bnc" id="L1465" title="All 2 branches missed.">			(checkC(&quot;&quot;, Codes.FALSE, AL).equals(&quot;&quot;)))) {</span>
<span class="nc" id="L1466">			result = checkC(&quot;LOGICAL VALUE&quot;,</span>
							 Codes.VARIABLE, AL);
<span class="nc bnc" id="L1468" title="All 2 branches missed.">			if (!result.equals(&quot;&quot;))</span>
<span class="nc" id="L1469">				return result;</span>
			else {
<span class="nc" id="L1471">				al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L1472">				int tmp = vars.indexOf(al.value);</span>
<span class="nc" id="L1473">				int type = ((Integer)var_types.get(tmp)).intValue();</span>
<span class="nc bnc" id="L1474" title="All 2 branches missed.">				if (!(type == Codes.BOOLEAN)) {</span>
<span class="nc" id="L1475">					al = (AdvLexem)AL.get(pos);</span>
<span class="nc" id="L1476">					return &quot;expected: LOGICAL VALUE&quot;</span>
						 + &quot;\n   found: &quot; + al.value
						 + &quot;\n   line: &quot; + al.line
						 + &quot;\n   column: &quot; + al.column;
				}
				else {
<span class="nc" id="L1482">					pos++;</span>
<span class="nc" id="L1483">					return &quot;&quot;;</span>
				}
			}
		}
		else {
<span class="nc" id="L1488">			pos ++;</span>
<span class="nc" id="L1489">			return &quot;&quot;;</span>
		}
	}// checkLEXPRLElem()

//mmmmmmmmmmmmmmmmmmmmmm	INTERPRETER   mmmmmmmmmmmmmmmmmmmmmmmmmmm

	private ArrayList interBody(ArrayList AL) {
<span class="nc" id="L1496">		ArrayList baze = new ArrayList();</span>
<span class="nc" id="L1497">		String itype = &quot;&quot;;</span>
<span class="nc" id="L1498">		String variable = &quot;&quot;;</span>
<span class="nc" id="L1499">		int start = 0;</span>
<span class="nc" id="L1500">		int finish = 0;</span>
<span class="nc" id="L1501">		ArrayList iftrue = new ArrayList();</span>
<span class="nc" id="L1502">		ArrayList ifelse = new ArrayList();</span>

<span class="nc" id="L1504">		AdvLexem al = null;</span>

		while (true) {
<span class="nc" id="L1507">			al = (AdvLexem)AL.get(pos);</span>
<span class="nc bnc" id="L1508" title="All 2 branches missed.">			if (al.code == Codes.VARIABLE) {</span>
<span class="nc" id="L1509">				variable = al.value;</span>
<span class="nc" id="L1510">				pos ++;</span>
<span class="nc" id="L1511">				pos ++;</span>
<span class="nc" id="L1512">				start = pos;</span>
<span class="nc" id="L1513">				int tmp = vars.indexOf(al.value);</span>
<span class="nc" id="L1514">				int type = ((Integer)var_types.get(tmp)).intValue();</span>
	
<span class="nc bnc" id="L1516" title="All 2 branches missed.">				if (type == Codes.INTEGER) {</span>
<span class="nc" id="L1517">					checkIASSOC(AL);</span>
<span class="nc" id="L1518">					finish = pos - 1;</span>
<span class="nc" id="L1519">					itype = &quot;IASSOC&quot;;</span>
				}
<span class="nc bnc" id="L1521" title="All 2 branches missed.">				else if (type == Codes.REAL) {</span>
<span class="nc" id="L1522">					checkRASSOC(AL);</span>
<span class="nc" id="L1523">					finish = pos - 1;</span>
<span class="nc" id="L1524">					itype = &quot;RASSOC&quot;;</span>
				}
<span class="nc bnc" id="L1526" title="All 2 branches missed.">				else if (type == Codes.BOOLEAN) {</span>
<span class="nc" id="L1527">					checkLEXPR(AL);</span>
<span class="nc" id="L1528">					finish = pos - 1;</span>
<span class="nc" id="L1529">					itype = &quot;BASSOC&quot;;</span>
				}
<span class="nc" id="L1531">				checkEnding(AL);</span>
<span class="nc" id="L1532">			}</span>
<span class="nc bnc" id="L1533" title="All 2 branches missed.">			else if (al.code == Codes.WRITELN) {</span>
<span class="nc" id="L1534">				itype = &quot;WRITE&quot;;</span>
<span class="nc" id="L1535">				pos ++;</span>
<span class="nc" id="L1536">				start = pos;</span>
<span class="nc" id="L1537">				checkWRITE(AL);</span>
<span class="nc" id="L1538">				finish = pos - 1;</span>
<span class="nc" id="L1539">				checkEnding(AL);</span>
			}
<span class="nc bnc" id="L1541" title="All 2 branches missed.">			else if (al.code == Codes.READLN) {</span>
<span class="nc" id="L1542">				itype = &quot;READ&quot;;</span>
<span class="nc" id="L1543">				pos ++;</span>
<span class="nc" id="L1544">				start = pos;</span>
<span class="nc" id="L1545">				checkREAD(AL);</span>
<span class="nc" id="L1546">				finish = pos - 1;</span>
<span class="nc" id="L1547">				checkEnding(AL);</span>
			}
<span class="nc bnc" id="L1549" title="All 2 branches missed.">			else if (al.code == Codes.WHILE) {</span>
<span class="nc" id="L1550">				itype = &quot;WHILE&quot;;</span>
<span class="nc" id="L1551">				pos ++;</span>
<span class="nc" id="L1552">				start = pos;</span>
<span class="nc" id="L1553">				checkLEXPR(AL);</span>
<span class="nc" id="L1554">				finish = pos - 1;</span>
<span class="nc" id="L1555">				pos ++;</span>
<span class="nc" id="L1556">				iftrue = interOne(AL);</span>
			}
<span class="nc bnc" id="L1558" title="All 2 branches missed.">			else if (al.code == Codes.IF) {</span>
<span class="nc" id="L1559">				itype = &quot;IF&quot;;</span>
<span class="nc" id="L1560">				pos ++;</span>
<span class="nc" id="L1561">				start = pos;</span>
<span class="nc" id="L1562">				checkLEXPR(AL);</span>
<span class="nc" id="L1563">				finish = pos - 1;</span>
<span class="nc" id="L1564">				pos ++;</span>
<span class="nc" id="L1565">				iftrue = interOne(AL);</span>
<span class="nc bnc" id="L1566" title="All 2 branches missed.">				if (checkC(&quot;keyword ELSE&quot;, Codes.ELSE, AL).equals(&quot;&quot;)) {</span>
<span class="nc" id="L1567">					pos ++;</span>
<span class="nc" id="L1568">					ifelse = interOne(AL);</span>
				}
			}
<span class="nc bnc" id="L1571" title="All 2 branches missed.">			else if (al.code == Codes.BEGIN) {</span>
<span class="nc" id="L1572">				pos ++;</span>
<span class="nc" id="L1573">				return interBlock(AL);</span>

			}
<span class="nc bnc" id="L1576" title="All 2 branches missed.">			else if (al.code == Codes.END_DOT) {</span>
<span class="nc" id="L1577">				pos ++;</span>
<span class="nc" id="L1578">				checkEnding(AL);</span>
<span class="nc" id="L1579">				return baze;</span>
			}
<span class="nc" id="L1581">			baze.add(new ExecLexem(itype, variable, AL, start, finish,</span>
					               iftrue, ifelse));
<span class="nc" id="L1583">			iftrue = new ArrayList();</span>
<span class="nc" id="L1584">			ifelse = new ArrayList();</span>
<span class="nc" id="L1585">			variable = &quot;&quot;;</span>
		}
	}// interBODY()	

	private ArrayList interBlock(ArrayList AL) {
<span class="nc" id="L1590">		ArrayList baze = new ArrayList();</span>
<span class="nc" id="L1591">		String itype = &quot;&quot;;</span>
<span class="nc" id="L1592">		String variable = &quot;&quot;;</span>
<span class="nc" id="L1593">		int start = 0;</span>
<span class="nc" id="L1594">		int finish = 0;</span>
<span class="nc" id="L1595">		ArrayList iftrue = new ArrayList();</span>
<span class="nc" id="L1596">		ArrayList ifelse = new ArrayList();</span>

<span class="nc" id="L1598">		AdvLexem al = null;</span>

		while (true) {
<span class="nc" id="L1601">			al = (AdvLexem)AL.get(pos);</span>
<span class="nc bnc" id="L1602" title="All 2 branches missed.">			if (al.code == Codes.VARIABLE) {</span>
<span class="nc" id="L1603">				variable = al.value;</span>
<span class="nc" id="L1604">				pos ++;</span>
<span class="nc" id="L1605">				pos ++;</span>
<span class="nc" id="L1606">				start = pos;</span>
<span class="nc" id="L1607">				int tmp = vars.indexOf(al.value);</span>
<span class="nc" id="L1608">				int type = ((Integer)var_types.get(tmp)).intValue();</span>
	
<span class="nc bnc" id="L1610" title="All 2 branches missed.">				if (type == Codes.INTEGER) {</span>
<span class="nc" id="L1611">					checkIASSOC(AL);</span>
<span class="nc" id="L1612">					finish = pos - 1;</span>
<span class="nc" id="L1613">					itype = &quot;IASSOC&quot;;</span>
				}
<span class="nc bnc" id="L1615" title="All 2 branches missed.">				else if (type == Codes.REAL) {</span>
<span class="nc" id="L1616">					checkRASSOC(AL);</span>
<span class="nc" id="L1617">					finish = pos - 1;</span>
<span class="nc" id="L1618">					itype = &quot;RASSOC&quot;;</span>
				}
<span class="nc bnc" id="L1620" title="All 2 branches missed.">				else if (type == Codes.BOOLEAN) {</span>
<span class="nc" id="L1621">					checkLEXPR(AL);</span>
<span class="nc" id="L1622">					finish = pos - 1;</span>
<span class="nc" id="L1623">					itype = &quot;BASSOC&quot;;</span>
				}
<span class="nc" id="L1625">				checkEnding(AL);</span>
<span class="nc" id="L1626">			}</span>
<span class="nc bnc" id="L1627" title="All 2 branches missed.">			else if (al.code == Codes.WRITELN) {</span>
<span class="nc" id="L1628">				itype = &quot;WRITE&quot;;</span>
<span class="nc" id="L1629">				pos ++;</span>
<span class="nc" id="L1630">				start = pos;</span>
<span class="nc" id="L1631">				checkWRITE(AL);</span>
<span class="nc" id="L1632">				finish = pos - 1;</span>
<span class="nc" id="L1633">				checkEnding(AL);</span>
			}
<span class="nc bnc" id="L1635" title="All 2 branches missed.">			else if (al.code == Codes.READLN) {</span>
<span class="nc" id="L1636">				itype = &quot;READ&quot;;</span>
<span class="nc" id="L1637">				pos ++;</span>
<span class="nc" id="L1638">				start = pos;</span>
<span class="nc" id="L1639">				checkREAD(AL);</span>
<span class="nc" id="L1640">				finish = pos - 1;</span>
<span class="nc" id="L1641">				checkEnding(AL);</span>
			}
<span class="nc bnc" id="L1643" title="All 2 branches missed.">			else if (al.code == Codes.WHILE) {</span>
<span class="nc" id="L1644">				itype = &quot;WHILE&quot;;</span>
<span class="nc" id="L1645">				pos ++;</span>
<span class="nc" id="L1646">				start = pos;</span>
<span class="nc" id="L1647">				checkLEXPR(AL);</span>
<span class="nc" id="L1648">				finish = pos - 1;</span>
<span class="nc" id="L1649">				pos ++;</span>
<span class="nc" id="L1650">				iftrue = interOne(AL);</span>
			}
<span class="nc bnc" id="L1652" title="All 2 branches missed.">			else if (al.code == Codes.IF) {</span>
<span class="nc" id="L1653">				itype = &quot;IF&quot;;</span>
<span class="nc" id="L1654">				pos ++;</span>
<span class="nc" id="L1655">				start = pos;</span>
<span class="nc" id="L1656">				checkLEXPR(AL);</span>
<span class="nc" id="L1657">				finish = pos - 1;</span>
<span class="nc" id="L1658">				pos ++;</span>
<span class="nc" id="L1659">				iftrue = interOne(AL);</span>
<span class="nc bnc" id="L1660" title="All 2 branches missed.">				if (checkC(&quot;keyword ELSE&quot;, Codes.ELSE, AL).equals(&quot;&quot;)) {</span>
<span class="nc" id="L1661">					pos ++;</span>
<span class="nc" id="L1662">					ifelse = interOne(AL);</span>
				}
			}
<span class="nc bnc" id="L1665" title="All 2 branches missed.">			else if (al.code == Codes.BEGIN) {</span>
<span class="nc" id="L1666">				pos ++;</span>
<span class="nc" id="L1667">				return interBlock(AL);</span>
			}
<span class="nc bnc" id="L1669" title="All 2 branches missed.">			else if (al.code == Codes.END) {</span>
<span class="nc" id="L1670">				pos ++;</span>
<span class="nc" id="L1671">				checkEnding(AL);</span>
<span class="nc" id="L1672">				return baze;</span>
			}
<span class="nc" id="L1674">			baze.add(new ExecLexem(itype, variable, AL, start, finish,</span>
					               iftrue, ifelse));
<span class="nc" id="L1676">			iftrue = new ArrayList();</span>
<span class="nc" id="L1677">			ifelse = new ArrayList();</span>
<span class="nc" id="L1678">			variable = &quot;&quot;;</span>

		}
	}// interBlock()

	private ArrayList interOne(ArrayList AL) {
<span class="nc" id="L1684">		ArrayList baze = new ArrayList();</span>
<span class="nc" id="L1685">		String itype = &quot;&quot;;</span>
<span class="nc" id="L1686">		String variable = &quot;&quot;;</span>
<span class="nc" id="L1687">		int start = 0;</span>
<span class="nc" id="L1688">		int finish = 0;</span>
<span class="nc" id="L1689">		ArrayList iftrue = new ArrayList();</span>
<span class="nc" id="L1690">		ArrayList ifelse = new ArrayList();</span>

<span class="nc" id="L1692">		AdvLexem al = null;</span>
<span class="nc" id="L1693">		al = (AdvLexem)AL.get(pos);</span>
<span class="nc bnc" id="L1694" title="All 2 branches missed.">		if (al.code == Codes.VARIABLE) {</span>
<span class="nc" id="L1695">			variable = al.value;</span>
<span class="nc" id="L1696">			pos ++;</span>
<span class="nc" id="L1697">			pos ++;</span>
<span class="nc" id="L1698">			start = pos;</span>
<span class="nc" id="L1699">			int tmp = vars.indexOf(al.value);</span>
<span class="nc" id="L1700">			int type = ((Integer)var_types.get(tmp)).intValue();</span>

<span class="nc bnc" id="L1702" title="All 2 branches missed.">			if (type == Codes.INTEGER) {</span>
<span class="nc" id="L1703">				checkIASSOC(AL);</span>
<span class="nc" id="L1704">				finish = pos - 1;</span>
<span class="nc" id="L1705">				itype = &quot;IASSOC&quot;;</span>
			}
<span class="nc bnc" id="L1707" title="All 2 branches missed.">			else if (type == Codes.REAL) {</span>
<span class="nc" id="L1708">				checkRASSOC(AL);</span>
<span class="nc" id="L1709">				finish = pos - 1;</span>
<span class="nc" id="L1710">				itype = &quot;RASSOC&quot;;</span>
			}
<span class="nc bnc" id="L1712" title="All 2 branches missed.">			else if (type == Codes.BOOLEAN) {</span>
<span class="nc" id="L1713">				checkLEXPR(AL);</span>
<span class="nc" id="L1714">				finish = pos - 1;</span>
<span class="nc" id="L1715">				itype = &quot;BASSOC&quot;;</span>
			}
<span class="nc" id="L1717">			checkEnding(AL);</span>
<span class="nc" id="L1718">		}</span>
<span class="nc bnc" id="L1719" title="All 2 branches missed.">		else if (al.code == Codes.WRITELN) {</span>
<span class="nc" id="L1720">			itype = &quot;WRITE&quot;;</span>
<span class="nc" id="L1721">			pos ++;</span>
<span class="nc" id="L1722">			start = pos;</span>
<span class="nc" id="L1723">			checkWRITE(AL);</span>
<span class="nc" id="L1724">			finish = pos - 1;</span>
<span class="nc" id="L1725">			checkEnding(AL);</span>
		}
<span class="nc bnc" id="L1727" title="All 2 branches missed.">		else if (al.code == Codes.READLN) {</span>
<span class="nc" id="L1728">			itype = &quot;READ&quot;;</span>
<span class="nc" id="L1729">			pos ++;</span>
<span class="nc" id="L1730">			start = pos;</span>
<span class="nc" id="L1731">			checkREAD(AL);</span>
<span class="nc" id="L1732">			finish = pos - 1;</span>
<span class="nc" id="L1733">			checkEnding(AL);</span>
		}
<span class="nc bnc" id="L1735" title="All 2 branches missed.">		else if (al.code == Codes.WHILE) {</span>
<span class="nc" id="L1736">			itype = &quot;WHILE&quot;;</span>
<span class="nc" id="L1737">			pos ++;</span>
<span class="nc" id="L1738">			start = pos;</span>
<span class="nc" id="L1739">			checkLEXPR(AL);</span>
<span class="nc" id="L1740">			finish = pos - 1;</span>
<span class="nc" id="L1741">			pos ++;</span>
<span class="nc" id="L1742">			iftrue = interOne(AL);</span>
		}
<span class="nc bnc" id="L1744" title="All 2 branches missed.">		else if (al.code == Codes.IF) {</span>
<span class="nc" id="L1745">			itype = &quot;IF&quot;;</span>
<span class="nc" id="L1746">			pos ++;</span>
<span class="nc" id="L1747">			start = pos;</span>
<span class="nc" id="L1748">			checkLEXPR(AL);</span>
<span class="nc" id="L1749">			finish = pos - 1;</span>
<span class="nc" id="L1750">			pos ++;</span>
<span class="nc" id="L1751">			iftrue = interOne(AL);</span>
<span class="nc bnc" id="L1752" title="All 2 branches missed.">			if (checkC(&quot;keyword ELSE&quot;, Codes.ELSE, AL).equals(&quot;&quot;)) {</span>
<span class="nc" id="L1753">				pos ++;</span>
<span class="nc" id="L1754">				ifelse = interOne(AL);</span>
			}
		}
<span class="nc bnc" id="L1757" title="All 2 branches missed.">		else if (al.code == Codes.BEGIN) {</span>
<span class="nc" id="L1758">			pos ++;</span>
<span class="nc" id="L1759">			return interBlock(AL);</span>
		}
<span class="nc" id="L1761">		baze.add(new ExecLexem(itype, variable, AL, start, finish,</span>
				               iftrue, ifelse));
<span class="nc" id="L1763">		return baze;</span>

	}// checkOne()

//mmmmmmmmmmmmmmmmmmmmmmm	EVALUATION	mmmmmmmmmmmmmmmmmmmmmmmmmmmmmm

	private void initializeVars() {
<span class="nc bnc" id="L1770" title="All 2 branches missed.">		for (int i = 0; i &lt; var_types.size(); i++)</span>
<span class="nc bnc" id="L1771" title="All 2 branches missed.">			if (((Integer)var_types.get(i)).intValue() == Codes.INTEGER)</span>
<span class="nc" id="L1772">				var_vals.add(new Integer(0));</span>
<span class="nc bnc" id="L1773" title="All 2 branches missed.">			else if (((Integer)var_types.get(i)).intValue() == Codes.REAL)</span>
<span class="nc" id="L1774">				var_vals.add(new Float(0));</span>
			else
<span class="nc" id="L1776">				var_vals.add(new Boolean(false));</span>
<span class="nc" id="L1777">	}// initializeVars()</span>

	private int evalInt(AdvLexem[] lex) {
<span class="nc" id="L1780">		ArrayList args = new ArrayList();</span>
<span class="nc" id="L1781">		ArrayList oper = new ArrayList();</span>

<span class="nc bnc" id="L1783" title="All 2 branches missed.">		while (place &lt; lex.length) {</span>
<span class="nc bnc" id="L1784" title="All 2 branches missed.">			if (lex[place].code == Codes.RBRACKET) {</span>
<span class="nc" id="L1785">				break;</span>
			}
<span class="nc bnc" id="L1787" title="All 2 branches missed.">			if (lex[place].code == Codes.INUMBER)</span>
<span class="nc" id="L1788">				args.add(new Integer(lex[place].value));</span>
<span class="nc bnc" id="L1789" title="All 2 branches missed.">			else if (lex[place].code == Codes.VARIABLE) {</span>
<span class="nc" id="L1790">				int tmp = vars.indexOf(lex[place].value);</span>
<span class="nc" id="L1791">				args.add((Integer)var_vals.get(tmp));</span>
<span class="nc" id="L1792">			}</span>
<span class="nc bnc" id="L1793" title="All 2 branches missed.">			else if (lex[place].code == Codes.LBRACKET) {</span>
<span class="nc" id="L1794">				place ++;</span>
<span class="nc" id="L1795">				args.add(new Integer(evalInt(lex)));	</span>
			}
<span class="nc bnc" id="L1797" title="All 2 branches missed.">			else if (lex[place].lcategory == Codes.AOPERATOR)</span>
<span class="nc" id="L1798">				oper.add(lex[place].value);</span>
<span class="nc" id="L1799">			place ++;</span>
		}

<span class="nc bnc" id="L1802" title="All 2 branches missed.">		for (int i = 0; i &lt; oper.size(); i++)</span>
<span class="nc bnc" id="L1803" title="All 2 branches missed.">			if (((String)oper.get(i)).equals(&quot;*&quot;)) {</span>
<span class="nc" id="L1804">				int tmp1 = ((Integer)args.get(i)).intValue();</span>
<span class="nc" id="L1805">				int tmp2 = ((Integer)args.get(i + 1)).intValue();</span>
<span class="nc" id="L1806">				args.set(i, new Integer(tmp1 * tmp2));</span>
<span class="nc" id="L1807">				args.remove(i + 1);</span>
<span class="nc" id="L1808">				oper.remove(i);</span>
<span class="nc" id="L1809">				i --;</span>
<span class="nc" id="L1810">			}</span>
<span class="nc bnc" id="L1811" title="All 2 branches missed.">			else if (((String)oper.get(i)).equals(&quot;/&quot;)) {</span>
<span class="nc" id="L1812">				int tmp1 = ((Integer)args.get(i)).intValue();</span>
<span class="nc" id="L1813">				int tmp2 = ((Integer)args.get(i + 1)).intValue();</span>
<span class="nc" id="L1814">				args.set(i, new Integer(tmp1 / tmp2));</span>
<span class="nc" id="L1815">				args.remove(i + 1);</span>
<span class="nc" id="L1816">				oper.remove(i);</span>
<span class="nc" id="L1817">				i --;</span>
			}

<span class="nc bnc" id="L1820" title="All 2 branches missed.">		for (int i = 0; i &lt; oper.size(); i++)</span>
<span class="nc bnc" id="L1821" title="All 2 branches missed.">			if (((String)oper.get(i)).equals(&quot;+&quot;)) {</span>
<span class="nc" id="L1822">				int tmp1 = ((Integer)args.get(i)).intValue();</span>
<span class="nc" id="L1823">				int tmp2 = ((Integer)args.get(i + 1)).intValue();</span>
<span class="nc" id="L1824">				args.set(i, new Integer(tmp1 + tmp2));</span>
<span class="nc" id="L1825">				args.remove(i + 1);</span>
<span class="nc" id="L1826">				oper.remove(i);</span>
<span class="nc" id="L1827">				i --;</span>
<span class="nc" id="L1828">			}</span>
<span class="nc bnc" id="L1829" title="All 2 branches missed.">			else if (((String)oper.get(i)).equals(&quot;-&quot;)) {</span>
<span class="nc" id="L1830">				int tmp1 = ((Integer)args.get(i)).intValue();</span>
<span class="nc" id="L1831">				int tmp2 = ((Integer)args.get(i + 1)).intValue();</span>
<span class="nc" id="L1832">				args.set(i, new Integer(tmp1 - tmp2));</span>
<span class="nc" id="L1833">				args.remove(i + 1);</span>
<span class="nc" id="L1834">				oper.remove(i);</span>
<span class="nc" id="L1835">				i --;</span>
			}

<span class="nc" id="L1838">		return ((Integer)args.get(0)).intValue();</span>
	}// evalInt()
	
	private float evalReal(AdvLexem[] lex) {
<span class="nc" id="L1842">		ArrayList args = new ArrayList();</span>
<span class="nc" id="L1843">		ArrayList oper = new ArrayList();</span>

<span class="nc bnc" id="L1845" title="All 2 branches missed.">		while (place &lt; lex.length) {</span>
<span class="nc bnc" id="L1846" title="All 2 branches missed.">			if (lex[place].code == Codes.RBRACKET) {</span>
<span class="nc" id="L1847">				break;</span>
			}
<span class="nc bnc" id="L1849" title="All 2 branches missed.">			if (lex[place].lcategory == Codes.NUMBER)</span>
<span class="nc" id="L1850">				args.add(new Float(lex[place].value));</span>
<span class="nc bnc" id="L1851" title="All 2 branches missed.">			else if (lex[place].code == Codes.VARIABLE) {</span>
<span class="nc" id="L1852">				int tmp = vars.indexOf(lex[place].value);</span>
<span class="nc" id="L1853">				int type = ((Integer)var_types.get(tmp)).intValue();</span>
<span class="nc bnc" id="L1854" title="All 2 branches missed.">				if (type == Codes.INTEGER) </span>
<span class="nc" id="L1855">					args.add(new Float(((Integer)var_vals.get(tmp)).</span>
<span class="nc" id="L1856">															intValue()));</span>
				else
<span class="nc" id="L1858">					args.add((Float)var_vals.get(tmp));</span>
<span class="nc" id="L1859">			}</span>
<span class="nc bnc" id="L1860" title="All 2 branches missed.">			else if (lex[place].code == Codes.LBRACKET) {</span>
<span class="nc" id="L1861">				place ++;</span>
<span class="nc" id="L1862">				args.add(new Float(evalReal(lex)));	</span>
			}
<span class="nc bnc" id="L1864" title="All 2 branches missed.">			else if (lex[place].lcategory == Codes.AOPERATOR)</span>
<span class="nc" id="L1865">				oper.add(lex[place].value);</span>
<span class="nc" id="L1866">			place ++;</span>
		}

<span class="nc bnc" id="L1869" title="All 2 branches missed.">		for (int i = 0; i &lt; oper.size(); i++)</span>
<span class="nc bnc" id="L1870" title="All 2 branches missed.">			if (((String)oper.get(i)).equals(&quot;*&quot;)) {</span>
<span class="nc" id="L1871">				float tmp1 = ((Float)args.get(i)).floatValue();</span>
<span class="nc" id="L1872">				float tmp2 = ((Float)args.get(i + 1)).floatValue();</span>
<span class="nc" id="L1873">				args.set(i, new Float(tmp1 * tmp2));</span>
<span class="nc" id="L1874">				args.remove(i + 1);</span>
<span class="nc" id="L1875">				oper.remove(i);</span>
<span class="nc" id="L1876">				i --;</span>
<span class="nc" id="L1877">			}</span>
<span class="nc bnc" id="L1878" title="All 2 branches missed.">			else if (((String)oper.get(i)).equals(&quot;/&quot;)) {</span>
<span class="nc" id="L1879">				float tmp1 = ((Float)args.get(i)).floatValue();</span>
<span class="nc" id="L1880">				float tmp2 = ((Float)args.get(i + 1)).floatValue();</span>
<span class="nc" id="L1881">				args.set(i, new Float(tmp1 / tmp2));</span>
<span class="nc" id="L1882">				args.remove(i + 1);</span>
<span class="nc" id="L1883">				oper.remove(i);</span>
<span class="nc" id="L1884">				i --;</span>
			}

<span class="nc bnc" id="L1887" title="All 2 branches missed.">		for (int i = 0; i &lt; oper.size(); i++)</span>
<span class="nc bnc" id="L1888" title="All 2 branches missed.">			if (((String)oper.get(i)).equals(&quot;+&quot;)) {</span>
<span class="nc" id="L1889">				float tmp1 = ((Float)args.get(i)).floatValue();</span>
<span class="nc" id="L1890">				float tmp2 = ((Float)args.get(i + 1)).floatValue();</span>
<span class="nc" id="L1891">				args.set(i, new Float(tmp1 + tmp2));</span>
<span class="nc" id="L1892">				args.remove(i + 1);</span>
<span class="nc" id="L1893">				oper.remove(i);</span>
<span class="nc" id="L1894">				i --;</span>
<span class="nc" id="L1895">			}</span>
<span class="nc bnc" id="L1896" title="All 2 branches missed.">			else if (((String)oper.get(i)).equals(&quot;-&quot;)) {</span>
<span class="nc" id="L1897">				float tmp1 = ((Float)args.get(i)).floatValue();</span>
<span class="nc" id="L1898">				float tmp2 = ((Float)args.get(i + 1)).floatValue();</span>
<span class="nc" id="L1899">				args.set(i, new Float(tmp1 - tmp2));</span>
<span class="nc" id="L1900">				args.remove(i + 1);</span>
<span class="nc" id="L1901">				oper.remove(i);</span>
<span class="nc" id="L1902">				i --;</span>
			}

<span class="nc" id="L1905">		return ((Float)args.get(0)).floatValue();</span>
	}// evalReal()
	
	private boolean evalBool(AdvLexem[] lex) {
<span class="nc" id="L1909">		ArrayList args = new ArrayList();</span>
<span class="nc" id="L1910">		ArrayList oper = new ArrayList();</span>
<span class="nc" id="L1911">		ArrayList nots = new ArrayList();</span>
<span class="nc" id="L1912">		int pointer = 0;</span>

<span class="nc bnc" id="L1914" title="All 2 branches missed.">		while (place &lt; lex.length) {</span>
<span class="nc bnc" id="L1915" title="All 2 branches missed.">			if (lex[place].code == Codes.RBRACKET) {</span>
<span class="nc" id="L1916">				break;</span>
			}
<span class="nc bnc" id="L1918" title="All 2 branches missed.">			if (lex[place].code == Codes.VARIABLE) {</span>
<span class="nc" id="L1919">				int tmp = vars.indexOf(lex[place].value);</span>
<span class="nc" id="L1920">				int type = ((Integer)var_types.get(tmp)).intValue();</span>
<span class="nc bnc" id="L1921" title="All 2 branches missed.">				if (type == Codes.BOOLEAN) </span>
<span class="nc" id="L1922">					pointer = 1;</span>
				else
<span class="nc" id="L1924">					pointer = 2;</span>
			}

<span class="nc bnc" id="L1927" title="All 4 branches missed.">			if ((lex[place].code == Codes.TRUE) ||</span>
				(lex[place].code == Codes.FALSE))
<span class="nc" id="L1929">				args.add(new Boolean(lex[place].value));</span>
<span class="nc bnc" id="L1930" title="All 2 branches missed.">			else if (pointer == 1) {</span>
<span class="nc" id="L1931">				int tmp = vars.indexOf(lex[place].value);</span>
<span class="nc" id="L1932">				args.add((Boolean)var_vals.get(tmp));</span>
<span class="nc" id="L1933">				pointer = 0;</span>
<span class="nc" id="L1934">			}</span>
<span class="nc bnc" id="L1935" title="All 2 branches missed.">			else if (lex[place].code == Codes.LBRACKET) {</span>
<span class="nc" id="L1936">				place ++;</span>
<span class="nc" id="L1937">				args.add(new Boolean(evalBool(lex)));	</span>
			}
<span class="nc bnc" id="L1939" title="All 4 branches missed.">			else if ((lex[place].code == Codes.AND) ||</span>
					 (lex[place].code == Codes.OR))
<span class="nc" id="L1941">				oper.add(lex[place].value);</span>
<span class="nc bnc" id="L1942" title="All 2 branches missed.">			else if (lex[place].code == Codes.NOT) </span>
<span class="nc" id="L1943">				nots.add(new Integer(args.size()));</span>
			else {
<span class="nc" id="L1945">				float tmp1 = 0;</span>
<span class="nc" id="L1946">				float tmp2 = 0;</span>
<span class="nc" id="L1947">				int rel = 0;</span>
<span class="nc bnc" id="L1948" title="All 2 branches missed.">				if (lex[place].lcategory == Codes.NUMBER)</span>
<span class="nc" id="L1949">					tmp1 = (new Float(lex[place].value)).floatValue();</span>
<span class="nc bnc" id="L1950" title="All 2 branches missed.">				else if (pointer == 2) {</span>
<span class="nc" id="L1951">					pointer = 0;</span>
<span class="nc" id="L1952">					int tmp = vars.indexOf(lex[place].value);</span>
<span class="nc" id="L1953">					int type = ((Integer)var_types.get(tmp)).intValue();</span>
<span class="nc bnc" id="L1954" title="All 2 branches missed.">					if (type == Codes.INTEGER) </span>
<span class="nc" id="L1955">						tmp1 = ((Integer)var_vals.get(tmp)).intValue();</span>
					else
<span class="nc" id="L1957">						tmp1 = ((Float)var_vals.get(tmp)).floatValue();</span>
				}
<span class="nc" id="L1959">				place ++;</span>
<span class="nc" id="L1960">				rel = lex[place].code;</span>
<span class="nc" id="L1961">				place ++;</span>
<span class="nc bnc" id="L1962" title="All 2 branches missed.">				if (lex[place].lcategory == Codes.NUMBER)</span>
<span class="nc" id="L1963">					tmp2 = (new Float(lex[place].value)).floatValue();</span>
<span class="nc bnc" id="L1964" title="All 2 branches missed.">				else if (lex[place].code == Codes.VARIABLE) {</span>
<span class="nc" id="L1965">					int tmp = vars.indexOf(lex[place].value);</span>
<span class="nc" id="L1966">					int type = ((Integer)var_types.get(tmp)).intValue();</span>
<span class="nc bnc" id="L1967" title="All 2 branches missed.">					if (type == Codes.INTEGER) </span>
<span class="nc" id="L1968">						tmp2 = ((Integer)var_vals.get(tmp)).intValue();</span>
					else
<span class="nc" id="L1970">						tmp2 = ((Float)var_vals.get(tmp)).floatValue();</span>
				}
<span class="nc" id="L1972">				boolean bool = false;</span>
<span class="nc bnc" id="L1973" title="All 2 branches missed.">				if (rel == Codes.E)</span>
<span class="nc bnc" id="L1974" title="All 2 branches missed.">					bool = tmp1 == tmp2;</span>
<span class="nc bnc" id="L1975" title="All 2 branches missed.">				else if (rel == Codes.NE)</span>
<span class="nc bnc" id="L1976" title="All 2 branches missed.">					bool = tmp1 != tmp2;</span>
<span class="nc bnc" id="L1977" title="All 2 branches missed.">				else if (rel == Codes.GT) {</span>
<span class="nc bnc" id="L1978" title="All 2 branches missed.">					bool = tmp1 &gt; tmp2;</span>
				}
<span class="nc bnc" id="L1980" title="All 2 branches missed.">				else if (rel == Codes.GE)</span>
<span class="nc bnc" id="L1981" title="All 2 branches missed.">					bool = tmp1 &gt;= tmp2;</span>
<span class="nc bnc" id="L1982" title="All 2 branches missed.">				else if (rel == Codes.LT)</span>
<span class="nc bnc" id="L1983" title="All 2 branches missed.">					bool = tmp1 &lt; tmp2;</span>
<span class="nc bnc" id="L1984" title="All 2 branches missed.">				else if (rel == Codes.LE)</span>
<span class="nc bnc" id="L1985" title="All 2 branches missed.">					bool = tmp1 &lt;= tmp2;		</span>

<span class="nc" id="L1987">				args.add(new Boolean(bool));				</span>
			}
				
<span class="nc" id="L1990">			place ++;</span>
		}
		
<span class="nc bnc" id="L1993" title="All 2 branches missed.">		for (int i = 0; i &lt; nots.size(); i++) {</span>
<span class="nc" id="L1994">			int neg = ((Integer)nots.get(i)).intValue();</span>
<span class="nc" id="L1995">			boolean temp = ((Boolean)args.get(neg)).booleanValue();</span>
<span class="nc bnc" id="L1996" title="All 2 branches missed.">			args.set(neg, new Boolean(!temp));</span>
		}

<span class="nc bnc" id="L1999" title="All 2 branches missed.">		for (int i = 0; i &lt; oper.size(); i++)</span>
<span class="nc bnc" id="L2000" title="All 2 branches missed.">			if (((String)oper.get(i)).equals(&quot;AND&quot;)) {</span>
<span class="nc" id="L2001">				boolean tmp1 = ((Boolean)args.get(i)).booleanValue();</span>
<span class="nc" id="L2002">				boolean tmp2 = ((Boolean)args.get(i + 1)).booleanValue();</span>
<span class="nc bnc" id="L2003" title="All 4 branches missed.">				args.set(i, new Boolean(tmp1 &amp;&amp; tmp2));</span>
<span class="nc" id="L2004">				args.remove(i + 1);</span>
<span class="nc" id="L2005">				oper.remove(i);</span>
<span class="nc" id="L2006">				i --;</span>
			}
<span class="nc bnc" id="L2008" title="All 2 branches missed.">		for (int i = 0; i &lt; oper.size(); i++)</span>
<span class="nc bnc" id="L2009" title="All 2 branches missed.">			if (((String)oper.get(i)).equals(&quot;OR&quot;)) {</span>
<span class="nc" id="L2010">				boolean tmp1 = ((Boolean)args.get(i)).booleanValue();</span>
<span class="nc" id="L2011">				boolean tmp2 = ((Boolean)args.get(i + 1)).booleanValue();</span>
<span class="nc bnc" id="L2012" title="All 4 branches missed.">				args.set(i, new Boolean(tmp1 || tmp2));</span>
<span class="nc" id="L2013">				args.remove(i + 1);</span>
<span class="nc" id="L2014">				oper.remove(i);</span>
<span class="nc" id="L2015">				i --;</span>
			}

<span class="nc" id="L2018">		return ((Boolean)args.get(0)).booleanValue();</span>
	}// evalBool()

//mmmmmmmmmmmmmmmmmmmmmmmmmmm	EXECUTOR	mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
	
	private void execute(ArrayList al) {
<span class="nc bnc" id="L2024" title="All 2 branches missed.">		for (int i = 0; i &lt; al.size(); i++)</span>
<span class="nc" id="L2025">			execLexem((ExecLexem)al.get(i));</span>
<span class="nc" id="L2026">	}// execute()</span>

	private void execLexem(ExecLexem el) {
<span class="nc bnc" id="L2029" title="All 2 branches missed.">		if (el.type.equals(&quot;IASSOC&quot;))</span>
<span class="nc" id="L2030">			execInt(el);</span>
<span class="nc bnc" id="L2031" title="All 2 branches missed.">		else if (el.type.equals(&quot;RASSOC&quot;))</span>
<span class="nc" id="L2032">			execReal(el);</span>
<span class="nc bnc" id="L2033" title="All 2 branches missed.">		else if (el.type.equals(&quot;BASSOC&quot;))</span>
<span class="nc" id="L2034">			execBool(el);</span>
<span class="nc bnc" id="L2035" title="All 2 branches missed.">		else if (el.type.equals(&quot;READ&quot;))</span>
<span class="nc" id="L2036">			execRead(el);		</span>
<span class="nc bnc" id="L2037" title="All 2 branches missed.">		else if (el.type.equals(&quot;WRITE&quot;))</span>
<span class="nc" id="L2038">			execWrite(el);</span>
<span class="nc bnc" id="L2039" title="All 2 branches missed.">		else if (el.type.equals(&quot;WHILE&quot;))</span>
<span class="nc" id="L2040">			execWhile(el);</span>
<span class="nc bnc" id="L2041" title="All 2 branches missed.">		else if (el.type.equals(&quot;IF&quot;))</span>
<span class="nc" id="L2042">			execIf(el);</span>

<span class="nc" id="L2044">	}// execLexem()</span>

	private void execInt(ExecLexem el) {
<span class="nc" id="L2047">		int tmp = vars.indexOf(el.variable);</span>
<span class="nc" id="L2048">		place = 0;</span>
<span class="nc" id="L2049">		var_vals.set(tmp, new Integer(evalInt(el.lexems)));</span>
<span class="nc" id="L2050">	}// execInt()</span>
	
	private void execReal(ExecLexem el) {
<span class="nc" id="L2053">		int tmp = vars.indexOf(el.variable);</span>
<span class="nc" id="L2054">		place = 0;</span>
<span class="nc" id="L2055">		var_vals.set(tmp, new Float(evalReal(el.lexems)));</span>
<span class="nc" id="L2056">	}// execReal()</span>
	
	private void execBool(ExecLexem el) {
<span class="nc" id="L2059">		int tmp = vars.indexOf(el.variable);</span>
<span class="nc" id="L2060">		place = 0;</span>
<span class="nc" id="L2061">		var_vals.set(tmp, new Boolean(evalBool(el.lexems)));</span>
<span class="nc" id="L2062">	}// execBool()</span>

	private void execWhile(ExecLexem el) {
<span class="nc" id="L2065">		place = 0;</span>
		
<span class="nc bnc" id="L2067" title="All 2 branches missed.">		while (evalBool(el.lexems)) {</span>
<span class="nc" id="L2068">			execute(el.iftrue);</span>
<span class="nc" id="L2069">			place = 0;</span>
		}
<span class="nc" id="L2071">	}// execWhile()</span>

	private void execIf(ExecLexem el) {
<span class="nc" id="L2074">		place = 0;</span>
		
<span class="nc bnc" id="L2076" title="All 2 branches missed.">		if (evalBool(el.lexems))</span>
<span class="nc" id="L2077">			execute(el.iftrue);</span>
		else
<span class="nc" id="L2079">			execute(el.ifelse);</span>
<span class="nc" id="L2080">	}// execIf()</span>

	private void execRead(ExecLexem el) {
<span class="nc" id="L2083">		int tmp = vars.indexOf(el.lexems[1].value);</span>
<span class="nc" id="L2084">		int type = ((Integer)var_types.get(tmp)).intValue();</span>
<span class="nc" id="L2085">		String s = &quot;&quot;;</span>
		
		try {
<span class="nc" id="L2088">			BufferedReader in = new BufferedReader(</span>
	  	    						new InputStreamReader(System.in));
<span class="nc" id="L2090">	  	    s = in.readLine();</span>
<span class="nc" id="L2091">	  	}catch (Exception ex) { </span>
<span class="nc" id="L2092">	  		System.out.println(&quot;Error during input operatiron !&quot;); }</span>

<span class="nc bnc" id="L2094" title="All 2 branches missed.">  	    if (type == Codes.INTEGER)</span>
<span class="nc" id="L2095">  	    	var_vals.set(tmp, new Integer(s));</span>
<span class="nc bnc" id="L2096" title="All 2 branches missed.">  	    else if (type == Codes.REAL)</span>
<span class="nc" id="L2097">  	    	var_vals.set(tmp, new Float(s));</span>
  	    else
<span class="nc" id="L2099">  	    	var_vals.set(tmp, new Boolean(s));</span>
 
<span class="nc" id="L2101">	}// execRead()</span>
	
	private void execWrite(ExecLexem el) {
<span class="nc bnc" id="L2104" title="All 2 branches missed.">		for (int i = 1; i &lt; el.lexems.length; i = i + 2)</span>
<span class="nc bnc" id="L2105" title="All 2 branches missed.">			if (el.lexems[i].code == Codes.STRING)</span>
<span class="nc" id="L2106">				System.out.print(el.lexems[i].value);</span>
			else {
<span class="nc" id="L2108">				int tmp = vars.indexOf(el.lexems[i].value);</span>
<span class="nc" id="L2109">				int type = ((Integer)var_types.get(tmp)).intValue();</span>
<span class="nc" id="L2110">				String s = &quot;&quot;;</span>

<span class="nc bnc" id="L2112" title="All 2 branches missed.">		  	    if (type == Codes.INTEGER)</span>
<span class="nc" id="L2113">		  	    	s = ((Integer)var_vals.get(tmp)).toString();</span>
<span class="nc bnc" id="L2114" title="All 2 branches missed.">		  	    else if (type == Codes.REAL)</span>
<span class="nc" id="L2115">		  	    	s = ((Float)var_vals.get(tmp)).toString();</span>
		  	    else
<span class="nc" id="L2117">		  	    	s = ((Boolean)var_vals.get(tmp)).toString();</span>
<span class="nc" id="L2118">		  	    System.out.print(s);</span>
			}
<span class="nc" id="L2120">		System.out.println();</span>
<span class="nc" id="L2121">	}// execWrite()</span>

	
}// class Scanner

//mmmmmmmmmmmmmmmmmmmm	ADDITIONAL CLASSES	mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm

class Lexem {
	String value;
	byte type;
	int line;
	int column;

<span class="nc" id="L2134">	public Lexem(String value, byte type, int line, int column) {</span>
<span class="nc bnc" id="L2135" title="All 2 branches missed.">		if (type != Codes.STRING)</span>
<span class="nc" id="L2136">			this.value = value.toUpperCase();</span>
		else
<span class="nc" id="L2138">			this.value = value;</span>
<span class="nc" id="L2139">		this.type = type;</span>
<span class="nc" id="L2140">		this.line = line;</span>
<span class="nc" id="L2141">		this.column = column;</span>
<span class="nc" id="L2142">	}</span>

<span class="nc" id="L2144">	public Lexem(StringBuffer value, byte type, int line, int column) {</span>
<span class="nc bnc" id="L2145" title="All 2 branches missed.">		if (type != Codes.STRING)</span>
<span class="nc" id="L2146">			this.value = value.toString().toUpperCase();</span>
		else
<span class="nc" id="L2148">			this.value = value.toString();</span>
<span class="nc" id="L2149">		this.type = type;</span>
<span class="nc" id="L2150">		this.line = line;</span>
<span class="nc" id="L2151">		this.column = column;</span>
<span class="nc" id="L2152">	}</span>

<span class="nc" id="L2154">	public Lexem(int value, int type, int line, int column) {</span>
<span class="nc" id="L2155">		char[] sign = new char[1];</span>
<span class="nc" id="L2156">		sign[0] = (char)value;</span>
<span class="nc" id="L2157">		this.value = new String(sign);</span>
<span class="nc" id="L2158">		this.type = (byte)type;</span>
<span class="nc" id="L2159">		this.line = line;</span>
<span class="nc" id="L2160">		this.column = column;</span>
<span class="nc" id="L2161">	}</span>
}// class Lexem

class AdvLexem {
	String value;
	byte code;
	byte lcategory; // lower category
	byte hcategory; // higher category
	byte ccategory; // custom category, if needed
	int line;
	int column;

	public AdvLexem(String value, byte code, byte lcategory,
<span class="nc" id="L2174">					byte hcategory, int line, int column) {</span>
<span class="nc" id="L2175">		this.value = value;</span>
<span class="nc" id="L2176">		this.code = code;</span>
<span class="nc" id="L2177">		this.lcategory = lcategory;</span>
<span class="nc" id="L2178">		this.hcategory = hcategory;</span>
<span class="nc" id="L2179">		this.line = line;</span>
<span class="nc" id="L2180">		this.column = column;</span>
<span class="nc" id="L2181">	}// AdvLexem()</span>
}// class AdvLexem

class ExecLexem {
	String type;     // instruction type
	String variable;  // name of variable in association instruction
	AdvLexem[] lexems; // lexems of the given instruction
	ArrayList iftrue;
	ArrayList ifelse;
	
	ExecLexem(String type, String variable, ArrayList AL,
			  int start, int finish,
<span class="nc" id="L2193">			  ArrayList iftrue, ArrayList ifelse) {</span>
<span class="nc" id="L2194">		this.type = type;</span>
<span class="nc" id="L2195">		this.variable = variable;</span>
<span class="nc" id="L2196">		lexems = new AdvLexem[finish - start + 1];</span>
<span class="nc bnc" id="L2197" title="All 2 branches missed.">		for (int i = start, j = 0; i &lt;= finish; i++, j++)</span>
<span class="nc" id="L2198">			lexems[j] = (AdvLexem)AL.get(i);</span>
<span class="nc" id="L2199">		this.iftrue = iftrue;</span>
<span class="nc" id="L2200">		this.ifelse = ifelse;</span>
<span class="nc" id="L2201">	}// ExecLexem()</span>
}// class ExecLexem
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>