<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AboutBoxDialog.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">102_squirrel-sql</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.squirrel_sql.client.gui</a> &gt; <span class="el_source">AboutBoxDialog.java</span></div><h1>AboutBoxDialog.java</h1><pre class="source lang-java linenums">package net.sourceforge.squirrel_sql.client.gui;
/*
 * Copyright (C) 2001-2003 Colin Bell
 * colbell@users.sourceforge.net
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Component;
import java.awt.Dimension;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.lang.management.ManagementFactory;
import java.lang.management.ThreadInfo;
import java.lang.management.ThreadMXBean;
import java.net.URL;
import java.util.Map;
import java.util.Set;
import java.util.StringTokenizer;

import javax.management.MXBean;
import javax.swing.BorderFactory;
import javax.swing.Icon;
import javax.swing.JButton;
import javax.swing.JDialog;
import javax.swing.JEditorPane;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTabbedPane;
import javax.swing.JTextArea;
import javax.swing.Timer;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;

import net.sourceforge.squirrel_sql.client.IApplication;
import net.sourceforge.squirrel_sql.client.gui.builders.UIFactory;
import net.sourceforge.squirrel_sql.client.plugin.PluginInfo;
import net.sourceforge.squirrel_sql.client.resources.SquirrelResources;
import net.sourceforge.squirrel_sql.fw.datasetviewer.DataSetException;
import net.sourceforge.squirrel_sql.fw.datasetviewer.DataSetViewerTablePanel;
import net.sourceforge.squirrel_sql.fw.datasetviewer.HashtableDataSet;
import net.sourceforge.squirrel_sql.fw.gui.GUIUtils;
import net.sourceforge.squirrel_sql.fw.gui.PropertyPanel;
import net.sourceforge.squirrel_sql.fw.util.StringManager;
import net.sourceforge.squirrel_sql.fw.util.StringManagerFactory;
import net.sourceforge.squirrel_sql.fw.util.StringUtilities;
import net.sourceforge.squirrel_sql.fw.util.Utilities;
import net.sourceforge.squirrel_sql.fw.util.log.ILogger;
import net.sourceforge.squirrel_sql.fw.util.log.LoggerController;

import com.jgoodies.forms.builder.ButtonBarBuilder;
/**
 * About box dialog.
 *
 * @author &lt;A HREF=&quot;mailto:colbell@users.sourceforge.net&quot;&gt;Colin Bell&lt;/A&gt;
 */
public class AboutBoxDialog extends JDialog
{
    private static final long serialVersionUID = 1L;

    /** Logger for this class. */
<span class="nc" id="L81">	private final static ILogger s_log =</span>
<span class="nc" id="L82">		LoggerController.createLogger(AboutBoxDialog.class);</span>

	/** Internationalized strings for this class. */
<span class="nc" id="L85">	private static final StringManager s_stringMgr =</span>
<span class="nc" id="L86">		StringManagerFactory.getStringManager(AboutBoxDialog.class);</span>

	/** Singleton instance of this class. */
	private static AboutBoxDialog s_instance;

	/** The tabbed panel. */
	private JTabbedPane _tabPnl;

	/** System panel. */
	private SystemPanel _systemPnl;
	
	private ThreadPanel _threadPnl;

	/** Close button for dialog. */
<span class="nc" id="L100">	private final JButton _closeBtn = new JButton(s_stringMgr.getString(&quot;AboutBoxDialog.close&quot;));</span>


	private AboutBoxDialog(IApplication app)
	{
<span class="nc" id="L105">		super(app.getMainFrame(), s_stringMgr.getString(&quot;AboutBoxDialog.about&quot;), true);</span>
<span class="nc" id="L106">		setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);</span>
<span class="nc" id="L107">		createGUI(app);</span>
<span class="nc" id="L108">	}</span>

	/**
	 * Show the About Box.
	 *
	 * @param	app		Application API.
	 *
	 * @throws	IllegalArgumentException
	 * 			Thrown if a &lt;TT&gt;null&lt;/TT&gt; &lt;TT&gt;IApplication&lt;/TT&gt; object passed.
	 */
	public static synchronized void showAboutBox(IApplication app)
		throws IllegalArgumentException
	{
<span class="nc bnc" id="L121" title="All 2 branches missed.">		if (app == null)</span>
		{
<span class="nc" id="L123">			throw new IllegalArgumentException(&quot;Null IApplication passed&quot;);</span>
		}
<span class="nc bnc" id="L125" title="All 2 branches missed.">		if (s_instance == null)</span>
		{
<span class="nc" id="L127">			s_instance = new AboutBoxDialog(app);</span>
		}
<span class="nc" id="L129">		s_instance.setVisible(true);</span>
<span class="nc" id="L130">	}</span>

	private void createGUI(IApplication app)
	{
<span class="nc" id="L134">		final JPanel contentPane = new JPanel(new BorderLayout());</span>
<span class="nc" id="L135">		setContentPane(contentPane);</span>
<span class="nc" id="L136">		contentPane.setBorder(BorderFactory.createEmptyBorder(4, 4, 4, 4));</span>

<span class="nc" id="L138">		final boolean isDebug = s_log.isDebugEnabled();</span>
<span class="nc" id="L139">		long start = 0;</span>

<span class="nc" id="L141">		_tabPnl = UIFactory.getInstance().createTabbedPane();</span>

<span class="nc bnc" id="L143" title="All 2 branches missed.">		if (isDebug)</span>
		{
<span class="nc" id="L145">			start = System.currentTimeMillis();</span>
		}
<span class="nc" id="L147">		_tabPnl.add(s_stringMgr.getString(&quot;AboutBoxDialog.about&quot;), new AboutPanel(app));</span>
<span class="nc bnc" id="L148" title="All 2 branches missed.">		if (isDebug)</span>
		{
            // i18n[AboutBoxDialog.aboutpanelcreatetime=AboutPanel created in ]
<span class="nc" id="L151">			s_log.debug(s_stringMgr.getString(&quot;AboutBoxDialog.aboutpanelcreatetime&quot;)</span>
<span class="nc" id="L152">					+ (System.currentTimeMillis() - start)</span>
					+ &quot;ms&quot;);
		}

<span class="nc bnc" id="L156" title="All 2 branches missed.">		if (isDebug)</span>
		{
<span class="nc" id="L158">			start = System.currentTimeMillis();</span>
		}
<span class="nc" id="L160">		_tabPnl.add(s_stringMgr.getString(&quot;AboutBoxDialog.credits&quot;), new CreditsPanel(app)); // i18n</span>
<span class="nc bnc" id="L161" title="All 2 branches missed.">		if (isDebug)</span>
		{
            // i18n[AboutBoxDialog.creditspanelcreatetime=CreditsPanel created in ]
<span class="nc" id="L164">			s_log.debug(s_stringMgr.getString(&quot;AboutBoxDialog.creditspanelcreatetime&quot;)</span>
<span class="nc" id="L165">					+ (System.currentTimeMillis() - start)</span>
					+ &quot;ms&quot;);
		}

<span class="nc bnc" id="L169" title="All 2 branches missed.">		if (isDebug)</span>
		{
<span class="nc" id="L171">			start = System.currentTimeMillis();</span>
		}
<span class="nc" id="L173">		_systemPnl = new SystemPanel();</span>
<span class="nc" id="L174">		_tabPnl.add(s_stringMgr.getString(&quot;AboutBoxDialog.system&quot;), _systemPnl);</span>
<span class="nc bnc" id="L175" title="All 2 branches missed.">		if (isDebug)</span>
		{
            // i18n[AboutBoxDialog.systempanelcreatetime=SystemPanel created in ]
<span class="nc" id="L178">			s_log.debug(s_stringMgr.getString(&quot;AboutBoxDialog.systempanelcreatetime&quot;)</span>
<span class="nc" id="L179">					+ (System.currentTimeMillis() - start)</span>
					+ &quot;ms&quot;);
		}
		
<span class="nc" id="L183">		_threadPnl = new ThreadPanel();</span>
<span class="nc" id="L184">		_tabPnl.add(s_stringMgr.getString(&quot;AboutBoxDialog.threads&quot;), _threadPnl);</span>

<span class="nc" id="L186">		_tabPnl.addChangeListener(new ChangeListener()</span>
<span class="nc" id="L187">		{</span>
			public void stateChanged(ChangeEvent evt)
			{
<span class="nc" id="L190">				String title = _tabPnl.getTitleAt(_tabPnl.getSelectedIndex());</span>
<span class="nc bnc" id="L191" title="All 2 branches missed.">				if (title.equals(s_stringMgr.getString(&quot;AboutBoxDialog.system&quot;)))</span>
				{
<span class="nc" id="L193">					_systemPnl._memoryPnl.startTimer();</span>
				}
				else
				{
<span class="nc" id="L197">					_systemPnl._memoryPnl.stopTimer();</span>
				}
<span class="nc" id="L199">			}</span>
		});

<span class="nc" id="L202">		contentPane.add(_tabPnl, BorderLayout.CENTER);</span>

		// Ok button at bottom of dialog.
//		JPanel btnsPnl = new JPanel();
//		JButton okBtn = new JButton(&quot;OK&quot;);

//		_closeBtn.addActionListener(new ActionListener()
//		{
//			public void actionPerformed(ActionEvent evt)
//			{
//				setVisible(false);
//			}
//		});
//		btnsPnl.add(okBtn);
//		contentPane.add(btnsPnl, BorderLayout.SOUTH);
<span class="nc" id="L217">		contentPane.add(createButtonBar(), BorderLayout.SOUTH);</span>

<span class="nc" id="L219">		getRootPane().setDefaultButton(_closeBtn);</span>

<span class="nc" id="L221">		addWindowListener(new WindowAdapter()</span>
<span class="nc" id="L222">		{</span>
			public void windowActivated(WindowEvent evt)
			{
<span class="nc" id="L225">				String title = _tabPnl.getTitleAt(_tabPnl.getSelectedIndex());</span>
<span class="nc bnc" id="L226" title="All 2 branches missed.">				if (title.equals(s_stringMgr.getString(&quot;AboutBoxDialog.system&quot;)))</span>
				{
<span class="nc" id="L228">					_systemPnl._memoryPnl.startTimer();</span>
				}
<span class="nc" id="L230">			}</span>
			public void windowDeactivated(WindowEvent evt)
			{
<span class="nc" id="L233">				String title = _tabPnl.getTitleAt(_tabPnl.getSelectedIndex());</span>
<span class="nc bnc" id="L234" title="All 2 branches missed.">				if (title.equals(s_stringMgr.getString(&quot;AboutBoxDialog.system&quot;)))</span>
				{
<span class="nc" id="L236">					_systemPnl._memoryPnl.stopTimer();</span>
				}
<span class="nc" id="L238">			}</span>
		});

<span class="nc" id="L241">		pack();</span>
<span class="nc" id="L242">		GUIUtils.centerWithinParent(this);</span>
<span class="nc" id="L243">		setResizable(true);</span>
<span class="nc" id="L244">	}</span>

	private JPanel createButtonBar()
	{
<span class="nc" id="L248">		_closeBtn.addActionListener(new ActionListener()</span>
<span class="nc" id="L249">		{</span>
			public void actionPerformed(ActionEvent evt)
			{
<span class="nc" id="L252">				setVisible(false);</span>
<span class="nc" id="L253">			}</span>
		});

<span class="nc" id="L256">		final ButtonBarBuilder builder = new ButtonBarBuilder();</span>
<span class="nc" id="L257">		builder.addGlue();</span>
//		builder.addGridded(new JButton(&quot;Alter&quot;));
//		builder.addRelatedGap();
<span class="nc" id="L260">		builder.addGridded(_closeBtn);</span>

<span class="nc" id="L262">		return builder.getPanel();</span>
	}

	private static final class CreditsPanel extends JScrollPane
	{
        private static final long serialVersionUID = 1L;

        CreditsPanel(IApplication app)
		{
<span class="nc" id="L271">			super();</span>

<span class="nc" id="L273">			setBorder(BorderFactory.createEmptyBorder());</span>

<span class="nc" id="L275">			final JEditorPane credits = new JEditorPane();</span>
<span class="nc" id="L276">			credits.setEditable(false);</span>
<span class="nc" id="L277">			credits.setContentType(&quot;text/html&quot;);</span>

			// Required with the first beta of JDK1.4.1 to stop
			// this scrollpane from being too tall.
<span class="nc" id="L281">			credits.setPreferredSize(new Dimension(200, 200));</span>

<span class="nc" id="L283">			String creditsHtml = readCreditsHtml(app);</span>

<span class="nc" id="L285">			StringBuffer pluginHtml = new StringBuffer();</span>
			// Get list of all plugin developers names. Allow for multiple
			// developers for a plugin in the form &quot;John Smith, James Brown&quot;.
<span class="nc" id="L288">			PluginInfo[] pi = app.getPluginManager().getPluginInformation();</span>
<span class="nc bnc" id="L289" title="All 2 branches missed.">			for (int i = 0; i &lt; pi.length; ++i)</span>
			{
<span class="nc" id="L291">				pluginHtml.append(&quot;&lt;br&gt;&lt;b&gt;&quot;).append(pi[i].getDescriptiveName()).append(&quot;:&lt;/b&gt;&quot;);</span>

<span class="nc" id="L293">				String authors = pi[i].getAuthor();</span>
<span class="nc" id="L294">				StringTokenizer strok = new StringTokenizer(authors, &quot;,&quot;);</span>
<span class="nc bnc" id="L295" title="All 2 branches missed.">				while (strok.hasMoreTokens())</span>
				{
<span class="nc" id="L297">					pluginHtml.append(&quot;&lt;br&gt;&quot;).append(strok.nextToken().trim());</span>
				}
<span class="nc" id="L299">				String contribs = pi[i].getContributors();</span>
<span class="nc" id="L300">				strok = new StringTokenizer(contribs, &quot;,&quot;);</span>
<span class="nc bnc" id="L301" title="All 2 branches missed.">				while (strok.hasMoreTokens())</span>
				{
<span class="nc" id="L303">					pluginHtml.append(&quot;&lt;br&gt;&quot;).append(strok.nextToken().trim());</span>
				}


<span class="nc" id="L307">				pluginHtml.append(&quot;&lt;br&gt;&quot;);</span>
			}

<span class="nc" id="L310">			creditsHtml = creditsHtml.replaceAll(&quot;@@replace&quot;, pluginHtml.toString());</span>
<span class="nc" id="L311">			credits.setText(creditsHtml);</span>

<span class="nc" id="L313">			setViewportView(credits);</span>
<span class="nc" id="L314">			credits.setCaretPosition(0);</span>
<span class="nc" id="L315">		}</span>

		private String readCreditsHtml(IApplication app)
		{
<span class="nc" id="L319">			final URL url = app.getResources().getCreditsURL();</span>
<span class="nc" id="L320">			StringBuffer buf = new StringBuffer(2048);</span>

<span class="nc bnc" id="L322" title="All 2 branches missed.">			if (url != null)</span>
			{
				try
				{
<span class="nc" id="L326">					BufferedReader rdr = new BufferedReader(new InputStreamReader(url.openStream()));</span>
					try
					{
<span class="nc" id="L329">						String line = null;</span>
<span class="nc bnc" id="L330" title="All 2 branches missed.">						while ((line = rdr.readLine()) != null)</span>
						{
<span class="nc" id="L332">							String internationalizedLine = </span>
<span class="nc" id="L333">								Utilities.replaceI18NSpanLine(line, s_stringMgr);</span>
<span class="nc" id="L334">							buf.append(internationalizedLine);</span>
<span class="nc" id="L335">						}</span>
					}
					finally
					{
<span class="nc" id="L339">						rdr.close();</span>
					}
				}
<span class="nc" id="L342">				catch (IOException ex)</span>
				{
						  // i18n[AboutBoxDialog.error.creditsfile=Error reading credits file]
						  String errorMsg =
<span class="nc" id="L346">								s_stringMgr.getString(&quot;AboutBoxDialog.error.creditsfile&quot;);</span>
<span class="nc" id="L347">					s_log.error(errorMsg, ex);</span>
<span class="nc" id="L348">					buf.append(errorMsg + &quot;: &quot; + ex.toString());</span>
<span class="nc" id="L349">				}</span>
			}
			else
			{
					 // i18n[AboutBoxDialog.error.creditsfileurl=Couldn't retrieve Credits File URL]
					 String errorMsg =
<span class="nc" id="L355">						  s_stringMgr.getString(&quot;AboutBoxDialog.error.creditsfileurl&quot;);</span>
<span class="nc" id="L356">				s_log.error(errorMsg);</span>
<span class="nc" id="L357">				buf.append(errorMsg);</span>
			}
<span class="nc" id="L359">			return buf.toString();</span>
		}
				
	}

	private static final class AboutPanel extends JPanel
	{
        private static final long serialVersionUID = 1L;

        AboutPanel(IApplication app)
		{
<span class="nc" id="L370">			super();</span>
<span class="nc" id="L371">			final SquirrelResources rsrc = app.getResources();</span>
<span class="nc" id="L372">			setBorder(BorderFactory.createEmptyBorder(4, 4, 4, 4));</span>
<span class="nc" id="L373">			setLayout(new BorderLayout());</span>
<span class="nc" id="L374">			setBackground(new Color(SquirrelResources.S_SPLASH_IMAGE_BACKGROUND));</span>
<span class="nc" id="L375">			Icon icon = rsrc.getIcon(SquirrelResources.IImageNames.SPLASH_SCREEN);</span>
<span class="nc" id="L376">			add(BorderLayout.CENTER, new JLabel(icon));</span>
            
<span class="nc" id="L378">            VersionPane versionPane = new VersionPane(true);</span>
<span class="nc" id="L379">            versionPane.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));</span>
<span class="nc" id="L380">            add(BorderLayout.SOUTH, versionPane);</span>
<span class="nc" id="L381">		}</span>
	}

	private static final class SystemPanel extends JPanel
	{
        private static final long serialVersionUID = 1L;
        private MemoryPanel _memoryPnl;

		SystemPanel()
		{
<span class="nc" id="L391">			super();</span>
<span class="nc" id="L392">			setLayout(new BorderLayout());</span>
<span class="nc" id="L393">			DataSetViewerTablePanel propsPnl = new DataSetViewerTablePanel();</span>
<span class="nc" id="L394">			propsPnl.init(null);</span>
			try
			{
<span class="nc" id="L397">				propsPnl.show(new HashtableDataSet(System.getProperties()));</span>
			}
<span class="nc" id="L399">			catch (DataSetException ex)</span>
			{
                // i18n[AboutBoxDialog.error.systemprops=Error occured displaying System Properties]
<span class="nc" id="L402">				s_log.error(s_stringMgr.getString(&quot;AboutBoxDialog.error.systemprops&quot;), ex);</span>
<span class="nc" id="L403">			}</span>

<span class="nc" id="L405">			_memoryPnl = new MemoryPanel();</span>
<span class="nc" id="L406">			add(new JScrollPane(propsPnl.getComponent()), BorderLayout.CENTER);</span>
<span class="nc" id="L407">			add(_memoryPnl, BorderLayout.SOUTH);</span>

			//setPreferredSize(new Dimension(400, 400));
<span class="nc" id="L410">		}</span>
	}

	
	
	private static class MemoryPanel
		extends PropertyPanel
		implements ActionListener
	{
        private static final long serialVersionUID = 1L;
<span class="nc" id="L420">        private final JLabel _totalMemoryLbl = new JLabel();</span>
<span class="nc" id="L421">		private final JLabel _usedMemoryLbl = new JLabel();</span>
<span class="nc" id="L422">		private final JLabel _freeMemoryLbl = new JLabel();</span>
		private Timer _timer;

		MemoryPanel()
		{
<span class="nc" id="L427">			super();</span>
<span class="nc" id="L428">			add(new JLabel(s_stringMgr.getString(&quot;AboutBoxDialog.heapsize&quot;)), _totalMemoryLbl);</span>
<span class="nc" id="L429">			add(new JLabel(s_stringMgr.getString(&quot;AboutBoxDialog.usedheap&quot;)), _usedMemoryLbl);</span>
<span class="nc" id="L430">			add(new JLabel(s_stringMgr.getString(&quot;AboutBoxDialog.freeheap&quot;)), _freeMemoryLbl);</span>

<span class="nc" id="L432">			JButton gcBtn = new JButton(s_stringMgr.getString(&quot;AboutBoxDialog.gc&quot;));</span>
<span class="nc" id="L433">			gcBtn.addActionListener(new ActionListener()</span>
<span class="nc" id="L434">			{</span>
				public void actionPerformed(ActionEvent evt)
				{
<span class="nc" id="L437">					Utilities.garbageCollect();</span>
<span class="nc" id="L438">				}</span>
			});
<span class="nc" id="L440">			add(gcBtn, new JLabel(&quot;&quot;));</span>
<span class="nc" id="L441">		}</span>

		public void removeNotify()
		{
<span class="nc" id="L445">			super.removeNotify();</span>
<span class="nc" id="L446">			stopTimer();</span>
<span class="nc" id="L447">		}</span>

		/**
		 * Update component with the current memory status.
		 *
		 * @param	evt		The current event.
		 */
		public void actionPerformed(ActionEvent evt)
		{
<span class="nc" id="L456">			updateMemoryStatus();</span>
<span class="nc" id="L457">		}</span>

		synchronized void startTimer()
		{
<span class="nc bnc" id="L461" title="All 2 branches missed.">			if (_timer == null)</span>
			{
                // i18n[AboutBoxDialog.info.startmemtime=Starting memory timer (AboutBox)]
<span class="nc" id="L464">				s_log.debug(s_stringMgr.getString(&quot;AboutBoxDialog.info.startmemtime&quot;));</span>
				//_thread = new Thread(new MemoryTimer());
				//_thread.start();
<span class="nc" id="L467">				updateMemoryStatus();</span>
<span class="nc" id="L468">				_timer = new Timer(2000, this);</span>
<span class="nc" id="L469">				_timer.start();</span>
			}
<span class="nc" id="L471">		}</span>

		synchronized void stopTimer()
		{
<span class="nc bnc" id="L475" title="All 2 branches missed.">			if (_timer != null)</span>
			{
                // i18n[AboutBoxDialog.info.endmemtimer=Ending memory timer (AboutBox)]
<span class="nc" id="L478">				s_log.debug(s_stringMgr.getString(&quot;AboutBoxDialog.info.endmemtimer&quot;));</span>
<span class="nc" id="L479">				_timer.stop();</span>
<span class="nc" id="L480">				_timer = null;</span>
			}
<span class="nc" id="L482">		}</span>

		private void updateMemoryStatus()
		{
<span class="nc" id="L486">			Runtime rt = Runtime.getRuntime();</span>
<span class="nc" id="L487">			final long totalMemory = rt.totalMemory();</span>
<span class="nc" id="L488">			final long freeMemory = rt.freeMemory();</span>
<span class="nc" id="L489">			final long usedMemory = totalMemory - freeMemory;</span>
<span class="nc" id="L490">			_totalMemoryLbl.setText(Utilities.formatSize(totalMemory, 1));</span>
<span class="nc" id="L491">			_usedMemoryLbl.setText(Utilities.formatSize(usedMemory, 1));</span>
<span class="nc" id="L492">			_freeMemoryLbl.setText(Utilities.formatSize(freeMemory, 1));</span>
<span class="nc" id="L493">		}</span>
	}
	
	private static final class ThreadPanel extends JPanel
	{
        private static final long serialVersionUID = 1L;
        
        private JTextArea content;

        ThreadPanel()
		{
<span class="nc" id="L504">			super();</span>
<span class="nc" id="L505">			setLayout(new BorderLayout());</span>
			
<span class="nc" id="L507">			content = new JTextArea(5,20);</span>
<span class="nc" id="L508">			content.setEditable(false);</span>
<span class="nc" id="L509">			content.setLineWrap(false);</span>
<span class="nc" id="L510">			doThreadDump();</span>
<span class="nc" id="L511">			add(new JScrollPane(content), BorderLayout.CENTER);</span>
<span class="nc" id="L512">			add(createButtons(), BorderLayout.SOUTH);</span>
<span class="nc" id="L513">		}</span>

		/**
		 * @return
		 */
		private JPanel createButtons() {
<span class="nc" id="L519">			JPanel buttonPanel = new JPanel(new BorderLayout());</span>
<span class="nc" id="L520">			JButton refreshButton = new JButton(s_stringMgr.getString(&quot;ThreadPanel.refresh&quot;));</span>
<span class="nc" id="L521">			buttonPanel.add(refreshButton, BorderLayout.WEST);</span>
			
<span class="nc" id="L523">			refreshButton.addActionListener(new ActionListener() {</span>
				
				@Override
				public void actionPerformed(ActionEvent e) {
<span class="nc" id="L527">					doThreadDump();</span>
<span class="nc" id="L528">				}</span>
			});
			
<span class="nc" id="L531">			return buttonPanel;</span>
		}

		private void doThreadDump() {
<span class="nc" id="L535">			StringBuilder sb = new StringBuilder(1000);</span>

<span class="nc" id="L537">			ThreadInfo[] threadInfos = ManagementFactory.getThreadMXBean().dumpAllThreads(true, true);</span>
<span class="nc bnc" id="L538" title="All 2 branches missed.">			for (ThreadInfo threadInfo : threadInfos) {</span>
<span class="nc" id="L539">				sb.append(threadInfo.toString());</span>
<span class="nc" id="L540">				sb.append(StringUtilities.getEolStr());</span>
			}

<span class="nc" id="L543">			content.setText(sb.toString());</span>
<span class="nc" id="L544">		}</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>