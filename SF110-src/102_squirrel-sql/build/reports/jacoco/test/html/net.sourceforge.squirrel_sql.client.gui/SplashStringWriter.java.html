<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SplashStringWriter.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">102_squirrel-sql</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.squirrel_sql.client.gui</a> &gt; <span class="el_source">SplashStringWriter.java</span></div><h1>SplashStringWriter.java</h1><pre class="source lang-java linenums">package net.sourceforge.squirrel_sql.client.gui;

import net.sourceforge.squirrel_sql.client.Version;
import net.sourceforge.squirrel_sql.fw.util.log.ILogger;
import net.sourceforge.squirrel_sql.fw.util.log.LoggerController;

import java.awt.*;

public class SplashStringWriter
{
<span class="nc" id="L11">   private final static ILogger s_log = LoggerController.createLogger(SplashStringWriter.class);</span>


   private SplashScreen _splashScreen;
   private boolean _hasTwoLines;
   private int _maxNumberOffCallsToWriteUpperLine;
<span class="nc" id="L17">   private static final Font FONT = new Font(Font.DIALOG, Font.BOLD, 14);</span>
<span class="nc" id="L18">   private static final Color BG = new Color(171, 176, 195);</span>
<span class="nc" id="L19">   private static final Color FG_UPPER = Color.black;</span>
<span class="nc" id="L20">   private static final Color FG_PROGRESS = new Color(74, 91, 153);</span>
<span class="nc" id="L21">   private static final Color FG_LOWER = new Color(74, 91, 153);</span>
   private static final int X_DIST = 10;
   private static final int Y_DIST = 12;
   private static final int X_PROGRESSBAR = X_DIST - 3;

   private Graphics2D _graphics;

   private int _yUpper;
   private int _yLower;
   private int _numberOffCallsToWriteUpperLine;
   private int _yProgressbar;
   private int _maxWidhtProgressbar;
   private int _heightProgressbar;
   private String _lowerLine;
   private String _upperLine;
   private int _paintAreaHeight;


   public SplashStringWriter(SplashScreen splashScreen, boolean hasTwoLines, int maxNumberOffCallsToWriteUpperLine)
<span class="nc" id="L40">   {</span>
<span class="nc" id="L41">      _splashScreen = splashScreen;</span>
<span class="nc" id="L42">      _hasTwoLines = hasTwoLines;</span>
<span class="nc" id="L43">      _maxNumberOffCallsToWriteUpperLine = maxNumberOffCallsToWriteUpperLine;</span>

<span class="nc" id="L45">      _graphics = _splashScreen.createGraphics();</span>

<span class="nc" id="L47">      _graphics.setFont(FONT);</span>


<span class="nc" id="L50">      _yLower = _splashScreen.getSize().height - Y_DIST;</span>

<span class="nc" id="L52">      FontMetrics fontMetrics = _graphics.getFontMetrics(FONT);</span>

<span class="nc bnc" id="L54" title="All 2 branches missed.">      if (_hasTwoLines)</span>
      {
<span class="nc" id="L56">         _yUpper = _yLower - fontMetrics.getHeight()  - Y_DIST;</span>
<span class="nc" id="L57">         _paintAreaHeight = 2 * (Y_DIST + fontMetrics.getHeight());</span>
      }
      else
      {
<span class="nc" id="L61">         _yUpper = _yLower;</span>
<span class="nc" id="L62">         _paintAreaHeight = Y_DIST + fontMetrics.getHeight();</span>
      }

<span class="nc" id="L65">      _yProgressbar = _yUpper - fontMetrics.getHeight() - 2;</span>

<span class="nc" id="L67">      _maxWidhtProgressbar = _splashScreen.getSize().width - 2 * X_DIST;</span>

<span class="nc" id="L69">      _heightProgressbar = fontMetrics.getHeight() + 10;</span>



<span class="nc" id="L73">      _graphics.setColor(FG_UPPER);</span>

<span class="nc" id="L75">      paintCopyrigthAndVersion(fontMetrics);</span>
<span class="nc" id="L76">   }</span>

   private void paintCopyrigthAndVersion(FontMetrics fontMetrics)
   {
<span class="nc" id="L80">      String[] splits = Version.getCopyrightStatement().split(&quot;\\n&quot;);</span>

<span class="nc" id="L82">      int xVers = (_splashScreen.getSize().width - fontMetrics.getStringBounds(Version.getVersion(), _graphics).getBounds().width) / 2;</span>
<span class="nc" id="L83">      int yVers = _splashScreen.getSize().height - (_paintAreaHeight + ((splits.length + 1) * (fontMetrics.getHeight() + 5)));</span>
<span class="nc" id="L84">      _graphics.drawString(Version.getVersion(), xVers, yVers);</span>


<span class="nc bnc" id="L87" title="All 2 branches missed.">      for (int i = 0; i &lt; splits.length; i++)</span>
      {
<span class="nc" id="L89">         int xSpilt = (_splashScreen.getSize().width - fontMetrics.getStringBounds(splits[i], _graphics).getBounds().width) / 2;</span>
<span class="nc" id="L90">         int ySplit = _splashScreen.getSize().height - (_paintAreaHeight + ((splits.length - i) * (fontMetrics.getHeight() + 5)));</span>
<span class="nc" id="L91">         _graphics.drawString(splits[i], xSpilt, ySplit);</span>
      }
<span class="nc" id="L93">   }</span>

   public void writeUpperProgressLine(String s)
   {
<span class="nc" id="L97">      _upperLine = s;</span>
<span class="nc" id="L98">      ++_numberOffCallsToWriteUpperLine;</span>
<span class="nc" id="L99">      paint();</span>
<span class="nc" id="L100">   }</span>

   public void writeLowerProgressLine(String s)
   {
<span class="nc" id="L104">      _lowerLine = s;</span>
<span class="nc" id="L105">      paint();</span>
<span class="nc" id="L106">   }</span>


   private void paint()
   {

<span class="nc" id="L112">      clear();</span>

<span class="nc" id="L114">      paintProgress();</span>

<span class="nc" id="L116">      paintStrings();</span>
<span class="nc" id="L117">   }</span>

   private void paintStrings()
   {
<span class="nc" id="L121">      write(_upperLine, _yUpper, FG_UPPER);</span>

<span class="nc bnc" id="L123" title="All 2 branches missed.">      if(_hasTwoLines)</span>
      {
<span class="nc" id="L125">         write(_lowerLine, _yLower, FG_LOWER);</span>
      }
<span class="nc" id="L127">   }</span>

   private void paintProgress()
   {
<span class="nc bnc" id="L131" title="All 2 branches missed.">      if(_maxNumberOffCallsToWriteUpperLine &lt; _numberOffCallsToWriteUpperLine + 1)</span>
      {
<span class="nc" id="L133">         String msg = &quot;Programmer: Please increase _maxNumberOffCallsToWriteUpperLine to make the Progressbar work right&quot;;</span>
<span class="nc" id="L134">         s_log.error(msg, new IllegalStateException(msg));</span>

<span class="nc" id="L136">         _numberOffCallsToWriteUpperLine = _maxNumberOffCallsToWriteUpperLine;</span>
      }

<span class="nc" id="L139">      int width = (int)</span>
            (
                  (double)(_maxWidhtProgressbar) * ((double)(_numberOffCallsToWriteUpperLine)) / ((double)(_maxNumberOffCallsToWriteUpperLine))
            );

<span class="nc" id="L144">      _graphics.setColor(FG_PROGRESS);</span>
<span class="nc" id="L145">      _graphics.fillRect(X_PROGRESSBAR, _yProgressbar, width,  _heightProgressbar);</span>
<span class="nc" id="L146">   }</span>

   private void clear()
   {
<span class="nc" id="L150">      _graphics.setColor(BG);</span>
<span class="nc" id="L151">      _graphics.fillRect(0, _splashScreen.getSize().height - _paintAreaHeight, _splashScreen.getSize().width, _paintAreaHeight);</span>
<span class="nc" id="L152">   }</span>


   private String write(String s, int y, Color fg)
   {
<span class="nc bnc" id="L157" title="All 2 branches missed.">      if (null != s)</span>
      {
<span class="nc" id="L159">         _graphics.setColor(fg);</span>
<span class="nc" id="L160">         _graphics.drawString(s, X_DIST, y);</span>
<span class="nc" id="L161">         _splashScreen.update();</span>
      }

<span class="nc" id="L164">      return s;</span>
   }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>