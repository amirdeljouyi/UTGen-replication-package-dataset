<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ButtonTableHeader.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">102_squirrel-sql</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.squirrel_sql.fw.gui</a> &gt; <span class="el_source">ButtonTableHeader.java</span></div><h1>ButtonTableHeader.java</h1><pre class="source lang-java linenums">package net.sourceforge.squirrel_sql.fw.gui;
/*
 * Copyright (C) 2002 Johan Compagner
 * jcompagner@j-com.nl
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */
import java.awt.*;
import java.awt.geom.Rectangle2D;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.event.MouseMotionListener;
import java.util.prefs.Preferences;

import javax.swing.*;
import javax.swing.event.*;
import javax.swing.table.JTableHeader;
import javax.swing.table.TableCellRenderer;
import javax.swing.table.TableColumn;
import javax.swing.table.TableModel;

import net.sourceforge.squirrel_sql.fw.resources.LibraryResources;
import net.sourceforge.squirrel_sql.fw.util.log.ILogger;
import net.sourceforge.squirrel_sql.fw.util.log.LoggerController;
import net.sourceforge.squirrel_sql.fw.datasetviewer.RowNumberTableColumn;
import net.sourceforge.squirrel_sql.fw.datasetviewer.cellcomponent.SquirrelTableCellRenderer;

/**
 * @version 	$Id: ButtonTableHeader.java,v 1.10 2009-09-17 05:40:53 gerdwagner Exp $
 * @author		Johan Compagner
 */
public class ButtonTableHeader extends JTableHeader
{
   /** Logger for this class. */
<span class="nc" id="L47">   private static ILogger s_log =</span>
<span class="nc" id="L48">      LoggerController.createLogger(ButtonTableHeader.class);</span>


   private static final String PREF_KEY_ALWAYS_ADJUST_ALL_COLUMN_HEADERS = &quot;Squirrel.alwaysAdoptAllColumnHeaders&quot;;

   /** Icon for &quot;Sorted ascending&quot;. */
   private static Icon s_ascIcon;

   /** Icon for &quot;Sorted descending&quot;. */
   private static Icon s_descIcon;

   /** Listens for changes in the underlying data. */
<span class="nc" id="L60">   private TableDataListener _dataListener = new TableDataListener();</span>

   private SortingListener _sortingListener;

   /** If &lt;TT&gt;true&lt;/TT&gt; then the mouse button is currently pressed. */
   private boolean _pressed;

   /**
    * If &lt;TT&gt;true&lt;/TT&gt; then the mouse is being dragged. This is only relevant
    * while the mouse is pressed.
    */
   private boolean _dragged;

   /**
    * if &lt;tt&gt;_pressed&lt;/tt&gt; is &lt;tt&gt;true&lt;/tt&gt; then this is the physical column
    * that the mouse was pressed in.
    */
   private int _pressedColumnIdx;

   /** Icon for the currently sorted column. */
   private Icon _currentSortedColumnIcon;

   /** Physical (as opposed to model) index of the currently sorted column. */
<span class="nc" id="L83">   private int _currentlySortedColumnIdx = -1;</span>

   static
   {
      try
      {
<span class="nc" id="L89">         LibraryResources rsrc = new LibraryResources();</span>
<span class="nc" id="L90">         s_descIcon =</span>
<span class="nc" id="L91">            rsrc.getIcon(LibraryResources.IImageNames.TABLE_DESCENDING);</span>
<span class="nc" id="L92">         s_ascIcon =</span>
<span class="nc" id="L93">            rsrc.getIcon(LibraryResources.IImageNames.TABLE_ASCENDING);</span>
      }
<span class="nc" id="L95">      catch (Exception ex)</span>
      {
<span class="nc" id="L97">         s_log.error(&quot;Error retrieving icons&quot;, ex);</span>
<span class="nc" id="L98">      }</span>
<span class="nc" id="L99">   }</span>

   /**
    * Constructor for ButtonTableHeader.
    */
   public ButtonTableHeader()
   {
<span class="nc" id="L106">      super();</span>
<span class="nc" id="L107">      _pressed = false;</span>
<span class="nc" id="L108">      _dragged = false;</span>
<span class="nc" id="L109">      _pressedColumnIdx = -1;</span>

<span class="nc" id="L111">      setDefaultRenderer(new ButtonTableRenderer(getFont()));</span>

<span class="nc" id="L113">      HeaderListener hl = new HeaderListener();</span>
<span class="nc" id="L114">      addMouseListener(hl);</span>
<span class="nc" id="L115">      addMouseMotionListener(hl);</span>

<span class="nc" id="L117">      _sortingListener = new SortingListener()</span>
<span class="nc" id="L118">      {</span>
         @Override
         public void sortingDone(int modelColumnIx, boolean ascending)
         {
<span class="nc" id="L122">            onSortingDone(modelColumnIx, ascending);</span>
<span class="nc" id="L123">         }</span>
      };

<span class="nc" id="L126">   }</span>

   private void onSortingDone(int modelColumnIx, boolean ascending)
   {
<span class="nc" id="L130">      int viewColumnIndex = getViewColumnIndex(modelColumnIx);</span>


<span class="nc bnc" id="L133" title="All 2 branches missed.">      if (ascending)</span>
      {
<span class="nc" id="L135">         _currentSortedColumnIcon = s_ascIcon;</span>
      }
      else
      {
<span class="nc" id="L139">         _currentSortedColumnIcon = s_descIcon;</span>
      }
<span class="nc" id="L141">      _currentlySortedColumnIdx = viewColumnIndex;</span>
<span class="nc" id="L142">      _pressedColumnIdx = viewColumnIndex;</span>

<span class="nc" id="L144">      repaint();</span>
<span class="nc" id="L145">   }</span>

   private int getViewColumnIndex(int modelColumnIx)
   {
<span class="nc" id="L149">      int viewColumnIndex = -1;</span>

<span class="nc bnc" id="L151" title="All 2 branches missed.">      for (int i = 0; i &lt; getTable().getColumnModel().getColumnCount(); i++)</span>
      {
<span class="nc bnc" id="L153" title="All 2 branches missed.">           if(modelColumnIx == getTable().getColumnModel().getColumn(i).getModelIndex())</span>
           {
<span class="nc" id="L155">               viewColumnIndex = i;</span>
           }
      }
<span class="nc" id="L158">      return viewColumnIndex;</span>
   }

   public void setTable(JTable table)
   {
<span class="nc" id="L163">      JTable oldTable = getTable();</span>
<span class="nc bnc" id="L164" title="All 2 branches missed.">      if (oldTable != null)</span>
      {
<span class="nc" id="L166">         Object obj = oldTable.getModel();</span>
<span class="nc bnc" id="L167" title="All 2 branches missed.">         if (obj instanceof SortableTableModel)</span>
         {
<span class="nc" id="L169">            SortableTableModel sortableTableModel = (SortableTableModel)obj;</span>
<span class="nc" id="L170">            sortableTableModel.getActualModel().removeTableModelListener(_dataListener);</span>
<span class="nc" id="L171">            sortableTableModel.removeSortingListener(_sortingListener);</span>
         }
      }

<span class="nc" id="L175">      super.setTable(table);</span>

<span class="nc bnc" id="L177" title="All 2 branches missed.">      if (table != null)</span>
      {
<span class="nc" id="L179">         Object obj = table.getModel();</span>
<span class="nc bnc" id="L180" title="All 2 branches missed.">         if (obj instanceof SortableTableModel)</span>
         {
<span class="nc" id="L182">            SortableTableModel sortableTableModel = (SortableTableModel)obj;</span>
<span class="nc" id="L183">            sortableTableModel.getActualModel().addTableModelListener(_dataListener);</span>
<span class="nc" id="L184">            sortableTableModel.addSortingListener(_sortingListener);</span>
         }
      }
<span class="nc" id="L187">      _currentSortedColumnIcon = null;</span>
<span class="nc" id="L188">      _currentlySortedColumnIdx = -1;</span>
<span class="nc" id="L189">   }</span>

   // SS: Display complete column header as tooltip if the column isn't wide enough to display it
   public String getToolTipText(MouseEvent e)
   {
<span class="nc" id="L194">      int col = columnAtPoint(e.getPoint());</span>
      //int modelCol = getTable().convertColumnIndexToModel(col);
<span class="nc" id="L196">      String retStr = null;</span>

<span class="nc bnc" id="L198" title="All 2 branches missed.">      if (col &gt;= 0)</span>
      {
<span class="nc" id="L200">         TableColumn tcol = getColumnModel().getColumn(col);</span>
<span class="nc" id="L201">         int colWidth = tcol.getWidth();</span>
<span class="nc" id="L202">         TableCellRenderer h = tcol.getHeaderRenderer();</span>

<span class="nc bnc" id="L204" title="All 2 branches missed.">         if (h == null)</span>
         {
<span class="nc" id="L206">            h = getDefaultRenderer();</span>
         }

<span class="nc" id="L209">         Component c = h.getTableCellRendererComponent(table, tcol.getHeaderValue(), false, false, -1, col);</span>

<span class="nc" id="L211">         int prefWidth = c.getPreferredSize().width;</span>
<span class="nc bnc" id="L212" title="All 2 branches missed.">         if (prefWidth &gt; colWidth)</span>
         {
<span class="nc" id="L214">            retStr = tcol.getHeaderValue().toString();</span>
         }
      }
<span class="nc" id="L217">      return retStr;</span>
   }

   /**
    * @return The currently sorted column index. If no column is sorted -1.
    */
   public int getCurrentlySortedColumnIdx()
   {
<span class="nc" id="L225">      return _currentlySortedColumnIdx;</span>
   }

   /**
    *
    * @return The direction of the currently sorted column. If no column is sorted false.
    */
   public boolean isAscending()
   {
<span class="nc bnc" id="L234" title="All 2 branches missed.">      return _currentSortedColumnIcon == s_ascIcon;</span>
   }

   public void columnIndexWillBeRemoved(int colIx)
   {
<span class="nc bnc" id="L239" title="All 2 branches missed.">      if( colIx &lt; _currentlySortedColumnIdx)</span>
      {
<span class="nc" id="L241">         --_currentlySortedColumnIdx;</span>
      }
<span class="nc bnc" id="L243" title="All 2 branches missed.">      else if (colIx == _currentlySortedColumnIdx)</span>
      {
<span class="nc" id="L245">         _currentlySortedColumnIdx = -1;</span>
      }
<span class="nc" id="L247">   }</span>

   public void columnIndexWillBeAdded(int colIx)
   {
<span class="nc bnc" id="L251" title="All 2 branches missed.">      if( colIx &lt;= _currentlySortedColumnIdx)</span>
      {
<span class="nc" id="L253">         ++_currentlySortedColumnIdx;</span>
      }
<span class="nc" id="L255">   }</span>

   public void adjustAllColWidths(boolean includeColHeaders)
   {
<span class="nc bnc" id="L259" title="All 2 branches missed.">      for(int i=0; i &lt; getTable().getColumnModel().getColumnCount(); ++i)</span>
      {
<span class="nc" id="L261">         adjustColWidth(i, includeColHeaders);</span>
      }
<span class="nc" id="L263">   }</span>

   public static boolean isAlwaysAdjustAllColWidths()
   {
<span class="nc" id="L267">      return Preferences.userRoot().getBoolean(PREF_KEY_ALWAYS_ADJUST_ALL_COLUMN_HEADERS, false);</span>
   }

   public static void setAlwaysAdjustAllColWidths(boolean b)
   {
<span class="nc" id="L272">      Preferences.userRoot().putBoolean(PREF_KEY_ALWAYS_ADJUST_ALL_COLUMN_HEADERS, b);</span>
<span class="nc" id="L273">   }</span>

   public void initColWidths()
   {
<span class="nc bnc" id="L277" title="All 2 branches missed.">      if (isAlwaysAdjustAllColWidths())</span>
      {
<span class="nc" id="L279">         SwingUtilities.invokeLater(new Runnable()</span>
<span class="nc" id="L280">         {</span>
            public void run()
            {
<span class="nc" id="L283">               adjustAllColWidths(true);</span>
<span class="nc" id="L284">            }</span>
         });
      }
<span class="nc" id="L287">   }</span>

<span class="nc" id="L289">   private final class TableDataListener implements TableModelListener</span>
   {
      public void tableChanged(TableModelEvent evt)
      {
<span class="nc" id="L293">         _currentSortedColumnIcon = null;</span>
<span class="nc" id="L294">         _currentlySortedColumnIdx = -1;</span>
<span class="nc" id="L295">      }</span>

   }


   private void adjustColWidth(int colIx, boolean includeColHeaders)
   {
<span class="nc" id="L302">      int modelIx = getTable().convertColumnIndexToModel(colIx);</span>

<span class="nc" id="L304">      int rowCount = getTable().getModel().getRowCount();</span>


<span class="nc" id="L307">      int newWidth = 20;</span>

<span class="nc bnc" id="L309" title="All 2 branches missed.">      if(includeColHeaders)</span>
      {
<span class="nc" id="L311">         TableColumn column = getTable().getColumnModel().getColumn(colIx);</span>
<span class="nc" id="L312">         TableCellRenderer headerRenderer = column.getHeaderRenderer();</span>
<span class="nc bnc" id="L313" title="All 2 branches missed.">         if(null == headerRenderer)</span>
         {
<span class="nc" id="L315">            headerRenderer = getTable().getTableHeader().getDefaultRenderer();</span>
         }

<span class="nc" id="L318">         Component headerComp = headerRenderer.getTableCellRendererComponent(getTable(), null, false, false, 0, colIx);</span>
<span class="nc" id="L319">         FontMetrics headerFontMetrics = headerComp.getFontMetrics(headerComp.getFont());</span>

<span class="nc" id="L321">         Rectangle2D bounds = headerFontMetrics.getStringBounds(&quot;&quot; + column.getHeaderValue(), headerComp.getGraphics());</span>

<span class="nc" id="L323">         newWidth = Math.max(newWidth, bounds.getBounds().width);</span>
      }



<span class="nc bnc" id="L328" title="All 2 branches missed.">      if(0 == rowCount)</span>
      {
<span class="nc bnc" id="L330" title="All 2 branches missed.">         if(includeColHeaders)</span>
         {
<span class="nc" id="L332">            getColumnModel().getColumn(colIx).setPreferredWidth(newWidth + 10);</span>
            //getTable().doLayout();
         }

<span class="nc" id="L336">         return;</span>
      }


<span class="nc" id="L340">      TableCellRenderer cellRenderer = getTable().getCellRenderer(0, colIx);</span>
<span class="nc" id="L341">      Component cellComp = cellRenderer.getTableCellRendererComponent(getTable(), null, false, false, rowCount - 1, colIx);</span>
<span class="nc" id="L342">      FontMetrics cellFontMetrics = cellComp.getFontMetrics(cellComp.getFont());</span>


<span class="nc bnc" id="L345" title="All 2 branches missed.">      for (int i = 0; i &lt; rowCount; i++)</span>
      {
<span class="nc" id="L347">         Object value = getTable().getModel().getValueAt(i, modelIx);</span>

<span class="nc" id="L349">         String stringVal = &quot;&quot;;</span>
<span class="nc bnc" id="L350" title="All 2 branches missed.">         if( getTable().getCellRenderer(i,colIx) instanceof SquirrelTableCellRenderer)</span>
         {
<span class="nc" id="L352">            stringVal += ((SquirrelTableCellRenderer)getTable().getCellRenderer(i,colIx)).renderValue(value);</span>
         }
         else
         {
<span class="nc" id="L356">            stringVal += value;</span>
         }

<span class="nc" id="L359">         Rectangle2D bounds = cellFontMetrics.getStringBounds(stringVal, cellComp.getGraphics());</span>

<span class="nc" id="L361">         newWidth = Math.max(newWidth, bounds.getBounds().width);</span>
      }

<span class="nc" id="L364">      getColumnModel().getColumn(colIx).setPreferredWidth(newWidth + 10);</span>
      //getTable().doLayout();
<span class="nc" id="L366">   }</span>


<span class="nc" id="L369">   class HeaderListener extends MouseAdapter implements MouseMotionListener</span>
   {
      /*
         * @see MouseListener#mousePressed(MouseEvent)
         */
      public void mousePressed(MouseEvent e)
      {
<span class="nc bnc" id="L376" title="All 2 branches missed.">         if(getCursor().getType() == Cursor.E_RESIZE_CURSOR)</span>
         {
<span class="nc" id="L378">            return;</span>
         }

<span class="nc" id="L381">         _pressed = true;</span>
<span class="nc bnc" id="L382" title="All 2 branches missed.">         if(RowNumberTableColumn.ROW_NUMBER_MODEL_INDEX == table.convertColumnIndexToModel(columnAtPoint(e.getPoint())))</span>
         {
<span class="nc" id="L384">            return;</span>
         }

<span class="nc" id="L387">         _pressedColumnIdx = columnAtPoint(e.getPoint());</span>
<span class="nc" id="L388">         repaint();</span>
<span class="nc" id="L389">      }</span>

      public void mouseClicked(MouseEvent e)
      {
<span class="nc bnc" id="L393" title="All 4 branches missed.">         if(2 == e.getClickCount() &amp;&amp; getCursor().getType() == Cursor.E_RESIZE_CURSOR)</span>
         {
<span class="nc" id="L395">            int colIx = columnAtPoint(e.getPoint());</span>
<span class="nc" id="L396">            Rectangle headerRect = getHeaderRect(colIx);</span>

<span class="nc" id="L398">            int distToColBegin = e.getPoint().x - headerRect.x;</span>
<span class="nc" id="L399">            int distToColEnd = headerRect.x + headerRect.width - e.getPoint().x;</span>
<span class="nc bnc" id="L400" title="All 6 branches missed.">            if(distToColBegin &lt; distToColEnd &amp;&amp; 0 &lt; colIx &amp;&amp; colIx &lt; getColumnModel().getColumnCount())</span>
            {
<span class="nc" id="L402">               --colIx;</span>
            }


<span class="nc" id="L406">            adjustColWidth(colIx, true);</span>
         }
<span class="nc" id="L408">      }</span>


      /*
		* @see MouseListener#mouseReleased(MouseEvent)
		*/
      public void mouseReleased(MouseEvent e)
      {
<span class="nc bnc" id="L416" title="All 2 branches missed.">         if(getCursor().getType() == Cursor.E_RESIZE_CURSOR)</span>
         {
<span class="nc" id="L418">            return;</span>
         }


<span class="nc bnc" id="L422" title="All 2 branches missed.">         if(RowNumberTableColumn.ROW_NUMBER_MODEL_INDEX == table.convertColumnIndexToModel(columnAtPoint(e.getPoint())))</span>
         {
<span class="nc" id="L424">            _pressed = false;</span>
<span class="nc" id="L425">            _dragged = false;</span>
<span class="nc" id="L426">            return;</span>
         }

<span class="nc" id="L429">         _pressed = false;</span>
<span class="nc bnc" id="L430" title="All 2 branches missed.">         if (!_dragged)</span>
         {
<span class="nc" id="L432">            _currentSortedColumnIcon = null;</span>
<span class="nc" id="L433">            int column = getTable().convertColumnIndexToModel(_pressedColumnIdx);</span>
<span class="nc" id="L434">            TableModel tm = table.getModel();</span>

<span class="nc bnc" id="L436" title="All 2 branches missed.">            if (column &gt; -1</span>
<span class="nc bnc" id="L437" title="All 4 branches missed.">               &amp;&amp; column &lt; tm.getColumnCount()</span>
               &amp;&amp; tm instanceof SortableTableModel)
            {
<span class="nc" id="L440">               ((SortableTableModel) tm).sortByColumn(column);</span>
<span class="nc bnc" id="L441" title="All 2 branches missed.">               if (((SortableTableModel)tm).isSortedAscending())</span>
               {
<span class="nc" id="L443">                  _currentSortedColumnIcon = s_ascIcon;</span>
               }
               else
               {
<span class="nc" id="L447">                  _currentSortedColumnIcon = s_descIcon;</span>
               }
<span class="nc" id="L449">               _currentlySortedColumnIdx = _pressedColumnIdx;</span>
            }
<span class="nc" id="L451">            repaint();</span>
         }
<span class="nc" id="L453">         _dragged = false;</span>
<span class="nc" id="L454">      }</span>

      /*
         * @see MouseMotionListener#mouseDragged(MouseEvent)
         */
      public void mouseDragged(MouseEvent e)
      {
<span class="nc" id="L461">         _dragged = true;</span>
<span class="nc bnc" id="L462" title="All 2 branches missed.">         if (_pressed)</span>
         {
<span class="nc" id="L464">            _currentSortedColumnIcon = null;</span>
<span class="nc" id="L465">            _currentlySortedColumnIdx = -1;</span>
<span class="nc" id="L466">            _pressed = false;</span>
<span class="nc" id="L467">            repaint();</span>
         }
<span class="nc" id="L469">      }</span>

      /*
         * @see MouseMotionListener#mouseMoved(MouseEvent)
         */
      public void mouseMoved(MouseEvent e)
      {
<span class="nc" id="L476">         _dragged = false;</span>
<span class="nc" id="L477">      }</span>

   }


   protected class ButtonTableRenderer implements TableCellRenderer
   {
      JButton _buttonRaised;
      JButton _buttonLowered;

      ButtonTableRenderer(Font font)
<span class="nc" id="L488">      {</span>
<span class="nc" id="L489">         _buttonRaised = new JButton();</span>
<span class="nc" id="L490">         _buttonRaised.putClientProperty(&quot;JButton.buttonType&quot;, &quot;gradient&quot;); // Added by Patch 2856103 for Apple/Mac</span>
<span class="nc" id="L491">         _buttonRaised.setMargin(new Insets(0, 0, 0, 0));</span>
<span class="nc" id="L492">         _buttonRaised.setFont(font);</span>
<span class="nc" id="L493">         _buttonLowered = new JButton();</span>
<span class="nc" id="L494">         _buttonLowered.putClientProperty(&quot;JButton.buttonType&quot;, &quot;gradient&quot;); // Added by Patch 2856103 for Apple/Mac</span>
<span class="nc" id="L495">         _buttonLowered.setMargin(new Insets(0, 0, 0, 0));</span>
<span class="nc" id="L496">         _buttonLowered.setFont(font);</span>
<span class="nc" id="L497">         _buttonLowered.getModel().setArmed(true);</span>
<span class="nc" id="L498">         _buttonLowered.getModel().setPressed(true);</span>

<span class="nc" id="L500">         _buttonLowered.setMinimumSize(new Dimension(50, 25));</span>
<span class="nc" id="L501">         _buttonRaised.setMinimumSize(new Dimension(50, 25));</span>
<span class="nc" id="L502">      }</span>
      /*
         * @see TableCellRenderer#getTableCellRendererComponent(JTable, Object, boolean, boolean, int, int)
         */
      public Component getTableCellRendererComponent(
         JTable table,
         Object value,
         boolean isSelected,
         boolean hasFocus,
         int row,
         int column)
      {

<span class="nc bnc" id="L515" title="All 2 branches missed.">         if (value == null)</span>
         {
<span class="nc" id="L517">            value = &quot;&quot;;</span>
         }

         // Rendering the column that the mouse has been pressed in.
<span class="nc bnc" id="L521" title="All 4 branches missed.">         if (_pressedColumnIdx == column &amp;&amp; _pressed)</span>
         {
<span class="nc" id="L523">            _buttonLowered.setText(value.toString());</span>

            // If this is the column that the table is currently is
            // currently sorted by then display the sort icon.
<span class="nc bnc" id="L527" title="All 2 branches missed.">            if (column == _currentlySortedColumnIdx</span>
<span class="nc bnc" id="L528" title="All 2 branches missed.">               &amp;&amp; _currentSortedColumnIcon != null)</span>
            {
<span class="nc" id="L530">               _buttonLowered.setIcon(_currentSortedColumnIcon);</span>
            }
            else
            {
<span class="nc" id="L534">               _buttonLowered.setIcon(null);</span>
            }
<span class="nc" id="L536">            return _buttonLowered;</span>
         }

         // This is not the column that the mouse has been pressed in.
<span class="nc" id="L540">         _buttonRaised.setText(value.toString());</span>
<span class="nc bnc" id="L541" title="All 2 branches missed.">         if (_currentSortedColumnIcon != null</span>
<span class="nc bnc" id="L542" title="All 2 branches missed.">            &amp;&amp; column == _currentlySortedColumnIdx)</span>
         {
<span class="nc" id="L544">            _buttonRaised.setIcon(_currentSortedColumnIcon);</span>
         }
         else
         {
<span class="nc" id="L548">            _buttonRaised.setIcon(null);</span>
         }
<span class="nc" id="L550">         return _buttonRaised;</span>
      }
   }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>