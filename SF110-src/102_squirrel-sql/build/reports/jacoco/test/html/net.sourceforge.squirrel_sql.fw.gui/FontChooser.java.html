<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>FontChooser.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">102_squirrel-sql</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.squirrel_sql.fw.gui</a> &gt; <span class="el_source">FontChooser.java</span></div><h1>FontChooser.java</h1><pre class="source lang-java linenums">package net.sourceforge.squirrel_sql.fw.gui;
/*
 * Copyright (C) 2001-2004 Colin Bell
 * colbell@users.sourceforge.net
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */
import java.awt.BorderLayout;
import java.awt.Dialog;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.Frame;
import java.awt.GraphicsEnvironment;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.Insets;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.BorderFactory;
import javax.swing.JButton;
import javax.swing.JCheckBox;
import javax.swing.JComboBox;
import javax.swing.JDialog;
import javax.swing.JLabel;
import javax.swing.JPanel;

import net.sourceforge.squirrel_sql.fw.util.StringManager;
import net.sourceforge.squirrel_sql.fw.util.StringManagerFactory;
/**
 * A dialog allow selection and a font and its associated info.
 *
 * @author &lt;A HREF=&quot;mailto:colbell@users.sourceforge.net&quot;&gt;Colin Bell&lt;/A&gt;
 */
public class FontChooser extends JDialog
{
	/** Internationalized strings for this class. */
<span class="nc" id="L50">	private static final StringManager s_stringMgr =</span>
<span class="nc" id="L51">		StringManagerFactory.getStringManager(FontChooser.class);</span>

	private final boolean _selectStyles;

	private JComboBox _fontNamesCmb;
<span class="nc" id="L56">	private final JComboBox _fontSizesCmb = new JComboBox(new String[]</span>
												{ &quot;8&quot;, &quot;9&quot;, &quot;10&quot;, &quot;12&quot;, &quot;14&quot; });
<span class="nc" id="L58">	private final JCheckBox _boldChk = new JCheckBox(s_stringMgr.getString(&quot;FontChooser.bold&quot;));</span>
<span class="nc" id="L59">	private final JCheckBox _italicChk = new JCheckBox(s_stringMgr.getString(&quot;FontChooser.italic&quot;));</span>
<span class="nc" id="L60">	private final JLabel _previewLbl = new JLabel(s_stringMgr.getString(&quot;FontChooser.previewText&quot;));</span>

	private Font _font;

	private ActionListener _previewUpdater;

	/**
	 * Default ctor.
	 */
	public FontChooser()
	{
<span class="nc" id="L71">		this((Frame)null);</span>
<span class="nc" id="L72">	}</span>

	/**
	 * ctor specifying whether styles can be selected.
	 *
	 * @param	selectStyles	If &lt;TT&gt;true&lt;/TT&gt; bold and italic checkboxes displayed.
	 */
	public FontChooser(boolean selectStyles)
	{
<span class="nc" id="L81">		this((Frame)null, selectStyles);</span>
<span class="nc" id="L82">	}</span>

	/**
	 * ctor specifying the parent frame.
	 *
	 * @param	owner	Parent frame.
	 */
	public FontChooser(Frame owner)
	{
<span class="nc" id="L91">		super(owner, s_stringMgr.getString(&quot;FontChooser.title&quot;), true);</span>
<span class="nc" id="L92">		_selectStyles = true;</span>
<span class="nc" id="L93">		createUserInterface();</span>
<span class="nc" id="L94">	}</span>

	/**
	 * ctor specifying the parent frame and whether styles can be selected.
	 *
	 * @param	owner			Parent frame.
	 * @param	selectStyles	If &lt;TT&gt;true&lt;/TT&gt; bold and italic checkboxes displayed.
	 */
	public FontChooser(Frame owner, boolean selectStyles)
	{
<span class="nc" id="L104">		super(owner, s_stringMgr.getString(&quot;FontChooser.title&quot;), true);</span>
<span class="nc" id="L105">		_selectStyles = selectStyles;</span>
<span class="nc" id="L106">		createUserInterface();</span>
<span class="nc" id="L107">	}</span>

	/**
	 * ctor specifying the parent dialog.
	 *
	 * @param	owner	Parent frame.
	 */
	public FontChooser(Dialog owner)
	{
<span class="nc" id="L116">		super(owner, s_stringMgr.getString(&quot;FontChooser.title&quot;), true);</span>
<span class="nc" id="L117">		_selectStyles = true;</span>
<span class="nc" id="L118">		createUserInterface();</span>
<span class="nc" id="L119">	}</span>

	/**
	 * ctor specifying the parent dialog and whether styles can be selected.
	 *
	 * @param	owner	Parent frame.
	 * @param	selectStyles	If &lt;TT&gt;true&lt;/TT&gt; bold and italic checkboxes displayed.
	 */
	public FontChooser(Dialog owner, boolean selectStyles)
	{
<span class="nc" id="L129">		super(owner, s_stringMgr.getString(&quot;FontChooser.title&quot;), true);</span>
<span class="nc" id="L130">		_selectStyles = selectStyles;</span>
<span class="nc" id="L131">		createUserInterface();</span>
<span class="nc" id="L132">	}</span>

	/**
	 * Component is being added to its parent.
	 */
	public void addNotify()
	{
<span class="nc" id="L139">		super.addNotify();</span>
<span class="nc bnc" id="L140" title="All 2 branches missed.">		if (_previewUpdater == null)</span>
		{
<span class="nc" id="L142">			_previewUpdater = new PreviewLabelUpdater();</span>
<span class="nc" id="L143">			_fontNamesCmb.addActionListener(_previewUpdater);</span>
<span class="nc" id="L144">			_fontSizesCmb.addActionListener(_previewUpdater);</span>
<span class="nc" id="L145">			_boldChk.addActionListener(_previewUpdater);</span>
<span class="nc" id="L146">			_italicChk.addActionListener(_previewUpdater);</span>
		}
<span class="nc" id="L148">	}</span>

	/**
	 * Component is being removed from its parent.
	 */
	public void removeNotify()
	{
<span class="nc" id="L155">		super.removeNotify();</span>
<span class="nc bnc" id="L156" title="All 2 branches missed.">		if (_previewUpdater != null)</span>
		{
<span class="nc" id="L158">			_fontNamesCmb.removeActionListener(_previewUpdater);</span>
<span class="nc" id="L159">			_fontSizesCmb.removeActionListener(_previewUpdater);</span>
<span class="nc" id="L160">			_boldChk.removeActionListener(_previewUpdater);</span>
<span class="nc" id="L161">			_italicChk.removeActionListener(_previewUpdater);</span>
<span class="nc" id="L162">			_previewUpdater = null;</span>
		}
<span class="nc" id="L164">	}</span>

	public Font showDialog()
	{
<span class="nc" id="L168">		return showDialog(null);</span>
	}

	/**
	 * Show dialog defaulting to the passed font.
	 *
	 * @param	font	The font to default to.
	 */
	public Font showDialog(Font font)
	{
<span class="nc bnc" id="L178" title="All 2 branches missed.">		if (font != null)</span>
		{
<span class="nc" id="L180">			_fontNamesCmb.setSelectedItem(font.getName());</span>
<span class="nc" id="L181">			_fontSizesCmb.setSelectedItem(&quot;&quot; + font.getSize());</span>
<span class="nc bnc" id="L182" title="All 4 branches missed.">			_boldChk.setSelected(_selectStyles &amp;&amp; font.isBold());</span>
<span class="nc bnc" id="L183" title="All 4 branches missed.">			_italicChk.setSelected(_selectStyles &amp;&amp; font.isItalic());</span>
		}
		else
		{
<span class="nc" id="L187">			_fontNamesCmb.setSelectedIndex(0);</span>
<span class="nc" id="L188">			_fontSizesCmb.setSelectedIndex(0);</span>
<span class="nc" id="L189">			_boldChk.setSelected(false);</span>
<span class="nc" id="L190">			_italicChk.setSelected(false);</span>
		}
<span class="nc" id="L192">		setupPreviewLabel();</span>
<span class="nc" id="L193">		setVisible(true);</span>
<span class="nc" id="L194">		return _font;</span>
	}

	public Font getSelectedFont()
	{
<span class="nc" id="L199">		return _font;</span>
	}

	protected void setupFontFromDialog()
	{
<span class="nc" id="L204">		int size = 12;</span>
		try
		{
<span class="nc" id="L207">			size = Integer.parseInt((String)_fontSizesCmb.getSelectedItem());</span>
		}
<span class="nc" id="L209">		catch (Exception ignore)</span>
		{
			// Ignore.
<span class="nc" id="L212">		}</span>
<span class="nc" id="L213">		FontInfo fi = new FontInfo();</span>
<span class="nc" id="L214">		fi.setFamily((String)_fontNamesCmb.getSelectedItem());</span>
<span class="nc" id="L215">		fi.setSize(size);</span>
<span class="nc" id="L216">		fi.setIsBold(_boldChk.isSelected());</span>
<span class="nc" id="L217">		fi.setIsItalic(_italicChk.isSelected());</span>
<span class="nc" id="L218">		_font = fi.createFont();</span>
<span class="nc" id="L219">	}</span>

	private void createUserInterface()
	{
<span class="nc" id="L223">		final JPanel content = new JPanel(new GridBagLayout());</span>
<span class="nc" id="L224">		final GridBagConstraints gbc = new GridBagConstraints();</span>

<span class="nc" id="L226">		setContentPane(content);</span>
<span class="nc" id="L227">		content.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));</span>

<span class="nc" id="L229">		gbc.anchor = GridBagConstraints.WEST;</span>
<span class="nc" id="L230">		gbc.insets = new Insets(2, 2, 2, 2);</span>
<span class="nc" id="L231">		gbc.fill = GridBagConstraints.HORIZONTAL;</span>

<span class="nc" id="L233">		gbc.gridx = gbc.gridy = 0;</span>
<span class="nc" id="L234">		content.add(new JLabel(s_stringMgr.getString(&quot;FontChooser.font&quot;)), gbc);</span>

<span class="nc" id="L236">		++gbc.gridx;</span>
<span class="nc" id="L237">		content.add(new JLabel(s_stringMgr.getString(&quot;FontChooser.size&quot;)), gbc);</span>

<span class="nc bnc" id="L239" title="All 2 branches missed.">		if (_selectStyles)</span>
		{
<span class="nc" id="L241">			++gbc.gridx;</span>
<span class="nc" id="L242">			content.add(new JLabel(s_stringMgr.getString(&quot;FontChooser.style&quot;)), gbc);</span>
		}

<span class="nc" id="L245">		++gbc.gridy;</span>
<span class="nc" id="L246">		gbc.gridx = 0;</span>
<span class="nc" id="L247">		_fontNamesCmb = new JComboBox(GraphicsEnvironment.getLocalGraphicsEnvironment().getAvailableFontFamilyNames());</span>
<span class="nc" id="L248">		content.add(_fontNamesCmb, gbc);</span>

<span class="nc" id="L250">		++gbc.gridx;</span>
<span class="nc" id="L251">		_fontSizesCmb.setEditable(true);</span>
<span class="nc" id="L252">		content.add(_fontSizesCmb, gbc);</span>

<span class="nc bnc" id="L254" title="All 2 branches missed.">		if (_selectStyles)</span>
		{
<span class="nc" id="L256">			++gbc.gridx;</span>
<span class="nc" id="L257">			content.add(_boldChk, gbc);</span>
<span class="nc" id="L258">			++gbc.gridy;</span>
<span class="nc" id="L259">			content.add(_italicChk, gbc);</span>
		}

<span class="nc" id="L262">		gbc.gridx = 0;</span>
<span class="nc" id="L263">		++gbc.gridy;</span>
<span class="nc" id="L264">		gbc.gridwidth = GridBagConstraints.REMAINDER;</span>
<span class="nc" id="L265">		gbc.fill = GridBagConstraints.BOTH;</span>
<span class="nc" id="L266">		gbc.anchor = GridBagConstraints.CENTER;</span>
<span class="nc" id="L267">		content.add(createPreviewPanel(), gbc);</span>

<span class="nc" id="L269">		++gbc.gridy;</span>
<span class="nc" id="L270">		gbc.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L271">		content.add(createButtonsPanel(), gbc);</span>

<span class="nc" id="L273">		pack();</span>
<span class="nc" id="L274">		GUIUtils.centerWithinParent(this);</span>
<span class="nc" id="L275">		setResizable(true);</span>
<span class="nc" id="L276">	}</span>

	private JPanel createPreviewPanel()
	{
<span class="nc" id="L280">		final JPanel pnl = new JPanel(new BorderLayout());</span>
<span class="nc" id="L281">		pnl.setBorder(BorderFactory.createTitledBorder(s_stringMgr.getString(&quot;FontChooser.previewTitle&quot;)));</span>
<span class="nc" id="L282">		Dimension prefSize = _previewLbl.getPreferredSize();</span>
<span class="nc" id="L283">		prefSize.height = 50;</span>
<span class="nc" id="L284">		_previewLbl.setPreferredSize(prefSize);</span>
<span class="nc" id="L285">		pnl.add(_previewLbl, BorderLayout.CENTER);</span>
<span class="nc" id="L286">		setupPreviewLabel();</span>

<span class="nc" id="L288">		return pnl;</span>
	}

	private JPanel createButtonsPanel()
	{
<span class="nc" id="L293">		JPanel pnl = new JPanel();</span>

<span class="nc" id="L295">		JButton okBtn = new JButton(s_stringMgr.getString(&quot;FontChooser.ok&quot;));</span>
<span class="nc" id="L296">		okBtn.addActionListener(new ActionListener()</span>
<span class="nc" id="L297">		{</span>
			public void actionPerformed(ActionEvent evt)
			{
<span class="nc" id="L300">				setupFontFromDialog();</span>
<span class="nc" id="L301">				dispose();</span>
<span class="nc" id="L302">			}</span>
		});
<span class="nc" id="L304">		JButton cancelBtn = new JButton(s_stringMgr.getString(&quot;FontChooser.cancel&quot;));</span>
<span class="nc" id="L305">		cancelBtn.addActionListener(new ActionListener()</span>
<span class="nc" id="L306">		{</span>
			public void actionPerformed(ActionEvent evt)
			{
<span class="nc" id="L309">				FontChooser.this._font = null;</span>
<span class="nc" id="L310">				dispose();</span>
<span class="nc" id="L311">			}</span>
		});

<span class="nc" id="L314">		pnl.add(okBtn);</span>
<span class="nc" id="L315">		pnl.add(cancelBtn);</span>

<span class="nc" id="L317">		GUIUtils.setJButtonSizesTheSame(new JButton[] { okBtn, cancelBtn });</span>
<span class="nc" id="L318">		getRootPane().setDefaultButton(okBtn);</span>

<span class="nc" id="L320">		return pnl;</span>
	}

	private void setupPreviewLabel()
	{
<span class="nc" id="L325">		setupFontFromDialog();</span>
<span class="nc" id="L326">		_previewLbl.setFont(_font);</span>
<span class="nc" id="L327">	}</span>

<span class="nc" id="L329">	private final class PreviewLabelUpdater implements ActionListener</span>
	{
		public void actionPerformed(ActionEvent evt)
		{
<span class="nc" id="L333">			setupPreviewLabel();</span>
<span class="nc" id="L334">		}</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>