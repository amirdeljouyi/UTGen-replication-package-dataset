<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ChartConfigPanelTabController.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">102_squirrel-sql</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.squirrel_sql.client.session.mainpanel.overview</a> &gt; <span class="el_source">ChartConfigPanelTabController.java</span></div><h1>ChartConfigPanelTabController.java</h1><pre class="source lang-java linenums">package net.sourceforge.squirrel_sql.client.session.mainpanel.overview;


import net.sourceforge.squirrel_sql.client.IApplication;
import net.sourceforge.squirrel_sql.client.session.mainpanel.overview.datascale.DataScale;
import net.sourceforge.squirrel_sql.client.session.mainpanel.overview.datascale.DataScaleTable;
import net.sourceforge.squirrel_sql.fw.util.StringManager;
import net.sourceforge.squirrel_sql.fw.util.StringManagerFactory;

import javax.swing.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.ItemEvent;
import java.awt.event.ItemListener;

public class ChartConfigPanelTabController
{
<span class="nc" id="L18">   private static final StringManager s_stringMgr = StringManagerFactory.getStringManager(ChartConfigController.class);</span>
   private IApplication _app;
   private ChartConfigPanelTabMode _chartConfigPanelTabMode;
   private ChartConfigPanelTab _chartConfigPanelTab;
   private DataScaleTable _dataScaleTable;


   public ChartConfigPanelTabController(IApplication app, ChartConfigPanelTabMode chartConfigPanelTabMode)
<span class="nc" id="L26">   {</span>
<span class="nc" id="L27">      _app = app;</span>
<span class="nc" id="L28">      _chartConfigPanelTabMode = chartConfigPanelTabMode;</span>
<span class="nc" id="L29">      _chartConfigPanelTab = new ChartConfigPanelTab(chartConfigPanelTabMode);</span>

<span class="nc" id="L31">      _chartConfigPanelTab.cboCallDepth.setModel(new DefaultComboBoxModel(CallDepthComboModel.createModels()));</span>
<span class="nc" id="L32">      _chartConfigPanelTab.cboCallDepth.setSelectedItem(CallDepthComboModel.getDefaultSelected());</span>

<span class="nc bnc" id="L34" title="All 2 branches missed.">      if (_chartConfigPanelTabMode == ChartConfigPanelTabMode.SINGLE_COLUMN)</span>
      {
<span class="nc" id="L36">         _chartConfigPanelTab.cboXColumns.addItemListener(new ItemListener()</span>
<span class="nc" id="L37">         {</span>
            @Override
            public void itemStateChanged(ItemEvent e)
            {
<span class="nc" id="L41">               onColumnSelected(e, ChartConfigPanelTabController.this._chartConfigPanelTab.cboXColumns);</span>
<span class="nc" id="L42">            }</span>
         });
      }
<span class="nc bnc" id="L45" title="All 2 branches missed.">      else if (_chartConfigPanelTabMode == ChartConfigPanelTabMode.XY_CHART)</span>
      {
<span class="nc" id="L47">         _chartConfigPanelTab.cboYColumns.addItemListener(new ItemListener()</span>
<span class="nc" id="L48">         {</span>
            @Override
            public void itemStateChanged(ItemEvent e)
            {
<span class="nc" id="L52">               onColumnSelected(e, ChartConfigPanelTabController.this._chartConfigPanelTab.cboYColumns);</span>
<span class="nc" id="L53">            }</span>
         });
      }

<span class="nc" id="L57">      _chartConfigPanelTab.btnChart.addActionListener(new ActionListener()</span>
<span class="nc" id="L58">      {</span>
         @Override
         public void actionPerformed(ActionEvent e)
         {
<span class="nc" id="L62">            onChart();</span>
<span class="nc" id="L63">         }</span>
      });

<span class="nc" id="L66">   }</span>

   public void setDataScaleTable(DataScaleTable dataScaleTable)
   {
<span class="nc" id="L70">      _dataScaleTable = dataScaleTable;</span>


<span class="nc bnc" id="L73" title="All 2 branches missed.">      if (_chartConfigPanelTabMode == ChartConfigPanelTabMode.SINGLE_COLUMN)</span>
      {
<span class="nc" id="L75">         fillColumnCombo(_chartConfigPanelTab.cboXColumns);</span>
      }
<span class="nc bnc" id="L77" title="All 2 branches missed.">      else if (_chartConfigPanelTabMode == ChartConfigPanelTabMode.XY_CHART)</span>
      {
<span class="nc" id="L79">         fillColumnCombo(_chartConfigPanelTab.cboXColumns);</span>
<span class="nc" id="L80">         fillColumnCombo(_chartConfigPanelTab.cboYColumns);</span>
      }


<span class="nc" id="L84">      onColumnSelected(null, _chartConfigPanelTab.cboXColumns);</span>
<span class="nc" id="L85">   }</span>

   private void fillColumnCombo(JComboBox cboColumns)
   {
<span class="nc" id="L89">      ColumnComboModel formerSelectedItem = (ColumnComboModel) cboColumns.getSelectedItem();</span>
<span class="nc" id="L90">      DefaultComboBoxModel defaultComboBoxModel = new DefaultComboBoxModel(ColumnComboModel.createColumnComboModels(_dataScaleTable));</span>
<span class="nc" id="L91">      cboColumns.setModel(defaultComboBoxModel);</span>
<span class="nc" id="L92">      cboColumns.setSelectedItem(formerSelectedItem);</span>


<span class="nc bnc" id="L95" title="All 2 branches missed.">      if(null == cboColumns.getSelectedItem())</span>
      {
<span class="nc" id="L97">         cboColumns.setSelectedIndex(0);</span>
      }
<span class="nc" id="L99">   }</span>


   private void onColumnSelected(ItemEvent e, JComboBox cboColumns)
   {
<span class="nc bnc" id="L104" title="All 4 branches missed.">      if (null == e || ItemEvent.SELECTED == e.getStateChange())</span>
      {
<span class="nc" id="L106">         ColumnComboModel selectedColumn = (ColumnComboModel) cboColumns.getSelectedItem();</span>
<span class="nc" id="L107">         _chartConfigPanelTab.cboYAxisKind.setModel(new DefaultComboBoxModel(ChartConfigMode.getAvailableValues(selectedColumn.getColumnDisplayDefinition(), _chartConfigPanelTabMode,s_stringMgr)));</span>
      }
<span class="nc" id="L109">   }</span>


   private void onChart()
   {
<span class="nc" id="L114">      ColumnComboModel selectedXAxisColumn = (ColumnComboModel) _chartConfigPanelTab.cboXColumns.getSelectedItem();</span>
<span class="nc" id="L115">      DataScale xAxisDataScale = _dataScaleTable.getDataScaleTableModel().getDataScaleAt(selectedXAxisColumn.getColumnIndexInDataScale());</span>

<span class="nc" id="L117">      DataScale yAxisDataScale = null;</span>
<span class="nc bnc" id="L118" title="All 2 branches missed.">      if(_chartConfigPanelTabMode == ChartConfigPanelTabMode.XY_CHART)</span>
      {
<span class="nc" id="L120">         ColumnComboModel selectedYAxisColumn = (ColumnComboModel) _chartConfigPanelTab.cboYColumns.getSelectedItem();</span>
<span class="nc" id="L121">         yAxisDataScale = _dataScaleTable.getDataScaleTableModel().getDataScaleAt(selectedYAxisColumn.getColumnIndexInDataScale());</span>
      }

<span class="nc" id="L124">      CallDepthComboModel selItem = (CallDepthComboModel) _chartConfigPanelTab.cboCallDepth.getSelectedItem();</span>

<span class="nc" id="L126">      ChartHandler.doChart(xAxisDataScale, yAxisDataScale, selItem.getCallDepth(), _app, (ChartConfigMode) _chartConfigPanelTab.cboYAxisKind.getSelectedItem());</span>
<span class="nc" id="L127">   }</span>


   public ChartConfigPanelTab getPanel()
   {
<span class="nc" id="L132">      return _chartConfigPanelTab;</span>
   }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>