<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DualProgressBarDialog.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">102_squirrel-sql</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.squirrel_sql.plugins.dbcopy.gui</a> &gt; <span class="el_source">DualProgressBarDialog.java</span></div><h1>DualProgressBarDialog.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2005 Rob Manning
 * manningr@users.sourceforge.net
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
 */
package net.sourceforge.squirrel_sql.plugins.dbcopy.gui;

import java.awt.BorderLayout;
import java.awt.FlowLayout;
import java.awt.Frame;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.GridLayout;
import java.awt.Insets;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.BorderFactory;
import javax.swing.JButton;
import javax.swing.JDialog;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JProgressBar;
import javax.swing.SwingConstants;
import javax.swing.SwingUtilities;

import net.sourceforge.squirrel_sql.fw.gui.GUIUtils;
import net.sourceforge.squirrel_sql.fw.util.StringManager;
import net.sourceforge.squirrel_sql.fw.util.StringManagerFactory;
import net.sourceforge.squirrel_sql.fw.util.log.ILogger;
import net.sourceforge.squirrel_sql.fw.util.log.LoggerController;

/**
 * A description of this class goes here...
 */

<span class="nc" id="L50">public class DualProgressBarDialog {</span>

<span class="nc" id="L52">    private static JProgressBar topBar = null;</span>
<span class="nc" id="L53">    private static JLabel topMessage = null;</span>
<span class="nc" id="L54">    private static JProgressBar bottomBar = null;</span>
<span class="nc" id="L55">    private static JLabel bottomMessage = null;</span>
<span class="nc" id="L56">    private static JButton cancelButton = null;</span>
    
<span class="nc" id="L58">    private static JDialog dialog = null;</span>
<span class="nc" id="L59">    private static JLabel elapsedTime = null;</span>
<span class="nc" id="L60">    private static TimeCounter elapsedTimeCounter = null;</span>
<span class="nc" id="L61">    private static JLabel remainingTime = null;</span>
<span class="nc" id="L62">    private static TimeCounter remainingTimeCounter = null;</span>
<span class="nc" id="L63">    private static TimeTracker timeTracker = null;</span>
<span class="nc" id="L64">    private static RemainingTimeCalculator remainingCalc = null;</span>
    
    /** Internationalized strings for this class */
<span class="nc" id="L67">    private static final StringManager s_stringMgr =</span>
<span class="nc" id="L68">        StringManagerFactory.getStringManager(DualProgressBarDialog.class);    </span>
    
    /** Logger for this class. */
<span class="nc" id="L71">    private final static ILogger log = </span>
<span class="nc" id="L72">        LoggerController.createLogger(DualProgressBarDialog.class);</span>
    
    
    public static JDialog getDialog(final Frame owner, 
                                    final String title,
                                    final boolean modal,
                                    final ActionListener listener) {
<span class="nc bnc" id="L79" title="All 2 branches missed.">        if (SwingUtilities.isEventDispatchThread()) {</span>
<span class="nc" id="L80">            _getDialog(owner, title, modal, listener);</span>
        } else {
            try {
<span class="nc" id="L83">                SwingUtilities.invokeAndWait(new Runnable() {</span>
                    public void run() {
<span class="nc" id="L85">                        _getDialog(owner, title, modal, listener);</span>
<span class="nc" id="L86">                    }</span>
                });
<span class="nc" id="L88">            } catch (Exception e) {</span>
                //i18n[DualProgressBarDialog.error.getdialog=getDialog: unable to invokeAndWait for dialog]
<span class="nc" id="L90">                log.error(s_stringMgr.getString(&quot;DualProgressBarDialog.error.getdialog&quot;), e);</span>
<span class="nc" id="L91">            }</span>
        }
        
<span class="nc" id="L94">        return dialog;</span>
    }
    
    /**
     * Starts the time tracking thread that updates the elapsed time counter.
     */
    public static void startTimer() {
<span class="nc bnc" id="L101" title="All 2 branches missed.">        if (timeTracker != null) {</span>
<span class="nc" id="L102">            timeTracker.setRunning(false);</span>
        }
<span class="nc" id="L104">        remainingCalc= new RemainingTimeCalculator();</span>
<span class="nc" id="L105">        timeTracker = new TimeTracker();</span>
<span class="nc" id="L106">    }</span>

    /**
     * Stops the time tracking thread that updates the elapsed time counter.
     */    
    public static void stopTimer() {
<span class="nc bnc" id="L112" title="All 2 branches missed.">        if (timeTracker != null) {</span>
<span class="nc" id="L113">            timeTracker.setRunning(false);</span>
        }
<span class="nc" id="L115">    }</span>
    
    private static void _getDialog(Frame owner, 
                                   String title,
                                   boolean modal,
                                   ActionListener listener) 
    {
<span class="nc" id="L122">        dialog = new JDialog(owner, title, modal);</span>
<span class="nc" id="L123">        dialog.getContentPane().setLayout(new BorderLayout());</span>
<span class="nc" id="L124">        dialog.getContentPane().add(buildPanel(), BorderLayout.CENTER);</span>
<span class="nc" id="L125">        dialog.getContentPane().add(buildButtonPanel(listener), BorderLayout.SOUTH);</span>
<span class="nc" id="L126">        dialog.setSize(350,205);</span>
<span class="nc" id="L127">        dialog.setLocationRelativeTo(owner);</span>
<span class="nc" id="L128">        cancelButton.addActionListener(new CancelButtonListener(dialog));</span>
<span class="nc" id="L129">        dialog.setVisible(true);</span>
<span class="nc" id="L130">    }</span>
    
    /**
     * @return
     */
    private static JPanel buildPanel() {
<span class="nc" id="L136">        JPanel dataPanel = new JPanel();</span>
<span class="nc" id="L137">        dataPanel.setBorder(BorderFactory.createEmptyBorder(0, 10, 0, 10));</span>
<span class="nc" id="L138">        GridBagLayout gl = new GridBagLayout();</span>
<span class="nc" id="L139">        dataPanel.setLayout(gl);</span>
        GridBagConstraints c;
        
<span class="nc" id="L142">        c = new GridBagConstraints();</span>
<span class="nc" id="L143">        c.gridx = 0;</span>
<span class="nc" id="L144">        c.gridy = 0;</span>
<span class="nc" id="L145">        c.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L146">        c.anchor = GridBagConstraints.WEST;</span>
        // i18n[DualProgressBarDialog.copyingRecordsLabel=Copying records]
<span class="nc" id="L148">        String topLabelText =</span>
<span class="nc" id="L149">            s_stringMgr.getString(&quot;DualProgressBarDialog.copyingRecordsLabel&quot;);</span>
<span class="nc" id="L150">        topMessage = </span>
            new JLabel(topLabelText);
<span class="nc" id="L152">        dataPanel.add(topMessage, c);</span>
        
<span class="nc" id="L154">        c = new GridBagConstraints();</span>
<span class="nc" id="L155">        c.gridx = 0;</span>
<span class="nc" id="L156">        c.gridy = 1;</span>
<span class="nc" id="L157">        c.anchor = GridBagConstraints.WEST;</span>
<span class="nc" id="L158">        c.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L159">        c.insets = new Insets(0,0,10,0);</span>
<span class="nc" id="L160">        c.weightx = 1.0;</span>
<span class="nc" id="L161">        topBar = new JProgressBar(0,10);</span>
<span class="nc" id="L162">        dataPanel.add(topBar, c);</span>
        
        
<span class="nc" id="L165">        c = new GridBagConstraints();</span>
<span class="nc" id="L166">        c.gridx = 0;</span>
<span class="nc" id="L167">        c.gridy = 2;</span>
<span class="nc" id="L168">        c.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L169">        c.anchor = GridBagConstraints.WEST;</span>
        //i18n[DualProgressBarDialog.copyingTablesLabel=Copying table]
<span class="nc" id="L171">        String bottomLabelText = </span>
<span class="nc" id="L172">            s_stringMgr.getString(&quot;DualProgressBarDialog.copyingTablesLabel&quot;);</span>
<span class="nc" id="L173">        bottomMessage = new JLabel(bottomLabelText);</span>
<span class="nc" id="L174">        dataPanel.add(bottomMessage, c);</span>
        
<span class="nc" id="L176">        c = new GridBagConstraints();</span>
<span class="nc" id="L177">        c.gridx = 0;</span>
<span class="nc" id="L178">        c.gridy = 3;</span>
<span class="nc" id="L179">        c.anchor = GridBagConstraints.WEST;</span>
<span class="nc" id="L180">        c.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L181">        c.insets = new Insets(0,0,10,0);</span>
<span class="nc" id="L182">        bottomBar = new JProgressBar(0,10);</span>
<span class="nc" id="L183">        dataPanel.add(bottomBar, c);</span>
        
<span class="nc" id="L185">        c = new GridBagConstraints();</span>
<span class="nc" id="L186">        c.gridx = 0;</span>
<span class="nc" id="L187">        c.gridy = 4;</span>
<span class="nc" id="L188">        c.ipadx = 5;</span>
<span class="nc" id="L189">        c.anchor = GridBagConstraints.CENTER;</span>
<span class="nc" id="L190">        c.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L191">        dataPanel.add(buildTimePanel(), c);</span>
        
<span class="nc" id="L193">        return dataPanel;</span>
    }    
    
    public static JPanel buildTimePanel() {
<span class="nc" id="L197">        JPanel result = new JPanel();</span>
<span class="nc" id="L198">        result.setLayout(new GridLayout(2,2,5,5));</span>
<span class="nc" id="L199">        JLabel elapsedTimeLabel = new JLabel(s_stringMgr.getString(&quot;DualProgressBarDialog.elapsedTimeLabel&quot;));</span>
<span class="nc" id="L200">        elapsedTimeCounter = new TimeCounter();</span>
<span class="nc" id="L201">        elapsedTime = new JLabel(elapsedTimeCounter.toString());</span>
<span class="nc" id="L202">        JLabel remainingTimeLabel = new JLabel(s_stringMgr.getString(&quot;DualProgressBarDialog.remainingTimeLabel&quot;));</span>
<span class="nc" id="L203">        remainingTimeCounter = new TimeCounter();</span>
<span class="nc" id="L204">        remainingTime = new JLabel(remainingTimeCounter.toString());</span>
<span class="nc" id="L205">        elapsedTimeLabel.setHorizontalAlignment(SwingConstants.RIGHT);</span>
<span class="nc" id="L206">        result.add(elapsedTimeLabel);</span>
<span class="nc" id="L207">        elapsedTime.setHorizontalAlignment(SwingConstants.LEFT);</span>
<span class="nc" id="L208">        result.add(elapsedTime);</span>
<span class="nc" id="L209">        remainingTimeLabel.setHorizontalAlignment(SwingConstants.RIGHT);</span>
<span class="nc" id="L210">        result.add(remainingTimeLabel);</span>
<span class="nc" id="L211">        remainingTime.setHorizontalAlignment(SwingConstants.LEFT);</span>
<span class="nc" id="L212">        result.add(remainingTime);</span>
<span class="nc" id="L213">        return result;</span>
    }
    
    public static JPanel buildButtonPanel(ActionListener listener) {
<span class="nc" id="L217">        JPanel buttonPanel = new JPanel(new FlowLayout());</span>
        // i18n[DualProgressBarDialog.cancelButtonLabel=Cancel]
<span class="nc" id="L219">        String buttonText = </span>
<span class="nc" id="L220">            s_stringMgr.getString(&quot;DualProgressBarDialog.cancelButtonLabel&quot;);</span>
<span class="nc" id="L221">        cancelButton = new JButton(buttonText);</span>
<span class="nc bnc" id="L222" title="All 2 branches missed.">        if (listener != null) {</span>
<span class="nc" id="L223">            cancelButton.addActionListener(listener);</span>
        }
<span class="nc" id="L225">        buttonPanel.add(cancelButton);</span>
<span class="nc" id="L226">        return buttonPanel;</span>
    }
        
    public static void setTopMessage(final String message) {
<span class="nc bnc" id="L230" title="All 2 branches missed.">        if (SwingUtilities.isEventDispatchThread()) {</span>
<span class="nc" id="L231">            topMessage.setText(message);            </span>
        } else {
<span class="nc" id="L233">            SwingUtilities.invokeLater(new Runnable() {</span>
                public void run() {
<span class="nc" id="L235">                    topMessage.setText(message);</span>
<span class="nc" id="L236">                }</span>
            });                    
        }
<span class="nc" id="L239">    }</span>
    
    public static void setBottomMessage(final String message) {
<span class="nc bnc" id="L242" title="All 2 branches missed.">        if (SwingUtilities.isEventDispatchThread()) {</span>
<span class="nc" id="L243">            bottomMessage.setText(message);            </span>
        } else {
<span class="nc" id="L245">            SwingUtilities.invokeLater(new Runnable() {</span>
                public void run() {
<span class="nc" id="L247">                    bottomMessage.setText(message);</span>
<span class="nc" id="L248">                }</span>
            });                    
        }
<span class="nc" id="L251">    }</span>

    public static void setTopBarMinMax(final int min, final int max) {
<span class="nc bnc" id="L254" title="All 2 branches missed.">        if (topBar.getMinimum() == min </span>
<span class="nc bnc" id="L255" title="All 2 branches missed.">                &amp;&amp; topBar.getMaximum() == max) </span>
        {
<span class="nc" id="L257">            return;</span>
        }
<span class="nc bnc" id="L259" title="All 2 branches missed.">        if (SwingUtilities.isEventDispatchThread()) {</span>
<span class="nc" id="L260">            topBar.setMinimum(min);</span>
<span class="nc" id="L261">            topBar.setMaximum(max);</span>
        } else {
<span class="nc" id="L263">            SwingUtilities.invokeLater(new Runnable() {</span>
                public void run() {
<span class="nc" id="L265">                    topBar.setMinimum(min);</span>
<span class="nc" id="L266">                    topBar.setMaximum(max);</span>
<span class="nc" id="L267">                }</span>
            });                    
        }
<span class="nc" id="L270">    }</span>
    
    public static void setBottomBarMinMax(final int min, final int max) {
<span class="nc bnc" id="L273" title="All 2 branches missed.">        if (bottomBar.getMinimum() == min </span>
<span class="nc bnc" id="L274" title="All 2 branches missed.">                &amp;&amp; bottomBar.getMaximum() == max) </span>
        {
<span class="nc" id="L276">            return;</span>
        }
<span class="nc bnc" id="L278" title="All 2 branches missed.">        if (SwingUtilities.isEventDispatchThread()) {</span>
<span class="nc" id="L279">            bottomBar.setMinimum(min);</span>
<span class="nc" id="L280">            bottomBar.setMaximum(max);</span>
        } else {
<span class="nc" id="L282">            SwingUtilities.invokeLater(new Runnable() {</span>
                public void run() {
<span class="nc" id="L284">                    bottomBar.setMinimum(min);</span>
<span class="nc" id="L285">                    bottomBar.setMaximum(max);</span>
<span class="nc" id="L286">                }</span>
            });                    
        }
<span class="nc" id="L289">    }</span>
    
    public static void setTopBarValue(final int value) {
<span class="nc bnc" id="L292" title="All 2 branches missed.">        if (SwingUtilities.isEventDispatchThread()) {</span>
<span class="nc" id="L293">            topBar.setValue(value);            </span>
        } else {
<span class="nc" id="L295">            SwingUtilities.invokeLater(new Runnable() {</span>
                public void run() {
<span class="nc" id="L297">                    topBar.setValue(value);</span>
<span class="nc" id="L298">                }</span>
            });                    
        }
<span class="nc" id="L301">    }</span>

    public static void setTableCounts(int[] tableCounts) {
<span class="nc bnc" id="L304" title="All 2 branches missed.">        for (int i = 0; i &lt; tableCounts.length; i++) {</span>
<span class="nc" id="L305">            remainingCalc.setTotalItems(remainingCalc.getTotalItems()+tableCounts[i]);</span>
        }
<span class="nc" id="L307">    }</span>
    
    public static void setBottomBarValue(final int value) {
<span class="nc bnc" id="L310" title="All 2 branches missed.">        if (SwingUtilities.isEventDispatchThread()) {</span>
<span class="nc" id="L311">            bottomBar.setValue(value);            </span>
        } else {
<span class="nc" id="L313">            SwingUtilities.invokeLater(new Runnable() {</span>
                public void run() {
<span class="nc" id="L315">                    bottomBar.setValue(value);</span>
<span class="nc" id="L316">                }</span>
            });                    
        }
<span class="nc" id="L319">    }</span>
    
    public static void incrementTopBar(final int value) {
<span class="nc" id="L322">        final int newValue = topBar.getValue() + value;</span>
<span class="nc" id="L323">        remainingCalc.incrementCurrentItem();</span>
<span class="nc" id="L324">        GUIUtils.processOnSwingEventThread(new Runnable() {</span>
               public void run() {
<span class="nc" id="L326">                   topBar.setValue(newValue);</span>
<span class="nc" id="L327">               }</span>
            }
            , true);        
<span class="nc" id="L330">    }</span>

    public static void incrementBottomBar(final int value) {
<span class="nc" id="L333">        final int newValue = bottomBar.getValue() + value;</span>
<span class="nc bnc" id="L334" title="All 2 branches missed.">        if (SwingUtilities.isEventDispatchThread()) {</span>
<span class="nc" id="L335">            bottomBar.setValue(newValue);</span>
        } else {
<span class="nc" id="L337">            SwingUtilities.invokeLater(new Runnable() {</span>
                public void run() {
<span class="nc" id="L339">                    bottomBar.setValue(newValue);</span>
<span class="nc" id="L340">                }</span>
            });                    
        }
<span class="nc" id="L343">    }    </span>
    
    /**
     * Sets the visibiility of the progress dialog
     * 
     * @param visible a boolean value indicating whether or not to make the 
     *                dialog visible.
     */
    public static void setVisible(final boolean visible) {
<span class="nc bnc" id="L352" title="All 2 branches missed.">        if (dialog == null) {</span>
<span class="nc" id="L353">            return;</span>
        }
<span class="nc bnc" id="L355" title="All 2 branches missed.">        if (dialog.isVisible() != visible) {</span>
<span class="nc bnc" id="L356" title="All 2 branches missed.">            if (SwingUtilities.isEventDispatchThread()) {</span>
<span class="nc" id="L357">                dialog.setVisible(visible);</span>
            } else {
<span class="nc" id="L359">                SwingUtilities.invokeLater(new Runnable() {</span>
                    public void run() {
<span class="nc" id="L361">                        dialog.setVisible(visible);</span>
<span class="nc" id="L362">                    }</span>
                });                    
            }
        }
<span class="nc" id="L366">    }</span>
        
    public static void dispose() {
<span class="nc bnc" id="L369" title="All 2 branches missed.">        if (dialog == null) {</span>
<span class="nc" id="L370">            return;</span>
        }
<span class="nc bnc" id="L372" title="All 2 branches missed.">        if (SwingUtilities.isEventDispatchThread()) {</span>
<span class="nc" id="L373">            dialog.dispose();            </span>
        } else {
<span class="nc" id="L375">            SwingUtilities.invokeLater(new Runnable() {</span>
                public void run() {
<span class="nc" id="L377">                    dialog.dispose();</span>
<span class="nc" id="L378">                }</span>
            });                    
        }
<span class="nc" id="L381">    }</span>
    
    /**
     * Add the specified ActionListener to the cancel button.
     * 
     * @param listener an ActionListener that will receive ActionEvents from the
     *        cancel button.
     */
    public static void addCancelButtonActionListener(ActionListener listener) {
<span class="nc bnc" id="L390" title="All 2 branches missed.">        if (cancelButton != null) {</span>
<span class="nc" id="L391">            cancelButton.addActionListener(listener);</span>
        }
<span class="nc" id="L393">    }</span>
        
    private static class CancelButtonListener implements ActionListener {
        
<span class="nc" id="L397">        JDialog _dialog = null;</span>
        
<span class="nc" id="L399">        public CancelButtonListener(JDialog dialog) {</span>
<span class="nc" id="L400">            _dialog = dialog;</span>
<span class="nc" id="L401">        }</span>
                
        public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L404" title="All 2 branches missed.">            if (_dialog != null) {</span>
<span class="nc" id="L405">                setVisible(false);</span>
<span class="nc" id="L406">                _dialog.dispose();</span>
            }
<span class="nc" id="L408">        }</span>
    }
     
    /**
     * This thread is responsible for updating the elapsed and remaining time
     * labels.
     */
    private static class TimeTracker implements Runnable {
        
<span class="nc" id="L417">        private Thread t = null;</span>
        
<span class="nc" id="L419">        private boolean running = true; </span>
        
<span class="nc" id="L421">        public TimeTracker() {</span>
<span class="nc" id="L422">            t = new Thread(this);</span>
<span class="nc" id="L423">            t.setName(&quot;DBCopy Time Tracker&quot;);</span>
<span class="nc" id="L424">            t.start();</span>
<span class="nc" id="L425">        }</span>
        
        public void run() {
<span class="nc" id="L428">            running = true;</span>

<span class="nc bnc" id="L430" title="All 2 branches missed.">            while (running) {</span>
                try {
<span class="nc" id="L432">                    Thread.sleep(1000);</span>
<span class="nc" id="L433">                } catch (InterruptedException e) {}</span>
<span class="nc" id="L434">                elapsedTimeCounter.increment();</span>
<span class="nc" id="L435">                remainingCalc.setTimeElapsed(elapsedTimeCounter);</span>
<span class="nc" id="L436">                remainingCalc.getTimeRemaining(remainingTimeCounter);</span>
<span class="nc" id="L437">                SwingUtilities.invokeLater(new Runnable() {</span>
                    public void run() {
<span class="nc" id="L439">                        String timeStr = elapsedTimeCounter.toString();</span>
<span class="nc" id="L440">                        elapsedTime.setText(timeStr);</span>
<span class="nc" id="L441">                        remainingTime.setText(remainingTimeCounter.toString());</span>
<span class="nc" id="L442">                    }</span>
                });
            }
<span class="nc" id="L445">        }</span>
        
        public void setRunning(boolean aBoolean) {
<span class="nc" id="L448">            running = aBoolean;</span>
<span class="nc" id="L449">        }</span>
    }
    
<span class="nc" id="L452">    private static class TimeCounter {</span>
        
<span class="nc" id="L454">        private int seconds = 0;</span>
<span class="nc" id="L455">        private int minutes = 0;</span>
<span class="nc" id="L456">        private int hours = 0;</span>
        
        public void reset() {
<span class="nc" id="L459">            seconds = 0;</span>
<span class="nc" id="L460">            minutes = 0;</span>
<span class="nc" id="L461">            hours = 0;</span>
<span class="nc" id="L462">        }</span>
        
        public void increment() {
<span class="nc bnc" id="L465" title="All 2 branches missed.">            if (seconds &lt; 59) {</span>
<span class="nc" id="L466">                seconds++;</span>
<span class="nc" id="L467">                return;</span>
            }
<span class="nc bnc" id="L469" title="All 2 branches missed.">            if (minutes &lt; 59) {</span>
<span class="nc" id="L470">                seconds = 0;</span>
<span class="nc" id="L471">                minutes++;</span>
<span class="nc" id="L472">                return;</span>
            }
<span class="nc" id="L474">            hours++;</span>
<span class="nc" id="L475">            minutes = 0;</span>
<span class="nc" id="L476">            seconds = 0;</span>
<span class="nc" id="L477">        }</span>
        
        public int getSeconds() {
<span class="nc" id="L480">            return seconds;</span>
        }
        
        public void setSeconds(int seconds) {
<span class="nc" id="L484">            this.seconds = seconds;</span>
<span class="nc" id="L485">        }</span>
        
        public int getMinutes() {
<span class="nc" id="L488">            return minutes;</span>
        }
        
        public void setMinutes(int minutes) {
<span class="nc" id="L492">            this.minutes = minutes;</span>
<span class="nc" id="L493">        }</span>
        
        public int getHours() {
<span class="nc" id="L496">            return hours;</span>
        }
        
        public void setHours(int hours) {
<span class="nc" id="L500">            this.hours = hours;</span>
<span class="nc" id="L501">        }</span>
        
        public String toString() {
<span class="nc" id="L504">            StringBuffer result = new StringBuffer();</span>
<span class="nc bnc" id="L505" title="All 2 branches missed.">            if (hours &lt; 10) {</span>
<span class="nc" id="L506">                result.append(&quot;0&quot;);</span>
            }
<span class="nc" id="L508">            result.append(hours);</span>
<span class="nc" id="L509">            result.append(&quot;:&quot;);</span>
<span class="nc bnc" id="L510" title="All 2 branches missed.">            if (minutes &lt; 10) {</span>
<span class="nc" id="L511">                result.append(&quot;0&quot;);</span>
            }
<span class="nc" id="L513">            result.append(minutes);</span>
<span class="nc" id="L514">            result.append(&quot;:&quot;);</span>
<span class="nc bnc" id="L515" title="All 2 branches missed.">            if (seconds &lt; 10) {</span>
<span class="nc" id="L516">                result.append(&quot;0&quot;);</span>
            }
<span class="nc" id="L518">            result.append(seconds);</span>
<span class="nc" id="L519">            return result.toString();</span>
        }
    }
    
<span class="nc" id="L523">    private static class RemainingTimeCalculator {</span>
        
<span class="nc" id="L525">        private long currentItem = 0;</span>
<span class="nc" id="L526">        private long totalItems = 0;</span>
<span class="nc" id="L527">        private long secondsElapsed = 0;</span>
<span class="nc" id="L528">        private long secondsRemaining = 0;</span>
        
        public void incrementCurrentItem() {
<span class="nc bnc" id="L531" title="All 2 branches missed.">            if (currentItem &lt; totalItems) {</span>
<span class="nc" id="L532">                currentItem++;</span>
            } 
<span class="nc" id="L534">        }</span>
        
        public void setCurrentItem(long anInt) {
<span class="nc bnc" id="L537" title="All 2 branches missed.">            if (currentItem &lt;= totalItems) {</span>
<span class="nc" id="L538">                currentItem = anInt;</span>
            } else {
<span class="nc" id="L540">                System.err.println(</span>
                    &quot;currentItem(&quot;+currentItem+&quot;) &gt; totalItems(&quot;+totalItems+&quot;) &quot;);
            }
<span class="nc" id="L543">        }</span>
        
        public long getTotalItems() {
<span class="nc" id="L546">            return totalItems;</span>
        }
        
        public void setTotalItems(long anInt) {
<span class="nc" id="L550">            totalItems = anInt;</span>
<span class="nc" id="L551">        }</span>
        
        public void setTimeElapsed(TimeCounter counter) {
<span class="nc" id="L554">            secondsElapsed = 0;</span>
<span class="nc" id="L555">            secondsElapsed += (counter.getHours() * 3600);</span>
<span class="nc" id="L556">            secondsElapsed += (counter.getMinutes() * 60);</span>
<span class="nc" id="L557">            secondsElapsed += counter.getSeconds();</span>
<span class="nc" id="L558">            calculateRemaining();</span>
<span class="nc" id="L559">        }</span>
        
        public TimeCounter getTimeRemaining(TimeCounter counter) {
<span class="nc" id="L562">            int hoursRemaining = (int)(secondsRemaining / 3600); </span>
<span class="nc" id="L563">            counter.setHours(hoursRemaining);</span>
            
<span class="nc" id="L565">            long hoursRemainder = secondsRemaining - (hoursRemaining * 3600);</span>
<span class="nc" id="L566">            int minutesRemaining = (int)(hoursRemainder / 60);</span>
<span class="nc" id="L567">            counter.setMinutes(minutesRemaining);</span>
            
<span class="nc" id="L569">            int secondsRemaining = </span>
                (int)(hoursRemainder - ( minutesRemaining * 60 ));
<span class="nc" id="L571">            counter.setSeconds(secondsRemaining);</span>
            
<span class="nc" id="L573">            return counter;</span>
        }
        
        private void calculateRemaining() {
            // calculate the average time / item 
<span class="nc" id="L578">            float avgTimePerItem = 0;</span>
<span class="nc bnc" id="L579" title="All 2 branches missed.">            if (currentItem &gt; 1) {</span>
<span class="nc" id="L580">                avgTimePerItem = (float)secondsElapsed / (float)(currentItem - 1);</span>
            } else {
<span class="nc" id="L582">                avgTimePerItem = secondsElapsed;</span>
            }
            
            // How many items left
<span class="nc" id="L586">            long itemsLeft = (totalItems - currentItem) + 1;</span>
            
<span class="nc" id="L588">            secondsRemaining = (int)(itemsLeft * avgTimePerItem);</span>
<span class="nc" id="L589">        }</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>