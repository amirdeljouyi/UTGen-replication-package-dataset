<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AliasFolderState.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">102_squirrel-sql</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.squirrel_sql.client.gui.db</a> &gt; <span class="el_source">AliasFolderState.java</span></div><h1>AliasFolderState.java</h1><pre class="source lang-java linenums">package net.sourceforge.squirrel_sql.client.gui.db;

import net.sourceforge.squirrel_sql.fw.sql.ISQLAlias;
import net.sourceforge.squirrel_sql.fw.id.IIdentifier;

import javax.swing.tree.DefaultMutableTreeNode;
import javax.swing.tree.TreePath;
import javax.swing.*;
import java.util.Arrays;

public class AliasFolderState implements Comparable&lt;AliasFolderState&gt;
{
<span class="nc" id="L13">   private AliasFolderState[] _kids = new AliasFolderState[0];</span>
   private IIdentifier _aliasIdentifier;
   private String _folderName;
   private boolean _isSelected;
   private boolean _isExpanded;

   /**
    * DO NOT introduce setter/getter for this member these members should
    * not be treated by XMLBeanReader or XMLBeanWriter.
    */
   private DefaultMutableTreeNode _node;
   private String _aliasName;

   /**
    * To be used by XmlBeanReader only
    */
   public AliasFolderState()
<span class="nc" id="L30">   {</span>
<span class="nc" id="L31">   }</span>

   public AliasFolderState(DefaultMutableTreeNode dmtn, JTree tree)
<span class="nc" id="L34">   {</span>
<span class="nc" id="L35">      TreePath selPath = tree.getSelectionPath();</span>

<span class="nc bnc" id="L37" title="All 4 branches missed.">      if(null != selPath &amp;&amp; selPath.getLastPathComponent() == dmtn)</span>
      {
<span class="nc" id="L39">         _isSelected = true;</span>
      }

<span class="nc" id="L42">      _isExpanded = tree.isExpanded(new TreePath(dmtn.getPath()));</span>


<span class="nc bnc" id="L45" title="All 2 branches missed.">      if(dmtn.getUserObject() instanceof ISQLAlias)</span>
      {
<span class="nc" id="L47">         ISQLAlias alias = (ISQLAlias) dmtn.getUserObject();</span>
<span class="nc" id="L48">         _aliasIdentifier = alias.getIdentifier();</span>
<span class="nc" id="L49">         _aliasName = alias.getName();</span>
<span class="nc" id="L50">      }</span>
      else
      {
<span class="nc" id="L53">         _folderName = dmtn.getUserObject().toString();</span>
<span class="nc" id="L54">         _kids = new AliasFolderState[dmtn.getChildCount()];</span>
<span class="nc bnc" id="L55" title="All 2 branches missed.">         for (int i = 0; i &lt; dmtn.getChildCount(); i++)</span>
         {
<span class="nc" id="L57">            AliasFolderState state = new AliasFolderState((DefaultMutableTreeNode) dmtn.getChildAt(i), tree);</span>
<span class="nc" id="L58">            _kids[i] = state;</span>
         }
      }
<span class="nc" id="L61">   }</span>

   public AliasFolderState[] getKids()
   {
<span class="nc" id="L65">      return _kids;</span>
   }

   public void setKids(AliasFolderState[] kids)
   {
<span class="nc" id="L70">      _kids = kids;</span>
<span class="nc" id="L71">   }</span>

   public IIdentifier getAliasIdentifier()
   {
<span class="nc" id="L75">      return _aliasIdentifier;</span>
   }

   public void setAliasIdentifier(IIdentifier aliasIdentifier)
   {
<span class="nc" id="L80">      _aliasIdentifier = aliasIdentifier;</span>
<span class="nc" id="L81">   }</span>

   public String getFolderName()
   {
<span class="nc" id="L85">      return _folderName;</span>
   }

   public void setFolderName(String folderName)
   {
<span class="nc" id="L90">      _folderName = folderName;</span>
<span class="nc" id="L91">   }</span>

   public boolean isSelected()
   {
<span class="nc" id="L95">      return _isSelected;</span>
   }

   public void setSelected(boolean selected)
   {
<span class="nc" id="L100">      _isSelected = selected;</span>
<span class="nc" id="L101">   }</span>

   public boolean isExpanded()
   {
<span class="nc" id="L105">      return _isExpanded;</span>
   }

   public void setExpanded(boolean expanded)
   {
<span class="nc" id="L110">      _isExpanded = expanded;</span>
<span class="nc" id="L111">   }</span>

   public void applyNodes(DefaultMutableTreeNode parent, AliasesListModel aliasesListModel)
   {
<span class="nc bnc" id="L115" title="All 2 branches missed.">      if(null != _folderName)</span>
      {
<span class="nc" id="L117">         _node = AliasesTreeUtil.createFolderNode(_folderName);</span>
<span class="nc" id="L118">         parent.add(_node);</span>
<span class="nc bnc" id="L119" title="All 2 branches missed.">         for (AliasFolderState kid : _kids)</span>
         {
<span class="nc" id="L121">            kid.applyNodes(_node, aliasesListModel);</span>
         }
      }
      else
      {
<span class="nc" id="L126">         SQLAlias sqlAlias = aliasesListModel.getAlias(_aliasIdentifier);</span>
<span class="nc bnc" id="L127" title="All 2 branches missed.">         if(null != sqlAlias)</span>
         {
<span class="nc" id="L129">            _node = new DefaultMutableTreeNode(sqlAlias);</span>
<span class="nc" id="L130">            parent.add(_node);</span>
         }
      }
<span class="nc" id="L133">   }</span>

   private void applyExpansionAndSelectionToNode(JTree tree, DefaultMutableTreeNode node)
   {
<span class="nc bnc" id="L137" title="All 2 branches missed.">      if(_isExpanded)</span>
      {
<span class="nc" id="L139">         tree.expandPath(new TreePath(node.getPath()));</span>
      }

<span class="nc bnc" id="L142" title="All 2 branches missed.">      if(_isSelected)</span>
      {
<span class="nc" id="L144">         tree.setSelectionPath(new TreePath(node.getPath()));</span>
      }
<span class="nc" id="L146">   }</span>

   public void applyExpansionAndSelection(JTree tree)
   {
<span class="nc bnc" id="L150" title="All 2 branches missed.">      if (_node != null)</span>
      {
         // _node is null when there is an _aliasIdentifier with no Alias
         // This has been seen some times and caused NullPointersHere  

<span class="nc bnc" id="L155" title="All 2 branches missed.">         if (null != _folderName)</span>
         {
<span class="nc" id="L157">            applyExpansionAndSelectionToNode(tree, _node);</span>
<span class="nc bnc" id="L158" title="All 2 branches missed.">            for (AliasFolderState kid : _kids)</span>
            {
<span class="nc" id="L160">               kid.applyExpansionAndSelection(tree);</span>
            }
         }
         else
         {
<span class="nc" id="L165">            applyExpansionAndSelectionToNode(tree, _node);</span>
         }
      }
<span class="nc" id="L168">   }</span>

   public void sort()
   {
<span class="nc" id="L172">      Arrays.sort(_kids);</span>

<span class="nc bnc" id="L174" title="All 2 branches missed.">      for (AliasFolderState kid : _kids)</span>
      {
<span class="nc" id="L176">         kid.sort();</span>
      }
<span class="nc" id="L178">   }</span>

   public int compareTo(AliasFolderState other)
   {
<span class="nc bnc" id="L182" title="All 4 branches missed.">      if(null == _aliasIdentifier &amp;&amp; null != other._aliasIdentifier)</span>
      {
<span class="nc" id="L184">         return -1;</span>
      }
<span class="nc bnc" id="L186" title="All 4 branches missed.">      else if(null != _aliasIdentifier &amp;&amp; null == other._aliasIdentifier)</span>
      {
<span class="nc" id="L188">         return 1;</span>
      }

<span class="nc" id="L191">      return getCompString().compareTo(other.getCompString());</span>
   }

   private String getCompString()
   {
<span class="nc bnc" id="L196" title="All 2 branches missed.">      return null != _folderName ? _folderName : _aliasName;</span>
   }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>