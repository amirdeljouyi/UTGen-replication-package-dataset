<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ColumnListDialog.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">102_squirrel-sql</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.squirrel_sql.client.gui.db</a> &gt; <span class="el_source">ColumnListDialog.java</span></div><h1>ColumnListDialog.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2006 Rob Manning
 * manningr@users.sourceforge.net
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */

package net.sourceforge.squirrel_sql.client.gui.db;

import java.awt.BorderLayout;
import java.awt.Container;
import java.awt.Dimension;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.Insets;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.ComponentEvent;
import java.awt.event.ComponentListener;
import java.util.ArrayList;

import javax.swing.JButton;
import javax.swing.JDialog;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JList;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextField;
import javax.swing.ListSelectionModel;
import javax.swing.SwingConstants;
import javax.swing.border.Border;
import javax.swing.border.EmptyBorder;
import javax.swing.event.ListSelectionEvent;
import javax.swing.event.ListSelectionListener;

import net.sourceforge.squirrel_sql.client.ApplicationArguments;
import net.sourceforge.squirrel_sql.fw.sql.TableColumnInfo;
import net.sourceforge.squirrel_sql.fw.util.StringManager;
import net.sourceforge.squirrel_sql.fw.util.StringManagerFactory;


/**
 * A dialog that can be used to get column(s) selected by the user 
 */
public class ColumnListDialog extends JDialog implements IDisposableDialog {

    private static final long serialVersionUID = 1L;

<span class="nc" id="L63">    private JLabel tableNameLabel = null;</span>
<span class="nc" id="L64">    private JLabel primaryKeyNameLabel = null;</span>
<span class="nc" id="L65">    private JTextField tableNameTextField = null;</span>
<span class="nc" id="L66">    private JLabel columnListLabel = null;</span>
<span class="nc" id="L67">    private JList columnList = null;</span>
    
<span class="nc" id="L69">    private JButton executeButton = null;</span>
<span class="nc" id="L70">    private JButton editSQLButton = null;</span>
<span class="nc" id="L71">    private JButton showSQLButton = null;</span>
<span class="nc" id="L72">    private JButton cancelButton = null;</span>
<span class="nc" id="L73">    private JTextField primaryKeyNameTF = null;</span>
    
    /** Internationalized strings for this class. */
<span class="nc" id="L76">    private static final StringManager s_stringMgr =</span>
<span class="nc" id="L77">        StringManagerFactory.getStringManager(ColumnListDialog.class);</span>
    
    private interface i18n {
        //i18n[ColumnListDialog.executeButtonLabel=Execute]
        String EXECUTE_BUTTON_LABEL =
<span class="nc" id="L82">            s_stringMgr.getString(&quot;ColumnListDialog.executeButtonLabel&quot;);</span>
        //i18n[ColumnListDialog.cancelButtonLabel=Cancel]
        String CANCEL_BUTTON_LABEL = 
<span class="nc" id="L85">            s_stringMgr.getString(&quot;ColumnListDialog.cancelButtonLabel&quot;);</span>
        //i18n[ColumnListDialog.columnNameLabel=Column: ]
        String COLUMN_NAME_LABEL = 
<span class="nc" id="L88">            s_stringMgr.getString(&quot;ColumnListDialog.columnNameLabel&quot;);</span>
        //i18n[ColumnListDialog.dropErrorMessage=Can't drop all columns - a 
        //table must have at least one column
        String DROP_ERROR_MESSAGE = 
<span class="nc" id="L92">            s_stringMgr.getString(&quot;ColumnListDialog.dropErrorMessage&quot;);</span>
        //i18n[ColumnListDialog.dropErrorTitle=Too Many Columns Selected]
        String DROP_ERROR_TITLE = 
<span class="nc" id="L95">            s_stringMgr.getString(&quot;ColumnListDialog.dropErrorTitle&quot;);</span>
        //i18n[ColumnListDialog.dropPrimaryKeyTitle=Drop Primary Key]        
        String DROP_PRIMARY_KEY_TITLE = 
<span class="nc" id="L98">            s_stringMgr.getString(&quot;ColumnListDialog.dropPrimaryKeyTitle&quot;);</span>
        //i18n[ColumnListDialog.dropTitle=Select Column(s) To Drop]
        String DROP_TITLE = 
<span class="nc" id="L101">            s_stringMgr.getString(&quot;ColumnListDialog.dropTitle&quot;);</span>
        //i18n[ColumnDetailsDialog.modifyButtonLabel=Modify Column]
        String MODIFY_BUTTON_LABEL = 
<span class="nc" id="L104">            s_stringMgr.getString(&quot;ColumnDetailsDialog.modifyButtonLabel&quot;);        </span>
        //i18n[ColumnListDialog.modifyTitle=Select Column To Modify]
        String MODIFY_TITLE = 
<span class="nc" id="L107">            s_stringMgr.getString(&quot;ColumnListDialog.modifyTitle&quot;);</span>
        //i18n[ColumnListDialog.primaryKeyTitle=Choose column(s) for primary key] 
        String PRIMARY_KEY_TITLE =
<span class="nc" id="L110">            s_stringMgr.getString(&quot;ColumnListDialog.primaryKeyTitle&quot;);</span>
        
        //i18n[ColumnListDialog.primaryKeyNameLabel=Primary Key Name: ]
        String PRIMARY_KEY_NAME_LABEL =
<span class="nc" id="L114">            s_stringMgr.getString(&quot;ColumnListDialog.primaryKeyNameLabel&quot;);</span>
        
        //i18n[ColumnListDialog.showSQLButtonLabel=Show SQL]
        String SHOWSQL_BUTTON_LABEL = 
<span class="nc" id="L118">            s_stringMgr.getString(&quot;ColumnListDialog.showSQLButtonLabel&quot;);</span>
        //i18n[ColumnListDialog.tableNameLabel=Table Name: ]
        String TABLE_NAME_LABEL = 
<span class="nc" id="L121">            s_stringMgr.getString(&quot;ColumnListDialog.tableNameLabel&quot;);</span>
        //i18n[ColumnListDialog.editSQLButtonLabel=Edit SQL]
<span class="nc" id="L123">        String EDIT_BUTTON_LABEL = </span>
<span class="nc" id="L124">            s_stringMgr.getString(&quot;ColumnListDialog.editSQLButtonLabel&quot;);</span>
    }
    
    public static final int DROP_COLUMN_MODE = 0;
    public static final int MODIFY_COLUMN_MODE = 1;
    public static final int ADD_PRIMARY_KEY_MODE = 2;
    public static final int DROP_PRIMARY_KEY_MODE = 3;
    
<span class="nc" id="L132">    private int _mode = DROP_COLUMN_MODE;</span>
    
<span class="nc" id="L134">    private TableColumnInfo[] colInfos = null;</span>
    
    /**
     * @param columnInfos the list of columns to display
     * @param mode the mode in which the dialog is acting.
     */
<span class="nc" id="L140">    public ColumnListDialog(TableColumnInfo[] columnInfos, int mode) { </span>
<span class="nc" id="L141">        _mode = mode;</span>
<span class="nc" id="L142">        setColumnList(columnInfos);</span>
<span class="nc" id="L143">    }</span>
            
    public void setColumnList(TableColumnInfo[] columnInfos) {
<span class="nc" id="L146">        colInfos = columnInfos;</span>
<span class="nc" id="L147">        ArrayList&lt;String&gt; tmp = new ArrayList&lt;String&gt;();</span>
<span class="nc bnc" id="L148" title="All 2 branches missed.">        for (int i = 0; i &lt; colInfos.length; i++) {</span>
<span class="nc" id="L149">            TableColumnInfo info = colInfos[i];</span>
<span class="nc" id="L150">            tmp.add(info.getColumnName());</span>
        }
<span class="nc" id="L152">        String[] cols = tmp.toArray(new String[tmp.size()]);</span>
<span class="nc bnc" id="L153" title="All 2 branches missed.">        if (columnList != null) {</span>
<span class="nc" id="L154">            columnList.setListData(cols);</span>
        } else {
<span class="nc" id="L156">            init(cols);</span>
        }
<span class="nc bnc" id="L158" title="All 2 branches missed.">        if (_mode == DROP_PRIMARY_KEY_MODE) {</span>
<span class="nc" id="L159">            columnList.setEnabled(false);</span>
        }
<span class="nc" id="L161">    }</span>
    
    public void setTableName(String tableName) {
<span class="nc" id="L164">        tableNameTextField.setText(tableName);</span>
<span class="nc" id="L165">    }</span>
    
    public String getTableName() {
<span class="nc" id="L168">        return tableNameTextField.getText();</span>
    }
        
    public void setPrimaryKeyName(String primaryKeyName) {
<span class="nc" id="L172">        primaryKeyNameTF.setText(primaryKeyName);</span>
<span class="nc" id="L173">    }</span>
    
    public String getPrimaryKeyName() {
<span class="nc" id="L176">        return primaryKeyNameTF.getText();</span>
    }
    
    public TableColumnInfo[] getSelectedColumnList() {
<span class="nc" id="L180">        ArrayList&lt;TableColumnInfo&gt; result = new ArrayList&lt;TableColumnInfo&gt;();</span>
<span class="nc" id="L181">        Object[] selectedColNames = columnList.getSelectedValues();</span>
<span class="nc bnc" id="L182" title="All 2 branches missed.">        for (int i = 0; i &lt; selectedColNames.length; i++) {</span>
<span class="nc" id="L183">            String columnName = (String)selectedColNames[i];</span>
<span class="nc" id="L184">            result.add(getColInfoByName(columnName));</span>
        }
<span class="nc" id="L186">        return result.toArray(new TableColumnInfo[result.size()]);</span>
    }
    
    private TableColumnInfo getColInfoByName(String columnName) {
<span class="nc bnc" id="L190" title="All 2 branches missed.">        for (int i = 0; i &lt; colInfos.length; i++) {</span>
<span class="nc" id="L191">            TableColumnInfo colInfo = colInfos[i];</span>
<span class="nc bnc" id="L192" title="All 2 branches missed.">            if (colInfo.getColumnName().equals(columnName)) {</span>
<span class="nc" id="L193">                return colInfo;</span>
            }
        }
<span class="nc" id="L196">        return null;</span>
    }
    
    public void addColumnSelectionListener(ActionListener listener) {
<span class="nc bnc" id="L200" title="All 2 branches missed.">        if (listener == null) {</span>
<span class="nc" id="L201">            throw new IllegalArgumentException(&quot;listener cannot be null&quot;);</span>
        }
<span class="nc" id="L203">        executeButton.addActionListener(listener);</span>
<span class="nc" id="L204">    }</span>
    
    public void addShowSQLListener(ActionListener listener) {
<span class="nc bnc" id="L207" title="All 2 branches missed.">        if (listener == null) {</span>
<span class="nc" id="L208">            throw new IllegalArgumentException(&quot;listener cannot be null&quot;);</span>
        }
<span class="nc" id="L210">        showSQLButton.addActionListener(listener);</span>
<span class="nc" id="L211">    }</span>

    public void addEditSQLListener(ActionListener listener) {
<span class="nc bnc" id="L214" title="All 2 branches missed.">        if (listener == null) {</span>
<span class="nc" id="L215">            throw new IllegalArgumentException(&quot;listener cannot be null&quot;);</span>
        }
<span class="nc" id="L217">        editSQLButton.addActionListener(listener);</span>
<span class="nc" id="L218">    }    </span>
    
    public void setMultiSelection() {
<span class="nc" id="L221">        columnList.setSelectionMode(ListSelectionModel.MULTIPLE_INTERVAL_SELECTION);</span>
<span class="nc" id="L222">    }</span>
    
    public void setSingleSelection() {
<span class="nc" id="L225">        columnList.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);</span>
<span class="nc" id="L226">    }</span>
    
    private GridBagConstraints getLabelConstraints(GridBagConstraints c) {
<span class="nc" id="L229">        c.gridx = 0;</span>
<span class="nc" id="L230">        c.gridy++;                </span>
<span class="nc" id="L231">        c.anchor = GridBagConstraints.NORTHEAST;</span>
<span class="nc" id="L232">        c.fill = GridBagConstraints.NONE;</span>
<span class="nc" id="L233">        c.weightx = 0;</span>
<span class="nc" id="L234">        c.weighty = 0;</span>
<span class="nc" id="L235">        return c;</span>
    }
    
    private GridBagConstraints getFieldConstraints(GridBagConstraints c) {
<span class="nc" id="L239">        c.gridx++;</span>
<span class="nc" id="L240">        c.anchor = GridBagConstraints.NORTHWEST;   </span>
<span class="nc" id="L241">        c.weightx = 0;</span>
<span class="nc" id="L242">        c.weighty = 0;</span>
<span class="nc" id="L243">        c.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L244">        return c;</span>
    }

    private JLabel getBorderedLabel(String text, Border border) {
<span class="nc" id="L248">        JLabel result = new JLabel(text);</span>
<span class="nc" id="L249">        result.setBorder(border);</span>
<span class="nc" id="L250">        result.setPreferredSize(new Dimension(115, 20));</span>
<span class="nc" id="L251">        result.setHorizontalAlignment(SwingConstants.RIGHT);</span>
<span class="nc" id="L252">        return result;</span>
    }
        
    /**
     * Creates the UI for this dialog.
     */
    private void init(String[] columnNames) {
<span class="nc" id="L259">        super.setModal(true);        </span>
<span class="nc bnc" id="L260" title="All 2 branches missed.">        if (_mode == DROP_COLUMN_MODE) {</span>
<span class="nc" id="L261">            setTitle(i18n.DROP_TITLE);</span>
        } 
<span class="nc bnc" id="L263" title="All 2 branches missed.">        if (_mode == MODIFY_COLUMN_MODE) {</span>
<span class="nc" id="L264">            setTitle(i18n.MODIFY_TITLE);</span>
        }
<span class="nc bnc" id="L266" title="All 2 branches missed.">        if (_mode == ADD_PRIMARY_KEY_MODE) {</span>
<span class="nc" id="L267">            setTitle(i18n.PRIMARY_KEY_TITLE);</span>
        }
<span class="nc bnc" id="L269" title="All 2 branches missed.">        if (_mode == DROP_PRIMARY_KEY_MODE) {</span>
<span class="nc" id="L270">            setTitle(i18n.DROP_PRIMARY_KEY_TITLE);</span>
        }
<span class="nc" id="L272">        setSize(425, 250);</span>
<span class="nc" id="L273">        EmptyBorder border = new EmptyBorder(new Insets(5,5,5,5));</span>
<span class="nc" id="L274">        Dimension mediumField = new Dimension(126, 20);</span>
        
<span class="nc" id="L276">        JPanel pane = new JPanel();</span>
<span class="nc" id="L277">        pane.setLayout(new GridBagLayout());</span>
<span class="nc" id="L278">        pane.setBorder(new EmptyBorder(10,0,0,30));</span>

<span class="nc" id="L280">        GridBagConstraints c = new GridBagConstraints();</span>
<span class="nc" id="L281">        c.gridx = 0;</span>
<span class="nc" id="L282">        c.gridy = -1;</span>

        // Table name
<span class="nc" id="L285">        tableNameLabel = getBorderedLabel(i18n.TABLE_NAME_LABEL, border);</span>
<span class="nc" id="L286">        pane.add(tableNameLabel, getLabelConstraints(c));</span>
        
<span class="nc" id="L288">        tableNameTextField = new JTextField();</span>
<span class="nc" id="L289">        tableNameTextField.setPreferredSize(mediumField);</span>
<span class="nc" id="L290">        tableNameTextField.setEditable(false);</span>
<span class="nc" id="L291">        pane.add(tableNameTextField, getFieldConstraints(c));</span>
                
        // Primary Key name
<span class="nc bnc" id="L294" title="All 4 branches missed.">        if (_mode == ADD_PRIMARY_KEY_MODE</span>
                || _mode == DROP_PRIMARY_KEY_MODE) {
<span class="nc" id="L296">            primaryKeyNameLabel = new JLabel(i18n.PRIMARY_KEY_NAME_LABEL);</span>
<span class="nc" id="L297">            pane.add(primaryKeyNameLabel, getLabelConstraints(c));</span>
            
<span class="nc" id="L299">            primaryKeyNameTF = new JTextField();</span>
<span class="nc" id="L300">            primaryKeyNameTF.setPreferredSize(mediumField);</span>
<span class="nc bnc" id="L301" title="All 2 branches missed.">            if (_mode == ADD_PRIMARY_KEY_MODE) {</span>
<span class="nc" id="L302">                primaryKeyNameTF.setEditable(true);</span>
            } else {
<span class="nc" id="L304">                primaryKeyNameTF.setEditable(false);</span>
            }
<span class="nc" id="L306">            pane.add(primaryKeyNameTF, getFieldConstraints(c));</span>
        }
        
        // Column list        
<span class="nc" id="L310">        columnListLabel = getBorderedLabel(i18n.COLUMN_NAME_LABEL, border);</span>
<span class="nc" id="L311">        columnListLabel.setVerticalAlignment(JLabel.NORTH);</span>
<span class="nc" id="L312">        pane.add(columnListLabel, getLabelConstraints(c));</span>
        
<span class="nc" id="L314">        columnList = new JList(columnNames);</span>
<span class="nc" id="L315">        columnList.addListSelectionListener(new ColumnListSelectionListener());</span>

<span class="nc" id="L317">        JScrollPane sp = new JScrollPane(columnList);</span>
<span class="nc" id="L318">        c = getFieldConstraints(c);</span>
<span class="nc" id="L319">        c.weightx = 1;</span>
<span class="nc" id="L320">        c.weighty = 1;        </span>
<span class="nc" id="L321">        c.fill=GridBagConstraints.BOTH;</span>
<span class="nc" id="L322">        pane.add(sp, c);</span>
                
<span class="nc" id="L324">        Container contentPane = super.getContentPane();</span>
<span class="nc" id="L325">        contentPane.setLayout(new BorderLayout());</span>
<span class="nc" id="L326">        contentPane.add(pane, BorderLayout.CENTER);</span>
        
<span class="nc" id="L328">        contentPane.add(getButtonPanel(), BorderLayout.SOUTH);</span>
<span class="nc" id="L329">    }</span>
    
    private JPanel getButtonPanel() {
<span class="nc" id="L332">        JPanel result = new JPanel();</span>
<span class="nc bnc" id="L333" title="All 2 branches missed.">        if (_mode == MODIFY_COLUMN_MODE) {</span>
<span class="nc" id="L334">            executeButton = new JButton(i18n.MODIFY_BUTTON_LABEL);</span>
        } else {
<span class="nc" id="L336">            executeButton = new JButton(i18n.EXECUTE_BUTTON_LABEL);</span>
        }        
<span class="nc" id="L338">        result.add(executeButton);</span>
        
<span class="nc bnc" id="L340" title="All 2 branches missed.">        if (_mode != MODIFY_COLUMN_MODE) {</span>
<span class="nc" id="L341">            editSQLButton = new JButton(i18n.EDIT_BUTTON_LABEL);</span>
<span class="nc" id="L342">            result.add(editSQLButton);</span>
<span class="nc" id="L343">            showSQLButton = new JButton(i18n.SHOWSQL_BUTTON_LABEL);</span>
<span class="nc" id="L344">            result.add(showSQLButton);</span>
        }
<span class="nc" id="L346">        cancelButton = new JButton(i18n.CANCEL_BUTTON_LABEL);</span>
<span class="nc" id="L347">        cancelButton.addActionListener(new ActionListener() {</span>
            public void actionPerformed(ActionEvent e) {
<span class="nc" id="L349">                setVisible(false);</span>
<span class="nc" id="L350">                dispose();</span>
<span class="nc" id="L351">            }</span>
        });
<span class="nc" id="L353">        result.add(cancelButton);</span>
<span class="nc bnc" id="L354" title="All 2 branches missed.">        if (_mode != DROP_PRIMARY_KEY_MODE) {</span>
<span class="nc" id="L355">            executeButton.setEnabled(false);</span>
<span class="nc bnc" id="L356" title="All 2 branches missed.">            if (_mode != MODIFY_COLUMN_MODE) {</span>
<span class="nc" id="L357">                editSQLButton.setEnabled(false);</span>
<span class="nc" id="L358">                showSQLButton.setEnabled(false);</span>
            }
        }
<span class="nc" id="L361">        return result;</span>
    }
    
    /**
     * @param args
     */
    public static void main(String[] args) {
<span class="nc" id="L368">        ApplicationArguments.initialize(new String[] {});</span>
<span class="nc" id="L369">        String[] data = </span>
            new String [] {&quot;A_Really_Long_Nasty_Column_Called_ColumnA&quot;, 
                           &quot;ColumnB&quot;,&quot;ColumnC&quot;,&quot;ColumnD&quot;,&quot;ColumnE&quot;,&quot;ColumnF&quot;,
                           &quot;ColumnG&quot;,&quot;ColumnH&quot;,&quot;ColumnI&quot;,&quot;ColumnJ&quot;,&quot;ColumnK&quot;,
                           &quot;ColumnL&quot;,&quot;ColumnM&quot;,&quot;ColumnN&quot;,&quot;ColumnO&quot;,&quot;ColumnP&quot;,
                           &quot;ColumnP&quot;,&quot;ColumnQ&quot;,&quot;ColumnR&quot;,&quot;ColumnS&quot;,&quot;ColumnT&quot;};
        
<span class="nc" id="L376">        TableColumnInfo[] infos = new TableColumnInfo[data.length];</span>
        
<span class="nc bnc" id="L378" title="All 2 branches missed.">        for (int i = 0; i &lt; infos.length; i++) {</span>
<span class="nc" id="L379">            infos[i] = new TableColumnInfo(&quot;aCat&quot;, </span>
                                          &quot;aSchem&quot;, 
                                          &quot;aTab&quot;, 
                                          data[i], 
                                          java.sql.Types.CHAR,
                                          &quot;character&quot;,
                                          10,
                                          0, 
                                          0,
                                          0,
                                          &quot;a comment&quot;,
                                          &quot;defVal&quot;,
                                          0,
                                          0,
                                          &quot;YES&quot;);      
        }
        
<span class="nc" id="L396">        final ColumnListDialog c = new ColumnListDialog(infos, 0);</span>
<span class="nc" id="L397">        c.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span>
<span class="nc" id="L398">        c.setTableName(&quot;FooTable&quot;);</span>
<span class="nc" id="L399">        c.addComponentListener(new ComponentListener() {</span>
<span class="nc" id="L400">            public void componentHidden(ComponentEvent e) {}</span>
<span class="nc" id="L401">            public void componentMoved(ComponentEvent e) {}</span>
            public void componentResized(ComponentEvent e) {
<span class="nc" id="L403">                System.out.println(&quot;Current size = &quot;+c.getSize());</span>
<span class="nc" id="L404">            }</span>
<span class="nc" id="L405">            public void componentShown(ComponentEvent e) {}            </span>
        });
<span class="nc" id="L407">        c.cancelButton.addActionListener(new ActionListener() {</span>
            public void actionPerformed(ActionEvent e) {
<span class="nc" id="L409">                System.exit(1);</span>
<span class="nc" id="L410">            }</span>
        });
<span class="nc" id="L412">        c.setVisible(true);</span>
        
        
<span class="nc" id="L415">    }</span>
    
    private void enable(JButton button) {
<span class="nc bnc" id="L418" title="All 2 branches missed.">        if (button != null) {</span>
<span class="nc" id="L419">            button.setEnabled(true);</span>
        }
<span class="nc" id="L421">    }</span>

    private void disable(JButton button) {        
<span class="nc bnc" id="L424" title="All 2 branches missed.">        if (button != null) {</span>
<span class="nc" id="L425">            button.setEnabled(false);</span>
        }
<span class="nc" id="L427">    }</span>
    
<span class="nc" id="L429">    private class ColumnListSelectionListener implements ListSelectionListener {</span>

        /**
         * Rules to handle enabling/disabling the buttons in this dialog.  Handle
         * all cases where buttons should be disable first; if every rule passes
         * then enable.
         */
        public void valueChanged(ListSelectionEvent e) {
<span class="nc" id="L437">            int[] selected = columnList.getSelectedIndices();</span>
            
            // If no columns are selected, and we're not dropping the PK, then
            // there is nothing to do.
<span class="nc bnc" id="L441" title="All 2 branches missed.">            if (_mode != DROP_PRIMARY_KEY_MODE) { </span>
<span class="nc bnc" id="L442" title="All 4 branches missed.">                if (selected == null || selected.length == 0) {</span>
<span class="nc" id="L443">                    disable(executeButton);</span>
<span class="nc" id="L444">                    disable(editSQLButton);</span>
<span class="nc" id="L445">                    disable(showSQLButton);</span>
<span class="nc" id="L446">                    return;</span>
                }
            } 
            
            // User cannot be allowed to drop all columns from a table
<span class="nc bnc" id="L451" title="All 2 branches missed.">            if (_mode == DROP_COLUMN_MODE</span>
<span class="nc bnc" id="L452" title="All 2 branches missed.">                    &amp;&amp; selected.length == columnList.getModel().getSize())</span>
            {
<span class="nc" id="L454">                JOptionPane.showMessageDialog(ColumnListDialog.this, </span>
                                              i18n.DROP_ERROR_MESSAGE, 
                                              i18n.DROP_ERROR_TITLE, 
                                              JOptionPane.ERROR_MESSAGE);
<span class="nc" id="L458">                columnList.clearSelection();</span>
<span class="nc" id="L459">                disable(executeButton);</span>
<span class="nc" id="L460">                disable(editSQLButton);</span>
<span class="nc" id="L461">                disable(showSQLButton);</span>
<span class="nc" id="L462">                return;</span>
            } 
            
            // All rules passed, so enable the buttons.
<span class="nc" id="L466">            enable(executeButton);</span>
<span class="nc" id="L467">            enable(editSQLButton);</span>
<span class="nc" id="L468">            enable(showSQLButton);                </span>
<span class="nc" id="L469">        }</span>
        
    }    
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>