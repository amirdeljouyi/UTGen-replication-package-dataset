<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SQLAlias.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">102_squirrel-sql</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.squirrel_sql.client.gui.db</a> &gt; <span class="el_source">SQLAlias.java</span></div><h1>SQLAlias.java</h1><pre class="source lang-java linenums">package net.sourceforge.squirrel_sql.client.gui.db;
/*
 * Copyright (C) 2001-2003 Colin Bell
 * colbell@users.sourceforge.net
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANT_Y; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */
import java.beans.PropertyChangeListener;
import java.io.Serializable;

import net.sourceforge.squirrel_sql.fw.id.IIdentifier;
import net.sourceforge.squirrel_sql.fw.persist.ValidationException;
import net.sourceforge.squirrel_sql.fw.sql.ISQLAlias;
import net.sourceforge.squirrel_sql.fw.sql.SQLDriverProperty;
import net.sourceforge.squirrel_sql.fw.sql.SQLDriverPropertyCollection;
import net.sourceforge.squirrel_sql.fw.util.PropertyChangeReporter;
import net.sourceforge.squirrel_sql.fw.util.StringManager;
import net.sourceforge.squirrel_sql.fw.util.StringManagerFactory;
import net.sourceforge.squirrel_sql.fw.util.Utilities;

/**
 * This represents a Database alias which is a description of the means
 * required to connect to a JDBC complient database.&lt;P&gt;
 * This class is a &lt;CODE&gt;JavaBean&lt;/CODE&gt;.
 *
 * @author &lt;A HREF=&quot;mailto:colbell@users.sourceforge.net&quot;&gt;Colin Bell&lt;/A&gt;
 */
@SuppressWarnings(&quot;serial&quot;)
public class SQLAlias implements Cloneable, Serializable, ISQLAliasExt, Comparable&lt;Object&gt;
{
    /** Internationalized strings for this class. */
<span class="nc" id="L44">   private static final StringManager s_stringMgr =</span>
<span class="nc" id="L45">      StringManagerFactory.getStringManager(SQLAlias.class);</span>


   private interface IStrings
   {
<span class="nc" id="L50">      String ERR_BLANK_NAME = s_stringMgr.getString(&quot;SQLAlias.error.blankname&quot;);</span>
<span class="nc" id="L51">      String ERR_BLANK_DRIVER = s_stringMgr.getString(&quot;SQLAlias.error.blankdriver&quot;);</span>
<span class="nc" id="L52">      String ERR_BLANK_URL = s_stringMgr.getString(&quot;SQLAlias.error.blankurl&quot;);</span>
   }

   private interface IPropNames extends ISQLAlias.IPropertyNames
   {
      // Empty block.
   }

   /** The &lt;CODE&gt;IIdentifier&lt;/CODE&gt; that uniquely identifies this object. */
   private IIdentifier _id;

   /** The name of this alias. */
   private String _name;

   /**
    * The &lt;CODE&gt;IIdentifier&lt;/CODE&gt; that identifies the &lt;CODE&gt;ISQLDriver&lt;/CODE&gt;
    * that this &lt;CODE&gt;ISQLAlias&lt;/CODE&gt; uses.
    */
   private IIdentifier _driverId;

   /** The URL required to access the database. */
   private String _url;

   /** Name of user for connection. */
   private String _userName;

   /** Password of user for connection. */
   private String _password;

   /** &lt;TT&gt;true&lt;/TT&gt; if this alias should be logged on automatically. */
   private boolean _autoLogon;

   /** Should this alias be connected when the application is started up. */
   private boolean _connectAtStartup;

   /** If &lt;TT&gt;true&lt;/TT&gt; then use drver properties. */
<span class="nc" id="L88">   private boolean _useDriverProperties = false;</span>

   /** Collection of &lt;TT&gt;SQLDriverProperty&lt;/TT&gt; objects for this alias. */
<span class="nc" id="L91">   private SQLDriverPropertyCollection _driverProps = new SQLDriverPropertyCollection();</span>

   /** Object to handle property change events. */
   private transient PropertyChangeReporter _propChgReporter;

<span class="nc" id="L96">   private SQLAliasSchemaProperties _schemaProperties = new SQLAliasSchemaProperties();</span>

<span class="nc" id="L98">   private SQLAliasColorProperties _colorProperties = new SQLAliasColorProperties();</span>
   
<span class="nc" id="L100">   private SQLAliasConnectionProperties _connectionProperties = new SQLAliasConnectionProperties();</span>
   
   /**
    * Default ctor.
    */
   public SQLAlias()
<span class="nc" id="L106">   {</span>
<span class="nc" id="L107">   }</span>

   /**
    * Ctor specifying the identifier.
    *
    * @param	id	Uniquely identifies this object.
    */
   public SQLAlias(IIdentifier id)
<span class="nc" id="L115">   {</span>
<span class="nc" id="L116">      _id = id;</span>
<span class="nc" id="L117">      _name = &quot;&quot;;</span>
<span class="nc" id="L118">      _driverId = null;</span>
<span class="nc" id="L119">      _url = &quot;&quot;;</span>
<span class="nc" id="L120">      _userName = &quot;&quot;;</span>
<span class="nc" id="L121">      _password = &quot;&quot;;</span>
<span class="nc" id="L122">   }</span>

   /**
    * Assign data from the passed &lt;CODE&gt;ISQLAlias&lt;/CODE&gt; to this one.
    *
    * This Alias becomes a clone of rhs.
    *
    * @param	rhs	 &lt;CODE&gt;ISQLAlias&lt;/CODE&gt; to copy data from.
    *
    * @param b
    * @exception	ValidationException
    *				Thrown if an error occurs assigning data from
    *				&lt;CODE&gt;rhs&lt;/CODE&gt;.
    */
   public synchronized void assignFrom(SQLAlias rhs, boolean withIdentifier)
      throws ValidationException
   {
<span class="nc bnc" id="L139" title="All 2 branches missed.">      if(withIdentifier)</span>
      {
<span class="nc" id="L141">         setIdentifier(rhs.getIdentifier());</span>
      }
      
<span class="nc" id="L144">      setName(rhs.getName());</span>
<span class="nc" id="L145">      setDriverIdentifier(rhs.getDriverIdentifier());</span>
<span class="nc" id="L146">      setUrl(rhs.getUrl());</span>
<span class="nc" id="L147">      setUserName(rhs.getUserName());</span>
<span class="nc" id="L148">      setPassword(rhs.getPassword());</span>
<span class="nc" id="L149">      setAutoLogon(rhs.isAutoLogon());</span>
<span class="nc" id="L150">      setUseDriverProperties(rhs.getUseDriverProperties());</span>
<span class="nc" id="L151">      setDriverProperties(rhs.getDriverPropertiesClone());</span>
<span class="nc" id="L152">      _schemaProperties = </span>
<span class="nc" id="L153">          (SQLAliasSchemaProperties) Utilities.cloneObject(rhs._schemaProperties, </span>
<span class="nc" id="L154">                                                           getClass().getClassLoader());</span>
<span class="nc" id="L155">      _colorProperties = </span>
<span class="nc" id="L156">      	(SQLAliasColorProperties) Utilities.cloneObject(rhs._colorProperties, getClass().getClassLoader());</span>
      
<span class="nc" id="L158">      _connectionProperties = new SQLAliasConnectionProperties();</span>
<span class="nc" id="L159">      SQLAliasConnectionProperties rhsConnProps = rhs.getConnectionProperties();</span>
<span class="nc" id="L160">		_connectionProperties.setEnableConnectionKeepAlive(rhsConnProps.isEnableConnectionKeepAlive());</span>
<span class="nc" id="L161">		_connectionProperties.setKeepAliveSleepTimeSeconds(rhsConnProps.getKeepAliveSleepTimeSeconds());</span>
<span class="nc" id="L162">		_connectionProperties.setKeepAliveSqlStatement(rhsConnProps.getKeepAliveSqlStatement());</span>
<span class="nc" id="L163">   }</span>

   /**
    * Returns &lt;TT&gt;true&lt;/TT&gt; if this objects is equal to the passed one. Two
    * &lt;TT&gt;ISQLAlias&lt;/TT&gt; objects are considered equal if they have the same
    * identifier.
    */
   public boolean equals(Object rhs)
   {
<span class="nc" id="L172">      boolean rc = false;</span>
<span class="nc bnc" id="L173" title="All 4 branches missed.">      if (rhs != null &amp;&amp; rhs.getClass().equals(getClass()))</span>
      {
<span class="nc" id="L175">         rc = ((ISQLAlias)rhs).getIdentifier().equals(getIdentifier());</span>
      }
<span class="nc" id="L177">      return rc;</span>
   }

   /**
    * Returns a hash code value for this object.
    */
   public synchronized int hashCode()
   {
<span class="nc" id="L185">      return getIdentifier().hashCode();</span>
   }

   /**
    * Returns the name of this &lt;TT&gt;ISQLAlias&lt;/TT&gt;.
    */
   public String toString()
   {
<span class="nc" id="L193">      return getName();</span>
   }

   /**
    * Compare this &lt;TT&gt;SQLAlias&lt;/TT&gt; to another object. If the passed object
    * is a &lt;TT&gt;SQLAlias&lt;/TT&gt;, then the &lt;TT&gt;getName()&lt;/TT&gt; functions of the two
    * &lt;TT&gt;SQLAlias&lt;/TT&gt; objects are used to compare them. Otherwise, it throws a
    * ClassCastException (as &lt;TT&gt;SQLAlias&lt;/TT&gt; objects are comparable only to
    * other &lt;TT&gt;SQLAlias&lt;/TT&gt; objects).
    */
   public int compareTo(Object rhs)
   {
<span class="nc" id="L205">      return _name.compareTo(((ISQLAlias)rhs).getName());</span>
   }

   public void addPropertyChangeListener(PropertyChangeListener listener)
   {
<span class="nc" id="L210">      getPropertyChangeReporter().addPropertyChangeListener(listener);</span>
<span class="nc" id="L211">   }</span>

   public void removePropertyChangeListener(PropertyChangeListener listener)
   {
<span class="nc" id="L215">      getPropertyChangeReporter().removePropertyChangeListener(listener);</span>
<span class="nc" id="L216">   }</span>

   /**
    * Returns &lt;CODE&gt;true&lt;/CODE&gt; if this object is valid.&lt;P&gt;
    * Implementation for &lt;CODE&gt;IPersistable&lt;/CODE&gt;.
    */
   public synchronized boolean isValid()
   {
<span class="nc bnc" id="L224" title="All 2 branches missed.">      return _name != null</span>
<span class="nc bnc" id="L225" title="All 6 branches missed.">                 &amp;&amp; _name.length() &gt; 0 </span>
                 &amp;&amp; _driverId != null
                 &amp;&amp; _url != null
<span class="nc bnc" id="L228" title="All 2 branches missed.">                 &amp;&amp; _url.length() &gt; 0;</span>
   }

   public IIdentifier getIdentifier()
   {
<span class="nc" id="L233">      return _id;</span>
   }

   public String getName()
   {
<span class="nc" id="L238">      return _name;</span>
   }

   public IIdentifier getDriverIdentifier()
   {
<span class="nc" id="L243">      return _driverId;</span>
   }

   public String getUrl()
   {
<span class="nc" id="L248">      return _url;</span>
   }

   public String getUserName()
   {
<span class="nc" id="L253">      return _userName;</span>
   }

   /**
    * Retrieve the saved password.
    *
    * @return		The saved password.
    */
   public String getPassword()
   {
<span class="nc" id="L263">      return _password;</span>
   }

   /**
    * Set the password for this alias.
    *
    * @param	password	The new password.
    */
   public void setPassword(String password)
   {
<span class="nc" id="L273">      String data = getString(password);</span>
<span class="nc bnc" id="L274" title="All 2 branches missed.">      if (_password != data)</span>
      {
<span class="nc" id="L276">         final String oldValue = _password;</span>
<span class="nc" id="L277">         _password = data;</span>
<span class="nc" id="L278">         getPropertyChangeReporter().firePropertyChange(IPropNames.PASSWORD,</span>
                                    oldValue, _password);
      }
<span class="nc" id="L281">   }</span>

   /**
    * Should this alias be logged on automatically.
    *
    * @return	&lt;TT&gt;true&lt;/TT&gt; is this alias should be logged on automatically
    * 			else &lt;TT&gt;false&lt;/TT&gt;.
    */
   public boolean isAutoLogon()
   {
<span class="nc" id="L291">      return _autoLogon;</span>
   }

   /**
    * Set whether this alias should be logged on automatically.
    *
    * @param	value	&lt;TT&gt;true&lt;/TT&gt; if alias should be autologged on
    * 					else &lt;TT&gt;false&lt;/TT.
    */
   public void setAutoLogon(boolean value)
   {
<span class="nc bnc" id="L302" title="All 2 branches missed.">      if (_autoLogon != value)</span>
      {
<span class="nc" id="L304">         _autoLogon = value;</span>
<span class="nc bnc" id="L305" title="All 2 branches missed.">         getPropertyChangeReporter().firePropertyChange(IPropNames.AUTO_LOGON,</span>
                                    !_autoLogon, _autoLogon);
      }
<span class="nc" id="L308">   }</span>

   /**
    * Should this alias be connected when the application is started up.
    *
    * @return	&lt;TT&gt;true&lt;/TT&gt; if this alias should be connected when the
    *			application is started up.
    */
   public boolean isConnectAtStartup()
   {
<span class="nc" id="L318">      return _connectAtStartup;</span>
   }

   /**
    * Set whether alias should be connected when the application is started up.
    *
    * @param	value	&lt;TT&gt;true&lt;/TT&gt; if alias should be connected when the
    *					application is started up.
    */
   public void setConnectAtStartup(boolean value)
   {
<span class="nc bnc" id="L329" title="All 2 branches missed.">      if (_connectAtStartup != value)</span>
      {
<span class="nc" id="L331">         _connectAtStartup = value;</span>
<span class="nc bnc" id="L332" title="All 2 branches missed.">         getPropertyChangeReporter().firePropertyChange(IPropNames.CONNECT_AT_STARTUP,</span>
                                    !_connectAtStartup, _connectAtStartup);
      }
<span class="nc" id="L335">   }</span>

   /**
    * Returns whether this alias uses driver properties.
    */
   public boolean getUseDriverProperties()
   {
<span class="nc" id="L342">      return _useDriverProperties;</span>
   }

   public void setIdentifier(IIdentifier id)
   {
<span class="nc" id="L347">      _id = id;</span>
<span class="nc" id="L348">   }</span>

   public void setName(String name) throws ValidationException
   {
<span class="nc" id="L352">      String data = getString(name);</span>
<span class="nc bnc" id="L353" title="All 2 branches missed.">      if (data.length() == 0)</span>
      {
<span class="nc" id="L355">         throw new ValidationException(IStrings.ERR_BLANK_NAME);</span>
      }
<span class="nc bnc" id="L357" title="All 2 branches missed.">      if (_name != data)</span>
      {
<span class="nc" id="L359">         final String oldValue = _name;</span>
<span class="nc" id="L360">         _name = data;</span>
<span class="nc" id="L361">         getPropertyChangeReporter().firePropertyChange(IPropNames.NAME,</span>
                                    oldValue, _name);
      }
<span class="nc" id="L364">   }</span>

   public void setDriverIdentifier(IIdentifier data)
      throws ValidationException
   {
<span class="nc bnc" id="L369" title="All 2 branches missed.">      if (data == null)</span>
      {
<span class="nc" id="L371">         throw new ValidationException(IStrings.ERR_BLANK_DRIVER);</span>
      }
<span class="nc bnc" id="L373" title="All 2 branches missed.">      if (_driverId != data)</span>
      {
<span class="nc" id="L375">         final IIdentifier oldValue = _driverId;</span>
<span class="nc" id="L376">         _driverId = data;</span>
<span class="nc" id="L377">         getPropertyChangeReporter().firePropertyChange(IPropNames.DRIVER,</span>
                                    oldValue, _driverId);
      }
<span class="nc" id="L380">   }</span>

   public void setUrl(String url) throws ValidationException
   {
<span class="nc" id="L384">      String data = getString(url);</span>
<span class="nc bnc" id="L385" title="All 2 branches missed.">      if (data.length() == 0)</span>
      {
<span class="nc" id="L387">         throw new ValidationException(IStrings.ERR_BLANK_URL);</span>
      }
<span class="nc bnc" id="L389" title="All 2 branches missed.">      if (_url != data)</span>
      {
<span class="nc" id="L391">         final String oldValue = _url;</span>
<span class="nc" id="L392">         _url = data;</span>
<span class="nc" id="L393">         getPropertyChangeReporter().firePropertyChange(IPropNames.URL,</span>
                                       oldValue, _url);
      }
<span class="nc" id="L396">   }</span>

   public void setUserName(String userName)
   {
<span class="nc" id="L400">      String data = getString(userName);</span>
<span class="nc bnc" id="L401" title="All 2 branches missed.">      if (_userName != data)</span>
      {
<span class="nc" id="L403">         final String oldValue = _userName;</span>
<span class="nc" id="L404">         _userName = data;</span>
<span class="nc" id="L405">         getPropertyChangeReporter().firePropertyChange(IPropNames.USER_NAME,</span>
                                    oldValue, _userName);
      }
<span class="nc" id="L408">   }</span>

   public void setUseDriverProperties(boolean value)
   {
<span class="nc bnc" id="L412" title="All 2 branches missed.">      if (_useDriverProperties != value)</span>
      {
<span class="nc" id="L414">         final boolean oldValue = _useDriverProperties;</span>
<span class="nc" id="L415">         _useDriverProperties = value;</span>
<span class="nc" id="L416">         getPropertyChangeReporter().firePropertyChange(IPropNames.USE_DRIVER_PROPERTIES,</span>
                                    oldValue, _useDriverProperties);
      }
<span class="nc" id="L419">   }</span>

   /**
    * Retrieve a copy of the SQL driver properties.
    *
    * @return	the SQL driver properties.
    */
   public synchronized SQLDriverPropertyCollection getDriverPropertiesClone()
   {
<span class="nc" id="L428">      final int count = _driverProps.size();</span>
<span class="nc" id="L429">      SQLDriverProperty[] newar = new SQLDriverProperty[count];</span>
<span class="nc bnc" id="L430" title="All 2 branches missed.">      for (int i = 0; i &lt; count; ++i)</span>
      {
<span class="nc" id="L432">         newar[i] = (SQLDriverProperty)_driverProps.getDriverProperty(i).clone();</span>
      }
<span class="nc" id="L434">      SQLDriverPropertyCollection coll = new SQLDriverPropertyCollection();</span>
<span class="nc" id="L435">      coll.setDriverProperties(newar);</span>
<span class="nc" id="L436">      return coll;</span>
   }

   public synchronized void setDriverProperties(SQLDriverPropertyCollection value)
   {
<span class="nc" id="L441">      _driverProps.clear();</span>
<span class="nc bnc" id="L442" title="All 2 branches missed.">      if (value != null)</span>
      {
<span class="nc" id="L444">         synchronized (value)</span>
         {
<span class="nc" id="L446">            final int count = value.size();</span>
<span class="nc" id="L447">            SQLDriverProperty[] newar = new SQLDriverProperty[count];</span>
<span class="nc bnc" id="L448" title="All 2 branches missed.">            for (int i = 0; i &lt; count; ++i)</span>
            {
<span class="nc" id="L450">               newar[i] = (SQLDriverProperty)value.getDriverProperty(i).clone();</span>

            }
<span class="nc" id="L453">            _driverProps.setDriverProperties(newar);</span>
<span class="nc" id="L454">         }</span>
      }
<span class="nc" id="L456">   }</span>

   private synchronized PropertyChangeReporter getPropertyChangeReporter()
   {
<span class="nc bnc" id="L460" title="All 2 branches missed.">      if (_propChgReporter == null)</span>
      {
<span class="nc" id="L462">         _propChgReporter = new PropertyChangeReporter(this);</span>
      }
<span class="nc" id="L464">      return _propChgReporter;</span>
   }

   private String getString(String data)
   {
<span class="nc bnc" id="L469" title="All 2 branches missed.">      return data != null ? data.trim() : &quot;&quot;;</span>
   }


   public SQLAliasSchemaProperties getSchemaProperties()
   {
<span class="nc" id="L475">      return _schemaProperties;      </span>
   }

   /**
    * @see net.sourceforge.squirrel_sql.client.gui.db.ISQLAliasExt#setSchemaProperties(net.sourceforge.squirrel_sql.client.gui.db.SQLAliasSchemaProperties)
    */
   public void setSchemaProperties(SQLAliasSchemaProperties schemaProperties)
   {
<span class="nc" id="L483">      _schemaProperties = schemaProperties;</span>
<span class="nc" id="L484">   }</span>

	@Override
	public SQLAliasColorProperties getColorProperties()
	{
<span class="nc" id="L489">		return _colorProperties;</span>
	}

	@Override
	public void setColorProperties(SQLAliasColorProperties colorProperties)
	{
<span class="nc" id="L495">		_colorProperties = colorProperties;</span>
<span class="nc" id="L496">	}</span>

	@Override
	public SQLAliasConnectionProperties getConnectionProperties()
	{
<span class="nc" id="L501">		return _connectionProperties;</span>
	}

	@Override
	public void setConnectionProperties(SQLAliasConnectionProperties connectionProperties)
	{
<span class="nc" id="L507">		_connectionProperties = connectionProperties;</span>
<span class="nc" id="L508">	}</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>