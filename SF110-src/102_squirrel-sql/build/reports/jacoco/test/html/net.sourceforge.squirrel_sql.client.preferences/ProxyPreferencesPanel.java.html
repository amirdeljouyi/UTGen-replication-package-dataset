<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ProxyPreferencesPanel.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">102_squirrel-sql</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.squirrel_sql.client.preferences</a> &gt; <span class="el_source">ProxyPreferencesPanel.java</span></div><h1>ProxyPreferencesPanel.java</h1><pre class="source lang-java linenums">package net.sourceforge.squirrel_sql.client.preferences;
/*
 * Copyright (C) 2002-2003 Colin Bell
 * colbell@users.sourceforge.net
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */
import java.awt.Component;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.Insets;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.BorderFactory;
import javax.swing.JCheckBox;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JPasswordField;
import javax.swing.JTextField;

import net.sourceforge.squirrel_sql.client.IApplication;
import net.sourceforge.squirrel_sql.fw.gui.MultipleLineLabel;
import net.sourceforge.squirrel_sql.fw.util.IProxySettings;
import net.sourceforge.squirrel_sql.fw.util.ProxySettings;
import net.sourceforge.squirrel_sql.fw.util.StringManager;
import net.sourceforge.squirrel_sql.fw.util.StringManagerFactory;

class ProxyPreferencesPanel implements IGlobalPreferencesPanel
{
	/** Internationalized strings for this class. */
<span class="nc" id="L44">	private static final StringManager s_stringMgr =</span>
<span class="nc" id="L45">		StringManagerFactory.getStringManager(ProxyPreferencesPanel.class);</span>

	/** Panel to be displayed in preferences dialog. */
	private MyPanel _myPanel;

	/** Application API. */
	private IApplication _app;

	/**
	 * Default ctor.
	 */
	public ProxyPreferencesPanel()
	{
<span class="nc" id="L58">		super();</span>
<span class="nc" id="L59">	}</span>

	public void initialize(IApplication app)
	{
<span class="nc bnc" id="L63" title="All 2 branches missed.">		if (app == null)</span>
		{
<span class="nc" id="L65">			throw new IllegalArgumentException(&quot;Null IApplication passed&quot;);</span>
		}

<span class="nc" id="L68">		_app = app;</span>

<span class="nc" id="L70">		((MyPanel)getPanelComponent()).loadData(_app, _app.getSquirrelPreferences());</span>
<span class="nc" id="L71">	}</span>

   public void uninitialize(IApplication app)
   {
      
<span class="nc" id="L76">   }</span>

   public synchronized Component getPanelComponent()
	{
<span class="nc bnc" id="L80" title="All 2 branches missed.">		if (_myPanel == null)</span>
		{
<span class="nc" id="L82">			_myPanel = new MyPanel();</span>
		}
<span class="nc" id="L84">		return _myPanel;</span>
	}

	public void applyChanges()
	{
<span class="nc" id="L89">		_myPanel.applyChanges(_app.getSquirrelPreferences());</span>
<span class="nc" id="L90">	}</span>

	public String getTitle()
	{
<span class="nc" id="L94">		return s_stringMgr.getString(&quot;ProxyPreferencesPanel.title&quot;);</span>
	}

	public String getHint()
	{
<span class="nc" id="L99">		return s_stringMgr.getString(&quot;ProxyPreferencesPanel.hint&quot;);</span>
	}

	private static final class MyPanel extends JPanel
	{
		private static final long serialVersionUID = 1L;
<span class="nc" id="L105">		private JCheckBox _httpUseProxyChk = new JCheckBox(s_stringMgr.getString(&quot;ProxyPreferencesPanel.useproxy&quot;));</span>
<span class="nc" id="L106">		private JLabel _httpProxyServerLabel = </span>
<span class="nc" id="L107">			new JLabel(s_stringMgr.getString(&quot;ProxyPreferencesPanel.server&quot;), JLabel.RIGHT);</span>
<span class="nc" id="L108">		private JTextField _httpProxyServer = new JTextField();</span>
<span class="nc" id="L109">		private JLabel _httpProxyPortLabel = </span>
<span class="nc" id="L110">			new JLabel(s_stringMgr.getString(&quot;ProxyPreferencesPanel.port&quot;), JLabel.RIGHT);</span>
<span class="nc" id="L111">		private JTextField _httpProxyPort = new JTextField();</span>
<span class="nc" id="L112">		private JLabel _httpProxyUserLabel = </span>
<span class="nc" id="L113">			new JLabel(s_stringMgr.getString(&quot;ProxyPreferencesPanel.user&quot;), JLabel.RIGHT);</span>
<span class="nc" id="L114">		private JTextField _httpProxyUser = new JTextField();</span>
<span class="nc" id="L115">		private JLabel _httpProxyPasswordLabel = </span>
<span class="nc" id="L116">			new JLabel(s_stringMgr.getString(&quot;ProxyPreferencesPanel.password&quot;), JLabel.RIGHT);		</span>
<span class="nc" id="L117">		private JPasswordField _httpProxyPassword = new JPasswordField();</span>
<span class="nc" id="L118">		private JLabel _httpNonProxyHostsLabel = </span>
<span class="nc" id="L119">			new JLabel(s_stringMgr.getString(&quot;ProxyPreferencesPanel.noproxyfor&quot;), JLabel.RIGHT);</span>
<span class="nc" id="L120">		private JTextField _httpNonProxyHosts = new JTextField();</span>
<span class="nc" id="L121">		private JCheckBox _socksUseProxyChk = new JCheckBox(s_stringMgr.getString(&quot;ProxyPreferencesPanel.useproxy&quot;));</span>
<span class="nc" id="L122">		private JLabel _socksProxyServerLabel = </span>
<span class="nc" id="L123">			new JLabel(s_stringMgr.getString(&quot;ProxyPreferencesPanel.server&quot;), JLabel.RIGHT);</span>
<span class="nc" id="L124">		private JTextField _socksProxyServer = new JTextField();</span>
<span class="nc" id="L125">		private JLabel _socksProxyPortLabel = </span>
<span class="nc" id="L126">			new JLabel(s_stringMgr.getString(&quot;ProxyPreferencesPanel.port&quot;), JLabel.RIGHT);</span>
<span class="nc" id="L127">		private JTextField _socksProxyPort = new JTextField();</span>
		

		MyPanel()
		{
<span class="nc" id="L132">			super(new GridBagLayout());</span>
<span class="nc" id="L133">			createUserInterface();</span>
<span class="nc" id="L134">		}</span>

		void loadData(IApplication app, SquirrelPreferences prefs)
		{
<span class="nc" id="L138">			final IProxySettings proxySettings = prefs.getProxySettings();</span>

<span class="nc" id="L140">			_httpUseProxyChk.setSelected(proxySettings.getHttpUseProxy());</span>
<span class="nc" id="L141">			_httpProxyServer.setText(proxySettings.getHttpProxyServer());</span>
<span class="nc" id="L142">			_httpProxyPort.setText(proxySettings.getHttpProxyPort());</span>
<span class="nc" id="L143">			_httpNonProxyHosts.setText(proxySettings.getHttpNonProxyHosts());</span>
<span class="nc" id="L144">			_httpProxyUser.setText(proxySettings.getHttpProxyUser());</span>
<span class="nc" id="L145">			_httpProxyPassword.setText(proxySettings.getHttpProxyPassword());</span>

<span class="nc" id="L147">			_socksUseProxyChk.setSelected(proxySettings.getSocksUseProxy());</span>
<span class="nc" id="L148">			_socksProxyServer.setText(proxySettings.getSocksProxyServer());</span>
<span class="nc" id="L149">			_socksProxyPort.setText(proxySettings.getSocksProxyPort());</span>

<span class="nc" id="L151">			updateControlStatus();</span>
<span class="nc" id="L152">		}</span>

		void applyChanges(SquirrelPreferences prefs)
		{
<span class="nc" id="L156">			final ProxySettings proxySettings = new ProxySettings();</span>

<span class="nc" id="L158">			proxySettings.setHttpUseProxy(_httpUseProxyChk.isSelected());</span>
<span class="nc" id="L159">			proxySettings.setHttpProxyServer(_httpProxyServer.getText());</span>
<span class="nc" id="L160">			proxySettings.setHttpProxyPort(_httpProxyPort.getText());</span>
<span class="nc" id="L161">			proxySettings.setHttpNonProxyHosts(_httpNonProxyHosts.getText());</span>
<span class="nc" id="L162">			proxySettings.setHttpProxyUser(_httpProxyUser.getText());</span>

<span class="nc" id="L164">			String password = new String(_httpProxyPassword.getPassword());</span>
<span class="nc" id="L165">			proxySettings.setHttpProxyPassword(password);</span>

<span class="nc" id="L167">			proxySettings.setSocksUseProxy(_socksUseProxyChk.isSelected());</span>
<span class="nc" id="L168">			proxySettings.setSocksProxyServer(_socksProxyServer.getText());</span>
<span class="nc" id="L169">			proxySettings.setSocksProxyPort(_socksProxyPort.getText());</span>

<span class="nc" id="L171">			prefs.setProxySettings(proxySettings);</span>
<span class="nc" id="L172">		}</span>

		private void updateControlStatus()
		{
<span class="nc" id="L176">			final boolean http = _httpUseProxyChk.isSelected();</span>
<span class="nc" id="L177">			_httpProxyServerLabel.setEnabled(http);</span>
<span class="nc" id="L178">			_httpProxyServer.setEnabled(http);</span>
<span class="nc" id="L179">			_httpProxyPortLabel.setEnabled(http);</span>
<span class="nc" id="L180">			_httpProxyPort.setEnabled(http);</span>
<span class="nc" id="L181">			_httpNonProxyHostsLabel.setEnabled(http);</span>
<span class="nc" id="L182">			_httpNonProxyHosts.setEnabled(http);</span>
<span class="nc" id="L183">			_httpProxyUserLabel.setEnabled(http);</span>
<span class="nc" id="L184">			_httpProxyUser.setEnabled(http);</span>
<span class="nc" id="L185">			_httpProxyPasswordLabel.setEnabled(http);</span>
<span class="nc" id="L186">			_httpProxyPassword.setEnabled(http);</span>

<span class="nc" id="L188">			final boolean socks = _socksUseProxyChk.isSelected();</span>
<span class="nc" id="L189">			_socksProxyServerLabel.setEnabled(socks);</span>
<span class="nc" id="L190">			_socksProxyServer.setEnabled(socks);</span>
<span class="nc" id="L191">			_socksProxyPortLabel.setEnabled(socks);</span>
<span class="nc" id="L192">			_socksProxyPort.setEnabled(socks);</span>
<span class="nc" id="L193">		}</span>

		private void createUserInterface()
		{
<span class="nc" id="L197">			final GridBagConstraints gbc = new GridBagConstraints();</span>
<span class="nc" id="L198">			gbc.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L199">			gbc.insets = new Insets(4, 4, 4, 4);</span>
<span class="nc" id="L200">			gbc.gridx = 0;</span>
<span class="nc" id="L201">			gbc.gridy = 0;</span>
<span class="nc" id="L202">			gbc.weightx = 1;</span>
<span class="nc" id="L203">			add(createHTTPPanel(), gbc);</span>
<span class="nc" id="L204">			++gbc.gridy;</span>
<span class="nc" id="L205">			add(createSOCKSPanel(), gbc);</span>

<span class="nc" id="L207">			final ActionListener lis = new MyActionHandler();</span>
<span class="nc" id="L208">			_httpUseProxyChk.addActionListener(lis);</span>
<span class="nc" id="L209">			_socksUseProxyChk.addActionListener(lis);</span>
<span class="nc" id="L210">		}</span>

		private JPanel createHTTPPanel()
		{

<span class="nc" id="L215">			JPanel pnl = new JPanel(new GridBagLayout());</span>
<span class="nc" id="L216">			pnl.setBorder(BorderFactory.createTitledBorder(s_stringMgr.getString(&quot;ProxyPreferencesPanel.httpproxy&quot;)));</span>

<span class="nc" id="L218">			final GridBagConstraints gbc = new GridBagConstraints();</span>
<span class="nc" id="L219">			gbc.anchor = GridBagConstraints.WEST;</span>
<span class="nc" id="L220">			gbc.insets = new Insets(4, 4, 4, 4);</span>
<span class="nc" id="L221">			gbc.gridx = 0;</span>
<span class="nc" id="L222">			gbc.gridy = 0;</span>
<span class="nc" id="L223">			pnl.add(_httpUseProxyChk, gbc);</span>

<span class="nc" id="L225">			gbc.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L226">			++gbc.gridx;</span>
<span class="nc" id="L227">			pnl.add(_httpProxyServerLabel, gbc);</span>
			
<span class="nc" id="L229">			++gbc.gridy;		</span>
<span class="nc" id="L230">			pnl.add(_httpProxyPortLabel, gbc);</span>

<span class="nc" id="L232">			++gbc.gridy;</span>
<span class="nc" id="L233">			pnl.add(_httpProxyUserLabel, gbc);</span>

<span class="nc" id="L235">			++gbc.gridy;</span>
<span class="nc" id="L236">			pnl.add(_httpProxyPasswordLabel, gbc);</span>

<span class="nc" id="L238">			++gbc.gridy;</span>
<span class="nc" id="L239">			pnl.add(_httpNonProxyHostsLabel, gbc);</span>

<span class="nc" id="L241">			++gbc.gridy;</span>
<span class="nc" id="L242">			--gbc.gridx;</span>
<span class="nc" id="L243">			gbc.gridwidth = GridBagConstraints.REMAINDER;</span>
<span class="nc" id="L244">			pnl.add(new MultipleLineLabel(s_stringMgr.getString(&quot;ProxyPreferencesPane.notes&quot;)), gbc);</span>
<span class="nc" id="L245">			gbc.gridwidth = 1;</span>
<span class="nc" id="L246">			++gbc.gridx;</span>

<span class="nc" id="L248">			++gbc.gridx;</span>
<span class="nc" id="L249">			gbc.gridy = 0;</span>
<span class="nc" id="L250">			gbc.weightx = 1;</span>
<span class="nc" id="L251">			pnl.add(_httpProxyServer, gbc);</span>

<span class="nc" id="L253">			++gbc.gridy;</span>
<span class="nc" id="L254">			pnl.add(_httpProxyPort, gbc);</span>

<span class="nc" id="L256">			++gbc.gridy;</span>
<span class="nc" id="L257">			pnl.add(_httpProxyUser, gbc);</span>

<span class="nc" id="L259">			++gbc.gridy;</span>
<span class="nc" id="L260">			pnl.add(_httpProxyPassword, gbc);</span>

<span class="nc" id="L262">			++gbc.gridy;</span>
<span class="nc" id="L263">			pnl.add(_httpNonProxyHosts, gbc);</span>

<span class="nc" id="L265">			return pnl;</span>
		}

		private JPanel createSOCKSPanel()
		{
<span class="nc" id="L270">			JPanel pnl = new JPanel(new GridBagLayout());</span>
<span class="nc" id="L271">			pnl.setBorder(BorderFactory.createTitledBorder(s_stringMgr.getString(&quot;ProxyPreferencesPanel.socksproxy&quot;)));</span>

<span class="nc" id="L273">			final GridBagConstraints gbc = new GridBagConstraints();</span>
<span class="nc" id="L274">			gbc.anchor = GridBagConstraints.WEST;</span>
<span class="nc" id="L275">			gbc.insets = new Insets(4, 4, 4, 4);</span>
<span class="nc" id="L276">			gbc.gridx = 0;</span>
<span class="nc" id="L277">			gbc.gridy = 0;</span>
<span class="nc" id="L278">			pnl.add(_socksUseProxyChk, gbc);</span>

<span class="nc" id="L280">			gbc.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L281">			++gbc.gridx;		</span>
<span class="nc" id="L282">			pnl.add(_socksProxyServerLabel, gbc);</span>

<span class="nc" id="L284">			++gbc.gridy;</span>
<span class="nc" id="L285">			pnl.add(_socksProxyPortLabel, gbc);</span>

<span class="nc" id="L287">			++gbc.gridx;</span>
<span class="nc" id="L288">			gbc.gridy = 0;</span>
<span class="nc" id="L289">			gbc.weightx = 1;</span>
<span class="nc" id="L290">			pnl.add(_socksProxyServer, gbc);</span>

<span class="nc" id="L292">			++gbc.gridy;</span>
<span class="nc" id="L293">			pnl.add(_socksProxyPort, gbc);</span>

<span class="nc" id="L295">			return pnl;</span>
		}

<span class="nc" id="L298">		private final class MyActionHandler implements ActionListener</span>
		{
			public void actionPerformed(ActionEvent evt)
			{
<span class="nc" id="L302">				updateControlStatus();</span>
<span class="nc" id="L303">			}</span>
		}
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>