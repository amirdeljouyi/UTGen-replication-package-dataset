<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SQLPreferencesPanel.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">102_squirrel-sql</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.squirrel_sql.client.preferences</a> &gt; <span class="el_source">SQLPreferencesPanel.java</span></div><h1>SQLPreferencesPanel.java</h1><pre class="source lang-java linenums">package net.sourceforge.squirrel_sql.client.preferences;
/*
 * Copyright (C) 2001-2003 Colin Bell
 * colbell@users.sourceforge.net
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */
import java.awt.Component;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.Insets;
import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;

import javax.swing.*;

import net.sourceforge.squirrel_sql.fw.gui.IntegerField;
import net.sourceforge.squirrel_sql.fw.gui.OutputLabel;
import net.sourceforge.squirrel_sql.fw.util.StringManager;
import net.sourceforge.squirrel_sql.fw.util.StringManagerFactory;

import net.sourceforge.squirrel_sql.client.IApplication;
import net.sourceforge.squirrel_sql.client.gui.mainframe.MainFrame;
import net.sourceforge.squirrel_sql.client.util.ApplicationFiles;
/**
 * This preferences panel allows maintenance of SQL preferences.
 * @author &lt;A HREF=&quot;mailto:colbell@users.sourceforge.net&quot;&gt;Colin Bell&lt;/A&gt;
 */
public class SQLPreferencesPanel implements IGlobalPreferencesPanel
{
	/** Internationalized strings for this class. */
<span class="nc" id="L44">	private static final StringManager s_stringMgr =</span>
<span class="nc" id="L45">		StringManagerFactory.getStringManager(SQLPreferencesPanel.class);</span>

	/** Panel to be displayed in preferences dialog. */
	private SQLPrefsPanel _myPanel;
   private JScrollPane _myScrollPane;

   /** Application API. */
	private IApplication _app;
   private MainFrame _mainFrame;
   
   /**
	 * Default ctor.
    * @param mainFrame
    */
	public SQLPreferencesPanel(MainFrame mainFrame)
	{
<span class="nc" id="L61">		super();</span>
<span class="nc" id="L62">      _mainFrame = mainFrame;</span>
<span class="nc" id="L63">   }</span>

	/**
	 * Initialize this panel. Called prior to it being displayed.
	 *
	 * @param	app	Application API.
	 *
	 * @throws	IllegalArgumentException
	 * 			if &lt;TT&gt;null&lt;/TT&gt; &lt;TT&gt;IApplication&lt;/TT&gt; passed.
	 */
	public void initialize(IApplication app)
	{
<span class="nc bnc" id="L75" title="All 2 branches missed.">		if (app == null)</span>
		{
<span class="nc" id="L77">			throw new IllegalArgumentException(&quot;Null IApplication passed&quot;);</span>
		}

<span class="nc" id="L80">		_app = app;</span>

<span class="nc" id="L82">		getPanelComponent();</span>
<span class="nc" id="L83">		_myPanel.loadData(_app, _app.getSquirrelPreferences());</span>

<span class="nc" id="L85">      _myPanel._fileOpenInPreviousDir.addActionListener(new ActionListener()</span>
<span class="nc" id="L86">      {</span>
         public void actionPerformed(ActionEvent e)
         {
<span class="nc" id="L89">            updateFilePanel(_myPanel);</span>
<span class="nc" id="L90">         }</span>
      });

<span class="nc" id="L93">      _myPanel._fileOpenInSpecifiedDir.addActionListener(new ActionListener()</span>
<span class="nc" id="L94">      {</span>
         public void actionPerformed(ActionEvent e)
         {
<span class="nc" id="L97">            updateFilePanel(_myPanel);</span>
<span class="nc" id="L98">         }</span>
      });

<span class="nc" id="L101">      updateFilePanel(_myPanel);</span>


<span class="nc" id="L104">      _myPanel._fileChooseDir.addActionListener(new ActionListener()</span>
<span class="nc" id="L105">      {</span>
         public void actionPerformed(ActionEvent e)
         {
<span class="nc" id="L108">            onChooseDir(_myPanel);</span>
<span class="nc" id="L109">         }</span>
      });

<span class="nc" id="L112">	}</span>

   public void uninitialize(IApplication app)
   {
      
<span class="nc" id="L117">   }</span>


   public void onChooseDir(SQLPrefsPanel pnl)
   {
<span class="nc" id="L122">      JFileChooser chooser = new JFileChooser(pnl._fileSpecifiedDir.getText());</span>
<span class="nc" id="L123">      chooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);</span>
<span class="nc" id="L124">      int returnVal = chooser.showOpenDialog(_mainFrame);</span>
<span class="nc bnc" id="L125" title="All 2 branches missed.">      if (returnVal == JFileChooser.APPROVE_OPTION)</span>
      {
<span class="nc" id="L127">         pnl._fileSpecifiedDir.setText(chooser.getSelectedFile().getAbsolutePath());</span>
      }
<span class="nc" id="L129">   }</span>


   private void updateFilePanel(SQLPrefsPanel pnl)
   {
<span class="nc" id="L134">      pnl._fileChooseDir.setEnabled(pnl._fileOpenInSpecifiedDir.isSelected());</span>
<span class="nc" id="L135">      pnl._fileSpecifiedDir.setEnabled(pnl._fileOpenInSpecifiedDir.isSelected());</span>
<span class="nc" id="L136">   }</span>

   public synchronized Component getPanelComponent()
	{
<span class="nc bnc" id="L140" title="All 2 branches missed.">		if (_myPanel == null)</span>
		{
<span class="nc" id="L142">			_myPanel = new SQLPrefsPanel();</span>
<span class="nc" id="L143">			_myScrollPane = new JScrollPane(_myPanel);</span>
		}
<span class="nc" id="L145">		return _myScrollPane;</span>
	}

	public void applyChanges()
	{
<span class="nc" id="L150">		_myPanel.applyChanges(_app.getSquirrelPreferences());</span>
<span class="nc" id="L151">	}</span>

	public String getTitle()
	{
<span class="nc" id="L155">		return s_stringMgr.getString(&quot;SQLPreferencesPanel.title&quot;);</span>
	}

	public String getHint()
	{
<span class="nc" id="L160">		return s_stringMgr.getString(&quot;SQLPreferencesPanel.hint&quot;);</span>
	}

	private static final class SQLPrefsPanel extends JPanel
	{

<span class="nc" id="L166">		private IntegerField _loginTimeout = new IntegerField();</span>
<span class="nc" id="L167">        private IntegerField _largeScriptStmtCount = new IntegerField();</span>
//		private JCheckBox _debugJdbc = new JCheckBox(s_stringMgr.getString(&quot;SQLPreferencesPanel.jdbcdebug&quot;));
<span class="nc" id="L169">		private JRadioButton _debugJdbcDont = new JRadioButton(s_stringMgr.getString(&quot;SQLPreferencesPanel.jdbcdebugdont&quot;));</span>
<span class="nc" id="L170">		private JRadioButton _debugJdbcStream = new JRadioButton(s_stringMgr.getString(&quot;SQLPreferencesPanel.jdbcdebugstream&quot;));</span>
<span class="nc" id="L171">		private JRadioButton _debugJdbcWriter = new JRadioButton(s_stringMgr.getString(&quot;SQLPreferencesPanel.jdbcdebugwriter&quot;));</span>
<span class="nc" id="L172">		private JLabel _jdbcDebugLogFileNameLbl = new OutputLabel(&quot; &quot;);</span>
<span class="nc" id="L173">      private JRadioButton _fileOpenInPreviousDir = new JRadioButton(s_stringMgr.getString(&quot;SQLPreferencesPanel.fileOpenInPreviousDir&quot;));</span>
<span class="nc" id="L174">      private JRadioButton _fileOpenInSpecifiedDir = new JRadioButton(s_stringMgr.getString(&quot;SQLPreferencesPanel.fileOpenInSpecifiedDir&quot;));;</span>
<span class="nc" id="L175">      private JTextField _fileSpecifiedDir = new JTextField();</span>
<span class="nc" id="L176">      private JButton _fileChooseDir = new JButton(&quot;...&quot;);</span>

      SQLPrefsPanel()
		{
<span class="nc" id="L180">			super(new GridBagLayout());</span>
<span class="nc" id="L181">			createUserInterface();</span>
<span class="nc" id="L182">		}</span>

		void loadData(IApplication app, SquirrelPreferences prefs)
		{
<span class="nc" id="L186">			final ApplicationFiles appFiles = new ApplicationFiles();</span>
<span class="nc" id="L187">			_loginTimeout.setInt(prefs.getLoginTimeout());</span>
<span class="nc" id="L188">            _largeScriptStmtCount.setInt(prefs.getLargeScriptStmtCount());</span>
<span class="nc" id="L189">			_debugJdbcStream.setSelected(prefs.isJdbcDebugToStream());</span>
<span class="nc" id="L190">			_debugJdbcWriter.setSelected(prefs.isJdbcDebugToWriter());</span>
<span class="nc" id="L191">			_debugJdbcDont.setSelected(prefs.isJdbcDebugDontDebug());</span>
<span class="nc" id="L192">			_jdbcDebugLogFileNameLbl.setText(appFiles.getJDBCDebugLogFile().getPath());</span>
<span class="nc" id="L193">         _fileOpenInPreviousDir.setSelected(prefs.isFileOpenInPreviousDir());</span>
<span class="nc" id="L194">         _fileOpenInSpecifiedDir.setSelected(prefs.isFileOpenInSpecifiedDir());</span>
<span class="nc" id="L195">         _fileSpecifiedDir.setText(prefs.getFileSpecifiedDir());</span>
<span class="nc" id="L196">		}</span>

		void applyChanges(SquirrelPreferences prefs)
		{
<span class="nc" id="L200">			prefs.setLoginTimeout(_loginTimeout.getInt());</span>
<span class="nc" id="L201">            prefs.setLargeScriptStmtCount(_largeScriptStmtCount.getInt());</span>
<span class="nc bnc" id="L202" title="All 2 branches missed.">			if (_debugJdbcStream.isSelected())</span>
			{
<span class="nc" id="L204">				prefs.doJdbcDebugToStream();</span>
			}
<span class="nc bnc" id="L206" title="All 2 branches missed.">			else if (_debugJdbcWriter.isSelected())</span>
			{
<span class="nc" id="L208">				prefs.doJdbcDebugToWriter();</span>
			}
			else
			{
<span class="nc" id="L212">				prefs.dontDoJdbcDebug();</span>
			}

<span class="nc" id="L215">         prefs.setFileOpenInPreviousDir(_fileOpenInPreviousDir.isSelected());</span>
<span class="nc" id="L216">         prefs.setFileOpenInSpecifiedDir(_fileOpenInSpecifiedDir.isSelected());</span>
<span class="nc" id="L217">         String specDir = _fileSpecifiedDir.getText();</span>
<span class="nc bnc" id="L218" title="All 2 branches missed.">         prefs.setFileSpecifiedDir(null == specDir ? &quot;&quot; : specDir);</span>


<span class="nc" id="L221">		}</span>

		private void createUserInterface()
		{
<span class="nc" id="L225">			final GridBagConstraints gbc = new GridBagConstraints();</span>
<span class="nc" id="L226">			gbc.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L227">			gbc.insets = new Insets(4, 4, 4, 4);</span>
<span class="nc" id="L228">			gbc.gridx = 0;</span>
<span class="nc" id="L229">			gbc.gridy = 0;</span>
<span class="nc" id="L230">			gbc.weightx = 1;</span>
<span class="nc" id="L231">			add(createGeneralPanel(), gbc);</span>
<span class="nc" id="L232">			++gbc.gridy;</span>
<span class="nc" id="L233">			add(createDebugPanel(), gbc);</span>
<span class="nc" id="L234">         ++gbc.gridy;</span>
<span class="nc" id="L235">         add(createFilePanel(), gbc);</span>
<span class="nc" id="L236">		}</span>

      private JPanel createGeneralPanel()
		{
<span class="nc" id="L240">			JPanel pnl = new JPanel(new GridBagLayout());</span>
<span class="nc" id="L241">			pnl.setBorder(BorderFactory.createTitledBorder(s_stringMgr.getString(&quot;SQLPreferencesPanel.general&quot;)));</span>

<span class="nc" id="L243">			_loginTimeout.setColumns(4);</span>

<span class="nc" id="L245">			GridBagConstraints gbc = new GridBagConstraints();</span>
<span class="nc" id="L246">			gbc.anchor = GridBagConstraints.WEST;</span>
<span class="nc" id="L247">			gbc.fill = GridBagConstraints.NONE;</span>
<span class="nc" id="L248">			gbc.insets = new Insets(4, 4, 4, 4);</span>

<span class="nc" id="L250">			gbc.gridx = 0;</span>
<span class="nc" id="L251">			gbc.gridy = 0;</span>
<span class="nc" id="L252">			pnl.add(new JLabel(s_stringMgr.getString(&quot;SQLPreferencesPanel.logintimeout&quot;)), gbc);</span>

<span class="nc" id="L254">			++gbc.gridx;</span>
<span class="nc" id="L255">			pnl.add(_loginTimeout, gbc);</span>

<span class="nc" id="L257">			++gbc.gridx;</span>
<span class="nc" id="L258">			gbc.weightx = 1;</span>
<span class="nc" id="L259">			pnl.add(new JLabel(s_stringMgr.getString(&quot;SQLPreferencesPanel.zerounlimited&quot;)), gbc);</span>

<span class="nc" id="L261">            _largeScriptStmtCount.setColumns(4);</span>
            
<span class="nc" id="L263">            gbc = new GridBagConstraints();</span>
<span class="nc" id="L264">            gbc.anchor = GridBagConstraints.WEST;</span>
<span class="nc" id="L265">            gbc.fill = GridBagConstraints.NONE;</span>
<span class="nc" id="L266">            gbc.insets = new Insets(4, 4, 4, 4);</span>

<span class="nc" id="L268">            gbc.gridx = 0;</span>
<span class="nc" id="L269">            gbc.gridy = 1;</span>
            // i18n[SQLPreferencesPanel.largeScriptStmtCount=Large Script Statement Count: ]
<span class="nc" id="L271">            pnl.add(new JLabel(s_stringMgr.getString(&quot;SQLPreferencesPanel.largeScriptStmtCount&quot;)), gbc);</span>
            
<span class="nc" id="L273">            ++gbc.gridx;</span>
<span class="nc" id="L274">            pnl.add(_largeScriptStmtCount, gbc);</span>
            
<span class="nc" id="L276">			return pnl;</span>
		}

		private JPanel createDebugPanel()
		{
<span class="nc" id="L281">			final ButtonGroup btnGroup = new ButtonGroup();</span>
<span class="nc" id="L282">			btnGroup.add(_debugJdbcDont);</span>
<span class="nc" id="L283">			btnGroup.add(_debugJdbcStream);</span>
<span class="nc" id="L284">			btnGroup.add(_debugJdbcWriter);</span>

<span class="nc" id="L286">			JPanel pnl = new JPanel(new GridBagLayout());</span>
<span class="nc" id="L287">			pnl.setBorder(BorderFactory.createTitledBorder(s_stringMgr.getString(&quot;SQLPreferencesPanel.debug&quot;)));</span>

<span class="nc" id="L289">			final GridBagConstraints gbc = new GridBagConstraints();</span>
<span class="nc" id="L290">			gbc.anchor = GridBagConstraints.WEST;</span>
<span class="nc" id="L291">			gbc.insets = new Insets(4, 4, 4, 4);</span>

<span class="nc" id="L293">			gbc.gridx = 0;</span>
<span class="nc" id="L294">			gbc.gridy = 0;</span>
<span class="nc" id="L295">			gbc.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L296">			gbc.gridx = 0;</span>
<span class="nc" id="L297">			++gbc.gridy;</span>
<span class="nc" id="L298">			gbc.gridwidth = GridBagConstraints.REMAINDER;</span>
<span class="nc" id="L299">			pnl.add(_debugJdbcDont, gbc);</span>

<span class="nc" id="L301">			++gbc.gridy;</span>
<span class="nc" id="L302">			pnl.add(_debugJdbcStream, gbc);</span>

<span class="nc" id="L304">			++gbc.gridy;</span>
<span class="nc" id="L305">			pnl.add(_debugJdbcWriter, gbc);</span>

<span class="nc" id="L307">			gbc.gridx = 0;</span>
<span class="nc" id="L308">			++gbc.gridy;</span>
<span class="nc" id="L309">			gbc.gridwidth = 1;</span>
<span class="nc" id="L310">			pnl.add(new JLabel(s_stringMgr.getString(&quot;SQLPreferencesPanel.jdbcdebugfile&quot;), SwingConstants.RIGHT), gbc);</span>

<span class="nc" id="L312">			++gbc.gridx;</span>
<span class="nc" id="L313">			gbc.weightx = 1;</span>
<span class="nc" id="L314">			gbc.gridwidth = GridBagConstraints.REMAINDER;</span>
<span class="nc" id="L315">			pnl.add(_jdbcDebugLogFileNameLbl, gbc);</span>

<span class="nc" id="L317">			return pnl;</span>
		}

      private Component createFilePanel()
      {
<span class="nc" id="L322">         final ButtonGroup btnGroup = new ButtonGroup();</span>
<span class="nc" id="L323">         btnGroup.add(_fileOpenInPreviousDir);</span>
<span class="nc" id="L324">         btnGroup.add(_fileOpenInSpecifiedDir);</span>

<span class="nc" id="L326">         JPanel pnl = new JPanel(new GridBagLayout());</span>
<span class="nc" id="L327">         pnl.setBorder(BorderFactory.createTitledBorder(s_stringMgr.getString(&quot;SQLPreferencesPanel.file&quot;)));</span>

         GridBagConstraints gbc;

<span class="nc" id="L331">         gbc = new GridBagConstraints(0,0,1,1,0,0,GridBagConstraints.NORTHWEST, GridBagConstraints.NONE, new Insets(5,5,5,5),0,0);</span>
<span class="nc" id="L332">         pnl.add(_fileOpenInPreviousDir, gbc);</span>

<span class="nc" id="L334">         gbc = new GridBagConstraints(1,0,2,1,1,0,GridBagConstraints.NORTHWEST, GridBagConstraints.HORIZONTAL, new Insets(5,5,5,5),0,0);</span>
<span class="nc" id="L335">         pnl.add(new JPanel(), gbc);</span>


<span class="nc" id="L338">         gbc = new GridBagConstraints(0,1,1,1,0,0,GridBagConstraints.NORTHWEST, GridBagConstraints.NONE, new Insets(0,5,5,5),0,0);</span>
<span class="nc" id="L339">         pnl.add(_fileOpenInSpecifiedDir, gbc);</span>

<span class="nc" id="L341">         gbc = new GridBagConstraints(1,1,1,1,1,0,GridBagConstraints.NORTHWEST, GridBagConstraints.HORIZONTAL, new Insets(0,5,5,5),0,0);</span>
<span class="nc" id="L342">         pnl.add(_fileSpecifiedDir, gbc);</span>

<span class="nc" id="L344">         gbc = new GridBagConstraints(2,1,1,1,0,0,GridBagConstraints.NORTHWEST, GridBagConstraints.NONE, new Insets(0,5,5,5),0,0);</span>
<span class="nc" id="L345">         pnl.add(_fileChooseDir, gbc);</span>

<span class="nc" id="L347">         return pnl;</span>

      }


	}
}

</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>