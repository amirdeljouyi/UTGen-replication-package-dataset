<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DialectFactory.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">102_squirrel-sql</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.squirrel_sql.fw.dialects</a> &gt; <span class="el_source">DialectFactory.java</span></div><h1>DialectFactory.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2006 Rob Manning
 * manningr@users.sourceforge.net
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */
package net.sourceforge.squirrel_sql.fw.dialects;

import java.io.PrintWriter;
import java.io.StringWriter;
import java.util.Arrays;
import java.util.Collection;
import java.util.HashMap;
import java.util.Set;

import javax.swing.JFrame;
import javax.swing.JOptionPane;

import net.sourceforge.squirrel_sql.fw.gui.DialogUtils;
import net.sourceforge.squirrel_sql.fw.gui.IDialogUtils;
import net.sourceforge.squirrel_sql.fw.sql.ISQLDatabaseMetaData;
import net.sourceforge.squirrel_sql.fw.util.StringManager;
import net.sourceforge.squirrel_sql.fw.util.StringManagerFactory;
import net.sourceforge.squirrel_sql.fw.util.log.ILogger;
import net.sourceforge.squirrel_sql.fw.util.log.LoggerController;

/**
 * This class maps SQLDatabaseMetaData instances to their corresponding Hibernate dialect.
 */
<span class="nc" id="L42">public class DialectFactory</span>
{

	/** this is used to indicate that the sesion is being copied from */
	public static final int SOURCE_TYPE = 0;

	/** this is used to indicate that the sesion is being copied to */
	public static final int DEST_TYPE = 1;

	/** Logger for this class. */
<span class="nc" id="L52">	private final static ILogger s_log = LoggerController.createLogger(DialectFactory.class);</span>

<span class="nc" id="L54">	private static final AxionDialectExt axionDialect = new AxionDialectExt();</span>

<span class="nc" id="L56">	private static final DB2DialectExt db2Dialect = new DB2DialectExt();</span>

	// TODO: subclass these hibernate dialects to provide the &quot;canPasteTo&quot;
	// api method in HibernateDialect interface.
	// private static final DB2390Dialect db2390Dialect = new DB2390Dialect();

	// private static final DB2400Dialect db2400Dialect = new DB2400Dialect();

<span class="nc" id="L64">	private static final DaffodilDialectExt daffodilDialect = new DaffodilDialectExt();</span>

<span class="nc" id="L66">	private static final DerbyDialectExt derbyDialect = new DerbyDialectExt();</span>

<span class="nc" id="L68">	private static final FirebirdDialectExt firebirdDialect = new FirebirdDialectExt();</span>

<span class="nc" id="L70">	private static final FrontBaseDialectExt frontbaseDialect = new FrontBaseDialectExt();</span>

<span class="nc" id="L72">	private static final GenericDialectExt genericDialect = new GenericDialectExt();</span>

<span class="nc" id="L74">	private static final HADBDialectExt hadbDialect = new HADBDialectExt();</span>

<span class="nc" id="L76">	private static final H2DialectExt h2Dialect = new H2DialectExt();</span>

<span class="nc" id="L78">	private static final HSQLDialectExt hsqlDialect = new HSQLDialectExt();</span>

<span class="nc" id="L80">	private static final InformixDialectExt informixDialect = new InformixDialectExt();</span>

<span class="nc" id="L82">	private static final InterbaseDialectExt interbaseDialect = new InterbaseDialectExt();</span>

<span class="nc" id="L84">	private static final IngresDialectExt ingresDialect = new IngresDialectExt();</span>

<span class="nc" id="L86">	private static final MAXDBDialectExt maxDbDialect = new MAXDBDialectExt();</span>

<span class="nc" id="L88">	private static final McKoiDialectExt mckoiDialect = new McKoiDialectExt();</span>

<span class="nc" id="L90">	private static final MySQLDialectExt mysqlDialect = new MySQLDialectExt();</span>

<span class="nc" id="L92">	private static final MySQL5DialectExt mysql5Dialect = new MySQL5DialectExt();</span>

<span class="nc" id="L94">	private static final NetezzaDialextExt netezzaDialect = new NetezzaDialextExt();</span>
	
<span class="nc" id="L96">	private static final GreenplumDialectExt greenplumDialect = new GreenplumDialectExt();</span>

<span class="nc" id="L98">	private static final OracleDialectExt oracle9iDialect = new OracleDialectExt();</span>

<span class="nc" id="L100">	private static final PointbaseDialectExt pointbaseDialect = new PointbaseDialectExt();</span>

<span class="nc" id="L102">	private static final PostgreSQLDialectExt postgreSQLDialect = new PostgreSQLDialectExt();</span>

<span class="nc" id="L104">	private static final ProgressDialectExt progressDialect = new ProgressDialectExt();</span>

<span class="nc" id="L106">	private static final SybaseDialectExt sybaseDialect = new SybaseDialectExt();</span>

<span class="nc" id="L108">	private static final SQLServerDialectExt sqlserverDialect = new SQLServerDialectExt();</span>

<span class="nc" id="L110">	private static final TimesTenDialectExt timestenDialect = new TimesTenDialectExt();</span>

<span class="nc" id="L112">	private static final IntersystemsCacheDialectExt intersystemsCacheDialectExt =</span>
		new IntersystemsCacheDialectExt();

<span class="nc" id="L115">	private static HashMap&lt;String, HibernateDialect&gt; dbNameDialectMap =</span>
		new HashMap&lt;String, HibernateDialect&gt;();

<span class="nc" id="L118">	public static boolean isPromptForDialect = false;</span>

	/** Internationalized strings for this class. */
<span class="nc" id="L121">	private static final StringManager s_stringMgr =</span>
<span class="nc" id="L122">		StringManagerFactory.getStringManager(DialectFactory.class);</span>

<span class="nc" id="L124">	private static IDialogUtils dialogUtils = new DialogUtils();</span>

	public static void setDialogUtils(IDialogUtils dialogUtils)
	{
<span class="nc" id="L128">		DialectFactory.dialogUtils = dialogUtils;</span>
<span class="nc" id="L129">	}</span>

	/**
	 * The keys to dbNameDialectMap are displayed to the user in the dialect chooser widget, so be sure to use
	 * something that is intelligable to an end user
	 */
	static
	{
<span class="nc" id="L137">		dbNameDialectMap.put(axionDialect.getDisplayName(), axionDialect);</span>
<span class="nc" id="L138">		dbNameDialectMap.put(db2Dialect.getDisplayName(), db2Dialect);</span>
		// dbNameDialectMap.put(&quot;DB2/390&quot;, db2390Dialect);
		// dbNameDialectMap.put(&quot;DB2/400&quot;, db2400Dialect);
<span class="nc" id="L141">		dbNameDialectMap.put(daffodilDialect.getDisplayName(), daffodilDialect);</span>
<span class="nc" id="L142">		dbNameDialectMap.put(derbyDialect.getDisplayName(), derbyDialect);</span>
<span class="nc" id="L143">		dbNameDialectMap.put(firebirdDialect.getDisplayName(), firebirdDialect);</span>
<span class="nc" id="L144">		dbNameDialectMap.put(frontbaseDialect.getDisplayName(), frontbaseDialect);</span>
<span class="nc" id="L145">		dbNameDialectMap.put(hadbDialect.getDisplayName(), hadbDialect);</span>
<span class="nc" id="L146">		dbNameDialectMap.put(hsqlDialect.getDisplayName(), hsqlDialect);</span>
<span class="nc" id="L147">		dbNameDialectMap.put(h2Dialect.getDisplayName(), h2Dialect);</span>
<span class="nc" id="L148">		dbNameDialectMap.put(informixDialect.getDisplayName(), informixDialect);</span>
<span class="nc" id="L149">		dbNameDialectMap.put(ingresDialect.getDisplayName(), ingresDialect);</span>
<span class="nc" id="L150">		dbNameDialectMap.put(interbaseDialect.getDisplayName(), interbaseDialect);</span>
<span class="nc" id="L151">		dbNameDialectMap.put(maxDbDialect.getDisplayName(), maxDbDialect);</span>
<span class="nc" id="L152">		dbNameDialectMap.put(mckoiDialect.getDisplayName(), mckoiDialect);</span>
<span class="nc" id="L153">		dbNameDialectMap.put(mysqlDialect.getDisplayName(), mysqlDialect);</span>
<span class="nc" id="L154">		dbNameDialectMap.put(netezzaDialect.getDisplayName(), netezzaDialect);</span>
<span class="nc" id="L155">		dbNameDialectMap.put(greenplumDialect.getDisplayName(), greenplumDialect);</span>
<span class="nc" id="L156">		dbNameDialectMap.put(oracle9iDialect.getDisplayName(), oracle9iDialect);</span>
<span class="nc" id="L157">		dbNameDialectMap.put(pointbaseDialect.getDisplayName(), pointbaseDialect);</span>
<span class="nc" id="L158">		dbNameDialectMap.put(postgreSQLDialect.getDisplayName(), postgreSQLDialect);</span>
<span class="nc" id="L159">		dbNameDialectMap.put(progressDialect.getDisplayName(), progressDialect);</span>
<span class="nc" id="L160">		dbNameDialectMap.put(sqlserverDialect.getDisplayName(), sqlserverDialect);</span>
<span class="nc" id="L161">		dbNameDialectMap.put(sybaseDialect.getDisplayName(), sybaseDialect);</span>
<span class="nc" id="L162">		dbNameDialectMap.put(timestenDialect.getDisplayName(), timestenDialect);</span>
<span class="nc" id="L163">		dbNameDialectMap.put(intersystemsCacheDialectExt.getDisplayName(), intersystemsCacheDialectExt);</span>
<span class="nc" id="L164">	}</span>

	public static boolean isAxion(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L168">		return dialectSupportsProduct(md, axionDialect);</span>
	}

	public static boolean isDaffodil(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L173">		return dialectSupportsProduct(md, daffodilDialect);</span>
	}

	public static boolean isDB2(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L178">		return dialectSupportsProduct(md, db2Dialect);</span>
	}

	public static boolean isDerby(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L183">		return dialectSupportsProduct(md, derbyDialect);</span>
	}

	public static boolean isFirebird(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L188">		return dialectSupportsProduct(md, firebirdDialect);</span>
	}

	public static boolean isFrontBase(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L193">		return dialectSupportsProduct(md, frontbaseDialect);</span>
	}

	public static boolean isHADB(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L198">		return dialectSupportsProduct(md, hadbDialect);</span>
	}

	public static boolean isH2(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L203">		return dialectSupportsProduct(md, h2Dialect);</span>
	}

	public static boolean isHSQL(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L208">		return dialectSupportsProduct(md, hsqlDialect);</span>
	}

	public static boolean isInformix(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L213">		return dialectSupportsProduct(md, informixDialect);</span>
	}

	public static boolean isIngres(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L218">		return dialectSupportsProduct(md, ingresDialect);</span>
	}

	public static boolean isInterbase(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L223">		return dialectSupportsProduct(md, interbaseDialect);</span>
	}

	public static boolean isMaxDB(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L228">		return dialectSupportsProduct(md, maxDbDialect);</span>
	}

	public static boolean isMcKoi(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L233">		return dialectSupportsProduct(md, mckoiDialect);</span>
	}

	public static boolean isMSSQLServer(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L238">		return dialectSupportsProduct(md, sqlserverDialect);</span>
	}

	public static boolean isMySQL(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L243">		return dialectSupportsProduct(md, mysqlDialect);</span>
	}

	public static boolean isMySQL5(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L248">		return dialectSupportsProduct(md, mysql5Dialect);</span>
	}

	public static boolean isNetezza(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L253">		return dialectSupportsProduct(md, netezzaDialect);</span>
	}

	public static boolean isGreenplum(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L258">		return dialectSupportsProduct(md, greenplumDialect);</span>
	}

	public static boolean isOracle(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L263">		return dialectSupportsProduct(md, oracle9iDialect);</span>
	}

	public static boolean isPointbase(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L268">		return dialectSupportsProduct(md, pointbaseDialect);</span>
	}

	public static boolean isPostgreSQL(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L273">		return dialectSupportsProduct(md, postgreSQLDialect);</span>
	}

	public static boolean isProgress(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L278">		return dialectSupportsProduct(md, progressDialect);</span>
	}

	public static boolean isSyBase(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L283">		return dialectSupportsProduct(md, sybaseDialect);</span>
	}

	public static boolean isTimesTen(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L288">		return dialectSupportsProduct(md, timestenDialect);</span>
	}

	public static boolean isIntersystemsCacheDialectExt(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L293">		return dialectSupportsProduct(md, intersystemsCacheDialectExt);</span>
	}

	/**
	 * Returns a DialectType for the specified ISQLDatabaseMetaData
	 * 
	 * @param md
	 *           the metadata to use to determine the dialect type
	 * @return a dialect type
	 */
	public static DialectType getDialectType(ISQLDatabaseMetaData md)
	{
<span class="nc" id="L305">		HibernateDialect dialect = getDialect(md);</span>
<span class="nc" id="L306">		return dialect.getDialectType();</span>
	}

	/**
	 * Examines the driver class name from the specified session to see if it begins with any of the
	 * space-delimited string tokens in the specified nameToMatch.
	 * 
	 * @param session
	 *           the ISession to check
	 * @param nameToMatch
	 *           a space-delimited string of driver class package prefixes
	 * @return true if there is a match of any string in the nameToMatch and the ISession's driver class name;
	 *         false otherwise.
	 */
	private static boolean dialectSupportsProduct(ISQLDatabaseMetaData data, HibernateDialect dialect)
	{
<span class="nc" id="L322">		boolean result = false;</span>
<span class="nc bnc" id="L323" title="All 4 branches missed.">		if (data != null &amp;&amp; dialect != null)</span>
		{
			try
			{
<span class="nc" id="L327">				String productName = data.getDatabaseProductName();</span>
<span class="nc" id="L328">				String productVersion = data.getDatabaseProductVersion();</span>
<span class="nc" id="L329">				result = dialect.supportsProduct(productName, productVersion);</span>
			}
<span class="nc" id="L331">			catch (Exception e)</span>
			{
<span class="nc" id="L333">				s_log.error(&quot;Encountered unexpected exception while attempting to &quot;</span>
<span class="nc" id="L334">					+ &quot;determine database product name/version: &quot; + e.getMessage());</span>
<span class="nc bnc" id="L335" title="All 2 branches missed.">				if (s_log.isDebugEnabled())</span>
				{
<span class="nc" id="L337">					StringWriter s = new StringWriter();</span>
<span class="nc" id="L338">					PrintWriter p = new PrintWriter(s);</span>
<span class="nc" id="L339">					e.printStackTrace(p);</span>
<span class="nc" id="L340">					s_log.debug(s.getBuffer().toString());</span>
				}
<span class="nc" id="L342">			}</span>
		}
<span class="nc" id="L344">		return result;</span>
	}

	public static HibernateDialect getDialect(String dbName)
	{
<span class="nc" id="L349">		return dbNameDialectMap.get(dbName);</span>
	}

	public static HibernateDialect getDialectIgnoreCase(String dbName)
	{
<span class="nc bnc" id="L354" title="All 2 branches missed.">		for (String displayName : dbNameDialectMap.keySet())</span>
		{
<span class="nc bnc" id="L356" title="All 2 branches missed.">			if (displayName.toLowerCase().equals(dbName.toLowerCase())) { return dbNameDialectMap.get(displayName); }</span>
<span class="nc" id="L357">		}</span>
<span class="nc" id="L358">		return null;</span>
	}

	/**
	 * @param md
	 * @return
	 */
	public static HibernateDialect getDialect(ISQLDatabaseMetaData md)
	{
<span class="nc bnc" id="L367" title="All 2 branches missed.">		if (isAxion(md)) { return axionDialect; }</span>
<span class="nc bnc" id="L368" title="All 2 branches missed.">		if (isDaffodil(md)) { return daffodilDialect; }</span>
<span class="nc bnc" id="L369" title="All 2 branches missed.">		if (isDB2(md)) { return db2Dialect; }</span>
<span class="nc bnc" id="L370" title="All 2 branches missed.">		if (isDerby(md)) { return derbyDialect; }</span>
<span class="nc bnc" id="L371" title="All 2 branches missed.">		if (isFirebird(md)) { return firebirdDialect; }</span>
<span class="nc bnc" id="L372" title="All 2 branches missed.">		if (isFrontBase(md)) { return frontbaseDialect; }</span>
<span class="nc bnc" id="L373" title="All 2 branches missed.">		if (isHADB(md)) { return hadbDialect; }</span>
<span class="nc bnc" id="L374" title="All 2 branches missed.">		if (isH2(md)) { return h2Dialect; }</span>
<span class="nc bnc" id="L375" title="All 2 branches missed.">		if (isHSQL(md)) { return hsqlDialect; }</span>
<span class="nc bnc" id="L376" title="All 2 branches missed.">		if (isInformix(md)) { return informixDialect; }</span>
<span class="nc bnc" id="L377" title="All 2 branches missed.">		if (isIngres(md)) { return ingresDialect; }</span>
<span class="nc bnc" id="L378" title="All 2 branches missed.">		if (isInterbase(md)) { return ingresDialect; }</span>
<span class="nc bnc" id="L379" title="All 2 branches missed.">		if (isMaxDB(md)) { return maxDbDialect; }</span>
<span class="nc bnc" id="L380" title="All 2 branches missed.">		if (isMcKoi(md)) { return mckoiDialect; }</span>
<span class="nc bnc" id="L381" title="All 2 branches missed.">		if (isMySQL(md)) { return mysqlDialect; }</span>
<span class="nc bnc" id="L382" title="All 2 branches missed.">		if (isMySQL5(md)) { return mysql5Dialect; }</span>
<span class="nc bnc" id="L383" title="All 2 branches missed.">		if (isMSSQLServer(md)) { return sqlserverDialect; }</span>
<span class="nc bnc" id="L384" title="All 2 branches missed.">		if (isNetezza(md)) { return netezzaDialect; }</span>
<span class="nc bnc" id="L385" title="All 2 branches missed.">		if (isGreenplum(md)) { return greenplumDialect; }</span>
<span class="nc bnc" id="L386" title="All 2 branches missed.">		if (isOracle(md)) { return oracle9iDialect; }</span>
<span class="nc bnc" id="L387" title="All 2 branches missed.">		if (isPointbase(md)) { return pointbaseDialect; }</span>
<span class="nc bnc" id="L388" title="All 2 branches missed.">		if (isPostgreSQL(md)) { return postgreSQLDialect; }</span>
<span class="nc bnc" id="L389" title="All 2 branches missed.">		if (isProgress(md)) { return progressDialect; }</span>
<span class="nc bnc" id="L390" title="All 2 branches missed.">		if (isSyBase(md)) { return sybaseDialect; }</span>
<span class="nc bnc" id="L391" title="All 2 branches missed.">		if (isTimesTen(md)) { return timestenDialect; }</span>
<span class="nc bnc" id="L392" title="All 2 branches missed.">		if (isIntersystemsCacheDialectExt(md)) { return intersystemsCacheDialectExt; }</span>
		// GenericDialect must be last, since it will claim that it supports any product/version. That is also
		// why there is no isGenericDialect - it would always return true if there was one, making it useless.
<span class="nc" id="L395">		return genericDialect;</span>
	}

	public static HibernateDialect getDialect(int sessionType, JFrame parent, ISQLDatabaseMetaData md)
		throws UserCancelledOperationException
	{
<span class="nc" id="L401">		HibernateDialect result = null;</span>

		// User doesn't wish for us to try to auto-detect the dest db.
<span class="nc bnc" id="L404" title="All 2 branches missed.">		if (isPromptForDialect)</span>
		{
<span class="nc" id="L406">			result = showDialectDialog(parent, sessionType);</span>
		}
		else
		{
<span class="nc" id="L410">			result = getDialect(md);</span>
		}
<span class="nc" id="L412">		return result;</span>
	}

	/**
	 * Shows the user a dialog explaining that we failed to detect the dialect of the destination database, and
	 * we are offering the user the opportunity to pick one from our supported dialects list. If the user
	 * cancels this dialog, null is returned to indicate that the user doesn't wish to continue the paste
	 * operation.
	 * 
	 * @param parent
	 *           the JFrame to use to display the dialog over.
	 * @param sessionType
	 *           the type of the session (source or destination). This is a left over from DBCopy Plugin and
	 *           should be refactored to not need this at some point.
	 * @return the dialect that the user picked.
	 */
	private static HibernateDialect showDialectDialog(JFrame parent, int sessionType)
		throws UserCancelledOperationException
	{
<span class="nc" id="L431">		Object[] dbNames = getDbNames();</span>
<span class="nc" id="L432">		String chooserTitle = s_stringMgr.getString(&quot;dialectChooseTitle&quot;);</span>
<span class="nc" id="L433">		String typeStr = null;</span>
<span class="nc bnc" id="L434" title="All 2 branches missed.">		if (sessionType == SOURCE_TYPE)</span>
		{
<span class="nc" id="L436">			typeStr = s_stringMgr.getString(&quot;sourceSessionTypeName&quot;);</span>
		}
<span class="nc bnc" id="L438" title="All 2 branches missed.">		if (sessionType == DEST_TYPE)</span>
		{
<span class="nc" id="L440">			typeStr = s_stringMgr.getString(&quot;destSessionTypeName&quot;);</span>
		}
<span class="nc" id="L442">		String message = s_stringMgr.getString(&quot;dialectDetectFailedMessage&quot;, typeStr);</span>
<span class="nc bnc" id="L443" title="All 2 branches missed.">		if (isPromptForDialect)</span>
		{
<span class="nc" id="L445">			message = s_stringMgr.getString(&quot;autoDetectDisabledMessage&quot;, typeStr);</span>
		}

<span class="nc" id="L448">		String dbName =</span>
<span class="nc" id="L449">			dialogUtils.showInputDialog(parent, message, chooserTitle, JOptionPane.INFORMATION_MESSAGE, null,</span>
				dbNames, dbNames[0]);

<span class="nc bnc" id="L452" title="All 4 branches missed.">		if (dbName == null || &quot;&quot;.equals(dbName)) { throw new UserCancelledOperationException(); }</span>
<span class="nc" id="L453">		return dbNameDialectMap.get(dbName);</span>
	}

	/**
	 * Returns a list of Database server names that can be preented to the user whenever we want the user to
	 * pick a dialect.
	 * 
	 * @return
	 */
	public static Object[] getDbNames()
	{
<span class="nc" id="L464">		Set&lt;String&gt; keyset = dbNameDialectMap.keySet();</span>
<span class="nc" id="L465">		Object[] keys = keyset.toArray();</span>
<span class="nc" id="L466">		Arrays.sort(keys);</span>
<span class="nc" id="L467">		return keys;</span>
	}

	/**
	 * Returns an array of HibernateDialect instances, one for each supported dialect.
	 * 
	 * @return
	 */
	public static Object[] getSupportedDialects()
	{
<span class="nc" id="L477">		Collection&lt;HibernateDialect&gt; c = dbNameDialectMap.values();</span>
<span class="nc" id="L478">		return c.toArray();</span>
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>