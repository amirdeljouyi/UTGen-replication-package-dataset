<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DriverPropertiesTable.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">102_squirrel-sql</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.squirrel_sql.client.gui.db.aliasproperties</a> &gt; <span class="el_source">DriverPropertiesTable.java</span></div><h1>DriverPropertiesTable.java</h1><pre class="source lang-java linenums">package net.sourceforge.squirrel_sql.client.gui.db.aliasproperties;

/*
 * Copyright (C) 2002-2003 Colin Bell
 * colbell@users.sourceforge.net
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */
import java.awt.Component;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.sql.DriverPropertyInfo;

import javax.swing.DefaultCellEditor;
import javax.swing.JComboBox;
import javax.swing.JComponent;
import javax.swing.JTable;
import javax.swing.JTextField;
import javax.swing.ListSelectionModel;
import javax.swing.table.DefaultTableColumnModel;
import javax.swing.table.TableColumn;

import net.sourceforge.squirrel_sql.fw.sql.SQLDriverProperty;
import net.sourceforge.squirrel_sql.fw.sql.SQLDriverPropertyCollection;
import net.sourceforge.squirrel_sql.fw.util.StringManager;
import net.sourceforge.squirrel_sql.fw.util.StringManagerFactory;

class DriverPropertiesTable extends JTable implements DriverPropertiesTableModel.IColumnIndexes,
	MouseListener
{
	private static final long serialVersionUID = 1834042774863321901L;

	/** Internationalized strings for this class. */
<span class="nc" id="L46">	private static final StringManager s_stringMgr =</span>
<span class="nc" id="L47">		StringManagerFactory.getStringManager(DriverPropertiesTable.class);</span>

<span class="nc" id="L49">	private DriverPropertiesPopupMenu popupMenu = null;</span>

	DriverPropertiesTable(SQLDriverPropertyCollection props)
	{
<span class="nc" id="L53">		super(new DriverPropertiesTableModel(props));</span>
<span class="nc" id="L54">		init();</span>
<span class="nc" id="L55">	}</span>

	DriverPropertiesTableModel getTypedModel()
	{
<span class="nc" id="L59">		return (DriverPropertiesTableModel) getModel();</span>
	}

	private void init()
	{
<span class="nc" id="L64">		setColumnModel(new PropertiesTableColumnModel());</span>
<span class="nc" id="L65">		setSelectionMode(ListSelectionModel.SINGLE_SELECTION);</span>
<span class="nc" id="L66">		setAutoResizeMode(JTable.AUTO_RESIZE_LAST_COLUMN);</span>
<span class="nc" id="L67">		getTableHeader().setResizingAllowed(true);</span>
<span class="nc" id="L68">		getTableHeader().setReorderingAllowed(false);</span>
<span class="nc" id="L69">		popupMenu = new DriverPropertiesPopupMenu(this);</span>
<span class="nc" id="L70">		addMouseListener(this);</span>
<span class="nc" id="L71">		this.getTableHeader().addMouseListener(this);</span>
<span class="nc" id="L72">	}</span>

	/**
	 * Adds the specified name, value and description as a new property to this Driver Properties table.
	 * 
	 * @param name
	 *           the name of the property.
	 * @param value
	 *           the value that the property should have.
	 * @param description
	 *           the description of the property.
	 */
	public void addProperty(String name, String value, String description)
	{
<span class="nc" id="L86">		getTypedModel().addRow(name, value, description);</span>
<span class="nc" id="L87">	}</span>

	/**
	 * Removes the property with the specified name
	 * 
	 * @param name
	 *           the name of the property to remove.
	 */
	public void removeProperty(String name)
	{
<span class="nc" id="L97">		getTypedModel().removeRow(name);</span>
<span class="nc" id="L98">	}</span>

	private final class PropertiesTableColumnModel extends DefaultTableColumnModel
	{
		private static final long serialVersionUID = 7718475486013810595L;

		PropertiesTableColumnModel()
<span class="nc" id="L105">		{</span>
<span class="nc" id="L106">			super();</span>

<span class="nc" id="L108">			TableColumn tc = new TableColumn(IDX_NAME);</span>
<span class="nc" id="L109">			tc.setHeaderValue(s_stringMgr.getString(&quot;DriverPropertiesTable.name&quot;));</span>
<span class="nc" id="L110">			addColumn(tc);</span>

<span class="nc" id="L112">			tc = new TableColumn(IDX_SPECIFY);</span>
<span class="nc" id="L113">			tc.setHeaderValue(s_stringMgr.getString(&quot;DriverPropertiesTable.specify&quot;));</span>
<span class="nc" id="L114">			addColumn(tc);</span>

<span class="nc" id="L116">			tc = new TableColumn(IDX_VALUE, 75, null, new ValueCellEditor());</span>
<span class="nc" id="L117">			tc.setHeaderValue(s_stringMgr.getString(&quot;DriverPropertiesTable.value&quot;));</span>
<span class="nc" id="L118">			addColumn(tc);</span>

<span class="nc" id="L120">			tc = new TableColumn(IDX_REQUIRED);</span>
<span class="nc" id="L121">			tc.setHeaderValue(s_stringMgr.getString(&quot;DriverPropertiesTable.required&quot;));</span>
<span class="nc" id="L122">			addColumn(tc);</span>

<span class="nc" id="L124">			tc = new TableColumn(IDX_DESCRIPTION);</span>
<span class="nc" id="L125">			tc.setHeaderValue(s_stringMgr.getString(&quot;DriverPropertiesTable.description&quot;));</span>
<span class="nc" id="L126">			addColumn(tc);</span>
<span class="nc" id="L127">		}</span>
	}

	private final class ValueCellEditor extends DefaultCellEditor
	{
		private static final long serialVersionUID = -7637425267855940899L;

<span class="nc" id="L134">		private final JTextField _textEditor = new JTextField();</span>

<span class="nc" id="L136">		private final JComboBox _comboEditor = new JComboBox();</span>

		private JComponent _currentEditor;

		ValueCellEditor()
<span class="nc" id="L141">		{</span>
<span class="nc" id="L142">			super(new JTextField());</span>
<span class="nc" id="L143">			setClickCountToStart(1);</span>
<span class="nc" id="L144">		}</span>

		public Component getTableCellEditorComponent(JTable table, Object value, boolean isSelected, int row,
			int col)
		{
<span class="nc bnc" id="L149" title="All 2 branches missed.">			if (col != IDX_VALUE) { throw new IllegalStateException(&quot;Editor used for cell other than value&quot;); }</span>

<span class="nc" id="L151">			SQLDriverPropertyCollection coll = getTypedModel().getSQLDriverProperties();</span>
<span class="nc" id="L152">			SQLDriverProperty sdp = coll.getDriverProperty(row);</span>
<span class="nc" id="L153">			DriverPropertyInfo prop = sdp.getDriverPropertyInfo();</span>
<span class="nc bnc" id="L154" title="All 4 branches missed.">			if (prop.choices != null &amp;&amp; prop.choices.length &gt; 0)</span>
			{
<span class="nc" id="L156">				_comboEditor.removeAllItems();</span>
<span class="nc bnc" id="L157" title="All 2 branches missed.">				for (int i = 0; i &lt; prop.choices.length; ++i)</span>
				{
<span class="nc" id="L159">					_comboEditor.addItem(prop.choices[i]);</span>
				}
<span class="nc bnc" id="L161" title="All 2 branches missed.">				if (sdp.getValue() != null)</span>
				{
<span class="nc" id="L163">					_comboEditor.setSelectedItem(sdp.getValue());</span>
				}
<span class="nc" id="L165">				_currentEditor = _comboEditor;</span>
			}
			else
			{
<span class="nc" id="L169">				_textEditor.setText(sdp.getValue());</span>
<span class="nc" id="L170">				_currentEditor = _textEditor;</span>
			}
<span class="nc" id="L172">			return _currentEditor;</span>
		}

		public Object getCellEditorValue()
		{
<span class="nc bnc" id="L177" title="All 2 branches missed.">			if (_currentEditor == _comboEditor) { return _comboEditor.getSelectedItem(); }</span>
<span class="nc" id="L178">			return _textEditor.getText();</span>
		}
	}

	/**
	 * @see java.awt.event.MouseListener#mousePressed(java.awt.event.MouseEvent)
	 */
	@Override
	public void mousePressed(MouseEvent e)
	{
<span class="nc bnc" id="L188" title="All 2 branches missed.">		if (e.isPopupTrigger())</span>
		{
<span class="nc" id="L190">			popupMenu.show(e.getComponent(), e.getX(), e.getY());</span>
		}

<span class="nc" id="L193">	}</span>
	
	/**
	 * @see java.awt.event.MouseListener#mouseClicked(java.awt.event.MouseEvent)
	 */
	@Override
	public void mouseClicked(MouseEvent e)
	{
		/* Do Nothing */
<span class="nc" id="L202">	}</span>

	/**
	 * @see java.awt.event.MouseListener#mouseEntered(java.awt.event.MouseEvent)
	 */
	@Override
	public void mouseEntered(MouseEvent e)
	{
		/* Do Nothing */
<span class="nc" id="L211">	}</span>

	/**
	 * @see java.awt.event.MouseListener#mouseExited(java.awt.event.MouseEvent)
	 */
	@Override
	public void mouseExited(MouseEvent e)
	{
		/* Do Nothing */
<span class="nc" id="L220">	}</span>

	/**
	 * @see java.awt.event.MouseListener#mouseReleased(java.awt.event.MouseEvent)
	 */
	@Override
	public void mouseReleased(MouseEvent e)
	{
		// According to the JavaDoc isPopupTrigger should be checked at mousePressed and mouseReleased
<span class="nc bnc" id="L229" title="All 2 branches missed.">		if (e.isPopupTrigger())</span>
		{
<span class="nc" id="L231">			popupMenu.show(e.getComponent(), e.getX(), e.getY());</span>
		}
<span class="nc" id="L233">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>