<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ObjectTreeCellRenderer.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">102_squirrel-sql</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.squirrel_sql.client.session.mainpanel.objecttree</a> &gt; <span class="el_source">ObjectTreeCellRenderer.java</span></div><h1>ObjectTreeCellRenderer.java</h1><pre class="source lang-java linenums">package net.sourceforge.squirrel_sql.client.session.mainpanel.objecttree;

import net.sourceforge.squirrel_sql.client.session.ISession;
import net.sourceforge.squirrel_sql.client.session.properties.SessionProperties;
import net.sourceforge.squirrel_sql.client.resources.SquirrelResources;
import net.sourceforge.squirrel_sql.fw.util.StringUtilities;

import javax.swing.tree.DefaultTreeCellRenderer;
import javax.swing.*;

import org.apache.commons.lang.StringUtils;

import java.awt.*;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;

public class ObjectTreeCellRenderer extends DefaultTreeCellRenderer
{
   private ObjectTreeModel _model;
   private ISession _session;

   private JPanel _pnlFilterRootNodeRendererComponent;
   private JLabel _filterHint;

<span class="nc" id="L25">   GridBagConstraints _gbcLeft = new GridBagConstraints(0,0,1,1,1,0,GridBagConstraints.NORTHWEST, GridBagConstraints.NONE, new Insets(0,0,0,0),0,0);</span>
<span class="nc" id="L26">   GridBagConstraints _gbcRight = new GridBagConstraints(1,0,1,1,0,0,GridBagConstraints.NORTHWEST, GridBagConstraints.NONE, new Insets(0,0,0,0),0,0);</span>

   public ObjectTreeCellRenderer(ObjectTreeModel model, ISession session)
<span class="nc" id="L29">   {</span>

<span class="nc" id="L31">      _model = model;</span>
<span class="nc" id="L32">      _session = session;</span>

<span class="nc" id="L34">      _session.getProperties().addPropertyChangeListener(new PropertyChangeListener()</span>
<span class="nc" id="L35">      {</span>
         public void propertyChange(PropertyChangeEvent evt)
         {
<span class="nc" id="L38">            onPropertyChanged(evt);</span>
<span class="nc" id="L39">         }</span>
      });

<span class="nc" id="L42">      initFilter();</span>

<span class="nc" id="L44">      _pnlFilterRootNodeRendererComponent = new JPanel(new GridBagLayout());</span>

<span class="nc" id="L46">   }</span>


   private void onPropertyChanged(PropertyChangeEvent evt)
   {
<span class="nc" id="L51">      if(</span>
<span class="nc bnc" id="L52" title="All 2 branches missed.">         SessionProperties.IPropertyNames.OBJECT_FILTER_INCLUDE.equals(evt.getPropertyName()) ||</span>
<span class="nc bnc" id="L53" title="All 2 branches missed.">         SessionProperties.IPropertyNames.OBJECT_FILTER_EXCLUDE.equals(evt.getPropertyName()) </span>

         )
      {
<span class="nc" id="L57">         initFilter();</span>
      }
<span class="nc" id="L59">   }</span>

   private void initFilter()
   {
<span class="nc" id="L63">      String objectFilterInclude = _session.getProperties().getObjectFilterInclude();</span>
<span class="nc" id="L64">      String objectFilterExclude = _session.getProperties().getObjectFilterExclude();</span>

<span class="nc" id="L66">      String filterhint = &quot;&quot;;</span>

<span class="nc bnc" id="L68" title="All 2 branches missed.">      if(false == StringUtils.isEmpty(objectFilterInclude))</span>
      {
<span class="nc" id="L70">         filterhint += &quot;Inc:&quot; + objectFilterInclude;</span>
      }

<span class="nc bnc" id="L73" title="All 2 branches missed.">      if(false == StringUtils.isEmpty(objectFilterExclude))</span>
      {
<span class="nc bnc" id="L75" title="All 2 branches missed.">         if(0 == filterhint.length())</span>
         {
<span class="nc" id="L77">            filterhint += &quot;Exc:&quot; + objectFilterExclude;</span>
         }
         else
         {
<span class="nc" id="L81">            filterhint += &quot;; Exc:&quot; + objectFilterExclude;</span>
         }
      }



<span class="nc bnc" id="L87" title="All 2 branches missed.">      if(0 &lt; filterhint.length())</span>
      {

<span class="nc" id="L90">         _filterHint = new JLabel(filterhint);</span>
<span class="nc" id="L91">         final SquirrelResources rsrc = _session.getApplication().getResources();</span>
<span class="nc" id="L92">         final ImageIcon icon = rsrc.getIcon(SquirrelResources.IImageNames.FILTER);</span>
<span class="nc" id="L93">         _filterHint.setIcon(icon);</span>
<span class="nc" id="L94">      }</span>
      else
      {
<span class="nc" id="L97">         _filterHint = null;</span>
      }

<span class="nc" id="L100">      _model.nodeChanged(_model.getRootObjectTreeNode());</span>
<span class="nc" id="L101">   }</span>




   public Component getTreeCellRendererComponent(JTree tree, Object value, boolean sel, boolean expanded, boolean leaf, int row, boolean hasFocus)
   {
<span class="nc" id="L108">      JLabel ret = (JLabel) super.getTreeCellRendererComponent(tree, value, sel, expanded, leaf, row, hasFocus);</span>

<span class="nc bnc" id="L110" title="All 4 branches missed.">      if(null != _filterHint &amp;&amp; _model.isRootNode(value))</span>
      {
<span class="nc" id="L112">         _pnlFilterRootNodeRendererComponent.removeAll();</span>
<span class="nc" id="L113">         _pnlFilterRootNodeRendererComponent.setBackground(new Color(255,204,204));</span>

<span class="nc" id="L115">         _pnlFilterRootNodeRendererComponent.add(ret, _gbcLeft);</span>
<span class="nc" id="L116">         _pnlFilterRootNodeRendererComponent.add(ret);</span>

<span class="nc" id="L118">         _pnlFilterRootNodeRendererComponent.add(_filterHint, _gbcRight);</span>
<span class="nc" id="L119">         _pnlFilterRootNodeRendererComponent.add(_filterHint);</span>

<span class="nc" id="L121">         return _pnlFilterRootNodeRendererComponent;</span>

      }
      else
      {
<span class="nc bnc" id="L126" title="All 2 branches missed.">         if(value instanceof ObjectTreeNode)</span>
         {
<span class="nc" id="L128">            ObjectTreeNode otn = (ObjectTreeNode) value;</span>
<span class="nc bnc" id="L129" title="All 2 branches missed.">            if (null != otn.getIcon())</span>
            {
<span class="nc" id="L131">               ret.setIcon(otn.getIcon());</span>
            }
            else
            {
<span class="nc" id="L135">               setDefaultIcon(expanded, leaf, ret);</span>
            }

<span class="nc" id="L138">         }</span>
         else
         {
<span class="nc" id="L141">            setDefaultIcon(expanded, leaf, ret);</span>
         }

<span class="nc" id="L144">         return ret;</span>
      }
   }

   private void setDefaultIcon(boolean expanded, boolean leaf, JLabel lbl)
   {
<span class="nc bnc" id="L150" title="All 2 branches missed.">      if (leaf)</span>
      {
<span class="nc" id="L152">         lbl.setIcon(getLeafIcon());</span>
      }
<span class="nc bnc" id="L154" title="All 2 branches missed.">      else if (expanded)</span>
      {
<span class="nc" id="L156">         lbl.setIcon(getDefaultOpenIcon());</span>
      }
      else
      {
<span class="nc" id="L160">         lbl.setIcon(getDefaultClosedIcon());</span>
      }
<span class="nc" id="L162">   }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>