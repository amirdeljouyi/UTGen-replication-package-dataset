<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ParameterWhereClausePart.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">102_squirrel-sql</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.squirrel_sql.fw.datasetviewer.cellcomponent.whereClause</a> &gt; <span class="el_source">ParameterWhereClausePart.java</span></div><h1>ParameterWhereClausePart.java</h1><pre class="source lang-java linenums">package net.sourceforge.squirrel_sql.fw.datasetviewer.cellcomponent.whereClause;

import java.sql.PreparedStatement;
import java.sql.SQLException;

import net.sourceforge.squirrel_sql.fw.datasetviewer.ColumnDisplayDefinition;
import net.sourceforge.squirrel_sql.fw.datasetviewer.cellcomponent.IDataTypeComponent;

/**
 * The part of an where-clause, which uses an parameter.
 * @author Stefan Willinger
 *
 */
public class ParameterWhereClausePart extends AbstractWhereClausePart {

	/**
	 * The DataTypeComponent, which had this WhereClausePart created and could
	 * be used for setting the parameter values into the PreparedStatement
	 */
	private IDataTypeComponent dataTypeComponent;
	/**
	 * Value of the parameter, if any is used by the whereClause.
	 */
	private Object parameterValue;

	
	/**
	 * Creates an {@link IWhereClausePart} with the given column and parameter.
	 * The generated part of the where-clause will use an parameter value like
	 * &lt;code&gt;column = ?&lt;/code&gt;
	 * If the value of the parameter is null, then you should use {@link IsNullWhereClausePart} insteed this.
	 * @param column
	 *            Column, which is part of the where clause (must be not null)
	 * @param parameterValue
	 *            Value, which is used within the where-clause (must not be
	 *            null)
	 * @param dataTypeComponent
	 *            DataTypeComponent, which is responsible for setting the
	 *            parameter into the PreparedStatement. (must be not null)
	 * @see IsNullWhereClausePart
	 */
	public ParameterWhereClausePart(ColumnDisplayDefinition columnDef,
			Object parameterValue, IDataTypeComponent dataTypeComponent) {
<span class="nc" id="L44">		super(columnDef);</span>
<span class="nc" id="L45">		setDataTypeComponent(dataTypeComponent);</span>
<span class="nc" id="L46">		setParameterValue(parameterValue);</span>
<span class="nc" id="L47">		setWhereClause(getColumn() + &quot; = ?&quot;);</span>
<span class="nc" id="L48">	}</span>

	/**
	 * Sets the parameter value, which should be used within this where clause
	 * part.
	 * 
	 * @param parameterValue
	 */
	protected void setParameterValue(Object parameterValue) {
<span class="nc bnc" id="L57" title="All 2 branches missed.">		if (parameterValue == null) {</span>
<span class="nc" id="L58">			throw new IllegalArgumentException(</span>
					&quot;The parameterValue must not be null&quot;);
		}
<span class="nc" id="L61">		this.parameterValue = parameterValue;</span>
<span class="nc" id="L62">	}</span>

	/**
	 * Set's the apropriate  {@link IDataTypeComponent} which should be used for setting the value into the {@link PreparedStatement}
	 * @param dataTypeComponent for setting the value into the PreparedStatement
	 */
	private void setDataTypeComponent(IDataTypeComponent dataTypeComponent) {

<span class="nc bnc" id="L70" title="All 2 branches missed.">		if (dataTypeComponent == null) {</span>
<span class="nc" id="L71">			throw new IllegalArgumentException(&quot;column must be not empty&quot;);</span>
		}
<span class="nc" id="L73">		this.dataTypeComponent = dataTypeComponent;</span>
<span class="nc" id="L74">	}</span>

	/**
	 * 
	 * @return the value of the parameter of this where clause part, if any
	 *         exists.
	 */
	public Object getParameterValue() {
<span class="nc" id="L82">		return parameterValue;</span>
	}

	/**
	 * (non-Javadoc)
	 * 
	 * @see
	 * net.sourceforge.squirrel_sql.fw.datasetviewer.cellcomponent.whereClause
	 * .IWhereClausePart#setParameter(java.sql.PreparedStatement, int)
	 */
	@Override
	public void setParameter(PreparedStatement pstmt, int position)
			throws SQLException {
<span class="nc" id="L95">		this.dataTypeComponent.setPreparedStatementValue(pstmt,</span>
				this.parameterValue, position);
<span class="nc" id="L97">	}</span>

	/**
	 * This clause uses parameter
	 * 
	 * @see net.sourceforge.squirrel_sql.fw.datasetviewer.cellcomponent.whereClause.IWhereClausePart#isParameterUsed()
	 */
	@Override
	public boolean isParameterUsed() {
<span class="nc" id="L106">		return true;</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>