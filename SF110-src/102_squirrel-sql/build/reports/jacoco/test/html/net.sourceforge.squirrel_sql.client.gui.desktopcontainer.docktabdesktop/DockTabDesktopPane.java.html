<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DockTabDesktopPane.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">102_squirrel-sql</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.squirrel_sql.client.gui.desktopcontainer.docktabdesktop</a> &gt; <span class="el_source">DockTabDesktopPane.java</span></div><h1>DockTabDesktopPane.java</h1><pre class="source lang-java linenums">package net.sourceforge.squirrel_sql.client.gui.desktopcontainer.docktabdesktop;

import java.awt.*;
import java.awt.event.*;
import java.util.ArrayList;
import java.util.HashSet;

import javax.swing.*;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;

import net.sourceforge.squirrel_sql.client.ApplicationListener;
import net.sourceforge.squirrel_sql.client.IApplication;
import net.sourceforge.squirrel_sql.client.gui.desktopcontainer.DialogWidget;
import net.sourceforge.squirrel_sql.client.gui.desktopcontainer.DockDelegate;
import net.sourceforge.squirrel_sql.client.gui.desktopcontainer.DockWidget;
import net.sourceforge.squirrel_sql.client.gui.desktopcontainer.IDesktopContainer;
import net.sourceforge.squirrel_sql.client.gui.desktopcontainer.IWidget;
import net.sourceforge.squirrel_sql.client.gui.desktopcontainer.TabDelegate;
import net.sourceforge.squirrel_sql.client.gui.desktopcontainer.TabWidget;
import net.sourceforge.squirrel_sql.client.gui.mainframe.SquirrelDesktopManager;
import net.sourceforge.squirrel_sql.client.mainframe.action.CloseAllButCurrentSessionsAction;
import net.sourceforge.squirrel_sql.client.mainframe.action.CloseAllSessionsAction;
import net.sourceforge.squirrel_sql.client.session.action.CloseSessionAction;
import net.sourceforge.squirrel_sql.client.session.action.CloseSessionWindowAction;
import net.sourceforge.squirrel_sql.client.session.action.RenameSessionAction;
import net.sourceforge.squirrel_sql.fw.util.Resources;

//
public class DockTabDesktopPane extends JComponent implements IDesktopContainer
{
<span class="nc" id="L32">   public enum TabClosingMode</span>
   {
<span class="nc" id="L34">      CLOSE_BUTTON,</span>
<span class="nc" id="L35">      DISPOSE</span>
   }

   private IApplication _app;

<span class="nc" id="L40">   private JPanel _pnlButtons = new JPanel();</span>

<span class="nc" id="L42">   private DockPanel _pnlDock = new DockPanel();</span>

   private DesktopTabbedPane _tabbedPane;

<span class="nc" id="L46">   private JSplitPane _split = new JSplitPane(JSplitPane.HORIZONTAL_SPLIT);</span>
   private boolean _inOnToggleOpenDock;
<span class="nc" id="L48">   private ArrayList&lt;DockHandle&gt; _dockHandles = new ArrayList&lt;DockHandle&gt;();</span>
<span class="nc" id="L49">   private ArrayList&lt;TabHandle&gt; _tabHandles = new ArrayList&lt;TabHandle&gt;();</span>
   private int _standardDividerSize;

<span class="nc" id="L52">   private HashSet&lt;TabHandle&gt; _handlesInRemoveTab_CloseButton = new HashSet&lt;TabHandle&gt;();</span>
<span class="nc" id="L53">   private HashSet&lt;TabHandle&gt; _handlesInRemoveTab_Dispose = new HashSet&lt;TabHandle&gt;();</span>

<span class="nc" id="L55">   private DockTabDesktopManager _dockTabDesktopManager = new DockTabDesktopManager();</span>

   private JPopupMenu _tabRightMouseMenu;

   private ScrollableTabHandler _scrollableTabHandler;

   public DockTabDesktopPane(IApplication app)
<span class="nc" id="L62">   {</span>
<span class="nc" id="L63">      _app = app;</span>

<span class="nc" id="L65">      _tabbedPane = new DesktopTabbedPane(_app);</span>

<span class="nc" id="L67">      setLayout(new BorderLayout());</span>

<span class="nc" id="L69">      _pnlButtons = new JPanel();</span>
<span class="nc" id="L70">      _pnlButtons.setLayout(new BoxLayout(_pnlButtons, BoxLayout.Y_AXIS));</span>
<span class="nc" id="L71">      add(_pnlButtons, BorderLayout.WEST);</span>

<span class="nc" id="L73">      _split.setLeftComponent(_pnlDock);</span>

<span class="nc" id="L75">      _scrollableTabHandler = new ScrollableTabHandler(_app, _tabbedPane);</span>

<span class="nc" id="L77">      _tabbedPane.addChangeListener(new ChangeListener()</span>
<span class="nc" id="L78">      {</span>
         public void stateChanged(ChangeEvent e)
         {
<span class="nc" id="L81">            onTabStateChanged(e);</span>
<span class="nc" id="L82">         }</span>
      });

<span class="nc" id="L85">      _split.setRightComponent(_tabbedPane);</span>


<span class="nc" id="L88">      add(_split, BorderLayout.CENTER);</span>
<span class="nc" id="L89">      _standardDividerSize = _split.getDividerSize();</span>

<span class="nc" id="L91">      _pnlDock.addComponentListener(new ComponentAdapter()</span>
<span class="nc" id="L92">      {</span>
         public void componentResized(ComponentEvent e)
         {
<span class="nc" id="L95">            onDockPanelResized();</span>
<span class="nc" id="L96">         }</span>
      });

<span class="nc" id="L99">      closeDock();</span>

<span class="nc" id="L101">      _app.addApplicationListener(new ApplicationListener()</span>
<span class="nc" id="L102">      {</span>
         public void saveApplicationState()
         {
<span class="nc" id="L105">            onSaveApplicationState();</span>
<span class="nc" id="L106">         }</span>
      });

<span class="nc" id="L109">      initTabRightMouseMenu();</span>
<span class="nc" id="L110">   }</span>

   private void onSaveApplicationState()
   {
<span class="nc bnc" id="L114" title="All 2 branches missed.">      for (DockHandle dockHandle : _dockHandles)</span>
      {
<span class="nc bnc" id="L116" title="All 2 branches missed.">         if(false == dockHandle.isClosed())</span>
         {
<span class="nc" id="L118">            dockHandle.storeDividerLocation(_split.getDividerLocation());</span>
         }
<span class="nc" id="L120">      }</span>
<span class="nc" id="L121">   }</span>

   private void onTabStateChanged(ChangeEvent e)
   {
<span class="nc" id="L125">      tabActivationChanged();</span>
<span class="nc" id="L126">   }</span>

   private void tabActivationChanged()
   {
<span class="nc" id="L130">      TabPanel tabPanel = (TabPanel) _tabbedPane.getSelectedComponent();</span>

<span class="nc bnc" id="L132" title="All 4 branches missed.">      if (null != tabPanel &amp;&amp; tabPanel.getTabHandle().isSelected())</span>
      {
<span class="nc" id="L134">         return;</span>
      }

<span class="nc bnc" id="L137" title="All 2 branches missed.">      for (TabHandle tabHandle : _tabHandles)</span>
      {
<span class="nc bnc" id="L139" title="All 6 branches missed.">         if (null == tabPanel || tabHandle.isSelected() &amp;&amp; tabHandle != tabPanel.getTabHandle())</span>
         {
<span class="nc" id="L141">            tabHandle.setSelected(false);</span>
         }
<span class="nc" id="L143">      }</span>

<span class="nc bnc" id="L145" title="All 2 branches missed.">      if (tabPanel != null)</span>
      {
<span class="nc" id="L147">         tabPanel.getTabHandle().setSelected(true);</span>
      }
<span class="nc" id="L149">   }</span>


   public void addWidget(DockWidget widget)
   {
<span class="nc" id="L154">      DockHandle dockHandle = addDock(widget.getContentPane(), widget.getTitle());</span>
<span class="nc" id="L155">      ((DockDelegate) widget.getDelegate()).setDockHandle(dockHandle);</span>
<span class="nc" id="L156">   }</span>

   public void addWidget(DialogWidget client)
   {
<span class="nc" id="L160">   }</span>

   public void addWidget(final TabWidget widget)
   {
<span class="nc" id="L164">      final TabHandle tabHandle = new TabHandle(widget, this);</span>
<span class="nc" id="L165">      ((TabDelegate) widget.getDelegate()).setTabHandle(tabHandle);</span>

<span class="nc" id="L167">      tabHandle.addTabHandleListener(_dockTabDesktopManager);</span>

<span class="nc" id="L169">      TabPanel tabPanel = createTabPanel(tabHandle);</span>
<span class="nc" id="L170">      _tabbedPane.addTab(widget.getTitle(), null, tabPanel, widget.getTitle());</span>
<span class="nc" id="L171">      int tabIx = _tabbedPane.indexOfComponent(tabPanel);</span>

<span class="nc" id="L173">      ButtonTabComponent btc = (ButtonTabComponent) _tabbedPane.getTabComponentAt(tabIx);</span>

<span class="nc" id="L175">      btc.getClosebutton().addActionListener(new ActionListener()</span>
<span class="nc" id="L176">      {</span>
         public void actionPerformed(ActionEvent e)
         {
<span class="nc" id="L179">            removeTab(tabHandle, e, TabClosingMode.CLOSE_BUTTON);</span>
<span class="nc" id="L180">         }</span>
      });

<span class="nc" id="L183">      btc.getToWindowButton().addActionListener(new ActionListener()</span>
<span class="nc" id="L184">      {</span>
         public void actionPerformed(ActionEvent e)
         {
<span class="nc" id="L187">            onToWindow(tabHandle);</span>
<span class="nc" id="L188">         }</span>
      });


<span class="nc" id="L192">      _tabHandles.add(tabHandle);</span>
<span class="nc" id="L193">      tabHandle.fireAdded();</span>
<span class="nc" id="L194">      _tabbedPane.setSelectedIndex(tabIx);</span>
<span class="nc" id="L195">      _scrollableTabHandler.tabAdded();</span>
<span class="nc" id="L196">   }</span>

   private void onToWindow(TabHandle tabHandle)
   {
<span class="nc" id="L200">      Point locationOnScreen = tabHandle.getWidget().getContentPane().getLocationOnScreen();</span>
<span class="nc" id="L201">      Dimension size = tabHandle.getWidget().getContentPane().getSize();</span>

<span class="nc" id="L203">      int tabIndex = getTabIndex(tabHandle);</span>
<span class="nc bnc" id="L204" title="All 2 branches missed.">      if (-1 != tabIndex)</span>
      {
<span class="nc" id="L206">         removeTabFromTabbedPane(tabIndex);</span>
      }
<span class="nc" id="L208">      _tabHandles.remove(tabHandle);</span>
<span class="nc" id="L209">      tabHandle.removeTabHandleListener(_dockTabDesktopManager);</span>


<span class="nc" id="L212">      TabWindowController tabWindowController = new TabWindowController(tabHandle, locationOnScreen, size, _app);</span>
<span class="nc" id="L213">      _app.getMultipleWindowsHandler().registerDesktop(tabWindowController);</span>
<span class="nc" id="L214">   }</span>

   private void onDockPanelResized()
   {
<span class="nc bnc" id="L218" title="All 2 branches missed.">      if (0 == _pnlDock.getComponentCount())</span>
      {
         // Without this the split moves when the window is resized.
<span class="nc" id="L221">         closeDock();</span>
      }
<span class="nc" id="L223">   }</span>

   private void closeDock()
   {
<span class="nc" id="L227">      _split.setDividerLocation(0);</span>
<span class="nc" id="L228">      _split.setDividerSize(0);</span>
<span class="nc" id="L229">   }</span>


   private void onToggleOpenDock(DockHandle handle, JToggleButton btn, ActionEvent e)
   {
<span class="nc bnc" id="L234" title="All 2 branches missed.">      if (_inOnToggleOpenDock)</span>
      {
<span class="nc" id="L236">         return;</span>
      }

      try
      {
<span class="nc" id="L241">         _inOnToggleOpenDock = true;</span>

<span class="nc bnc" id="L243" title="All 2 branches missed.">         for (int i = 0; i &lt; _pnlButtons.getComponents().length; i++)</span>
         {
<span class="nc" id="L245">            JToggleButton btnBuf = (JToggleButton) _pnlButtons.getComponents()[i];</span>

<span class="nc bnc" id="L247" title="All 2 branches missed.">            if (btnBuf != btn)</span>
            {
<span class="nc" id="L249">               btnBuf.setSelected(false);</span>
            }
         }


<span class="nc bnc" id="L254" title="All 2 branches missed.">         if (1 == _pnlDock.getComponentCount())</span>
         {
<span class="nc" id="L256">            DockHandle lastHandle = getDockHandleForComponent(_pnlDock.getComponent(0));</span>
<span class="nc" id="L257">            lastHandle.storeDividerLocation(_split.getDividerLocation());</span>
<span class="nc" id="L258">            _pnlDock.remove(0);</span>
<span class="nc" id="L259">            lastHandle.wasClosedByOtherButton(e);</span>
         }

<span class="nc bnc" id="L262" title="All 2 branches missed.">         if (btn.isSelected())</span>
         {
<span class="nc" id="L264">            _pnlDock.add(handle.getDockFrame());</span>
<span class="nc" id="L265">            _split.setDividerSize(_standardDividerSize);</span>
<span class="nc" id="L266">            _split.setDividerLocation(handle.getDividerLocation());</span>

         }
         else
         {
<span class="nc" id="L271">            closeDock();</span>
         }
      }
      finally
      {
<span class="nc" id="L276">         _inOnToggleOpenDock = false;</span>
      }
<span class="nc" id="L278">   }</span>

   private DockHandle getDockHandleForComponent(Component component)
   {
<span class="nc bnc" id="L282" title="All 2 branches missed.">      for (DockHandle dockHandle : _dockHandles)</span>
      {
<span class="nc bnc" id="L284" title="All 2 branches missed.">         if (dockHandle.getDockFrame() == component)</span>
         {
<span class="nc" id="L286">            return dockHandle;</span>
         }
<span class="nc" id="L288">      }</span>

<span class="nc" id="L290">      return null;</span>
   }

   private DockHandle addDock(Container comp, String title)
   {
<span class="nc" id="L295">      final VerticalToggleButton btn = new VerticalToggleButton(title);</span>
<span class="nc" id="L296">      btn.setBorder(BorderFactory.createEtchedBorder());</span>

<span class="nc" id="L298">      _pnlButtons.add(btn);</span>

<span class="nc" id="L300">      final DockHandle handle = new DockHandle(_app, comp, title, btn);</span>

<span class="nc" id="L302">      btn.addActionListener(new ActionListener()</span>
<span class="nc" id="L303">      {</span>
         public void actionPerformed(ActionEvent e)
         {
<span class="nc" id="L306">            onToggleOpenDock(handle, btn, e);</span>
<span class="nc" id="L307">         }</span>
      });

<span class="nc" id="L310">      _dockHandles.add(handle);</span>

<span class="nc" id="L312">      return handle;</span>
   }


   private TabPanel createTabPanel(final TabHandle tabHandle)
   {
<span class="nc" id="L318">      return new TabPanel(tabHandle);</span>
   }

   public void selectTab(TabHandle tabHandle)
   {
<span class="nc" id="L323">      TabHandle selectedHandle = getSelectedHandle();</span>
<span class="nc bnc" id="L324" title="All 2 branches missed.">      if(selectedHandle == tabHandle)</span>
      {
<span class="nc" id="L326">         return;</span>
      }

<span class="nc bnc" id="L329" title="All 2 branches missed.">      if (null != selectedHandle)</span>
      {
<span class="nc" id="L331">         selectedHandle.fireDeselected(null);</span>
      }

<span class="nc bnc" id="L334" title="All 2 branches missed.">      if (null != tabHandle)</span>
      {
<span class="nc" id="L336">         int tabIx = getTabIndex(tabHandle);</span>
<span class="nc" id="L337">         _tabbedPane.setSelectedIndex(tabIx);</span>
      }
<span class="nc" id="L339">   }</span>


   void removeTab(TabHandle tabHandle, ActionEvent e, TabClosingMode tabClosingMode)
   {


<span class="nc bnc" id="L346" title="All 2 branches missed.">      if(TabClosingMode.CLOSE_BUTTON == tabClosingMode)</span>
      {
         try
         {
<span class="nc bnc" id="L350" title="All 2 branches missed.">            if(_handlesInRemoveTab_CloseButton.contains(tabHandle))</span>
            {
<span class="nc" id="L352">               return;</span>
            }

<span class="nc" id="L355">            _handlesInRemoveTab_CloseButton.add(tabHandle);</span>
<span class="nc" id="L356">            tabHandle.fireClosing(e);</span>
<span class="nc bnc" id="L357" title="All 2 branches missed.">            if (WindowConstants.DO_NOTHING_ON_CLOSE != tabHandle.getWidget().getDefaultCloseOperation())</span>
            {
<span class="nc" id="L359">               int tabIndex = getTabIndex(tabHandle);</span>
<span class="nc bnc" id="L360" title="All 2 branches missed.">               if (-1 != tabIndex)</span>
               {
<span class="nc" id="L362">                  removeTabFromTabbedPane(tabIndex);</span>
               }
<span class="nc" id="L364">               tabHandle.fireClosed(e);</span>
<span class="nc" id="L365">               _tabHandles.remove(tabHandle);</span>
<span class="nc" id="L366">               tabHandle.removeTabHandleListener(_dockTabDesktopManager);</span>
            }
         }
         finally
         {
<span class="nc" id="L371">            _handlesInRemoveTab_CloseButton.remove(tabHandle);</span>
<span class="nc" id="L372">         }</span>
      }
<span class="nc bnc" id="L374" title="All 2 branches missed.">      else if(TabClosingMode.DISPOSE == tabClosingMode)</span>
      {
         try
         {
<span class="nc bnc" id="L378" title="All 2 branches missed.">            if(_handlesInRemoveTab_Dispose.contains(tabHandle))</span>
            {
<span class="nc" id="L380">               return;</span>
            }

<span class="nc" id="L383">            _handlesInRemoveTab_Dispose.add(tabHandle);</span>

<span class="nc bnc" id="L385" title="All 2 branches missed.">            if(false == tabHandle.isFireClosingProceedingOrDone())</span>
            {
               // Has to be done here e.g. when &quot;Close All Sessions&quot; menu was used.
<span class="nc" id="L388">               tabHandle.fireClosing(e);</span>
            }

<span class="nc" id="L391">            tabHandle.getWidget().setVisible(false);</span>
<span class="nc" id="L392">            tabHandle.fireDeselected(e);</span>
<span class="nc" id="L393">            int tabIndex = getTabIndex(tabHandle);</span>
<span class="nc bnc" id="L394" title="All 2 branches missed.">            if(-1 != tabIndex)</span>
            {
<span class="nc" id="L396">               removeTabFromTabbedPane(tabIndex);</span>
            }

            ////////////////////////////////////////////////////
            // Is done in dispose itself because listeners must be fired even in DO_NOTHING_ON_CLOSE mode
            // tabHandle.fireClosed(e);
            ///////////////////////////////////////////////////

<span class="nc" id="L404">            _tabHandles.remove(tabHandle);</span>
<span class="nc" id="L405">            tabHandle.removeTabHandleListener(_dockTabDesktopManager);</span>


<span class="nc" id="L408">            TabHandle newSelectedHandle = getSelectedHandle();</span>
<span class="nc bnc" id="L409" title="All 2 branches missed.">            if(null != newSelectedHandle)</span>
            {
               // Make sure a deselect is followed by a select when a new selected Tab exists. 
<span class="nc" id="L412">               newSelectedHandle.fireSelected(e);</span>
            }
         }
         finally
         {
<span class="nc" id="L417">            _handlesInRemoveTab_Dispose.remove(tabHandle);</span>
<span class="nc" id="L418">         }</span>
      }
      else
      {
<span class="nc" id="L422">         throw new IllegalArgumentException(&quot;Unknown TabClosingMode: &quot; + tabClosingMode);</span>
      }
<span class="nc" id="L424">   }</span>

   private void removeTabFromTabbedPane(int tabIndex)
   {
<span class="nc" id="L428">      _tabbedPane.remove(tabIndex);</span>
<span class="nc" id="L429">      _scrollableTabHandler.tabRemoved();</span>
<span class="nc" id="L430">   }</span>


   public IWidget[] getAllWidgets()
   {
<span class="nc" id="L435">      IWidget[] ret = new IWidget[_tabHandles.size()];</span>

<span class="nc bnc" id="L437" title="All 2 branches missed.">      for (int i = 0; i &lt; ret.length; i++)</span>
      {
<span class="nc" id="L439">         ret[i] = _tabHandles.get(i).getWidget();</span>
      }

<span class="nc" id="L442">      return ret;</span>
   }

   public IWidget getSelectedWidget()
   {
<span class="nc" id="L447">      TabHandle selectedHandle = getSelectedHandle();</span>

<span class="nc bnc" id="L449" title="All 2 branches missed.">      if(null == selectedHandle)</span>
      {
<span class="nc" id="L451">         return null;</span>
      }

<span class="nc" id="L454">      return selectedHandle.getWidget();</span>
   }

   private TabHandle getSelectedHandle()
   {
<span class="nc" id="L459">      TabPanel selComp = (TabPanel) _tabbedPane.getSelectedComponent();</span>

<span class="nc bnc" id="L461" title="All 2 branches missed.">      if (null == selComp)</span>
      {
<span class="nc" id="L463">         return null;</span>
      }

<span class="nc bnc" id="L466" title="All 2 branches missed.">      for (TabHandle tabHandle : _tabHandles)</span>
      {
<span class="nc bnc" id="L468" title="All 2 branches missed.">         if (tabHandle == selComp.getTabHandle())</span>
         {
<span class="nc" id="L470">            return tabHandle;</span>
         }
<span class="nc" id="L472">      }</span>

<span class="nc" id="L474">      return null;</span>
   }





   private int getTabIndex(TabHandle tabHandle)
   {
<span class="nc bnc" id="L483" title="All 2 branches missed.">      for (int i = 0; i &lt; _tabbedPane.getTabCount(); ++i)</span>
      {
<span class="nc" id="L485">         TabPanel comp = (TabPanel) _tabbedPane.getComponentAt(i);</span>

<span class="nc bnc" id="L487" title="All 2 branches missed.">         if (comp.getTabHandle() == tabHandle)</span>
         {
<span class="nc" id="L489">            return i;</span>
         }
      }

<span class="nc" id="L493">      return -1;</span>
   }


   public Dimension getRequiredSize()
   {
<span class="nc" id="L499">      return getPreferredSize();</span>
   }

   public JComponent getComponent()
   {
<span class="nc" id="L504">      return this;</span>
   }

   public void initTabRightMouseMenu()
   {
<span class="nc" id="L509">      _tabRightMouseMenu = new JPopupMenu();</span>

<span class="nc" id="L511">      _tabbedPane.addMouseListener(new MouseAdapter()</span>
<span class="nc" id="L512">      {</span>
         public void mousePressed(MouseEvent e)
         {
<span class="nc" id="L515">            maybeShowTabRightMouseMenu(e);</span>
<span class="nc" id="L516">         }</span>

         public void mouseReleased(MouseEvent e)
         {
<span class="nc" id="L520">            maybeShowTabRightMouseMenu(e);</span>
<span class="nc" id="L521">         }</span>
      });

<span class="nc" id="L524">      _tabRightMouseMenu.add(createMenu(_app.getActionCollection().get(CloseSessionWindowAction.class)));</span>
<span class="nc" id="L525">      _tabRightMouseMenu.add(createMenu(_app.getActionCollection().get(CloseSessionAction.class)));</span>
<span class="nc" id="L526">      _tabRightMouseMenu.add(createMenu(_app.getActionCollection().get(CloseAllButCurrentSessionsAction.class)));</span>
<span class="nc" id="L527">      _tabRightMouseMenu.add(createMenu(_app.getActionCollection().get(CloseAllSessionsAction.class)));</span>
      
<span class="nc" id="L529">      _tabRightMouseMenu.add(createMenu(_app.getActionCollection().get(RenameSessionAction.class)));</span>
      
<span class="nc" id="L531">   }</span>

   private JMenuItem createMenu(Action action)
   {
<span class="nc" id="L535">      JMenuItem ret = new JMenuItem(action);</span>

<span class="nc" id="L537">      String accel = (String) action.getValue(Resources.ACCELERATOR_STRING);</span>
<span class="nc bnc" id="L538" title="All 4 branches missed.">      if(   null != accel &amp;&amp; 0 != accel.trim().length())</span>
      {
<span class="nc" id="L540">         ret.setAccelerator(KeyStroke.getKeyStroke(accel));</span>
      }

<span class="nc" id="L543">      return ret;</span>
   }

   private void maybeShowTabRightMouseMenu(MouseEvent e)
   {
<span class="nc bnc" id="L548" title="All 2 branches missed.">      if (e.isPopupTrigger())</span>
      {
<span class="nc" id="L550">         int tab = _tabbedPane.getUI().tabForCoordinate(_tabbedPane, e.getX(), e.getY());</span>
<span class="nc bnc" id="L551" title="All 2 branches missed.">         if (-1 != tab)</span>
         {
<span class="nc" id="L553">            _tabRightMouseMenu.show(e.getComponent(), e.getX(), e.getY());</span>
         }
      }
<span class="nc" id="L556">   }</span>


   public void setDesktopManager(SquirrelDesktopManager squirrelDesktopManager)
   {
<span class="nc" id="L561">      _dockTabDesktopManager.setSquirrelDesktopManager(squirrelDesktopManager);</span>
<span class="nc" id="L562">   }</span>

   public void setTabTitle(TabHandle tabHandle, String title)
   {
<span class="nc" id="L566">      _tabbedPane.setTitleAt(getTabIndex(tabHandle), title);</span>
<span class="nc" id="L567">   }</span>

   public void addSmallTabButton(TabHandle tabHandle, SmallTabButton smallTabButton)
   {
<span class="nc" id="L571">      _tabbedPane.addSmallTabButtonAt(getTabIndex(tabHandle), smallTabButton);</span>
<span class="nc" id="L572">   }</span>

   public void removeSmallTabButton(TabHandle tabHandle, SmallTabButton smallTabButton)
   {
<span class="nc" id="L576">      _tabbedPane.removeSmallTabButtonAt(getTabIndex(tabHandle), smallTabButton);</span>
<span class="nc" id="L577">   }</span>



   public String getTabTitle(TabHandle tabHandle)
   {
<span class="nc" id="L583">      int index = getTabIndex(tabHandle);</span>

<span class="nc bnc" id="L585" title="All 2 branches missed.">      if(-1 == index)</span>
      {
<span class="nc" id="L587">         return null;</span>
      }
<span class="nc" id="L589">      return _tabbedPane.getTitleAt(index);</span>
   }

   public void setTabIcon(TabHandle tabHandle, Icon frameIcon)
   {
<span class="nc" id="L594">      _tabbedPane.setIconAt(getTabIndex(tabHandle), frameIcon);</span>
<span class="nc" id="L595">   }</span>


   public void putClientProperty(String key, String value)
   {
<span class="nc" id="L600">   }</span>

   public void setSelected(boolean b)
   {
<span class="nc" id="L604">      TabHandle selectedHandle = getSelectedHandle();</span>
<span class="nc bnc" id="L605" title="All 2 branches missed.">      if (null != selectedHandle)</span>
      {
<span class="nc" id="L607">         selectedHandle._setSelected(b, true);</span>
      }
      else
      {
<span class="nc" id="L611">         _app.getWindowManager().disableSessionMenu();</span>

      }
<span class="nc" id="L614">   }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>