<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>BaseDataSetViewerDestination.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">102_squirrel-sql</a> &gt; <a href="index.source.html" class="el_package">net.sourceforge.squirrel_sql.fw.datasetviewer</a> &gt; <span class="el_source">BaseDataSetViewerDestination.java</span></div><h1>BaseDataSetViewerDestination.java</h1><pre class="source lang-java linenums">package net.sourceforge.squirrel_sql.fw.datasetviewer;
/*
 * Copyright (C) 2001-2003 Colin Bell
 * colbell@users.sourceforge.net
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */
 
import javax.swing.DefaultCellEditor;

import net.sourceforge.squirrel_sql.fw.util.IMessageHandler;
import net.sourceforge.squirrel_sql.fw.util.log.ILogger;
import net.sourceforge.squirrel_sql.fw.util.log.LoggerController;

/**
 * This provides base behaviour for implemtations of &lt;TT&gt;IDataSetViewerDestination&lt;/TT&gt;.
 *
 * @author  &lt;A HREF=&quot;mailto:colbell@users.sourceforge.net&quot;&gt;Colin Bell&lt;/A&gt;
 */
<span class="nc" id="L32">public abstract class BaseDataSetViewerDestination implements IDataSetViewer</span>
{
	/** Logger for this class. */
<span class="nc" id="L35">	private static ILogger s_log =</span>
<span class="nc" id="L36">		LoggerController.createLogger(BaseDataSetViewerDestination.class);</span>

	/** Specifies whether to show the column headings. */
<span class="nc" id="L39">	private boolean _showHeadings = true;</span>

	/** Column definitions. */
<span class="nc" id="L42">	protected ColumnDisplayDefinition[] _colDefs = new ColumnDisplayDefinition[0];</span>

	/** reference to the object generating the data being displayed */
<span class="nc" id="L45">	private IDataSetUpdateableModel _updateableModelReference = null;</span>
	
	/** reference to DefaultCellEditor currently in operation, if any */
<span class="nc" id="L48">	protected DefaultCellEditor currentCellEditor = null;</span>
	
	
	public void init(IDataSetUpdateableModel updateableObject)
	{
<span class="nc" id="L53">      init(updateableObject, null);</span>
<span class="nc" id="L54">	}</span>

   /**
    * Some types of DataSetViewers require extra initialization to set up
    * a return reference to the originating data object (e.g. to allow
    * editing of that object later).  The reference is needed to distinguish
    * which tables/text may be edited and which may not.  This cannot be included
    * in the object creation because the Class.newInstance() method used in the
    * getInstance() method of this class does not allow for arguments.  Since this
    * info is needed for the DataSetViewerTablePanel and DataSetViewerTextPanel classes
    * to be able to set up the
    * popup menu correctly, those classes cannot complete their initialization without
    * this added info.  Therefore we need to initialize that class in two stages.
    */
   @Override
   public void init(IDataSetUpdateableModel updateableModel, IDataModelImplementationDetails dataModelImplementationDetails)
   {
<span class="nc" id="L71">   }</span>

   /**
	 * Specify the column definitions to use.
	 *
	 * @param	hdgs	Column definitions to use.
	 */
	public void setColumnDefinitions(ColumnDisplayDefinition[] colDefs)
	{
<span class="nc bnc" id="L80" title="All 2 branches missed.">		_colDefs = colDefs != null ? colDefs : new ColumnDisplayDefinition[0];</span>
<span class="nc" id="L81">	}</span>

	/**
	 * Return the column definitions to use.
	 *
	 * @return the column definitions to use.
	 */
	public ColumnDisplayDefinition[] getColumnDefinitions()
	{
<span class="nc" id="L90">		return _colDefs;</span>
	}

	/**
	 * Specify whether to show the column headings.
	 *
	 * @param	show	&lt;TT&gt;true&lt;/TT&gt; if headibgs to be shown else &lt;TT&gt;false&lt;/TT&gt;.
	 */
	public void showHeadings(boolean show)
	{
<span class="nc" id="L100">		_showHeadings = show;</span>
<span class="nc" id="L101">	}</span>

	/**
	 * Return whether to show the column headings.
	 *
	 * @return whether to show the column headings.
	 */
	public boolean getShowHeadings()
	{
<span class="nc" id="L110">		return _showHeadings;</span>
	}

	public synchronized void show(IDataSet ds) throws DataSetException
	{
<span class="nc" id="L115">		show(ds, null);</span>
<span class="nc" id="L116">	}</span>

	/**
	 * @throws	IllegalArgumentException
	 * 			Thrown if &lt;TT&gt;null&lt;/TT&gt; &lt;TT&gt;IDataSet&lt;/TT&gt; passed.
	 */
	public synchronized void show(IDataSet ds, IMessageHandler msgHandler)
		throws DataSetException
	{

		// We are displaying a new dataset, so if there was
		// a cell editor in operation, tell it to cancel.
		//???? How does this impact popup display?
<span class="nc bnc" id="L129" title="All 2 branches missed.">		if (currentCellEditor != null) {</span>
<span class="nc" id="L130">			currentCellEditor.cancelCellEditing();</span>
<span class="nc" id="L131">			currentCellEditor = null;</span>
		}

<span class="nc bnc" id="L134" title="All 2 branches missed.">		if (ds == null)</span>
		{
<span class="nc" id="L136">			throw new IllegalArgumentException(&quot;IDataSet == null&quot;);</span>
		}

<span class="nc" id="L139">		clear();</span>
<span class="nc bnc" id="L140" title="All 2 branches missed.">        if (ds.getDataSetDefinition() != null) {</span>
<span class="nc" id="L141">    		setColumnDefinitions(ds.getDataSetDefinition().getColumnDefinitions());</span>
<span class="nc" id="L142">    		final int colCount = ds.getColumnCount();</span>
<span class="nc bnc" id="L143" title="All 2 branches missed.">    		while (ds.next(msgHandler))</span>
    		{
<span class="nc" id="L145">    			addRow(ds, colCount);</span>
    		}
<span class="nc" id="L147">    		allRowsAdded();</span>
<span class="nc" id="L148">    		moveToTop();</span>
        }
<span class="nc" id="L150">	}</span>


	protected void addRow(IDataSet ds, int columnCount) throws DataSetException
	{
<span class="nc" id="L155">		Object[] row = new Object[columnCount];</span>
<span class="nc bnc" id="L156" title="All 2 branches missed.">		for (int i = 0; i &lt; columnCount; ++i)</span>
		{
<span class="nc" id="L158">			row[i] = ds.get(i);</span>
		}
<span class="nc" id="L160">		addRow(row);</span>
<span class="nc" id="L161">	}</span>
	
	/**
	 * Setter and getter for the reference to the updateable object
	 * representing the actual underlying data.  This will be null if
	 * the underlying data is not updateable.
	 */
	public void setUpdateableModelReference(IDataSetUpdateableModel updateableObject)
	{
<span class="nc" id="L170">		_updateableModelReference = updateableObject;</span>
<span class="nc" id="L171">	}</span>

	public IDataSetUpdateableModel getUpdateableModelReference(){
<span class="nc" id="L174">		return _updateableModelReference;</span>
	}

	protected abstract void allRowsAdded() throws DataSetException;
	protected abstract void addRow(Object[] row) throws DataSetException;


   public static IDataSetViewer getInstance(String sName, IDataSetUpdateableModel updateableModel)
   {
<span class="nc" id="L183">      return getInstance(sName, updateableModel, null);</span>
   }

	/**
	 * factory method for getting IDataSetViewer instances
	 * If no instance can be made then the default
	 * will be returned.
	 */
	public static IDataSetViewer getInstance(String sName, IDataSetUpdateableModel updateableModel, IDataModelImplementationDetails dataModelImplementationDetails)
	{
<span class="nc" id="L193">		IDataSetViewer dsv = null;</span>
		try
		{
<span class="nc" id="L196">			Class&lt;?&gt; cls = Class.forName(sName);</span>
<span class="nc" id="L197">			dsv = (IDataSetViewer) cls.newInstance();</span>
<span class="nc" id="L198">			dsv.init(updateableModel, dataModelImplementationDetails);</span>
		}
<span class="nc" id="L200">		catch (Exception e)</span>
		{
<span class="nc" id="L202">			s_log.error(&quot;Error&quot;, e);</span>
<span class="nc" id="L203">		}</span>
<span class="nc bnc" id="L204" title="All 2 branches missed.">		if (dsv == null)</span>
		{
<span class="nc" id="L206">			dsv = new DataSetViewerTablePanel();</span>
<span class="nc" id="L207">			dsv.init(updateableModel, dataModelImplementationDetails);</span>
		}
<span class="nc" id="L209">		return dsv;</span>
	}

   @Override
   public TableState getResultSortableTableState()
   {
<span class="nc" id="L215">      return null;</span>
   }

   @Override
   public void applyResultSortableTableState(TableState sortableTableState)
   {
<span class="nc" id="L221">   }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>