<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>battlecryGUI.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">72_battlecry</a> &gt; <a href="index.source.html" class="el_package">bcry</a> &gt; <span class="el_source">battlecryGUI.java</span></div><h1>battlecryGUI.java</h1><pre class="source lang-java linenums">/* Battlecry V0.1
 * Copyright (C) 2003  Marek &quot;Wansti&quot; Moeckel
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
 */

package bcry;

import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
import java.io.*;
import java.util.*;
import java.util.List.*;

/* THE BATTLECRY FRONTEND
 * This is a graphical frontend for Battlecry.
 */
public class battlecryGUI extends JFrame implements ActionListener{

<span class="nc" id="L33">   private final String TEMP_LAYOUT = &quot;data/temp/temp_lo.dat&quot;;</span>
<span class="nc" id="L34">   private final String BANNER = &quot;data/images/bcBanner.jpg&quot;;</span>
<span class="nc" id="L35">   private final String BACKGROUND_IMAGE = &quot;data/images/bcBackground.jpg&quot;;</span>
<span class="nc" id="L36">   private final String README = &quot;readme.html&quot;;</span>
<span class="nc" id="L37">   private final String DEFAULT_OUTPUT_FILE = &quot;data/temp/output.txt&quot;;</span>
   
<span class="nc" id="L39">   private int fontSize = 4;</span>
<span class="nc" id="L40">   private String fontColor = &quot;#c0c0c0&quot;;</span>
<span class="nc" id="L41">   private boolean showBackground = true;</span>
   private java.util.List currentLyrics;
   
   private bcFileDialog fd;
<span class="nc" id="L45">   private String currentModule = &quot;&quot;;</span>
   private JFrame owner;
   private JButton buttonExit;
   private JButton buttonGen;
   private JButton buttonClear;
   private JButton buttonModinfo;
   private JButton buttonLoad;
   private JButton buttonClearLayout;
<span class="nc" id="L53">   private JMenuBar mainMenu = new JMenuBar();</span>
   private JMenu menuFile;
   private JMenu menuView;  
   private JMenu menuTools;
   private JMenu menuHelp;
   private JMenu submenuFont;
   private JMenu submenuFontSize;
   private JMenu submenuFontColor;
   private JMenuItem menuOpen;
   private JMenuItem menuSave;
   private JMenuItem menuOpenLayout;
   private JMenuItem menuSaveLayout;
   private JMenuItem menuExit;
   private JMenuItem menuAbout;
   private JMenuItem menuEditor;
   private JMenuItem menuConverter;
   private JMenuItem menuReadme;
   private JMenuItem menuToggleImage;
   private JMenuItem submenuFontSize2;
   private JMenuItem submenuFontSize3;
   private JMenuItem submenuFontSize4;
   private JMenuItem submenuFontSize5;
   private JMenuItem submenuFontSize6;
   private JMenuItem submenuFontColorBlack;
   private JMenuItem submenuFontColorGrey;
<span class="nc" id="L78">   private JPanel panel = new JPanel();</span>
<span class="nc" id="L79">   private JPanel subpanel1 = new JPanel();</span>
<span class="nc" id="L80">   private JPanel subpanel2 = new JPanel();</span>
<span class="nc" id="L81">   private JPanel textPanel = new JPanel();</span>
<span class="nc" id="L82">   private JPanel sideBarLeft = new JPanel();</span>
<span class="nc" id="L83">   private JPanel sideBarRight = new JPanel();</span>
<span class="nc" id="L84">   private JPanel logPanel = new JPanel();</span>
<span class="nc" id="L85">   private JPanel layoutPanel = new JPanel();</span>
<span class="nc" id="L86">   private TextArea logWindow = new TextArea(5,80);</span>
<span class="nc" id="L87">   private JTextArea layoutField = new JTextArea(3,12);</span>
   private JEditorPane textField;
   private JScrollPane mainScroll;
<span class="nc" id="L90">   private bcGenerator bc = null;</span>
<span class="nc" id="L91">   private bcVoice voice = null;</span>
<span class="nc" id="L92">   private bcModule module = null;</span>
   private static battlecryGUI f;

   /*
    * Class Constructor
    */
   public battlecryGUI() {
<span class="nc" id="L99">      super(&quot;Battlecry 0.2cvs&quot;);</span>
<span class="nc" id="L100">      initComponents();</span>
<span class="nc" id="L101">   }</span>

   /* initComponents
    * Initializes the GUI.
    */
   private void initComponents() {

      //Menu: File
<span class="nc" id="L109">      menuFile = new JMenu(&quot;File&quot;);</span>
<span class="nc" id="L110">      menuFile.setMnemonic('F');</span>
<span class="nc" id="L111">         menuOpen = new JMenuItem(&quot;Open Module...&quot;,'o');</span>
<span class="nc" id="L112">         menuOpen.addActionListener(this);</span>
<span class="nc" id="L113">         menuSave = new JMenuItem(&quot;Save Lyrics...&quot;,'s');</span>
<span class="nc" id="L114">         menuSave.addActionListener(this);</span>
<span class="nc" id="L115">         menuOpenLayout = new JMenuItem(&quot;Open Layout...&quot;,'l');</span>
<span class="nc" id="L116">         menuOpenLayout.addActionListener(this);</span>
<span class="nc" id="L117">         menuSaveLayout = new JMenuItem(&quot;Save Layout...&quot;,'y');</span>
<span class="nc" id="L118">         menuSaveLayout.addActionListener(this);</span>
<span class="nc" id="L119">         menuExit = new JMenuItem(&quot;Exit&quot;,'x');</span>
<span class="nc" id="L120">         menuExit.addActionListener(this);</span>
<span class="nc" id="L121">      menuFile.add(menuOpen);     </span>
<span class="nc" id="L122">      menuFile.add(menuSave);</span>
<span class="nc" id="L123">      menuFile.addSeparator();</span>
<span class="nc" id="L124">      menuFile.add(menuOpenLayout);     </span>
<span class="nc" id="L125">      menuFile.add(menuSaveLayout);</span>
<span class="nc" id="L126">      menuFile.addSeparator();</span>
<span class="nc" id="L127">      menuFile.add(menuExit);</span>
      
      //Menu: View
<span class="nc" id="L130">      menuView = new JMenu(&quot;View&quot;);</span>
<span class="nc" id="L131">      menuView.setMnemonic('V');</span>
<span class="nc" id="L132">         menuToggleImage = new JMenuItem(&quot;Toggle Background&quot;,'b');</span>
<span class="nc" id="L133">         menuToggleImage.addActionListener(this);</span>
         //Submenu: Font
<span class="nc" id="L135">         submenuFont = new JMenu(&quot;Font&quot;);</span>
<span class="nc" id="L136">         submenuFont.setMnemonic('N');</span>
            //Submenus: Size and Color
<span class="nc" id="L138">            submenuFontSize = new JMenu(&quot;Size&quot;);</span>
<span class="nc" id="L139">               submenuFontSize2 = new JMenuItem(&quot;Very Small&quot;);</span>
<span class="nc" id="L140">               submenuFontSize2.addActionListener(this);</span>
<span class="nc" id="L141">               submenuFontSize3 = new JMenuItem(&quot;Small&quot;);</span>
<span class="nc" id="L142">               submenuFontSize3.addActionListener(this);</span>
<span class="nc" id="L143">               submenuFontSize4 = new JMenuItem(&quot;Normal&quot;);</span>
<span class="nc" id="L144">               submenuFontSize4.addActionListener(this);</span>
<span class="nc" id="L145">               submenuFontSize5 = new JMenuItem(&quot;Large&quot;);</span>
<span class="nc" id="L146">               submenuFontSize5.addActionListener(this);</span>
<span class="nc" id="L147">               submenuFontSize6 = new JMenuItem(&quot;Very Large&quot;);</span>
<span class="nc" id="L148">               submenuFontSize6.addActionListener(this);</span>
<span class="nc" id="L149">            submenuFontSize.add(submenuFontSize2);</span>
<span class="nc" id="L150">            submenuFontSize.add(submenuFontSize3);</span>
<span class="nc" id="L151">            submenuFontSize.add(submenuFontSize4);</span>
<span class="nc" id="L152">            submenuFontSize.add(submenuFontSize5);</span>
<span class="nc" id="L153">            submenuFontSize.add(submenuFontSize6);</span>
<span class="nc" id="L154">            submenuFontColor = new JMenu(&quot;Color&quot;);</span>
<span class="nc" id="L155">               submenuFontColorBlack = new JMenuItem(&quot;Black&quot;);</span>
<span class="nc" id="L156">               submenuFontColorBlack.addActionListener(this);</span>
<span class="nc" id="L157">               submenuFontColorGrey = new JMenuItem(&quot;Grey&quot;);</span>
<span class="nc" id="L158">               submenuFontColorGrey.addActionListener(this);</span>
<span class="nc" id="L159">            submenuFontColor.add(submenuFontColorBlack);</span>
<span class="nc" id="L160">            submenuFontColor.add(submenuFontColorGrey);</span>
<span class="nc" id="L161">         submenuFont.add(submenuFontColor);</span>
<span class="nc" id="L162">         submenuFont.add(submenuFontSize);</span>
<span class="nc" id="L163">      menuView.add(menuToggleImage);</span>
<span class="nc" id="L164">      menuView.add(submenuFont);</span>
      
      //Menu: Help
<span class="nc" id="L167">      menuHelp = new JMenu(&quot;Help&quot;);</span>
<span class="nc" id="L168">      menuHelp.setMnemonic('h');</span>
<span class="nc" id="L169">         menuReadme = new JMenuItem(&quot;Show Readme&quot;,'r');</span>
<span class="nc" id="L170">         menuReadme.addActionListener(this);</span>
<span class="nc" id="L171">         menuAbout = new JMenuItem(&quot;About...&quot;,'a');</span>
<span class="nc" id="L172">         menuAbout.addActionListener(this);</span>
<span class="nc" id="L173">      menuHelp.add(menuReadme);</span>
<span class="nc" id="L174">      menuHelp.add(menuAbout);</span>
      
      //Menu: Tools
<span class="nc" id="L177">      menuTools = new JMenu(&quot;Tools&quot;);</span>
<span class="nc" id="L178">      menuTools.setMnemonic('t');</span>
<span class="nc" id="L179">         menuEditor = new JMenuItem(&quot;Module Editor&quot;,'e');</span>
<span class="nc" id="L180">         menuEditor.addActionListener(this);</span>
<span class="nc" id="L181">         menuConverter = new JMenuItem(&quot;List Converter&quot;,'c');</span>
<span class="nc" id="L182">         menuConverter.addActionListener(this);</span>
<span class="nc" id="L183">      menuTools.add(menuEditor);</span>
<span class="nc" id="L184">      menuTools.add(menuConverter);</span>
      
      //Add Menus
<span class="nc" id="L187">      mainMenu.add(menuFile);</span>
<span class="nc" id="L188">      mainMenu.add(menuView);</span>
      //mainMenu.add(menuTools);
<span class="nc" id="L190">      mainMenu.add(menuHelp);</span>
<span class="nc" id="L191">      this.setJMenuBar(mainMenu);</span>

      //Set up text Field
<span class="nc" id="L194">      textField = new JEditorPane() {</span>
         public void paintComponent(Graphics g) {
<span class="nc" id="L196">            ImageIcon icon = new ImageIcon(BACKGROUND_IMAGE);</span>
<span class="nc" id="L197">            Dimension d = getSize(); </span>
<span class="nc" id="L198">            g.drawImage(icon.getImage(), 0, 0, d.width, d.height, null);</span>
<span class="nc" id="L199">            setOpaque(false);</span>
<span class="nc" id="L200">            super.paintComponent(g);</span>
<span class="nc" id="L201">         }</span>
      };
<span class="nc" id="L203">      textField.setBackground(new Color(100, 100, 210));</span>
<span class="nc" id="L204">      textField.setContentType(&quot;text/html&quot;);</span>
      
      //Set up other elements
<span class="nc" id="L207">      mainScroll = new JScrollPane(textField);</span>
<span class="nc" id="L208">      mainScroll.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_ALWAYS);</span>
<span class="nc" id="L209">      mainScroll.getViewport().setScrollMode(JViewport.BACKINGSTORE_SCROLL_MODE);</span>
<span class="nc" id="L210">      logWindow.setFont(new Font(&quot;SansSerif&quot;, Font.PLAIN, 10));</span>
<span class="nc" id="L211">      logWindow.setEditable(false);</span>
<span class="nc" id="L212">      layoutField.setFont(new Font(&quot;SansSerif&quot;, Font.PLAIN, 10));</span>
<span class="nc" id="L213">      layoutField.setBackground(new Color(155, 155, 200));</span>
<span class="nc" id="L214">      JScrollPane layoutScroll = new JScrollPane(layoutField);</span>

<span class="nc" id="L216">      buttonExit = new JButton(&quot;Exit&quot;);</span>
<span class="nc" id="L217">      buttonExit.addActionListener(this);</span>
<span class="nc" id="L218">      buttonGen = new JButton(&quot;Generate&quot;);</span>
<span class="nc" id="L219">      buttonGen.addActionListener(this);</span>
<span class="nc" id="L220">      buttonClear = new JButton(&quot;Clear&quot;);</span>
<span class="nc" id="L221">      buttonClear.addActionListener(this);</span>
<span class="nc" id="L222">      buttonModinfo = new JButton(&quot;Module Info&quot;);</span>
<span class="nc" id="L223">      buttonModinfo.addActionListener(this);</span>
<span class="nc" id="L224">      buttonLoad = new JButton(&quot;Load Module&quot;);</span>
<span class="nc" id="L225">      buttonLoad.addActionListener(this);</span>
<span class="nc" id="L226">      buttonClearLayout = new JButton(&quot;Clear&quot;);</span>
<span class="nc" id="L227">      buttonClearLayout.addActionListener(this);</span>

<span class="nc" id="L229">      logPanel.setLayout(new GridLayout(1,0));</span>
<span class="nc" id="L230">      logPanel.setBorder(BorderFactory.createTitledBorder(BorderFactory.createEtchedBorder(), &quot;Log Window&quot;));</span>
<span class="nc" id="L231">      logPanel.add(logWindow);</span>
<span class="nc" id="L232">      textPanel.setLayout(new BorderLayout());</span>
<span class="nc" id="L233">      textPanel.setBorder(BorderFactory.createTitledBorder(BorderFactory.createEtchedBorder(), &quot;Lyrics&quot;));</span>
<span class="nc" id="L234">      textPanel.add(&quot;Center&quot;,mainScroll);</span>
<span class="nc" id="L235">      textPanel.setMinimumSize(new Dimension(10,40));</span>

<span class="nc" id="L237">      layoutPanel.setLayout(new BorderLayout());</span>
<span class="nc" id="L238">      layoutPanel.setBorder(BorderFactory.createTitledBorder(BorderFactory.createEtchedBorder(), &quot;Custom Layout&quot;));</span>
<span class="nc" id="L239">      layoutPanel.add(&quot;Center&quot;,layoutScroll);</span>
<span class="nc" id="L240">      layoutPanel.add(&quot;South&quot;,buttonClearLayout);</span>
<span class="nc" id="L241">      sideBarRight.setLayout(new GridLayout(3,1));</span>
<span class="nc" id="L242">      sideBarRight.add(layoutPanel);</span>
<span class="nc" id="L243">      sideBarRight.setMinimumSize(new Dimension(20,10));</span>
<span class="nc" id="L244">      sideBarLeft.setLayout(new GridLayout(5,1));</span>
<span class="nc" id="L245">      sideBarLeft.setBorder(BorderFactory.createTitledBorder(BorderFactory.createEtchedBorder(), &quot;Actions&quot;));</span>
<span class="nc" id="L246">      sideBarLeft.add(buttonLoad);</span>
<span class="nc" id="L247">      sideBarLeft.add(buttonGen);</span>
<span class="nc" id="L248">      sideBarLeft.add(buttonClear);</span>
<span class="nc" id="L249">      sideBarLeft.add(buttonModinfo);</span>
<span class="nc" id="L250">      sideBarLeft.add(buttonExit);</span>
<span class="nc" id="L251">      sideBarLeft.setMinimumSize(new Dimension(20,10));</span>

<span class="nc" id="L253">      subpanel2.setLayout(new BorderLayout());</span>
<span class="nc" id="L254">      subpanel2.add(&quot;East&quot;,sideBarRight);</span>
<span class="nc" id="L255">      subpanel2.add(&quot;Center&quot;, textPanel);</span>
<span class="nc" id="L256">      subpanel1.setLayout(new BorderLayout());</span>
<span class="nc" id="L257">      subpanel1.setOpaque(false);</span>
<span class="nc" id="L258">      subpanel1.add(&quot;West&quot;,sideBarLeft);</span>
<span class="nc" id="L259">      subpanel1.add(&quot;Center&quot;, subpanel2);</span>
<span class="nc" id="L260">      JPanel subpanel3 = new JPanel();</span>
<span class="nc" id="L261">      subpanel3.setLayout(new BorderLayout());</span>
<span class="nc" id="L262">      subpanel3.add(&quot;Center&quot;, subpanel1);</span>
<span class="nc" id="L263">      subpanel3.add(&quot;North&quot;, new JLabel(new ImageIcon(BANNER)));</span>
<span class="nc" id="L264">      panel.setLayout(new BorderLayout());</span>
<span class="nc" id="L265">      panel.add(&quot;Center&quot;, subpanel3);</span>
<span class="nc" id="L266">      panel.add(&quot;South&quot;, logPanel);</span>

<span class="nc" id="L268">      getContentPane().add(panel);</span>
<span class="nc" id="L269">      pack();</span>
<span class="nc" id="L270">      setDefaultCloseOperation(WindowConstants.DO_NOTHING_ON_CLOSE);</span>
<span class="nc" id="L271">      setSize(800,600);</span>
<span class="nc" id="L272">      setResizable(true);</span>
<span class="nc" id="L273">      Window wnd = new Window(this);</span>
<span class="nc" id="L274">      setLocation((int)(wnd.getToolkit().getScreenSize().getWidth()/2-this.getWidth()/2), (int)(wnd.getToolkit().getScreenSize().getHeight()/2 - this.getHeight()/2));</span>
<span class="nc" id="L275">      setVisible(true);</span>

<span class="nc" id="L277">      addWindowListener(new java.awt.event.WindowAdapter() {</span>
             public void windowClosing(java.awt.event.WindowEvent evt) {
<span class="nc" id="L279">                  System.exit(0);</span>
<span class="nc" id="L280">            }</span>
        });
        
<span class="nc" id="L283">      guiLog(&quot;Initialized.&quot;);</span>

<span class="nc" id="L285">      boolean[] options = new boolean[2];</span>
<span class="nc" id="L286">      options[0] = true;</span>
<span class="nc" id="L287">      options[1] = false;</span>
<span class="nc" id="L288">      voice = new bcVoice(options, this);     </span>
<span class="nc" id="L289">   }</span>

   /* lyricsToTextField
    * Gets lyrics from the generator and sends them to the lyrics field.
    */
   private void lyricsToTextField() {
<span class="nc bnc" id="L295" title="All 2 branches missed.">      if (bc != null) {</span>
<span class="nc" id="L296">         currentLyrics = bc.getLyrics();</span>
<span class="nc" id="L297">         drawCurrentLyrics(currentLyrics);</span>
      }
      else {
<span class="nc" id="L300">         guiLog(&quot;You must load a module first.&quot;);</span>
      }

<span class="nc" id="L303">   }</span>

   /* writeLayoutToFile
    * Writes the text from the layout field to a temporary file.
    */
   private void writeLayoutToFile(String filename) {
      try {
<span class="nc" id="L310">         BufferedWriter bw = new BufferedWriter(new FileWriter(filename));</span>
<span class="nc" id="L311">         bw.write(layoutField.getText());</span>
<span class="nc" id="L312">         bw.close();</span>
      }
<span class="nc" id="L314">      catch (IOException e) {}</span>
<span class="nc" id="L315">   }</span>
   
   /* writeLyricsToFile
    * Saves the current lyrics to a text file.
    */
   private void writeLyricsToFile(String filename) {
      try {
<span class="nc" id="L322">         BufferedWriter bw = new BufferedWriter(new FileWriter(filename, true));</span>
<span class="nc bnc" id="L323" title="All 2 branches missed.">         if (!textField.getText().equals(&quot;&quot;)) {</span>
<span class="nc" id="L324">            bw.write(textField.getText());</span>
<span class="nc" id="L325">            bw.newLine();</span>
<span class="nc" id="L326">            bw.newLine();</span>
<span class="nc" id="L327">            bw.close();</span>
         }
         else {
<span class="nc" id="L330">            guiLog(&quot;Please load a module and generate a set of lyrics first.&quot;);</span>
         }
      }
<span class="nc" id="L333">      catch (IOException e) {}</span>
<span class="nc" id="L334">   }</span>

   /* loadModule
    * Loads a battlecry module.
    */
   private void loadModule() {
<span class="nc" id="L340">      String layout = &quot;&quot;;</span>
<span class="nc" id="L341">      fd = new bcFileDialog(&quot;bcm&quot;,&quot;Battlecry Module&quot;);</span>
<span class="nc bnc" id="L342" title="All 2 branches missed.">      if (!(layoutField.getText().equals(&quot;&quot;))) {</span>
<span class="nc" id="L343">         String temp = layoutField.getText().substring(layoutField.getText().length()-3);</span>
<span class="nc bnc" id="L344" title="All 2 branches missed.">         if (temp.equals(&quot;dat&quot;)) {</span>
<span class="nc" id="L345">            layout = layoutField.getText();</span>
<span class="nc" id="L346">            guiLog(&quot;Trying to open layout file &quot;+layoutField.getText());</span>
         }
         else {
<span class="nc" id="L349">            guiLog(&quot;Saving custom layout...&quot;);</span>
<span class="nc" id="L350">            writeLayoutToFile(TEMP_LAYOUT);</span>
<span class="nc" id="L351">            layout = TEMP_LAYOUT;</span>
         }
      }
<span class="nc bnc" id="L354" title="All 2 branches missed.">      if (currentModule.equals(&quot;&quot;)) {</span>
<span class="nc" id="L355">         clearLayout();</span>
<span class="nc" id="L356">         currentModule = fd.openDialog().getPath();</span>
<span class="nc" id="L357">         buttonLoad.setText(&quot;Reload&quot;);</span>
      }
<span class="nc bnc" id="L359" title="All 2 branches missed.">      if (!currentModule.equals(&quot;&quot;)) {</span>
         //try to get dictionary from old module, so it won't be loaded again
<span class="nc bnc" id="L361" title="All 4 branches missed.">         if ((module != null) &amp;&amp; (module.getDictionary() != null)) {</span>
<span class="nc" id="L362">            module = new bcModule(currentModule,layout,voice,module.getDictionary());</span>
         }
<span class="nc" id="L364">         else {module = new bcModule(currentModule,layout,voice);}         </span>
<span class="nc" id="L365">         bc = new bcGenerator(module,voice);</span>
      }
<span class="nc" id="L367">   }</span>

   /* readModuleInfo
    * Gets the module info and prints it to the log window.
    */
   private void readModuleInfo() {
<span class="nc bnc" id="L373" title="All 2 branches missed.">      if (bc != null) {bc.getModuleInfo();}</span>
      else {
<span class="nc" id="L375">         guiLog(&quot;You must load a module first.&quot;);</span>
      }
<span class="nc" id="L377">   }</span>

   /* clearLayout
    * Empties the layout field
    */
   private void clearLayout() {
<span class="nc bnc" id="L383" title="All 2 branches missed.">      if (!(layoutField.getText().equals(&quot;&quot;))) {</span>
<span class="nc" id="L384">         layoutField.setText(&quot;&quot;);</span>
<span class="nc bnc" id="L385" title="All 2 branches missed.">         if (!(currentModule.equals(&quot;&quot;))) {guiLog(&quot;Reloading Module...&quot;); loadModule();}</span>
      }
<span class="nc" id="L387">   }</span>
   
   /* showReadme
    * Displays the readme file in the main window.
    */
   private void showReadme() {
      try {
<span class="nc" id="L394">         textField.setPage(&quot;file://localhost/&quot;+new File(README).getAbsoluteFile());</span>
      }
<span class="nc" id="L396">      catch (IOException e) {</span>
<span class="nc" id="L397">         guiLog(e.toString());</span>
<span class="nc" id="L398">      }</span>
<span class="nc" id="L399">   }</span>
   
   /* clearMainWindow
    * does what the name says :)
    */
   private void clearMainWindow() {
<span class="nc" id="L405">      textField.setText(&quot;&quot;);</span>
<span class="nc" id="L406">   }</span>
   
   /* toggleBackground
    * show or hide background image
    */
   private void toggleBackground() {
<span class="nc bnc" id="L412" title="All 2 branches missed.">      if (showBackground == true) {</span>
<span class="nc" id="L413">         showBackground = false;</span>
<span class="nc" id="L414">         textField = new JEditorPane();</span>
<span class="nc" id="L415">         fontColor = &quot;#000000&quot;;</span>
      }
      else {
<span class="nc" id="L418">         showBackground = true;</span>
<span class="nc" id="L419">         textField = new JEditorPane() {</span>
            public void paintComponent(Graphics g) {
<span class="nc" id="L421">               ImageIcon icon = new ImageIcon(BACKGROUND_IMAGE);</span>
<span class="nc" id="L422">               Dimension d = getSize(); </span>
<span class="nc" id="L423">               g.drawImage(icon.getImage(), 0, 0, d.width, d.height, null);</span>
<span class="nc" id="L424">               setOpaque(false);</span>
<span class="nc" id="L425">               super.paintComponent(g);</span>
<span class="nc" id="L426">            }</span>
         }; 
<span class="nc" id="L428">         fontColor = &quot;#c0c0c0&quot;;</span>
      }
<span class="nc" id="L430">      textField.setBackground(new Color(100, 100, 210));</span>
<span class="nc" id="L431">      textField.setContentType(&quot;text/html&quot;);</span>
<span class="nc" id="L432">      mainScroll.setViewportView(textField);</span>
<span class="nc" id="L433">      drawCurrentLyrics(currentLyrics);</span>
<span class="nc" id="L434">   }</span>
   
   /* drawCurrentLyrics
    * formats lyrics and prints them to the text field
    */
   private void drawCurrentLyrics(java.util.List lyrics) {
         String output;
<span class="nc bnc" id="L441" title="All 2 branches missed.">         if (lyrics != null) {</span>
         //Handle title separately to add some HTML tags
<span class="nc" id="L443">         output = &quot;&lt;html&gt;&lt;font color=&quot;+fontColor+&quot;style=sans-serif size=&quot;+(fontSize+1)+&quot;&gt;&lt;b&gt;&quot;;</span>
<span class="nc" id="L444">         output += &quot;&lt;center&gt;&quot;+((String)lyrics.get(1)).substring(1,((String)lyrics.get(1)).length()-1)+&quot;&lt;/center&gt;&lt;/font&gt;&lt;hr&gt;&quot;;</span>
<span class="nc" id="L445">         output += &quot;&lt;font color=&quot;+fontColor+&quot;style=sans-serif size=&quot;+fontSize+&quot;&gt;&quot;;</span>
         //Skip title lines in the loop, also skip last line, as it is only the added line of &quot;*&quot;
<span class="nc bnc" id="L447" title="All 2 branches missed.">         for (int i=3; i&lt;lyrics.size()-1;i++) {</span>
<span class="nc" id="L448">            output += (String)lyrics.get(i)+&quot;&lt;br&gt;&quot;;</span>
         }
<span class="nc" id="L450">         output += &quot;&lt;hr&gt;&lt;/b&gt;&lt;/font&gt;&lt;/html&gt;&quot;;</span>
<span class="nc" id="L451">         textField.setText(output);</span>
      }
      else {
<span class="nc" id="L454">         guiLog(&quot;No lyrics found; you must load a module first.&quot;);</span>
      }
<span class="nc" id="L456">   }</span>

   /* actionPerformed
    * Action Listeners from all GUI elements
    */
   public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L462" title="All 4 branches missed.">      if ((e.getSource()==buttonExit) || (e.getSource()==menuExit)) {</span>
<span class="nc" id="L463">         System.out.println(&quot;Shutdown.&quot;);</span>
<span class="nc" id="L464">         System.exit(0);</span>
      }
<span class="nc bnc" id="L466" title="All 2 branches missed.">      else if (e.getSource()==buttonGen) {</span>
<span class="nc" id="L467">         lyricsToTextField();</span>
      }
<span class="nc bnc" id="L469" title="All 2 branches missed.">      else if (e.getSource()==buttonClear) {</span>
<span class="nc" id="L470">         clearMainWindow();</span>
      }
<span class="nc bnc" id="L472" title="All 2 branches missed.">      else if (e.getSource()==buttonModinfo) {</span>
<span class="nc" id="L473">         readModuleInfo();</span>
      }
<span class="nc bnc" id="L475" title="All 2 branches missed.">      else if (e.getSource()==buttonLoad) {</span>
<span class="nc" id="L476">         loadModule();</span>
      }
<span class="nc bnc" id="L478" title="All 2 branches missed.">      else if (e.getSource()==menuOpen) {</span>
<span class="nc" id="L479">         currentModule = &quot;&quot;;</span>
<span class="nc" id="L480">         loadModule();</span>
      }
<span class="nc bnc" id="L482" title="All 2 branches missed.">      else if (e.getSource()==menuSave) {</span>
<span class="nc" id="L483">         writeLyricsToFile(DEFAULT_OUTPUT_FILE);</span>
      }
<span class="nc bnc" id="L485" title="All 2 branches missed.">      else if (e.getSource()==buttonClearLayout) {</span>
<span class="nc" id="L486">         clearLayout();</span>
      }
<span class="nc bnc" id="L488" title="All 2 branches missed.">      else if (e.getSource()==menuReadme) {</span>
<span class="nc" id="L489">         showReadme();</span>
      }
<span class="nc bnc" id="L491" title="All 2 branches missed.">      else if (e.getSource()==menuToggleImage) {</span>
<span class="nc" id="L492">         toggleBackground();</span>
      }
<span class="nc bnc" id="L494" title="All 2 branches missed.">      else if (e.getSource()==submenuFontColorBlack) {</span>
<span class="nc" id="L495">         fontColor = &quot;#000000&quot;;</span>
<span class="nc" id="L496">         drawCurrentLyrics(currentLyrics);</span>
      }
<span class="nc bnc" id="L498" title="All 2 branches missed.">      else if (e.getSource()==submenuFontColorGrey) {</span>
<span class="nc" id="L499">         fontColor = &quot;#c0c0c0&quot;;</span>
<span class="nc" id="L500">         drawCurrentLyrics(currentLyrics);</span>
      }
<span class="nc bnc" id="L502" title="All 2 branches missed.">      else if (e.getSource()==submenuFontSize2) {</span>
<span class="nc" id="L503">         fontSize = 2;</span>
<span class="nc" id="L504">         drawCurrentLyrics(currentLyrics);</span>
      }
<span class="nc bnc" id="L506" title="All 2 branches missed.">      else if (e.getSource()==submenuFontSize3) {</span>
<span class="nc" id="L507">         fontSize = 3;</span>
<span class="nc" id="L508">         drawCurrentLyrics(currentLyrics);</span>
      }
<span class="nc bnc" id="L510" title="All 2 branches missed.">      else if (e.getSource()==submenuFontSize4) {</span>
<span class="nc" id="L511">         fontSize = 4;</span>
<span class="nc" id="L512">         drawCurrentLyrics(currentLyrics);</span>
      }
<span class="nc bnc" id="L514" title="All 2 branches missed.">      else if (e.getSource()==submenuFontSize5) {</span>
<span class="nc" id="L515">         fontSize = 5;</span>
<span class="nc" id="L516">         drawCurrentLyrics(currentLyrics);</span>
      }
<span class="nc bnc" id="L518" title="All 2 branches missed.">      else if (e.getSource()==submenuFontSize6) {</span>
<span class="nc" id="L519">         fontSize = 6;</span>
<span class="nc" id="L520">         drawCurrentLyrics(currentLyrics);</span>
      }

<span class="nc" id="L523">   }</span>

   /* guiLog
    * Used to print messages from the frontend class to the log window.
    */
   private void guiLog(String text) {
<span class="nc" id="L529">      logWindow.append(&quot;Gui: &quot;+text+'\n');</span>
<span class="nc" id="L530">   }</span>

   /* updateLog
    * Used by external classes (i.e. bcVoice) to print messages on the GUI.
    */
   public void updateLog(String text) {
<span class="nc" id="L536">      logWindow.append(text);</span>
<span class="nc" id="L537">   }</span>

   /* main method
    */
   public static void main(String[] args) {
<span class="fc" id="L542">      System.out.println(&quot;Battlecry GUI is starting...&quot;);</span>
<span class="nc" id="L543">      f = new battlecryGUI();</span>
<span class="nc" id="L544">   }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>