<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>bcDictionary.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">72_battlecry</a> &gt; <a href="index.source.html" class="el_package">bcry</a> &gt; <span class="el_source">bcDictionary.java</span></div><h1>bcDictionary.java</h1><pre class="source lang-java linenums">/* Battlecry V0.1
 * Copyright (C) 2003  Marek &quot;Wansti&quot; Moeckel
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
 */

package bcry;


/* BATTLECRY RHYME DICTIONARY MANAGER
 * This class manages the word database that is used to determine rhymes and syllable count
 */
import java.io.*;
import java.util.Hashtable;

class bcDictionary {

   private Hashtable database;
   private bcVoice voice;

<span class="nc" id="L33">   public bcDictionary(String dictfile, bcVoice v) {</span>
<span class="nc" id="L34">      database = new Hashtable();</span>
<span class="nc" id="L35">      voice = v;</span>
<span class="nc" id="L36">      loadDict(dictfile);</span>
<span class="nc" id="L37">   }</span>

   public int getSize() {
<span class="nc" id="L40">      return database.size();</span>
   }
          
   public String getPhonemes(String[] words) {
<span class="nc" id="L44">      String result = &quot;&quot;;</span>
<span class="nc bnc" id="L45" title="All 2 branches missed.">      for (int i = 0; i &lt; words.length-1; i++) {</span>
<span class="nc" id="L46">         result += getPhonemes(words[i]) + &quot; &quot;;</span>
      }
<span class="nc" id="L48">      result += getPhonemes(words[words.length-1]);</span>
<span class="nc" id="L49">      return result;</span>
   }
   
   public String getPhonemes(String word) {
<span class="nc" id="L53">      boolean test = false;</span>
<span class="nc" id="L54">      String result = &quot;&quot;;</span>
<span class="nc bnc" id="L55" title="All 2 branches missed.">      if (word.indexOf(&quot; &quot;) != -1) {   //if String contains more than one word, process them one by one</span>
<span class="nc" id="L56">         String[] temp = word.split(&quot; &quot;);</span>
<span class="nc bnc" id="L57" title="All 2 branches missed.">         for (int i=0; i&lt;temp.length-1; i++) {</span>
<span class="nc bnc" id="L58" title="All 2 branches missed.">            if (database.get(temp[i].toUpperCase()) != null) {</span>
<span class="nc" id="L59">               result += database.get(temp[i].toUpperCase()).toString()+&quot; &quot;;</span>
            }
         }
<span class="nc" id="L62">         test = true;</span>
<span class="nc bnc" id="L63" title="All 2 branches missed.">         if (database.get(temp[temp.length-1].toUpperCase()) != null) {</span>
<span class="nc" id="L64">               result += database.get(temp[temp.length-1].toUpperCase()).toString();</span>
         }
<span class="nc" id="L66">      }</span>
<span class="nc bnc" id="L67" title="All 2 branches missed.">      else if (database.get(word.toUpperCase()) != null) {</span>
<span class="nc" id="L68">         result = database.get(word.toUpperCase()).toString();</span>
      }
<span class="nc" id="L70">      return result;</span>
   }
   
   /* loadDict
    * Loads the Dictionary from an ASCII file and creates the word database.
    */
   public void loadDict(String filename) {
<span class="nc" id="L77">      voice.verbose(&quot;Loading dictionary file, please wait...&quot;);</span>
<span class="nc" id="L78">      String line = &quot;&quot;;</span>
<span class="nc" id="L79">      int blank = 0;</span>
      try {
<span class="nc" id="L81">         BufferedReader br = new BufferedReader(new FileReader(filename));</span>
<span class="nc bnc" id="L82" title="All 2 branches missed.">         while ((line = br.readLine()) != null) {</span>
<span class="nc bnc" id="L83" title="All 4 branches missed.">            if ((!line.startsWith(&quot;##&quot;)) &amp;&amp; (!line.equals(&quot;&quot;))) {</span>
<span class="nc" id="L84">               blank = line.indexOf(&quot; &quot;);</span>
<span class="nc" id="L85">               database.put(line.substring(0,blank), line.substring(blank+2));</span>
            }
         }
<span class="nc" id="L88">         br.close();</span>
      }
<span class="nc" id="L90">      catch (IOException e) {System.out.println(e.toString());}</span>
<span class="nc" id="L91">      voice.verbose(&quot;Dictionary ready.&quot;);</span>
<span class="nc" id="L92">   }</span>
   
   /* saveDB
    * Writes the database to a file.
    * TODO: Reduce saving time
    */
   public void saveDB(String filename) {
<span class="nc" id="L99">      System.out.print(&quot;Saving database...&quot;);</span>
      try {
<span class="nc" id="L101">         ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(filename));</span>
<span class="nc" id="L102">         oos.writeObject(database);</span>
<span class="nc" id="L103">         oos.close();</span>
      }
<span class="nc" id="L105">      catch (Exception e) {System.out.println(e.toString());}</span>
<span class="nc" id="L106">      System.out.println(&quot;done.&quot;);</span>
<span class="nc" id="L107">   }</span>
   
   /* loadDB
    * Loads a database from a file.
    * TODO: Reduce loading time
    */
   public void loadDB(String filename) {
<span class="nc" id="L114">      System.out.print(&quot;Loading database...&quot;);</span>
      try {
<span class="nc" id="L116">         ObjectInputStream ois = new ObjectInputStream(new FileInputStream(filename));</span>
<span class="nc" id="L117">         database = (Hashtable)ois.readObject();</span>
<span class="nc" id="L118">         ois.close();</span>
      }
<span class="nc" id="L120">      catch (Exception e) {System.out.println(e.toString());}</span>
<span class="nc" id="L121">      System.out.println(&quot;done.&quot;);       </span>
<span class="nc" id="L122">   }</span>
     
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>