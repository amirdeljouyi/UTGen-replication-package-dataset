<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>IPv6.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">82_ipcalculator</a> &gt; <a href="index.source.html" class="el_package">ipac</a> &gt; <span class="el_source">IPv6.java</span></div><h1>IPv6.java</h1><pre class="source lang-java linenums">package ipac;
import java.awt.*;
import java.awt.event.*;
import java.awt.Cursor;
import java.util.*;
import java.math.*;
import javax.swing.*;
import javax.swing.border.*;
import java.net.*;

/**
 *  Title: IPv6 Panel
 *  &lt;br&gt;Description: The IPv6 Panel for the Graphical User Interface.
 *  &lt;br&gt;Copyright (c) 2006-7 Jason Wang
 *
 *  &lt;p&gt;This program is free software; you can redistribute it and/or
 *  &lt;br&gt;modify it under the terms of the GNU General Public License
 *  &lt;br&gt;as published by the Free Software Foundation; either version 2
 *  &lt;br&gt;of the License, or (at your option) any later version.
 *
 *  &lt;br&gt;This program is distributed in the hope that it will be useful,
 *  &lt;br&gt;but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  &lt;br&gt;MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  &lt;br&gt;GNU General Public License for more details.
 *
 *  &lt;br&gt;You should have received a copy of the GNU General Public License
 *  &lt;br&gt;along with this program; if not, write to the Free Software
 *  &lt;br&gt;Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
 *                                                              02110-1301, USA.
 *
 *  @author      Jason Wang
 *  @version     v0.19
 */

public class IPv6 extends JPanel implements ActionListener{
    /** USER EDITABLE OPTIONS */
    /** Maximum Prefix Size / Total bits in IP address */
<span class="nc" id="L38">    int MAXPREFIX = 128;</span>
    /** Number of bits per group */
<span class="nc" id="L40">    int BITS_PER_GROUP = 16;</span>
    /** Characters per group */
<span class="nc" id="L42">    int CHARS_PER_GROUP = 4;</span>
    /** Number of groups */
<span class="nc" id="L44">    int NUMBER_OF_GROUPS = MAXPREFIX / BITS_PER_GROUP;</span>
    /** Delimiter used to seperate groups */
<span class="nc" id="L46">    String DELIMITER = &quot;:&quot;;</span>
    /** Color of the left column */
<span class="nc" id="L48">    Color TABLE_HEADINGS_BACKGROUND = new Color(240, 248, 255);</span>
    /** Color around each column */
<span class="nc" id="L50">    Color TABLE_CELL_COLOR = new Color(11, 196, 222);</span>
    
    /** Global Variables -=- DO NOT EDIT */
<span class="nc" id="L53">    Border TABLE_CELL_BORDER = BorderFactory.createMatteBorder(1, 1, 0, 1,</span>
            TABLE_CELL_COLOR);
    JTextField IPAddressTextField, numberOfIPTextField, netmaskTextField,
            rangeTextField;
    JTextArea outputTextArea;
    JCheckBox IPAddressCheckBox, rangeCheckBox;
    JRadioButton splittingPrefixRadioButton, numberOfIPRadioButton,
            netmaskRadioButton, rangeRadioButton;
<span class="nc" id="L61">    ButtonGroup radioButtonGroup = new ButtonGroup();</span>
    JComboBox childPrefix;
    JButton calculateButton, resetButton;
    
    JPanel IPv6Panel;
    GridBagConstraints gridBagConstraints;
    
    /**
     *  Creates a new instance of the IPv6 Panel for the Main Graphical User
     *  Interface.
     */
<span class="nc" id="L72">    public IPv6() {</span>
<span class="nc" id="L73">        setBackground(Color.WHITE);</span>
<span class="nc" id="L74">        IPv6Panel = new JPanel(new GridBagLayout());</span>
<span class="nc" id="L75">        IPv6Panel.setBackground(Color.WHITE);</span>
        
        /**
         *  Components within this panel are left-aligned and stretched by
         *  default.
         */
<span class="nc" id="L81">        gridBagConstraints = new GridBagConstraints();</span>
<span class="nc" id="L82">        gridBagConstraints.anchor = GridBagConstraints.WEST;</span>
<span class="nc" id="L83">        gridBagConstraints.fill = GridBagConstraints.BOTH;</span>
        
        /** Add the rows into the panel */
<span class="nc" id="L86">        addIPAddressRow();</span>
<span class="nc" id="L87">        addRangeRow();</span>
<span class="nc" id="L88">        addNetmaskRow();</span>
<span class="nc" id="L89">        addSplittingPrefixRow();</span>
<span class="nc" id="L90">        addNumberOfIPAddressRow();</span>
<span class="nc" id="L91">        addButtonsRow();</span>
<span class="nc" id="L92">        addOutputRow();</span>
        
<span class="nc" id="L94">        add(IPv6Panel);</span>
<span class="nc" id="L95">    }</span>
    
    /**
     *  Creates the IP Address row by adding a &lt;code&gt;JLabel&lt;/code&gt;, a
     *  &lt;code&gt;JTextField&lt;/code&gt; and a &lt;code&gt;JCheckBox&lt;/code&gt; to the
     *  &lt;code&gt;JPanel&lt;/code&gt;
     */
    private void addIPAddressRow(){
        /** Internet Protocol Address Label */
<span class="nc" id="L104">        JLabel IPAddressLabel = new JLabel(&quot;  Start Address / Prefix  &quot;);</span>
<span class="nc" id="L105">        IPAddressLabel.setOpaque(true);</span>
<span class="nc" id="L106">        IPAddressLabel.setBackground(TABLE_HEADINGS_BACKGROUND);</span>
<span class="nc" id="L107">        IPAddressLabel.setBorder(TABLE_CELL_BORDER);</span>
<span class="nc" id="L108">        IPAddressLabel.setFont(new Font(&quot;Arial&quot;, Font.BOLD, 12));</span>
        
        /** Edit default global constraints for this component */
<span class="nc" id="L111">        gridBagConstraints.gridx = 0;</span>
<span class="nc" id="L112">        gridBagConstraints.gridy = 0;</span>
<span class="nc" id="L113">        IPv6Panel.add(IPAddressLabel, gridBagConstraints);</span>
        /**********************************************************************/
        /**
         *  Create the right-click drop-down menu for the
         *  &lt;code&gt;JTextField&lt;/code&gt;
         */
<span class="nc" id="L119">        final JPopupMenu popupMenu = new JPopupMenu();</span>
<span class="nc" id="L120">        JMenuItem cut = new JMenuItem(&quot;Cut&quot;);</span>
<span class="nc" id="L121">        JMenuItem copy = new JMenuItem(&quot;Copy&quot;);</span>
<span class="nc" id="L122">        JMenuItem paste = new JMenuItem(&quot;Paste&quot;);</span>
<span class="nc" id="L123">        JMenuItem selectAll = new JMenuItem(&quot;Select All&quot;);</span>
        
<span class="nc" id="L125">        popupMenu.add(cut);</span>
<span class="nc" id="L126">        popupMenu.add(copy);</span>
<span class="nc" id="L127">        popupMenu.add(paste);</span>
<span class="nc" id="L128">        popupMenu.add(selectAll);</span>
        
<span class="nc" id="L130">        cut.addActionListener(new ActionListener() {</span>
            public void actionPerformed( ActionEvent e ) {
<span class="nc" id="L132">                IPAddressTextField.cut();</span>
<span class="nc" id="L133">            }</span>
        });
        
<span class="nc" id="L136">        copy.addActionListener(new ActionListener() {</span>
            public void actionPerformed( ActionEvent e ) {
<span class="nc" id="L138">                IPAddressTextField.copy();</span>
<span class="nc" id="L139">            }</span>
        });
        
<span class="nc" id="L142">        paste.addActionListener(new ActionListener() {</span>
            public void actionPerformed( ActionEvent e ) {
<span class="nc" id="L144">                IPAddressTextField.paste();</span>
<span class="nc" id="L145">            }</span>
        });
        
<span class="nc" id="L148">        selectAll.addActionListener(new ActionListener() {</span>
            public void actionPerformed( ActionEvent e ) {
<span class="nc" id="L150">                IPAddressTextField.selectAll();</span>
<span class="nc" id="L151">            }</span>
        });
        
        /** Internet Protocol Address Text Field */
<span class="nc" id="L155">        IPAddressTextField = new JTextField(25);</span>
        
        /** Add drop-down menu */
<span class="nc" id="L158">        IPAddressTextField.addMouseListener(new MouseAdapter() {</span>
            public void mousePressed( MouseEvent e ) {
<span class="nc" id="L160">                checkForTriggerEvent(e);</span>
<span class="nc" id="L161">            }</span>
            public void mouseReleased( MouseEvent e ) {
<span class="nc" id="L163">                checkForTriggerEvent(e);</span>
<span class="nc" id="L164">            }</span>
            private void checkForTriggerEvent( MouseEvent e ) {
<span class="nc bnc" id="L166" title="All 2 branches missed.">                if ( e.isPopupTrigger() )</span>
<span class="nc" id="L167">                    popupMenu.show( e.getComponent(), e.getX(), e.getY() );</span>
<span class="nc" id="L168">            }</span>
        });
        
        /** When &quot;ENTER&quot; key is pressed, it calls &lt;code&gt;calculate()&lt;/code&gt; */
<span class="nc" id="L172">        IPAddressTextField.addKeyListener(new KeyAdapter(){</span>
            public void keyPressed(KeyEvent e ){
<span class="nc bnc" id="L174" title="All 2 branches missed.">                if (e.getKeyCode() == KeyEvent.VK_ENTER){</span>
<span class="nc" id="L175">                    calculate();</span>
                }
<span class="nc" id="L177">            }</span>
        });
<span class="nc" id="L179">        IPAddressTextField.setToolTipText(&quot;Enter a valid IPv6 address. &quot; +</span>
                &quot;e.g. 1234:5678:90AB:CDEF:1234:5678:90AB:CDEF&quot;);
        
        /** Edit default global constraints for this component */
<span class="nc" id="L183">        gridBagConstraints.gridx = 2;</span>
<span class="nc" id="L184">        gridBagConstraints.gridwidth = 3;</span>
<span class="nc" id="L185">        IPv6Panel.add(IPAddressTextField, gridBagConstraints);</span>
<span class="nc" id="L186">        gridBagConstraints.gridwidth = 1;</span>
<span class="nc" id="L187">        IPAddressTextField.setRequestFocusEnabled(true);</span>
        /**********************************************************************/
        /** Padding option */
<span class="nc" id="L190">        Action actionListener = new AbstractAction(&quot;  Padded  &quot;) {</span>
            public void actionPerformed(ActionEvent evt){
<span class="nc" id="L192">                boolean inputPadded = ((JCheckBox)evt.getSource()).isSelected();</span>
<span class="nc" id="L193">                pad(IPAddressTextField, inputPadded);</span>
<span class="nc" id="L194">            }</span>
        };
<span class="nc" id="L196">        IPAddressCheckBox = new JCheckBox(actionListener);</span>
        
        /** When &quot;ENTER&quot; key is pressed, it calls &lt;code&gt;calculate()&lt;/code&gt; */
<span class="nc" id="L199">        IPAddressCheckBox.addKeyListener(new KeyAdapter(){</span>
            public void keyPressed(KeyEvent e ){
<span class="nc bnc" id="L201" title="All 2 branches missed.">                if (e.getKeyCode() == KeyEvent.VK_ENTER){</span>
<span class="nc" id="L202">                    calculate();</span>
                }
<span class="nc" id="L204">            }</span>
        });
<span class="nc" id="L206">        IPAddressCheckBox.setToolTipText(&quot;Zero pad decimal representation&quot;);</span>
<span class="nc" id="L207">        IPAddressCheckBox.setBackground(Color.WHITE);</span>
        
        /** Edit default global constraints for this component */
<span class="nc" id="L210">        gridBagConstraints.gridx = 5;</span>
<span class="nc" id="L211">        IPv6Panel.add(IPAddressCheckBox, gridBagConstraints);</span>
<span class="nc" id="L212">    }</span>
    
    /**
     *  Creates the IP Range row by adding a &lt;code&gt;JLabel&lt;/code&gt;, a
     *  &lt;code&gt;JRadioButton&lt;/code&gt;, a &lt;code&gt;JTextField&lt;/code&gt; and a
     *  &lt;code&gt;JCheckBox&lt;/code&gt; to the &lt;code&gt;JPanel&lt;/code&gt;
     */
    private void addRangeRow() {
        /** Range Label */
<span class="nc" id="L221">        JLabel rangeLabel = new JLabel(&quot;  End Address  &quot;);</span>
<span class="nc" id="L222">        rangeLabel.setBackground(TABLE_HEADINGS_BACKGROUND);</span>
<span class="nc" id="L223">        rangeLabel.setOpaque(true);</span>
<span class="nc" id="L224">        rangeLabel.setFont(new Font(&quot;Arial&quot;, Font.BOLD, 12));</span>
<span class="nc" id="L225">        rangeLabel.setBorder(TABLE_CELL_BORDER);</span>
        
        /** Edit default global constraints for this component */
<span class="nc" id="L228">        gridBagConstraints.gridx = 0;</span>
<span class="nc" id="L229">        gridBagConstraints.gridy = 1;</span>
<span class="nc" id="L230">        IPv6Panel.add(rangeLabel, gridBagConstraints);</span>
        /**********************************************************************/
        /** Netmask Radio Button */
<span class="nc" id="L233">        rangeRadioButton = new JRadioButton();</span>
<span class="nc" id="L234">        rangeRadioButton.addActionListener(this);</span>
<span class="nc" id="L235">        radioButtonGroup.add(rangeRadioButton);</span>
        
        /** When &quot;ENTER&quot; key is pressed, it calls &lt;code&gt;calculate()&lt;/code&gt; */
<span class="nc" id="L238">        rangeRadioButton.addKeyListener(new KeyAdapter(){</span>
            public void keyPressed(KeyEvent e ){
<span class="nc bnc" id="L240" title="All 2 branches missed.">                if (e.getKeyCode() == KeyEvent.VK_ENTER){</span>
<span class="nc" id="L241">                    calculate();</span>
                }
<span class="nc" id="L243">            }</span>
        });
<span class="nc" id="L245">        rangeRadioButton.setBackground(Color.WHITE);</span>
        
        /** Edit default global constraints for this component */
<span class="nc" id="L248">        gridBagConstraints.gridx = 1;</span>
<span class="nc" id="L249">        IPv6Panel.add(rangeRadioButton, gridBagConstraints);</span>
        /**********************************************************************/
        /**
         *  Create the right-click drop-down menu for the
         *  &lt;code&gt;JTextField&lt;/code&gt;
         */
<span class="nc" id="L255">        final JPopupMenu popupMenu = new JPopupMenu();</span>
<span class="nc" id="L256">        JMenuItem cut = new JMenuItem(&quot;Cut&quot;);</span>
<span class="nc" id="L257">        JMenuItem copy = new JMenuItem(&quot;Copy&quot;);</span>
<span class="nc" id="L258">        JMenuItem paste = new JMenuItem(&quot;Paste&quot;);</span>
<span class="nc" id="L259">        JMenuItem selectAll = new JMenuItem(&quot;Select All&quot;);</span>
        
<span class="nc" id="L261">        popupMenu.add(cut);</span>
<span class="nc" id="L262">        popupMenu.add(copy);</span>
<span class="nc" id="L263">        popupMenu.add(paste);</span>
<span class="nc" id="L264">        popupMenu.add(selectAll);</span>
        
<span class="nc" id="L266">        cut.addActionListener(new ActionListener() {</span>
            public void actionPerformed( ActionEvent e ) {
<span class="nc" id="L268">                rangeTextField.cut();</span>
<span class="nc" id="L269">            }</span>
        });
        
<span class="nc" id="L272">        copy.addActionListener(new ActionListener() {</span>
            public void actionPerformed( ActionEvent e ) {
<span class="nc" id="L274">                rangeTextField.copy();</span>
<span class="nc" id="L275">            }</span>
        });
        
<span class="nc" id="L278">        paste.addActionListener(new ActionListener() {</span>
            public void actionPerformed( ActionEvent e ) {
<span class="nc" id="L280">                rangeTextField.paste();</span>
<span class="nc" id="L281">            }</span>
        });
        
<span class="nc" id="L284">        selectAll.addActionListener(new ActionListener() {</span>
            public void actionPerformed( ActionEvent e ) {
<span class="nc" id="L286">                rangeTextField.selectAll();</span>
<span class="nc" id="L287">            }</span>
        });
        
        /** Netmask Text Field */
<span class="nc" id="L291">        rangeTextField = new JTextField();</span>
        
        /** Add drop-down menu */
<span class="nc" id="L294">        rangeTextField.addMouseListener(new MouseAdapter() {</span>
            public void mousePressed( MouseEvent e ) {
<span class="nc" id="L296">                checkForTriggerEvent(e);</span>
<span class="nc" id="L297">            }</span>
            public void mouseReleased( MouseEvent e ) {
<span class="nc" id="L299">                checkForTriggerEvent(e);</span>
<span class="nc" id="L300">            }</span>
            private void checkForTriggerEvent( MouseEvent e ) {
<span class="nc bnc" id="L302" title="All 2 branches missed.">                if ( e.isPopupTrigger() )</span>
<span class="nc" id="L303">                    popupMenu.show( e.getComponent(), e.getX(), e.getY() );</span>
<span class="nc" id="L304">            }</span>
        });
        
        /** When &quot;ENTER&quot; key is pressed, it calls &lt;code&gt;calculate()&lt;/code&gt; */
<span class="nc" id="L308">        rangeTextField.addKeyListener(new KeyAdapter(){</span>
            public void keyPressed(KeyEvent e ){
<span class="nc bnc" id="L310" title="All 2 branches missed.">                if (e.getKeyCode() == KeyEvent.VK_ENTER){</span>
<span class="nc" id="L311">                    calculate();</span>
                }
<span class="nc" id="L313">            }</span>
        });
<span class="nc" id="L315">        rangeTextField.setToolTipText(&quot;Enter the end IP address range you &quot; +</span>
                &quot;wish to calculate&quot;);
<span class="nc" id="L317">        rangeTextField.setEditable(false);</span>
        
        /** Edit default global constraints for this component */
<span class="nc" id="L320">        gridBagConstraints.gridx = 2;</span>
<span class="nc" id="L321">        gridBagConstraints.gridwidth = 3;</span>
<span class="nc" id="L322">        IPv6Panel.add(rangeTextField, gridBagConstraints);</span>
<span class="nc" id="L323">        gridBagConstraints.gridwidth = 1;</span>
        /**********************************************************************/
        /** Padding option */
<span class="nc" id="L326">        Action actionListener = new AbstractAction(&quot;  Padded  &quot;) {</span>
            public void actionPerformed(ActionEvent evt){
<span class="nc" id="L328">                boolean rangePadded = ((JCheckBox)evt.getSource()).isSelected();</span>
<span class="nc" id="L329">                pad(rangeTextField, rangePadded);</span>
<span class="nc" id="L330">            }</span>
        };
<span class="nc" id="L332">        rangeCheckBox = new JCheckBox(actionListener);</span>
        
        /** When &quot;ENTER&quot; key is pressed, it calls &lt;code&gt;calculate()&lt;/code&gt; */
<span class="nc" id="L335">        rangeCheckBox.addKeyListener(new KeyAdapter(){</span>
            public void keyPressed(KeyEvent e ){
<span class="nc bnc" id="L337" title="All 2 branches missed.">                if (e.getKeyCode() == KeyEvent.VK_ENTER){</span>
<span class="nc" id="L338">                    calculate();</span>
                }
<span class="nc" id="L340">            }</span>
        });
<span class="nc" id="L342">        rangeCheckBox.setToolTipText(&quot;Zero pad decimal representation&quot;);</span>
<span class="nc" id="L343">        rangeCheckBox.setBackground(Color.WHITE);</span>
<span class="nc" id="L344">        rangeCheckBox.setEnabled(false);</span>
        
        /** Edit default global constraints for this component */
<span class="nc" id="L347">        gridBagConstraints.gridx = 5;</span>
<span class="nc" id="L348">        IPv6Panel.add(rangeCheckBox, gridBagConstraints);</span>
<span class="nc" id="L349">    }</span>
    
    /**
     *  Creates the Netmask row by adding a &lt;code&gt;JLabel&lt;/code&gt;, a
     *  &lt;code&gt;JRadioButton&lt;/code&gt; and a &lt;code&gt;JTextField&lt;/code&gt; to the
     *  &lt;code&gt;JPanel&lt;/code&gt;
     */
    private void addNetmaskRow() {
        /** Netmask Label */
<span class="nc" id="L358">        JLabel netmaskLabel = new JLabel(&quot;  Netmask  &quot;);</span>
<span class="nc" id="L359">        netmaskLabel.setBackground(TABLE_HEADINGS_BACKGROUND);</span>
<span class="nc" id="L360">        netmaskLabel.setOpaque(true);</span>
<span class="nc" id="L361">        netmaskLabel.setFont(new Font(&quot;Arial&quot;, Font.BOLD, 12));</span>
<span class="nc" id="L362">        netmaskLabel.setBorder(TABLE_CELL_BORDER);</span>
        
        /** Edit default global constraints for this component */
<span class="nc" id="L365">        gridBagConstraints.gridx = 0;</span>
<span class="nc" id="L366">        gridBagConstraints.gridy = 2;</span>
<span class="nc" id="L367">        IPv6Panel.add(netmaskLabel, gridBagConstraints);</span>
        /**********************************************************************/
        /** Netmask Radio Button */
<span class="nc" id="L370">        netmaskRadioButton = new JRadioButton();</span>
<span class="nc" id="L371">        netmaskRadioButton.addActionListener(this);</span>
<span class="nc" id="L372">        radioButtonGroup.add(netmaskRadioButton);</span>
        
        /** When &quot;ENTER&quot; key is pressed, starts calculations */
<span class="nc" id="L375">        netmaskRadioButton.addKeyListener(new KeyAdapter(){</span>
            public void keyPressed(KeyEvent e ){
<span class="nc bnc" id="L377" title="All 2 branches missed.">                if (e.getKeyCode() == KeyEvent.VK_ENTER){</span>
<span class="nc" id="L378">                    calculate();</span>
                }
<span class="nc" id="L380">            }</span>
        });
<span class="nc" id="L382">        netmaskRadioButton.setBackground(Color.WHITE);</span>
        
        /** Edit default global constraints for this component */
<span class="nc" id="L385">        gridBagConstraints.gridx = 1;</span>
<span class="nc" id="L386">        IPv6Panel.add(netmaskRadioButton, gridBagConstraints);</span>
        /**********************************************************************/
        /**
         *  Create the right-click drop-down menu for the
         *  &lt;code&gt;JTextField&lt;/code&gt;
         */
<span class="nc" id="L392">        final JPopupMenu popupMenu = new JPopupMenu();</span>
<span class="nc" id="L393">        JMenuItem cut = new JMenuItem(&quot;Cut&quot;);</span>
<span class="nc" id="L394">        JMenuItem copy = new JMenuItem(&quot;Copy&quot;);</span>
<span class="nc" id="L395">        JMenuItem paste = new JMenuItem(&quot;Paste&quot;);</span>
<span class="nc" id="L396">        JMenuItem selectAll = new JMenuItem(&quot;Select All&quot;);</span>
        
<span class="nc" id="L398">        popupMenu.add(cut);</span>
<span class="nc" id="L399">        popupMenu.add(copy);</span>
<span class="nc" id="L400">        popupMenu.add(paste);</span>
<span class="nc" id="L401">        popupMenu.add(selectAll);</span>
        
<span class="nc" id="L403">        cut.addActionListener(new ActionListener() {</span>
            public void actionPerformed( ActionEvent e ) {
<span class="nc" id="L405">                netmaskTextField.cut();</span>
<span class="nc" id="L406">            }</span>
        });
        
<span class="nc" id="L409">        copy.addActionListener(new ActionListener() {</span>
            public void actionPerformed( ActionEvent e ) {
<span class="nc" id="L411">                netmaskTextField.copy();</span>
<span class="nc" id="L412">            }</span>
        });
        
<span class="nc" id="L415">        paste.addActionListener(new ActionListener() {</span>
            public void actionPerformed( ActionEvent e ) {
<span class="nc" id="L417">                netmaskTextField.paste();</span>
<span class="nc" id="L418">            }</span>
        });
        
<span class="nc" id="L421">        selectAll.addActionListener(new ActionListener() {</span>
            public void actionPerformed( ActionEvent e ) {
<span class="nc" id="L423">                netmaskTextField.selectAll();</span>
<span class="nc" id="L424">            }</span>
        });
        
        /** Netmask Text Field */
<span class="nc" id="L428">        netmaskTextField = new JTextField();</span>
<span class="nc" id="L429">        netmaskTextField.setEditable(false);</span>
        
        /** Add drop-down menu */
<span class="nc" id="L432">        netmaskTextField.addMouseListener(new MouseAdapter() {</span>
            public void mousePressed( MouseEvent e ) {
<span class="nc" id="L434">                checkForTriggerEvent(e);</span>
<span class="nc" id="L435">            }</span>
            public void mouseReleased( MouseEvent e ) {
<span class="nc" id="L437">                checkForTriggerEvent(e);</span>
<span class="nc" id="L438">            }</span>
            private void checkForTriggerEvent( MouseEvent e ) {
<span class="nc bnc" id="L440" title="All 2 branches missed.">                if ( e.isPopupTrigger() )</span>
<span class="nc" id="L441">                    popupMenu.show( e.getComponent(), e.getX(), e.getY() );</span>
<span class="nc" id="L442">            }</span>
        });
        
        /** When &quot;ENTER&quot; key is pressed, it calls &lt;code&gt;calculate()&lt;/code&gt; */
<span class="nc" id="L446">        netmaskTextField.addKeyListener(new KeyAdapter(){</span>
            public void keyPressed(KeyEvent e ){
<span class="nc bnc" id="L448" title="All 2 branches missed.">                if (e.getKeyCode() == KeyEvent.VK_ENTER){</span>
<span class="nc" id="L449">                    calculate();</span>
                }
<span class="nc" id="L451">            }</span>
        });
<span class="nc" id="L453">        netmaskTextField.setToolTipText(&quot;Enter the netmask you wish to &quot; +</span>
                &quot;calculate&quot;);
        
        /** Edit default global constraints for this component */
<span class="nc" id="L457">        gridBagConstraints.gridx = 2;</span>
<span class="nc" id="L458">        gridBagConstraints.gridwidth = 3;</span>
<span class="nc" id="L459">        IPv6Panel.add(netmaskTextField, gridBagConstraints);</span>
<span class="nc" id="L460">        gridBagConstraints.gridwidth = 1;</span>
<span class="nc" id="L461">    }</span>
    
    /**
     *  Creates the Splitting Prefix row by adding three &lt;code&gt;JLabel&lt;/code&gt;, a
     *  &lt;code&gt;JRadioButton&lt;/code&gt; and two &lt;code&gt;JComboBox&lt;/code&gt; to the
     *  &lt;code&gt;JPanel&lt;/code&gt;
     */
    private void addSplittingPrefixRow(){
        /** Splitting Prefix Label */
<span class="nc" id="L470">        JLabel splittingPrefixLabel = new JLabel(&quot;  Split into  &quot;);</span>
<span class="nc" id="L471">        splittingPrefixLabel.setBackground(TABLE_HEADINGS_BACKGROUND);</span>
<span class="nc" id="L472">        splittingPrefixLabel.setOpaque(true);</span>
<span class="nc" id="L473">        splittingPrefixLabel.setBorder(TABLE_CELL_BORDER);</span>
<span class="nc" id="L474">        splittingPrefixLabel.setFont(new Font(&quot;Arial&quot;, Font.BOLD, 12));</span>
        
        /** Edit default global constraints for this component */
<span class="nc" id="L477">        gridBagConstraints.gridx = 0;</span>
<span class="nc" id="L478">        gridBagConstraints.gridy = 3;</span>
<span class="nc" id="L479">        IPv6Panel.add(splittingPrefixLabel, gridBagConstraints);</span>
        /**********************************************************************/
        /** Splitting Prefix Radio Button */
<span class="nc" id="L482">        splittingPrefixRadioButton = new JRadioButton(&quot;&quot;,true);</span>
<span class="nc" id="L483">        splittingPrefixRadioButton.addActionListener(this);</span>
<span class="nc" id="L484">        radioButtonGroup.add(splittingPrefixRadioButton);</span>
        
        /** When &quot;ENTER&quot; key is pressed, it calls &lt;code&gt;calculate()&lt;/code&gt; */
<span class="nc" id="L487">        splittingPrefixRadioButton.addKeyListener(new KeyAdapter(){</span>
            public void keyPressed(KeyEvent e ){
<span class="nc bnc" id="L489" title="All 2 branches missed.">                if (e.getKeyCode() == KeyEvent.VK_ENTER){</span>
<span class="nc" id="L490">                    calculate();</span>
                }
<span class="nc" id="L492">            }</span>
        });
<span class="nc" id="L494">        splittingPrefixRadioButton.setBackground(Color.WHITE);</span>
        
        /** Edit default global constraints for this component */
<span class="nc" id="L497">        gridBagConstraints.gridx = 1;</span>
<span class="nc" id="L498">        IPv6Panel.add(splittingPrefixRadioButton, gridBagConstraints);</span>
        /**********************************************************************/
        /** Child Prefix drop-down menu */
<span class="nc" id="L501">        childPrefix = new JComboBox();</span>
<span class="nc" id="L502">        childPrefix.addItem(&quot;&quot;);</span>
<span class="nc bnc" id="L503" title="All 2 branches missed.">        for (int i = MAXPREFIX - 2; i &gt;= 1; i--){</span>
<span class="nc" id="L504">            childPrefix.addItem(&quot;/&quot; + i);</span>
        }
        
        /** When &quot;ENTER&quot; key is pressed, it calls &lt;code&gt;calculate()&lt;/code&gt; */
<span class="nc" id="L508">        childPrefix.addKeyListener(new KeyAdapter(){</span>
            public void keyPressed(KeyEvent e ){
<span class="nc bnc" id="L510" title="All 2 branches missed.">                if (e.getKeyCode() == KeyEvent.VK_ENTER){</span>
<span class="nc" id="L511">                    calculate();</span>
                }
<span class="nc" id="L513">            }</span>
        });
<span class="nc" id="L515">        childPrefix.setToolTipText(&quot;Select the child prefix size you require&quot;);</span>
<span class="nc" id="L516">        childPrefix.setBackground(Color.WHITE);</span>
        
        /** Edit default global constraints for this component */
<span class="nc" id="L519">        gridBagConstraints.gridx = 2;</span>
<span class="nc" id="L520">        IPv6Panel.add(childPrefix, gridBagConstraints);</span>
        /**********************************************************************/
        /** End label */
<span class="nc" id="L523">        JLabel endLabel = new JLabel(&quot;   prefixs  &quot;);</span>
        
        /** Edit default global constraints for this component */
<span class="nc" id="L526">        gridBagConstraints.gridx = 3;</span>
<span class="nc" id="L527">        IPv6Panel.add(endLabel, gridBagConstraints);</span>
<span class="nc" id="L528">    }</span>
    
    /**
     *  Creates the Number of IP Addresses row by adding a &lt;code&gt;JLabel&lt;/code&gt;,
     *  a &lt;code&gt;JRadioButton&lt;/code&gt; and a &lt;code&gt;JTextField&lt;/code&gt; to the
     *  &lt;code&gt;JPanel&lt;/code&gt;
     */
    private void addNumberOfIPAddressRow() {
        /** Number of IP Label */
<span class="nc" id="L537">        JLabel numberOfIPLabel = new JLabel(&quot;  Number of IP Addresses  &quot;);</span>
<span class="nc" id="L538">        numberOfIPLabel.setBackground(TABLE_HEADINGS_BACKGROUND);</span>
<span class="nc" id="L539">        numberOfIPLabel.setOpaque(true);</span>
<span class="nc" id="L540">        numberOfIPLabel.setFont(new Font(&quot;Arial&quot;, Font.BOLD, 12));</span>
<span class="nc" id="L541">        numberOfIPLabel.setBorder(BorderFactory.createMatteBorder(1, 1, 1, 1,</span>
                TABLE_CELL_COLOR));
        
        /** Edit default global constraints for this component */
<span class="nc" id="L545">        gridBagConstraints.gridx = 0;</span>
<span class="nc" id="L546">        gridBagConstraints.gridy = 4;</span>
<span class="nc" id="L547">        IPv6Panel.add(numberOfIPLabel, gridBagConstraints);</span>
        /**********************************************************************/
        /** Number of IP Radio Button */
<span class="nc" id="L550">        numberOfIPRadioButton = new JRadioButton();</span>
<span class="nc" id="L551">        numberOfIPRadioButton.addActionListener(this);</span>
<span class="nc" id="L552">        radioButtonGroup.add(numberOfIPRadioButton);</span>
        
        /** When &quot;ENTER&quot; key is pressed, it calls &lt;code&gt;calculate()&lt;/code&gt; */
<span class="nc" id="L555">        numberOfIPRadioButton.addKeyListener(new KeyAdapter(){</span>
            public void keyPressed(KeyEvent e ){
<span class="nc bnc" id="L557" title="All 2 branches missed.">                if (e.getKeyCode() == KeyEvent.VK_ENTER){</span>
<span class="nc" id="L558">                    calculate();</span>
                }
<span class="nc" id="L560">            }</span>
        });
<span class="nc" id="L562">        numberOfIPRadioButton.setBackground(Color.WHITE);</span>
        
        /** Edit default global constraints for this component */
<span class="nc" id="L565">        gridBagConstraints.gridx = 1;</span>
<span class="nc" id="L566">        IPv6Panel.add(numberOfIPRadioButton, gridBagConstraints);</span>
        /**********************************************************************/
        /** Number of IP Text Field */
<span class="nc" id="L569">        numberOfIPTextField = new JTextField();</span>
<span class="nc" id="L570">        numberOfIPTextField.setEditable(false);</span>
        
        /** When &quot;ENTER&quot; key is pressed, it calls &lt;code&gt;calculate()&lt;/code&gt; */
<span class="nc" id="L573">        numberOfIPTextField.addKeyListener(new KeyAdapter(){</span>
            public void keyPressed(KeyEvent e ){
<span class="nc bnc" id="L575" title="All 2 branches missed.">                if (e.getKeyCode() == KeyEvent.VK_ENTER){</span>
<span class="nc" id="L576">                    calculate();</span>
                }
<span class="nc" id="L578">            }</span>
        });
<span class="nc" id="L580">        numberOfIPTextField.setToolTipText(&quot;Enter the number of IPv6 &quot; +</span>
                &quot;addresses you require&quot;);
        
        /** Edit default global constraints for this component */
<span class="nc" id="L584">        gridBagConstraints.gridx = 2;</span>
<span class="nc" id="L585">        gridBagConstraints.gridwidth = 3;</span>
<span class="nc" id="L586">        IPv6Panel.add(numberOfIPTextField, gridBagConstraints);</span>
<span class="nc" id="L587">        gridBagConstraints.gridwidth = 1;</span>
<span class="nc" id="L588">    }</span>
    
    /**
     *  Creates the buttons row by adding two &lt;code&gt;JButtons&lt;/code&gt; to the
     *  &lt;code&gt;JPanel&lt;/code&gt;
     */
    private void addButtonsRow() {
        /** Calculate Button */
<span class="nc" id="L596">        calculateButton = new JButton(&quot;  Calculate  &quot;);</span>
<span class="nc" id="L597">        calculateButton.addActionListener(this);</span>
        
        /** Edit default global constraints for this component */
<span class="nc" id="L600">        gridBagConstraints.gridx = 1;</span>
<span class="nc" id="L601">        gridBagConstraints.gridy = 5;</span>
<span class="nc" id="L602">        gridBagConstraints.gridwidth = 2;</span>
<span class="nc" id="L603">        gridBagConstraints.insets = new Insets(10, 0, 0, 0);</span>
<span class="nc" id="L604">        gridBagConstraints.fill = GridBagConstraints.NONE;</span>
<span class="nc" id="L605">        IPv6Panel.add(calculateButton, gridBagConstraints);</span>
        /**********************************************************************/
        /** Reset Button */
<span class="nc" id="L608">        resetButton = new JButton(&quot;  Reset  &quot;);</span>
<span class="nc" id="L609">        resetButton.addActionListener(this);</span>
        
        /** Edit default global constraints for this component */
<span class="nc" id="L612">        gridBagConstraints.gridx = 4;</span>
<span class="nc" id="L613">        IPv6Panel.add(resetButton, gridBagConstraints);</span>
<span class="nc" id="L614">        gridBagConstraints.gridwidth = 1;</span>
<span class="nc" id="L615">        gridBagConstraints.fill = GridBagConstraints.BOTH;</span>
<span class="nc" id="L616">    }</span>
    
    /**
     *  Creates the output row by adding a &lt;code&gt;JTextArea&lt;/code&gt; to the
     *  &lt;code&gt;JPanel&lt;/code&gt;
     */
    private void addOutputRow(){
        // Text Area where output would be printed
<span class="nc" id="L624">        outputTextArea = new JTextArea();</span>
<span class="nc" id="L625">        outputTextArea.setLineWrap(true);</span>
<span class="nc" id="L626">        outputTextArea.setEditable(false);</span>
        
        // Edit default global constraints for this component
<span class="nc" id="L629">        gridBagConstraints.gridx = 0;</span>
<span class="nc" id="L630">        gridBagConstraints.gridy = 6;</span>
<span class="nc" id="L631">        gridBagConstraints.gridwidth = 6;</span>
<span class="nc" id="L632">        IPv6Panel.add(outputTextArea, gridBagConstraints);</span>
<span class="nc" id="L633">        gridBagConstraints.gridwidth = 1;</span>
<span class="nc" id="L634">    }</span>
    
    /**
     *  Determines what to do when a button is pressed, when a radio button is
     *  selected, or when the value in the parent prefix &lt;code&gt;JComboBox&lt;/code&gt;
     *  is changed.
     *
     *  &lt;p&gt;If the &lt;b&gt;Calculate&lt;/b&gt; &lt;code&gt;JButton&lt;/code&gt; is pressed, it triggers
     *  the &lt;code&gt;calculate()&lt;/code&gt; method.
     *
     *  &lt;p&gt;If the &lt;b&gt;Reset&lt;/b&gt; &lt;code&gt;JButton&lt;/code&gt; is pressed, it triggers the
     *  &lt;code&gt;reset()&lt;/code&gt; method to reset the current panel to its original
     *  state.
     *
     *  &lt;p&gt;If any of the five radio buttons are selected, other un-related rows
     *  are disabled to prevent the user from performing two calculations
     *  simontanously.
     *
     *  &lt;p&gt;When a value has been selected in the parent prefix drop-down menu,
     *  &lt;code&gt;checkChildPrefix()&lt;/code&gt; is called to re-populate the child
     *  prefix drop-down menu to adjust to the changes.
     */
    public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L657" title="All 2 branches missed.">        if (e.getSource() == calculateButton)</span>
<span class="nc" id="L658">            calculate();</span>
<span class="nc bnc" id="L659" title="All 2 branches missed.">        else if (e.getSource() == resetButton)</span>
<span class="nc" id="L660">            reset();</span>
<span class="nc bnc" id="L661" title="All 2 branches missed.">        else if (rangeRadioButton.isSelected()) {</span>
<span class="nc" id="L662">            rangeTextField.setEditable(true);</span>
<span class="nc" id="L663">            rangeCheckBox.setEnabled(true);</span>
<span class="nc" id="L664">            netmaskTextField.setEditable(false);</span>
<span class="nc" id="L665">            childPrefix.setEnabled(false);</span>
<span class="nc" id="L666">            numberOfIPTextField.setEditable(false);</span>
<span class="nc" id="L667">            outputTextArea.setText(&quot;&quot;);</span>
<span class="nc bnc" id="L668" title="All 2 branches missed.">        } else if (netmaskRadioButton.isSelected()) {</span>
<span class="nc" id="L669">            rangeTextField.setEditable(false);</span>
<span class="nc" id="L670">            rangeCheckBox.setEnabled(false);</span>
<span class="nc" id="L671">            netmaskTextField.setEditable(true);</span>
<span class="nc" id="L672">            childPrefix.setEnabled(false);</span>
<span class="nc" id="L673">            numberOfIPTextField.setEditable(false);</span>
<span class="nc" id="L674">            outputTextArea.setText(&quot;&quot;);</span>
<span class="nc bnc" id="L675" title="All 2 branches missed.">        } else if (splittingPrefixRadioButton.isSelected()) {</span>
<span class="nc" id="L676">            rangeTextField.setEditable(false);</span>
<span class="nc" id="L677">            rangeCheckBox.setEnabled(false);</span>
<span class="nc" id="L678">            netmaskTextField.setEditable(false);</span>
<span class="nc" id="L679">            childPrefix.setEnabled(true);</span>
<span class="nc" id="L680">            numberOfIPTextField.setEditable(false);</span>
<span class="nc" id="L681">            outputTextArea.setText(&quot;&quot;);</span>
<span class="nc bnc" id="L682" title="All 2 branches missed.">        } else if (numberOfIPRadioButton.isSelected()){</span>
<span class="nc" id="L683">            rangeTextField.setEditable(false);</span>
<span class="nc" id="L684">            rangeCheckBox.setEnabled(false);</span>
<span class="nc" id="L685">            netmaskTextField.setEditable(false);</span>
<span class="nc" id="L686">            childPrefix.setEnabled(false);</span>
<span class="nc" id="L687">            numberOfIPTextField.setEditable(true);</span>
<span class="nc" id="L688">            outputTextArea.setText(&quot;&quot;);</span>
        }
<span class="nc" id="L690">    }</span>
    
    /**
     *  This method re-directs the calculation to the appropriate method
     *  depending on what &lt;code&gt;JRadioButton&lt;/code&gt; is selected.
     */
    private void calculate(){
<span class="nc" id="L697">        outputTextArea.setText(&quot;&quot;);</span>
        try {
<span class="nc" id="L699">            setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));</span>
<span class="nc bnc" id="L700" title="All 2 branches missed.">            if (numberOfIPRadioButton.isSelected()){</span>
<span class="nc bnc" id="L701" title="All 2 branches missed.">                if (checkIP(IPAddressTextField)){</span>
<span class="nc" id="L702">                    calculateNumberOfAddresses();</span>
                }
<span class="nc bnc" id="L704" title="All 2 branches missed.">            } else if (splittingPrefixRadioButton.isSelected()){</span>
<span class="nc" id="L705">                int prefix = getPrefix();</span>
<span class="nc bnc" id="L706" title="All 4 branches missed.">                if (checkIP(IPAddressTextField) &amp;&amp; prefix != (MAXPREFIX + 1)){</span>
<span class="nc bnc" id="L707" title="All 2 branches missed.">                    if (childPrefix.getSelectedItem() == &quot;&quot;){</span>
<span class="nc" id="L708">                        calculatePrefix(prefix);</span>
                    } else {
<span class="nc" id="L710">                        int childPrefixInt = Integer.parseInt(childPrefix.</span>
<span class="nc" id="L711">                                getSelectedItem().toString().substring(1,</span>
<span class="nc" id="L712">                                childPrefix.getSelectedItem().toString().length()));</span>
<span class="nc bnc" id="L713" title="All 2 branches missed.">                        if (childPrefixInt &gt; prefix){</span>
<span class="nc" id="L714">                            calculateSplitting(prefix);</span>
                        } else
<span class="nc" id="L716">                            displayError(&quot;Splitting Prefix incorrect&quot;);</span>
                    }
                }
<span class="nc bnc" id="L719" title="All 2 branches missed.">                if (prefix == (MAXPREFIX + 1))</span>
<span class="nc" id="L720">                    prefix--;</span>
<span class="nc" id="L721">                IPAddressTextField.setText(IPAddressTextField.getText().trim()</span>
                + &quot; /&quot; + prefix);
<span class="nc bnc" id="L723" title="All 2 branches missed.">            } else if (netmaskRadioButton.isSelected()){</span>
<span class="nc bnc" id="L724" title="All 2 branches missed.">                if (checkIP(IPAddressTextField)){</span>
<span class="nc" id="L725">                    calculateNetmask();</span>
                }
<span class="nc bnc" id="L727" title="All 2 branches missed.">            } else if (rangeRadioButton.isSelected()){</span>
<span class="nc bnc" id="L728" title="All 2 branches missed.">                if (checkIP(IPAddressTextField)){</span>
<span class="nc" id="L729">                    calculateRange();</span>
                }
            }
<span class="nc" id="L732">        } catch (NumberFormatException ex) {</span>
<span class="nc" id="L733">            ex.printStackTrace();</span>
        } finally {
<span class="nc" id="L735">            setCursor(Cursor.getDefaultCursor());</span>
        }
<span class="nc" id="L737">    }</span>
    
    /**
     *  Gets the prefix from IPAddressTextField.
     *
     *  @return     Prefix from IPAddressTextField
     */
    private int getPrefix(){
<span class="nc" id="L745">        StringTokenizer prefixToken = new StringTokenizer(</span>
<span class="nc" id="L746">                IPAddressTextField.getText().trim(), &quot; /&quot;);</span>
<span class="nc" id="L747">        int output = MAXPREFIX + 1;</span>
<span class="nc bnc" id="L748" title="All 2 branches missed.">        if (prefixToken.countTokens() == 2){</span>
<span class="nc" id="L749">            IPAddressTextField.setText(prefixToken.nextToken());</span>
            try {
<span class="nc" id="L751">                output = Integer.parseInt(prefixToken.nextToken());</span>
<span class="nc bnc" id="L752" title="All 2 branches missed.">                if (output &gt; MAXPREFIX){</span>
<span class="nc" id="L753">                    output = MAXPREFIX + 1;</span>
<span class="nc" id="L754">                    displayError(&quot;Prefix too large.&quot;);</span>
                }
<span class="nc" id="L756">            } catch (NumberFormatException ex) {</span>
<span class="nc" id="L757">                displayError(&quot;Invalid input detected.&quot;);</span>
<span class="nc" id="L758">            }</span>
        } else
<span class="nc" id="L760">            displayError(&quot;No Prefix Detected&quot;);</span>
<span class="nc" id="L761">        return output;</span>
    }
    
    /**
     *  Calculates the prefix size needed to accommodate the IP addresses from
     *  the &lt;code&gt;IPAddressTextField&lt;/code&gt; and &lt;code&gt;rangeTextField&lt;/code&gt;.
     */
    private void calculateRange(){
<span class="nc bnc" id="L769" title="All 2 branches missed.">        if (checkIP(rangeTextField)){</span>
<span class="nc" id="L770">            BigInteger sib = new BigInteger(IPToBinary(IPAddressTextField), 2);</span>
<span class="nc" id="L771">            BigInteger eib = new BigInteger(IPToBinary(rangeTextField), 2);</span>
            
            /**
             *  Check that the IP Address in rangeTextField is larger than the
             *  IP Address in IPAddressTextField.
             */
<span class="nc bnc" id="L777" title="All 2 branches missed.">            if (sib.doubleValue() &lt;= eib.doubleValue()){</span>
                /** Find the difference (in binary) of the two IP Addresses */
<span class="nc" id="L779">                String difference = new BinaryCalculate().subBinary(IPToBinary(</span>
<span class="nc" id="L780">                        IPAddressTextField), IPToBinary(rangeTextField));</span>
<span class="nc" id="L781">                int totalIPAddresses = Integer.parseInt(difference, 2) + 1;</span>
<span class="nc" id="L782">                int prefixInt = 0;</span>
<span class="nc bnc" id="L783" title="All 2 branches missed.">                if (difference.length() &lt;= MAXPREFIX){</span>
                    /** Convert back to prefix form */
<span class="nc bnc" id="L785" title="All 2 branches missed.">                    if (totalIPAddresses == 2)</span>
<span class="nc" id="L786">                        prefixInt = (MAXPREFIX - 2);</span>
                    else
<span class="nc" id="L788">                        prefixInt = MAXPREFIX - (int)Math.ceil(Math.log(</span>
<span class="nc" id="L789">                                totalIPAddresses)/Math.log(2.0));</span>
                }
<span class="nc" id="L791">                String prefix = &quot;/&quot; + prefixInt;</span>
                /** Check for prefix guards */
<span class="nc bnc" id="L793" title="All 2 branches missed.">                if (checkPrefix(prefixInt))</span>
<span class="nc" id="L794">                    JOptionPane.showMessageDialog(this, &quot;From the given IP &quot; +</span>
                            &quot;addresses, the following prefix is \nrequired to&quot; +
                            &quot; accommodate the IP Addresses:    &quot; +
<span class="nc" id="L797">                            IPAddressTextField.getText().trim().substring(0,</span>
<span class="nc" id="L798">                            IPAddressTextField.getText().trim().length()) +</span>
                            &quot;   &quot; + prefix,&quot;Required Slash Notation&quot;,
                            JOptionPane.INFORMATION_MESSAGE);
                else
<span class="nc" id="L802">                    JOptionPane.showMessageDialog(this, &quot;No prefix can &quot; +</span>
                            &quot;accomodate this range&quot;, &quot;Error&quot;,
                            JOptionPane.INFORMATION_MESSAGE);
<span class="nc" id="L805">            } else</span>
<span class="nc" id="L806">                displayError(&quot;Starting IP Address is smaller than End IP &quot; +</span>
                        &quot;Addresss&quot;);
        }
<span class="nc" id="L809">    }</span>
    
    /**
     *  Calculates the number of IP address starting from the IP address in
     *  &lt;code&gt;IPAddressTextField&lt;/code&gt;. The results are displayed on a pop-up
     *  window.
     */
    private void calculateNumberOfAddresses(){
<span class="nc bnc" id="L817" title="All 2 branches missed.">        if (numberOfIPTextField.getText().trim().length() == 0)</span>
<span class="nc" id="L818">            displayError(&quot;Number of IP Addresses not detected. Please enter a&quot; +</span>
                    &quot; number.&quot;);
        else {
            try {
<span class="nc" id="L822">                int prefixInt = MAXPREFIX - (int) Math.ceil(Math.log(</span>
<span class="nc" id="L823">                        Integer.parseInt(numberOfIPTextField.getText().trim()))</span>
<span class="nc" id="L824">                        / Math.log(2.0));</span>
<span class="nc bnc" id="L825" title="All 2 branches missed.">                if (checkPrefix(prefixInt))</span>
<span class="nc" id="L826">                    outputTextArea.setText(new BinaryCalculate().IPCalculate(</span>
<span class="nc" id="L827">                            IPToBinary(IPAddressTextField), getNumberOfIPs()));</span>
                else
<span class="nc" id="L829">                    displayError(&quot;Not a valid IPv6 Address &amp; number of &quot; +</span>
                            &quot;IP addresses combination&quot;);
<span class="nc" id="L831">            } catch (NumberFormatException ex) {</span>
<span class="nc" id="L832">                displayError(&quot;Invalid input detected&quot;);</span>
<span class="nc" id="L833">            }</span>
        }
<span class="nc" id="L835">    }</span>
    
    /**
     *  Calculates the IP addresses needed to accomodate all the IP addresses
     *  from the selected slash prefix starting from the IP address in
     *  &lt;code&gt;IPAddressTextField&lt;/code&gt;.
     */
    private void calculatePrefix(int prefixInt){
<span class="nc bnc" id="L843" title="All 2 branches missed.">        if (prefixInt &gt;= (MAXPREFIX - 1))</span>
<span class="nc" id="L844">            displayError(&quot;Cannot have /&quot; + (MAXPREFIX - 1));</span>
        else {
<span class="nc bnc" id="L846" title="All 2 branches missed.">            if (checkPrefix(prefixInt))</span>
<span class="nc" id="L847">                outputTextArea.setText(new BinaryCalculate().IPCalculate(</span>
<span class="nc" id="L848">                        IPToBinary(IPAddressTextField), getSlashPrefix(</span>
                        prefixInt)));
            else
<span class="nc" id="L851">                displayError(&quot;Not a valid IPv6 Address &amp; slash prefix&quot; +</span>
                        &quot; combination&quot;);
        }
<span class="nc" id="L854">    }</span>
    
    /**
     *  Calculates the list of IP address ranges needed to accomodate all the IP
     *  address from the selected parent prefix splitted into the select child
     *  prefixs starting from the IP address in &lt;code&gt;IPAddressTextField&lt;/code&gt;.
     */
    private void calculateSplitting(int prefixInt){
<span class="nc bnc" id="L862" title="All 2 branches missed.">        if (checkPrefix(prefixInt))</span>
<span class="nc" id="L863">            new BinaryCalculate().prefixInPrefixCalculate(IPToBinary(</span>
<span class="nc" id="L864">                    IPAddressTextField),getChildPrefix(),</span>
<span class="nc" id="L865">                    calculatePrefixInPrefix(prefixInt),</span>
                    &quot;/&quot; + prefixInt);
        else
<span class="nc" id="L868">            displayError(&quot;Not a valid IPv6 Address &amp; splitting &quot; +</span>
                    &quot;prefix combination&quot;);
<span class="nc" id="L870">    }</span>
    
    /**
     *  Calculates the IP addresses needed to accomodate the IP addresses from
     *  the selected netmask starting from the IP address in
     *  &lt;code&gt;IPAddressTextField&lt;/code&gt;
     */
    private void calculateNetmask(){
        try {
<span class="nc bnc" id="L879" title="All 2 branches missed.">            if (netmaskTextField.getText().trim().length() != 0){</span>
<span class="nc" id="L880">                checkIP(netmaskTextField);</span>
<span class="nc" id="L881">                StringTokenizer netmaskTokens = new StringTokenizer(</span>
<span class="nc" id="L882">                        netmaskTextField.getText().trim(), DELIMITER);</span>
<span class="nc" id="L883">                String netmaskBinary = &quot;&quot;;</span>
<span class="nc bnc" id="L884" title="All 2 branches missed.">                while (netmaskTokens.hasMoreTokens()){</span>
<span class="nc" id="L885">                    String binary = convertToBinary(Integer.parseInt(</span>
<span class="nc" id="L886">                            netmaskTokens.nextToken(), 16));</span>
<span class="nc bnc" id="L887" title="All 2 branches missed.">                    while (binary.length() &lt; BITS_PER_GROUP)</span>
<span class="nc" id="L888">                        binary = &quot;0&quot; + binary;</span>
<span class="nc" id="L889">                    netmaskBinary += binary;</span>
<span class="nc" id="L890">                }</span>
<span class="nc" id="L891">                int prefix = 0;</span>
<span class="nc bnc" id="L892" title="All 2 branches missed.">                while (netmaskBinary.charAt(prefix) != '0'){</span>
<span class="nc" id="L893">                    prefix++;</span>
<span class="nc bnc" id="L894" title="All 2 branches missed.">                    if (prefix == MAXPREFIX)</span>
<span class="nc" id="L895">                        break;</span>
                }
<span class="nc bnc" id="L897" title="All 2 branches missed.">                if (checkPrefix(prefix))</span>
<span class="nc" id="L898">                    outputTextArea.setText(new BinaryCalculate().IPCalculate(</span>
<span class="nc" id="L899">                            IPToBinary(IPAddressTextField), getSlashPrefix(</span>
                            prefix)));
                else
<span class="nc" id="L902">                    displayError(&quot;Not a valid IPv6 Address &amp; netmask&quot; +</span>
                            &quot; combination&quot;);
<span class="nc" id="L904">            } else</span>
<span class="nc" id="L905">                displayError(&quot;Netmask field is empty. Please enter a number.&quot;);</span>
<span class="nc" id="L906">        } catch (NumberFormatException ex) {</span>
<span class="nc" id="L907">            displayError(&quot;Invalid input detected&quot;);</span>
<span class="nc" id="L908">        }</span>
<span class="nc" id="L909">    }</span>
    
    /**
     *  Displays errors in a notification pop-up box.
     *
     *  @param      error       The error message to be displayed.
     */
    public void displayError(String error){
<span class="nc" id="L917">        JOptionPane.showMessageDialog(this, error, &quot;Error&quot;,</span>
                JOptionPane.ERROR_MESSAGE);
<span class="nc" id="L919">    }</span>
    
    /**
     *  Checks if given IP is a correct IPv6 address.
     *  Displays an appropriate error if an incorrect IPv6 address is detected.
     *
     *  @return      &lt;code&gt;true&lt;/code&gt; if the Internet Protocol Address is a
     *               valid IPv6 address, otherwise &lt;code&gt;false&lt;/code&gt;.
     */
    private boolean checkIP(JTextField inputTextField){
<span class="nc" id="L929">        boolean IPPassed = false;</span>
        try {
<span class="nc" id="L931">            String IP = (InetAddress.getByName(inputTextField.getText().trim()).</span>
<span class="nc" id="L932">                    toString());</span>
            
<span class="nc bnc" id="L934" title="All 2 branches missed.">            if (IP.equalsIgnoreCase(&quot;localhost/127.0.0.1&quot;)){</span>
<span class="nc" id="L935">                displayError(&quot;No Input Detected&quot;);</span>
            } else {
<span class="nc" id="L937">                IPPassed = true;</span>
<span class="nc" id="L938">                inputTextField.setText(IP.substring(1, IP.length()));</span>
            }
<span class="nc" id="L940">        } catch (UnknownHostException e) {</span>
<span class="nc" id="L941">            IPPassed = false;</span>
<span class="nc" id="L942">            displayError(&quot;Invalid IPv6 Address Detected.&quot;);</span>
<span class="nc" id="L943">        } catch (NumberFormatException e) {</span>
<span class="nc" id="L944">            displayError(&quot;Invalid IPv6 Address Detected.\nUse &quot; +</span>
                    &quot;0123:4567:89AB:CDEF:0123:4567:89AB:CDEF format&quot;);
<span class="nc" id="L946">        }</span>
<span class="nc" id="L947">        return IPPassed;</span>
    }
    
    /**
     *  Converts a &lt;code&gt;integer&lt;/code&gt; into a binary string.
     *
     *  @parm       input       The &lt;code&gt;integer&lt;/code&gt; value to be converted.
     *  @return     Binary representation of the &lt;code&gt;integer&lt;/code&gt;.
     */
    private String convertToBinary(long input){
<span class="nc" id="L957">        return (Long.toBinaryString(input));</span>
    }
    
    /**
     *  Calculates the padded binary representation of the IP Address from the
     *  &lt;code&gt;JTextField&lt;/code&gt;.
     *
     *  @param      textField       The &lt;code&gt;JTextField&lt;/code&gt; where the IP
     *                              address can be found
     *  @return     Padded binary representation of IP Address from the
     *              &lt;code&gt;JTextField&lt;/code&gt;.
     */
    private String IPToBinary(JTextField textField){
<span class="nc" id="L970">        String paddedBinary = &quot;&quot;;</span>
<span class="nc" id="L971">        StringTokenizer octet = new StringTokenizer(textField.getText().trim(),</span>
                DELIMITER);
<span class="nc bnc" id="L973" title="All 2 branches missed.">        while (octet.hasMoreTokens()){</span>
<span class="nc" id="L974">            String unpaddedBinary = convertToBinary(Integer.parseInt(</span>
<span class="nc" id="L975">                    octet.nextToken(), 16));</span>
<span class="nc bnc" id="L976" title="All 2 branches missed.">            while (unpaddedBinary.length() &lt; BITS_PER_GROUP)</span>
<span class="nc" id="L977">                unpaddedBinary = &quot;0&quot; + unpaddedBinary;</span>
<span class="nc" id="L978">            paddedBinary += unpaddedBinary;</span>
<span class="nc" id="L979">        }</span>
        
<span class="nc" id="L981">        return paddedBinary;</span>
    }
    
    /**
     *  Pads or Unpads the given &lt;code&gt;JTextField&lt;/code&gt;
     *
     *  @parm   inputTextField      The &lt;code&gt;JTextField&lt;/code&gt; to be padded
     *  @parm   padded              To pad or unpad the &lt;code&gt;JTextField&lt;/code&gt;
     */
    private void pad(JTextField inputTextField, boolean padded){
<span class="nc" id="L991">        StringTokenizer tokens = new StringTokenizer(</span>
<span class="nc" id="L992">                inputTextField.getText(), &quot;/ &quot;);</span>
<span class="nc" id="L993">        String prefix = &quot;&quot;;</span>
<span class="nc bnc" id="L994" title="All 2 branches missed.">        if (tokens.countTokens() == 2){</span>
<span class="nc" id="L995">            inputTextField.setText(tokens.nextToken());</span>
<span class="nc" id="L996">            prefix = tokens.nextToken();</span>
        }
<span class="nc bnc" id="L998" title="All 2 branches missed.">        if (checkIP(inputTextField)){</span>
<span class="nc" id="L999">            StringTokenizer octetToken = new StringTokenizer(</span>
<span class="nc" id="L1000">                    inputTextField.getText(), DELIMITER);</span>
<span class="nc" id="L1001">            String output = &quot;&quot;;</span>
<span class="nc" id="L1002">            int dotDecimal = 1;</span>
<span class="nc bnc" id="L1003" title="All 2 branches missed.">            while (octetToken.hasMoreTokens()){</span>
<span class="nc" id="L1004">                String out = octetToken.nextToken();</span>
<span class="nc bnc" id="L1005" title="All 2 branches missed.">                if (padded)</span>
<span class="nc bnc" id="L1006" title="All 2 branches missed.">                    while (out.length() &lt; CHARS_PER_GROUP)</span>
<span class="nc" id="L1007">                        out = &quot;0&quot; + out;</span>
<span class="nc" id="L1008">                output += out;</span>
<span class="nc bnc" id="L1009" title="All 2 branches missed.">                if (dotDecimal &lt; NUMBER_OF_GROUPS){</span>
<span class="nc" id="L1010">                    output += DELIMITER;</span>
<span class="nc" id="L1011">                    dotDecimal++;</span>
                }
<span class="nc" id="L1013">            }</span>
<span class="nc bnc" id="L1014" title="All 2 branches missed.">            if (prefix.length() != 0)</span>
<span class="nc" id="L1015">                inputTextField.setText(output + &quot;/&quot; + prefix);</span>
            else
<span class="nc" id="L1017">                inputTextField.setText(output);</span>
        }
<span class="nc" id="L1019">    }</span>
    
    /**
     *  Calculates the number of child prefixs that can fit inside the parent
     *  prefix.
     *
     *  @return     Number of child prefixs that can fit inside the parent
     *              prefix
     */
    private int calculatePrefixInPrefix(int parentPrefixInt){
<span class="nc" id="L1029">        double parentTruePrefix = 0;</span>
        
<span class="nc bnc" id="L1031" title="All 2 branches missed.">        if (parentPrefixInt == (MAXPREFIX - 1))</span>
<span class="nc" id="L1032">            displayError(&quot;Cannot have /&quot; + (MAXPREFIX - 1));</span>
        else {
<span class="nc" id="L1034">            parentTruePrefix = MAXPREFIX - parentPrefixInt;</span>
<span class="nc" id="L1035">            parentTruePrefix = Math.pow(2, parentTruePrefix);</span>
            
<span class="nc bnc" id="L1037" title="All 2 branches missed.">            if (parentTruePrefix &lt; 0)</span>
<span class="nc" id="L1038">                parentTruePrefix *= -1;</span>
        }
        
<span class="nc" id="L1041">        String childPrefixString = childPrefix.getSelectedItem().toString();</span>
<span class="nc" id="L1042">        int childPrefixInt = Integer.parseInt(childPrefixString.substring(</span>
<span class="nc" id="L1043">                1, childPrefixString.length()));</span>
<span class="nc" id="L1044">        double childTruePrefix = MAXPREFIX - childPrefixInt;</span>
<span class="nc" id="L1045">        childTruePrefix = Math.pow(2, childTruePrefix);</span>
        
<span class="nc bnc" id="L1047" title="All 2 branches missed.">        if (childTruePrefix &lt; 0)</span>
<span class="nc" id="L1048">            childTruePrefix *= -1;</span>
        
<span class="nc" id="L1050">        double prefixDifference = parentTruePrefix / childTruePrefix;</span>
        
<span class="nc" id="L1052">        return (int)prefixDifference;</span>
    }
    
    /**
     *  Calculates the binary representation of the selected child prefix.
     *
     *  @return      Binary representation of the selected child prefix.
     */
    private String getChildPrefix(){
<span class="nc" id="L1061">        String childPrefixString = childPrefix.getSelectedItem().toString();</span>
<span class="nc" id="L1062">        int childPrefixInt = Integer.parseInt(childPrefixString.substring(</span>
<span class="nc" id="L1063">                1, childPrefixString.length()));</span>
        
        /*double truePrefix= 0;
         
        if (childPrefixInt == (MAXPREFIX - 1))
            displayError(&quot;Cannot have /&quot; + (MAXPREFIX - 1));
        else {
            truePrefix = MAXPREFIX - childPrefixInt;
            truePrefix = Math.pow(2, truePrefix);
         
            if (truePrefix &lt; 0)
                truePrefix *= -1;
        }
         
        String childPrefixBinary = convertToBinary((int)truePrefix - 1);
        while (childPrefixBinary.length() &lt; MAXPREFIX)
            childPrefixBinary = &quot;0&quot; + childPrefixBinary;*/
        
<span class="nc" id="L1081">        String childPrefixBinary = &quot;&quot;;</span>
<span class="nc bnc" id="L1082" title="All 2 branches missed.">        for (int i = 0; i &lt; childPrefixInt; i++){</span>
<span class="nc" id="L1083">            childPrefixBinary += &quot;0&quot;;</span>
        }
        
<span class="nc bnc" id="L1086" title="All 2 branches missed.">        for (int j = childPrefixInt; j &lt; MAXPREFIX; j++){</span>
<span class="nc" id="L1087">            childPrefixBinary += &quot;1&quot;;</span>
        }
        
<span class="nc" id="L1090">        return childPrefixBinary;</span>
    }
    
    /**
     *  Calculates the binary representation of the given prefix.
     *
     *  @param      prefixInt       Prefix to be converted
     *  @return     Binary representation of the given prefix
     */
    private String getSlashPrefix(int prefixInt){
        /*double truePrefix= 0;
        boolean over64 = false;
         
        if (prefixInt &lt;= 64){
            prefixInt = prefixInt + 62;
            over64 = true;
        }
         
        truePrefix = MAXPREFIX - prefixInt;
        truePrefix = Math.pow(2, truePrefix);
        if (truePrefix &lt; 0)
            truePrefix *= -1;
         
        String slashPrefix = convertToBinary((long)truePrefix - 1);
        if (over64){
            String over64String = convertToBinary((long)(Math.pow(2, 64))).
                    substring(1);
            slashPrefix += over64String;
        }
        while (slashPrefix.length() &lt; MAXPREFIX)
            slashPrefix = &quot;0&quot; + slashPrefix;
        return slashPrefix;*/
        
<span class="nc" id="L1123">        String output = &quot;&quot;;</span>
<span class="nc" id="L1124">        int guard = MAXPREFIX - prefixInt;</span>
        
        
<span class="nc bnc" id="L1127" title="All 2 branches missed.">        for (int i = MAXPREFIX; i &gt; guard; i--){</span>
<span class="nc" id="L1128">            output += &quot;0&quot;;</span>
        }
<span class="nc bnc" id="L1130" title="All 2 branches missed.">        for (int j = prefixInt; j &lt; MAXPREFIX; j++){</span>
<span class="nc" id="L1131">            output += &quot;1&quot;;</span>
        }
<span class="nc" id="L1133">        return output;</span>
    }
    
    /**
     *  Calculates the binary representation of the value in numberOfIPTextField
     *
     *  @return      Binary representation of the number of IP addresses
     */
    private String getNumberOfIPs(){
        /*String numberOfIPs = convertToBinary(Integer.parseInt(
                numberOfIPTextField.getText().trim()) + 1);
        while (numberOfIPs.length() &lt; MAXPREFIX)
            numberOfIPs = &quot;0&quot; + numberOfIPs;
        return numberOfIPs;*/
        
<span class="nc" id="L1148">        int prefixInt = MAXPREFIX - (int) Math.ceil(Math.log(</span>
<span class="nc" id="L1149">                Integer.parseInt(numberOfIPTextField.getText().trim()) + 2)</span>
<span class="nc" id="L1150">                / Math.log(2.0));</span>
<span class="nc" id="L1151">        return getSlashPrefix(prefixInt);</span>
    }
    
    /** Resets this panel to its initial state on startup. */
    private void reset(){
<span class="nc" id="L1156">        IPAddressTextField.setText(&quot;&quot;);</span>
<span class="nc" id="L1157">        IPAddressTextField.grabFocus();</span>
<span class="nc" id="L1158">        IPAddressCheckBox.setSelected(false);</span>
<span class="nc" id="L1159">        rangeTextField.setText(&quot;&quot;);</span>
<span class="nc" id="L1160">        rangeTextField.setEditable(false);</span>
<span class="nc" id="L1161">        rangeRadioButton.setSelected(false);</span>
<span class="nc" id="L1162">        rangeCheckBox.setSelected(false);</span>
<span class="nc" id="L1163">        rangeCheckBox.setEnabled(false);</span>
<span class="nc" id="L1164">        netmaskTextField.setEditable(false);</span>
<span class="nc" id="L1165">        netmaskTextField.setText(&quot;&quot;);</span>
<span class="nc" id="L1166">        splittingPrefixRadioButton.setSelected(true);</span>
<span class="nc" id="L1167">        childPrefix.setSelectedItem(&quot;&quot;);</span>
<span class="nc" id="L1168">        childPrefix.setEnabled(true);</span>
<span class="nc" id="L1169">        numberOfIPTextField.setEditable(false);</span>
<span class="nc" id="L1170">        numberOfIPTextField.setText(&quot;&quot;);</span>
<span class="nc" id="L1171">        outputTextArea.setText(&quot;&quot;);</span>
<span class="nc" id="L1172">    }</span>
    
    /**
     *  Checks if the &lt;code&gt;prefixInt&lt;/code&gt; and the inputed IP address are
     *  limited within the given prefix.
     *
     *  @param       prefixInt       Integer value of prefix to be tested
     *
     *  @return      &lt;code&gt;true&lt;/code&gt; if &lt;code&gt;prefixInt&lt;/code&gt; and IP address
     *               does not cross another prefix boundary. &lt;code&gt;false&lt;/code&gt;
     *               if it crosses another prefix boundary.
     */
    private boolean checkPrefix(int prefixInt){
<span class="nc" id="L1185">        String slashPrefixGuard = &quot;&quot;;</span>
        
<span class="nc bnc" id="L1187" title="All 2 branches missed.">        for (int i = MAXPREFIX - prefixInt; i &gt; 0; i--)</span>
<span class="nc" id="L1188">            slashPrefixGuard += &quot;0&quot;;</span>
<span class="nc" id="L1189">        String out = IPToBinary(IPAddressTextField);</span>
        
<span class="nc bnc" id="L1191" title="All 2 branches missed.">        if (slashPrefixGuard.equals(out.substring(prefixInt, out.length())))</span>
<span class="nc" id="L1192">            return true;</span>
        else
<span class="nc" id="L1194">            return false;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>