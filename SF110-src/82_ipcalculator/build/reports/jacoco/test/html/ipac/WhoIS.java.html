<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>WhoIS.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">82_ipcalculator</a> &gt; <a href="index.source.html" class="el_package">ipac</a> &gt; <span class="el_source">WhoIS.java</span></div><h1>WhoIS.java</h1><pre class="source lang-java linenums">package ipac;
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import java.io.*;
import java.net.*;

/**
 *  Title: WhoIS Panel
 *  &lt;br&gt;Description: The IP Range Panel for the Graphical User Interface.
 *  &lt;br&gt;Copyright (c) 2006-7 Jason Wang
 *
 *  &lt;p&gt;This program is free software; you can redistribute it and/or
 *  &lt;br&gt;modify it under the terms of the GNU General Public License
 *  &lt;br&gt;as published by the Free Software Foundation; either version 2
 *  &lt;br&gt;of the License, or (at your option) any later version.
 *
 *  &lt;br&gt;This program is distributed in the hope that it will be useful,
 *  &lt;br&gt;but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  &lt;br&gt;MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  &lt;br&gt;GNU General Public License for more details.
 *
 *  &lt;br&gt;You should have received a copy of the GNU General Public License
 *  &lt;br&gt;along with this program; if not, write to the Free Software
 *  &lt;br&gt;Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
 *                                                              02110-1301, USA.
 *
 *  @author      Jason Wang
 *  @version     Beta v0.17
 */

public class WhoIS extends JPanel implements ActionListener{
    /** USER EDITABLE OPTIONS */
        /** WhoIs server name */
<span class="fc" id="L35">        String WHOIS_NAME = &quot;APNIC&quot;;</span>
        /** WhoIs server address */
<span class="fc" id="L37">        String WHOIS_ADDRESS = &quot;whois.apnic.net&quot;;</span>
        /** WhoIs server port*/
<span class="fc" id="L39">        int WHOIS_PORT = 43;</span>
    
    /** Global Variables -=- DO NOT EDIT */
    JTextField queryTextField;
    JButton queryButton, resetButton;
    JCheckBox lowercaseD;
    boolean booleanD;
    JRadioButton lowercaseL, uppercaseL, lowercaseM, uppercaseM, lowercaseX,
            resetRadioButton;
<span class="fc" id="L48">    ButtonGroup radioButtonGroup = new ButtonGroup();</span>
    JPopupMenu popupMenu;
    JComboBox inverseQueries;
    JList miscList;
    
    /**
     *  Creates a new instance of the WhoIS Panel containing both sub-panels for
     *  use in IPAC (the Main Graphical User Interface).
     */
<span class="fc" id="L57">    public WhoIS() {</span>
<span class="fc" id="L58">        JPanel WhoISPanel = new JPanel();</span>
<span class="fc" id="L59">        WhoISPanel.setLayout(new BoxLayout(WhoISPanel, BoxLayout.Y_AXIS));</span>
        
<span class="fc" id="L61">        createPopupMenu();</span>
        
<span class="fc" id="L63">        WhoISPanel.add(queryPanel());</span>
<span class="fc" id="L64">        WhoISPanel.add(additionalQueriesPanel());</span>
<span class="fc" id="L65">        WhoISPanel.add(queryHintsPanel());</span>
        
<span class="fc" id="L67">        setBackground(Color.WHITE);</span>
        
<span class="fc" id="L69">        add(WhoISPanel);</span>
<span class="fc" id="L70">    }</span>
    
    /**
     *  Creates a sub-panel containing:
     *  &lt;ul&gt;
     *      &lt;li&gt;a &lt;b&gt;&quot;IP Address&quot;&lt;/b&gt; label
     *      &lt;li&gt;a Text Field where the user can enter the desired Internet
     *          Protocol Address to be queried
     *      &lt;li&gt;a &lt;b&gt;&quot;Query&quot;&lt;/b&gt; button
     *  &lt;/ul&gt;
     *
     *  @return      Query sub-panel.
     */
    private JPanel queryPanel(){
<span class="fc" id="L84">        JPanel queryPanel = new JPanel();</span>
<span class="fc" id="L85">        queryPanel.setLayout(new FlowLayout(FlowLayout.LEFT));</span>
        
<span class="fc" id="L87">        JLabel queryLabel = new JLabel(&quot;Search for : &quot;);</span>
<span class="fc" id="L88">        queryPanel.add(queryLabel);</span>
        
<span class="fc" id="L90">        queryTextField = new JTextField(40);</span>
<span class="fc" id="L91">        queryTextField.addMouseListener(new MouseAdapter() {</span>
            public void mousePressed( MouseEvent e ) {
<span class="nc" id="L93">                checkForTriggerEvent(e);</span>
<span class="nc" id="L94">            }</span>
            public void mouseReleased( MouseEvent e ) {
<span class="nc" id="L96">                checkForTriggerEvent(e);</span>
<span class="nc" id="L97">            }</span>
            private void checkForTriggerEvent( MouseEvent e ) {
<span class="nc bnc" id="L99" title="All 2 branches missed.">                if ( e.isPopupTrigger() )</span>
<span class="nc" id="L100">                    popupMenu.show( e.getComponent(), e.getX(), e.getY() );</span>
<span class="nc" id="L101">            }</span>
        });
<span class="fc" id="L103">        queryTextField.addKeyListener(new KeyAdapter(){</span>
            public void keyPressed(KeyEvent e ){
<span class="nc bnc" id="L105" title="All 2 branches missed.">                if (e.getKeyCode() == KeyEvent.VK_ENTER){</span>
<span class="nc" id="L106">                    startQuery();</span>
                }
<span class="nc" id="L108">            }</span>
        });
<span class="fc" id="L110">        queryTextField.setToolTipText(&quot;Enter Whois database object you would &quot; +</span>
                &quot;like to query&quot;);
<span class="fc" id="L112">        queryPanel.add(queryTextField);</span>
        
<span class="fc" id="L114">        queryButton = new JButton(&quot;Query&quot;);</span>
<span class="fc" id="L115">        queryButton.addActionListener(this);</span>
<span class="fc" id="L116">        queryPanel.add(queryButton);</span>
        
<span class="fc" id="L118">        resetButton = new JButton(&quot;Reset&quot;);</span>
<span class="fc" id="L119">        resetButton.addActionListener(this);</span>
<span class="fc" id="L120">        queryPanel.add(resetButton);</span>
        
<span class="fc" id="L122">        queryTextField.setRequestFocusEnabled(true);</span>
        
<span class="fc" id="L124">        queryPanel.setBackground(Color.WHITE);</span>
        
<span class="fc" id="L126">        return queryPanel;</span>
    }
    
    /**
     *  Creates a sub-panel containing two inner sub-panels:
     *  &lt;ul&gt;
     *      &lt;li&gt;IP Address Lookups Panel
     *      &lt;li&gt;Miscellaneous Queries Panel
     *  &lt;/ul&gt;
     *
     *  @return      Additional Queries sub-panel.
     */
    private JPanel additionalQueriesPanel(){
<span class="fc" id="L139">        JPanel additionalQueriesPanel = new JPanel();</span>
<span class="fc" id="L140">        additionalQueriesPanel.setLayout(new FlowLayout(FlowLayout.LEFT));</span>
        
<span class="fc" id="L142">        additionalQueriesPanel.add(IPAddressLookups());</span>
<span class="fc" id="L143">        additionalQueriesPanel.add(MiscellaneousQueries());</span>
        
<span class="fc" id="L145">        additionalQueriesPanel.setBackground(Color.WHITE);</span>
        
<span class="fc" id="L147">        return additionalQueriesPanel;</span>
    }
    
    /**
     *  Creates a inner sub-panel containing:
     *  &lt;ul&gt;
     *      &lt;li&gt;a couple clickable radio button labels
     *      &lt;li&gt;a checkbox label for user to &lt;b&gt;&quot;Associated reverse domain&quot;&lt;/b&gt;
     *  &lt;/ul&gt;
     *
     *  @return      IP Address Lookups inner sub-panel.
     */
    private JPanel IPAddressLookups(){
<span class="fc" id="L160">        JPanel LookupPanel = new JPanel();</span>
<span class="fc" id="L161">        LookupPanel.setLayout(new BoxLayout(LookupPanel, BoxLayout.Y_AXIS));</span>
        
<span class="fc" id="L163">        lowercaseL = new JRadioButton(&quot;1st level less specific&quot;);</span>
<span class="fc" id="L164">        radioButtonGroup.add(lowercaseL);</span>
<span class="fc" id="L165">        LookupPanel.add(lowercaseL);</span>
        
<span class="fc" id="L167">        uppercaseL = new JRadioButton(&quot;All less specific&quot;);</span>
<span class="fc" id="L168">        radioButtonGroup.add(uppercaseL);</span>
<span class="fc" id="L169">        LookupPanel.add(uppercaseL);</span>
        
<span class="fc" id="L171">        lowercaseM = new JRadioButton(&quot;1st level more specific&quot;);</span>
<span class="fc" id="L172">        radioButtonGroup.add(lowercaseM);</span>
<span class="fc" id="L173">        LookupPanel.add(lowercaseM);</span>
        
<span class="fc" id="L175">        uppercaseM = new JRadioButton(&quot;All more specific&quot;);</span>
<span class="fc" id="L176">        radioButtonGroup.add(uppercaseM);</span>
<span class="fc" id="L177">        LookupPanel.add(uppercaseM);</span>
        
<span class="fc" id="L179">        lowercaseX = new JRadioButton(&quot;Exact match only&quot;);</span>
<span class="fc" id="L180">        radioButtonGroup.add(lowercaseX);</span>
<span class="fc" id="L181">        LookupPanel.add(lowercaseX);</span>
        
<span class="fc" id="L183">        Action actionListener = new AbstractAction(&quot;Associated reverse domain&quot;){</span>
            public void actionPerformed(ActionEvent evt){
<span class="nc" id="L185">                booleanD = ((JCheckBox)evt.getSource()).isSelected();</span>
<span class="nc" id="L186">            }</span>
        };
<span class="fc" id="L188">        lowercaseD = new JCheckBox(actionListener);</span>
<span class="fc" id="L189">        LookupPanel.add(lowercaseD);</span>
        
<span class="fc" id="L191">        resetRadioButton = new JRadioButton(&quot;Reset Radio Button&quot;);</span>
<span class="fc" id="L192">        radioButtonGroup.add(resetRadioButton);</span>
        
<span class="fc" id="L194">        LookupPanel.setBackground(Color.WHITE);</span>
<span class="fc" id="L195">        lowercaseL.setBackground(Color.WHITE);</span>
<span class="fc" id="L196">        uppercaseL.setBackground(Color.WHITE);</span>
<span class="fc" id="L197">        lowercaseM.setBackground(Color.WHITE);</span>
<span class="fc" id="L198">        uppercaseM.setBackground(Color.WHITE);</span>
<span class="fc" id="L199">        lowercaseX.setBackground(Color.WHITE);</span>
<span class="fc" id="L200">        lowercaseD.setBackground(Color.WHITE);</span>
        
<span class="fc" id="L202">        String toolTipText = &quot;Use these options to view IP address blocks &quot; +</span>
                &quot;that match or are larger than the IP address or range you &quot; +
                &quot;wish to query&quot;;
<span class="fc" id="L205">        lowercaseL.setToolTipText(toolTipText);</span>
<span class="fc" id="L206">        uppercaseL.setToolTipText(toolTipText);</span>
<span class="fc" id="L207">        lowercaseM.setToolTipText(toolTipText);</span>
<span class="fc" id="L208">        uppercaseM.setToolTipText(toolTipText);</span>
<span class="fc" id="L209">        lowercaseX.setToolTipText(toolTipText);</span>
<span class="fc" id="L210">        lowercaseD.setToolTipText(toolTipText);</span>
        
<span class="fc" id="L212">        return LookupPanel;</span>
    }
    
    /**
     *  Creates a inner sub-panel containing:
     *  &lt;ul&gt;
     *      &lt;li&gt;a &lt;b&gt;&quot;Inverse Queries&quot;&lt;/b&gt; label
     *      &lt;li&gt;a drop-down menu containing Inverse Queries
     *      &lt;li&gt;a &lt;b&gt;&quot;Miscellaneous Queries&quot;&lt;/b&gt; label
     *      &lt;li&gt;a list containing Miscellaneous Queries inside a scrollable
     *          panel
     *  &lt;/ul&gt;
     *
     *  @return      Miscellaneous Queries inner sub-panel.
     */
    private JPanel MiscellaneousQueries(){
<span class="fc" id="L228">        JPanel MiscPanel = new JPanel();</span>
<span class="fc" id="L229">        MiscPanel.setLayout(new BoxLayout(MiscPanel, BoxLayout.Y_AXIS));</span>
        
<span class="fc" id="L231">        JLabel inverseLabel = new JLabel(&quot;Inverse Queries&quot;);</span>
<span class="fc" id="L232">        MiscPanel.add(inverseLabel);</span>
<span class="fc" id="L233">        inverseQueries = new JComboBox();</span>
<span class="fc" id="L234">        inverseQueries.addItem(&quot;None&quot;);</span>
<span class="fc" id="L235">        inverseQueries.addItem(&quot;admin-c&quot;);</span>
<span class="fc" id="L236">        inverseQueries.addItem(&quot;admin-c,tech-c,zone-c&quot;);</span>
<span class="fc" id="L237">        inverseQueries.addItem(&quot;author&quot;);</span>
<span class="fc" id="L238">        inverseQueries.addItem(&quot;cross-mnt&quot;);</span>
<span class="fc" id="L239">        inverseQueries.addItem(&quot;cross-nfy&quot;);</span>
<span class="fc" id="L240">        inverseQueries.addItem(&quot;local-as&quot;);</span>
<span class="fc" id="L241">        inverseQueries.addItem(&quot;mbrs-by-ref&quot;);</span>
<span class="fc" id="L242">        inverseQueries.addItem(&quot;member-of&quot;);</span>
<span class="fc" id="L243">        inverseQueries.addItem(&quot;mnt-by&quot;);</span>
<span class="fc" id="L244">        inverseQueries.addItem(&quot;mnt-lower&quot;);</span>
<span class="fc" id="L245">        inverseQueries.addItem(&quot;mnt-nfy&quot;);</span>
<span class="fc" id="L246">        inverseQueries.addItem(&quot;mnt-routes&quot;);</span>
<span class="fc" id="L247">        inverseQueries.addItem(&quot;notify&quot;);</span>
<span class="fc" id="L248">        inverseQueries.addItem(&quot;nserver&quot;);</span>
<span class="fc" id="L249">        inverseQueries.addItem(&quot;origin&quot;);</span>
<span class="fc" id="L250">        inverseQueries.addItem(&quot;person&quot;);</span>
<span class="fc" id="L251">        inverseQueries.addItem(&quot;referral-by&quot;);</span>
<span class="fc" id="L252">        inverseQueries.addItem(&quot;rev-srv&quot;);</span>
<span class="fc" id="L253">        inverseQueries.addItem(&quot;sub-dom&quot;);</span>
<span class="fc" id="L254">        inverseQueries.addItem(&quot;tech-c&quot;);</span>
<span class="fc" id="L255">        inverseQueries.addItem(&quot;upd-to&quot;);</span>
<span class="fc" id="L256">        inverseQueries.addItem(&quot;zone-c&quot;);</span>
<span class="fc" id="L257">        inverseQueries.setToolTipText(&quot;Searching for objects in the &quot;+</span>
                WHOIS_NAME + &quot; Whois Database that have an attribute matching&quot; +
                &quot; the attribute type chosen from the inverse lookup scroll &quot; +
                &quot;list and the query text given by the user&quot;);
<span class="fc" id="L261">        MiscPanel.add(inverseQueries);</span>
        
<span class="fc" id="L263">        JLabel miscLabel = new JLabel(&quot;Object Types&quot;);</span>
<span class="fc" id="L264">        MiscPanel.add(miscLabel);</span>
<span class="fc" id="L265">        String[] items = {&quot;All&quot;, &quot;as-block&quot;, &quot;as-set&quot;, &quot;aut-num&quot;, &quot;domain&quot;,</span>
        &quot;filter-set&quot;, &quot;inet-rtr&quot;, &quot;inet6num&quot;, &quot;inetnum&quot;, &quot;irt&quot;, &quot;key-cert&quot;,
        &quot;mntner&quot;, &quot;peering-set&quot;, &quot;person&quot;, &quot;role&quot;, &quot;route&quot;, &quot;route-set&quot;,
        &quot;rtr-set&quot;};
<span class="fc" id="L269">        miscList = new JList(items);</span>
<span class="fc" id="L270">        miscList.setSelectedIndex(0);</span>
<span class="fc" id="L271">        miscList.setToolTipText(&quot;Limit your search to particular types of &quot; +</span>
                &quot;objects&quot;);
<span class="fc" id="L273">        JScrollPane scrollingList = new JScrollPane(miscList);</span>
        
<span class="fc" id="L275">        MiscPanel.add(scrollingList);</span>
        
<span class="fc" id="L277">        MiscPanel.setBackground(Color.WHITE);</span>
<span class="fc" id="L278">        inverseQueries.setBackground(Color.WHITE);</span>
        
<span class="fc" id="L280">        return MiscPanel;</span>
    }
    
    /**
     *  Creates a sub-panel placed on the bottom of the main panel.
     *
     *  @return     Query Hints sub-panel
     */
    private JPanel queryHintsPanel(){
<span class="fc" id="L289">        JPanel queryHintsPanel = new JPanel();</span>
<span class="fc" id="L290">        queryHintsPanel.setLayout(new FlowLayout(FlowLayout.CENTER));</span>
        
<span class="fc" id="L292">        JPanel innerPanel = new JPanel();</span>
<span class="fc" id="L293">        innerPanel.setLayout(new BoxLayout(innerPanel, BoxLayout.Y_AXIS));</span>
        
<span class="fc" id="L295">        JLabel queryHintsText1 = new JLabel(&quot;Query hints &quot;);</span>
<span class="fc" id="L296">        JLabel emptyLabel = new JLabel(&quot;EMPTY LABEL&quot;);</span>
<span class="fc" id="L297">        emptyLabel.setForeground(Color.WHITE);</span>
<span class="fc" id="L298">        JLabel queryHintsText2 = new JLabel(&quot;* Include \&quot;AS\&quot; in front of an &quot; +</span>
                &quot;AS number.&quot;);
<span class="fc" id="L300">        JLabel queryHintsText3 = new JLabel(&quot;Example: AS4808&quot;);</span>
<span class="fc" id="L301">        JLabel queryHintsText4 = new JLabel(&quot;* Include \&quot;-t\&quot; (template only)&quot; +</span>
                &quot; or \&quot;-v\&quot; (template and description) in front of an object &quot; +
                &quot;name to view the template.&quot;);
<span class="fc" id="L304">        JLabel queryHintsText5 = new JLabel(&quot;Example: -t inetnum&quot;);</span>
        
<span class="fc" id="L306">        innerPanel.add(queryHintsText1);</span>
<span class="fc" id="L307">        innerPanel.add(emptyLabel);</span>
<span class="fc" id="L308">        innerPanel.add(queryHintsText2);</span>
<span class="fc" id="L309">        innerPanel.add(queryHintsText3);</span>
<span class="fc" id="L310">        innerPanel.add(queryHintsText4);</span>
<span class="fc" id="L311">        innerPanel.add(queryHintsText5);</span>
        
<span class="fc" id="L313">        queryHintsPanel.setBackground(Color.WHITE);</span>
<span class="fc" id="L314">        innerPanel.setBackground(Color.WHITE);</span>
        
<span class="fc" id="L316">        queryHintsPanel.add(innerPanel);</span>
<span class="fc" id="L317">        return queryHintsPanel;</span>
    }
    
    /**
     *  Create a right-click drop-down menu for the &lt;b&gt;queryTextField&lt;/b&gt;
     *  &lt;code&gt;JTextField&lt;/code&gt;
     */
    private void createPopupMenu(){
<span class="fc" id="L325">        popupMenu = new JPopupMenu();</span>
<span class="fc" id="L326">        JMenuItem cut = new JMenuItem(&quot;Cut&quot;);</span>
<span class="fc" id="L327">        JMenuItem copy = new JMenuItem(&quot;Copy&quot;);</span>
<span class="fc" id="L328">        JMenuItem paste = new JMenuItem(&quot;Paste&quot;);</span>
<span class="fc" id="L329">        JMenuItem selectAll = new JMenuItem(&quot;Select All&quot;);</span>
        
<span class="fc" id="L331">        popupMenu.add(cut);</span>
<span class="fc" id="L332">        popupMenu.add(copy);</span>
<span class="fc" id="L333">        popupMenu.add(paste);</span>
<span class="fc" id="L334">        popupMenu.add(selectAll);</span>
        
<span class="fc" id="L336">        cut.addActionListener(new ActionListener() {</span>
            public void actionPerformed( ActionEvent e ) {
<span class="nc" id="L338">                queryTextField.cut();</span>
<span class="nc" id="L339">            }</span>
        });
        
<span class="fc" id="L342">        copy.addActionListener(new ActionListener() {</span>
            public void actionPerformed( ActionEvent e ) {
<span class="nc" id="L344">                queryTextField.copy();</span>
<span class="nc" id="L345">            }</span>
        });
        
<span class="fc" id="L348">        paste.addActionListener(new ActionListener() {</span>
            public void actionPerformed( ActionEvent e ) {
<span class="nc" id="L350">                queryTextField.paste();</span>
<span class="nc" id="L351">            }</span>
        });
        
<span class="fc" id="L354">        selectAll.addActionListener(new ActionListener() {</span>
            public void actionPerformed( ActionEvent e ) {
<span class="nc" id="L356">                queryTextField.selectAll();</span>
<span class="nc" id="L357">            }</span>
        });
<span class="fc" id="L359">    }</span>
    
    /**
     *  Determines what to do when a button is pressed.
     *
     *  &lt;p&gt;If &lt;b&gt;Calculate&lt;/b&gt; button is pressed, it triggers the
     *  &lt;code&gt;startQuery()&lt;/code&gt; method to query the WhoIS server address.
     *
     *  &lt;p&gt;If &lt;b&gt;Reset&lt;/b&gt; button is pressed, it initialises the
     *  &lt;code&gt;reset()&lt;/code&gt; method to reset this panel back to its initial
     *  state.
     */
    public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L372" title="All 2 branches missed.">        if (e.getSource() == queryButton)</span>
<span class="nc" id="L373">            startQuery();</span>
<span class="nc bnc" id="L374" title="All 2 branches missed.">        else if (e.getSource() == resetButton)</span>
<span class="nc" id="L375">            reset();</span>
<span class="nc" id="L376">    }</span>
    
    /**
     *  Starts querying the WhoIs server if the query length is greater than 1.
     */
    private void startQuery(){
<span class="nc bnc" id="L382" title="All 2 branches missed.">        if (getQuery().length() &lt; 1)</span>
<span class="nc" id="L383">            displayError(&quot;No Query Detected&quot;);</span>
        else
<span class="nc" id="L385">            query(getQuery());</span>
<span class="nc" id="L386">    }</span>
    
    /**
     *  Displays errors in a notification pop-up box.
     *
     *  @param      error       The error message to be displayed.
     */
    private void displayError(String error){
<span class="nc" id="L394">        JOptionPane.showMessageDialog(this, error, &quot;Error&quot;,</span>
                JOptionPane.ERROR_MESSAGE);
<span class="nc" id="L396">    }</span>
    
    /**
     *  Establishs a connection to the WhoIS server, sends the query to the
     *  server and reads the query's result then sends the output to
     *  &lt;code&gt;&lt;b&gt;WhoISOutput.java&lt;/b&gt;&lt;/code&gt;
     *
     *  &lt;p&gt;Displays appropriate errors if the WhoIS server address was declared
     *  incorrectly or the WhoIS server cannot be contacted.
     *
     *  @param      query       WhoIs Database Object to be queried.
     */
    private void query(String query) {
        try {
<span class="nc" id="L410">            Socket connection = new Socket(WHOIS_ADDRESS, WHOIS_PORT);</span>
<span class="nc" id="L411">            PrintStream out = new PrintStream(connection.getOutputStream());</span>
<span class="nc" id="L412">            BufferedReader in = new BufferedReader(new InputStreamReader(</span>
<span class="nc" id="L413">                    connection.getInputStream()));</span>
<span class="nc" id="L414">            String line = &quot;&quot;;</span>
            
<span class="nc" id="L416">            out.println(query);</span>
            
<span class="nc" id="L418">            String output = &quot;&quot;;</span>
<span class="nc bnc" id="L419" title="All 2 branches missed.">            while ((line = in.readLine()) != null)</span>
<span class="nc" id="L420">                output += line + &quot;\n&quot;;</span>
            
<span class="nc" id="L422">            new WhoISOutput(output);</span>
<span class="nc" id="L423">            output = &quot;&quot;;</span>
<span class="nc" id="L424">        } catch (java.net.UnknownHostException e) {</span>
<span class="nc" id="L425">            displayError(&quot;Unknown Whois host: &quot; + WHOIS_ADDRESS);</span>
<span class="nc" id="L426">        } catch (IOException e) {</span>
<span class="nc" id="L427">            displayError(&quot;Whois server could not be contacted.\nPlease check&quot; +</span>
                    &quot; your internet connection.&quot;);
<span class="nc" id="L429">        }</span>
<span class="nc" id="L430">    }</span>
    
    /**
     *  Retrieves the WhoIs Database object to be queried and any selections the
     *  user has made.
     *
     *  @return     Full query with WhoIs Database object and any additional
     *              queries.
     */
    private String getQuery(){
<span class="nc" id="L440">        String query = queryTextField.getText().trim();</span>
        
<span class="nc" id="L442">        String iqs = inverseQueries.getSelectedItem().toString();</span>
<span class="nc bnc" id="L443" title="All 2 branches missed.">        if (!iqs.equals(&quot;None&quot;))</span>
<span class="nc" id="L444">            query = &quot;-i &quot; + iqs + &quot; &quot; + query;</span>
        
<span class="nc bnc" id="L446" title="All 2 branches missed.">        if (lowercaseL.isSelected())</span>
<span class="nc" id="L447">            query = &quot;-l &quot; + query;</span>
<span class="nc bnc" id="L448" title="All 2 branches missed.">        else if (uppercaseL.isSelected())</span>
<span class="nc" id="L449">            query = &quot;-L &quot; + query;</span>
<span class="nc bnc" id="L450" title="All 2 branches missed.">        else if (lowercaseM.isSelected())</span>
<span class="nc" id="L451">            query = &quot;-m &quot; + query;</span>
<span class="nc bnc" id="L452" title="All 2 branches missed.">        else if (uppercaseM.isSelected())</span>
<span class="nc" id="L453">            query = &quot;-M &quot; + query;</span>
<span class="nc bnc" id="L454" title="All 2 branches missed.">        else if (lowercaseX.isSelected())</span>
<span class="nc" id="L455">            query = &quot;-x &quot; + query;</span>
        
<span class="nc bnc" id="L457" title="All 2 branches missed.">        if (booleanD)</span>
<span class="nc" id="L458">            query = &quot;-d &quot; + query;</span>
        
<span class="nc" id="L460">        String miscQueries = &quot;&quot;;</span>
<span class="nc" id="L461">        Object[] selected = miscList.getSelectedValues();</span>
<span class="nc bnc" id="L462" title="All 2 branches missed.">        for (int i = 0; i &lt; selected.length; i++)</span>
<span class="nc bnc" id="L463" title="All 2 branches missed.">            if (selected[i] != &quot;All&quot;)</span>
<span class="nc" id="L464">                miscQueries += selected[i] + &quot;,&quot;;</span>
        
<span class="nc bnc" id="L466" title="All 2 branches missed.">        if (miscQueries != &quot;&quot;){</span>
<span class="nc" id="L467">            miscQueries = miscQueries.substring(0, (miscQueries.length() - 1));</span>
<span class="nc" id="L468">            query = &quot;-T &quot; + miscQueries + &quot; &quot; + query;</span>
        }
        
<span class="nc" id="L471">        return query;</span>
    }
    
    /** Resets this panel to its initial state on startup. */
    public void reset(){
<span class="fc" id="L476">        queryTextField.setText(&quot;&quot;);</span>
<span class="fc" id="L477">        resetRadioButton.setSelected(true);</span>
<span class="fc" id="L478">        lowercaseD.setSelected(false);</span>
<span class="fc" id="L479">        inverseQueries.setSelectedIndex(0);</span>
<span class="fc" id="L480">        miscList.setSelectedIndex(0);</span>
<span class="fc" id="L481">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>