<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TraceFileRenamer.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">83_xbus</a> &gt; <a href="index.source.html" class="el_package">net.sf.xbus.base.core.trace</a> &gt; <span class="el_source">TraceFileRenamer.java</span></div><h1>TraceFileRenamer.java</h1><pre class="source lang-java linenums">package net.sf.xbus.base.core.trace;

import java.io.File;

import net.sf.xbus.base.core.Constants;
import net.sf.xbus.base.core.XException;
import net.sf.xbus.base.core.config.Configuration;

/**
 * The &lt;code&gt;TraceFileRenamer&lt;/code&gt; class is for renaming the trace file by
 * adding a timestamp.&lt;br&gt;
 * This serves for preventing to large trace files. The class just consists of a
 * &lt;code&gt;main&lt;/code&gt; method. This method checks the actual trace file size
 * against a configured maximally desired size and renames the file if its size
 * is too big.&lt;br&gt;
 * The next trace entry after a rename will construct a new trace file with the
 * configured original name.&lt;br&gt;
 * If no trace file name or no maximal length specification is found in the
 * configuration, nothing is done.
 * 
 * @author Stephan Duwel
 */
<span class="nc" id="L23">public class TraceFileRenamer</span>
{

	public static void main(String[] args)
	{
		Configuration config;
		// to get the path of the trace file and the &quot;critical&quot; file size
		try
		{
<span class="nc" id="L32">			config = Configuration.getInstance();</span>
<span class="nc" id="L33">			String fileName = config.getValueOptional(&quot;Base&quot;, &quot;Trace&quot;,</span>
					&quot;Filename&quot;);
			// trace file name
<span class="nc bnc" id="L36" title="All 2 branches missed.">			if (fileName != null)</span>
			{ // file name given
<span class="nc" id="L38">				long maxFileSize = config.getValueAsLongOptional(&quot;Base&quot;,</span>
						&quot;Trace&quot;, &quot;MaxFileSize&quot;);
				// maximal size
<span class="nc bnc" id="L41" title="All 2 branches missed.">				if (maxFileSize &gt; 0)</span>
				{ // maximal size specified
<span class="nc" id="L43">					String filePath = Constants.XBUS_HOME</span>
							+ Constants.FILE_SEPERATOR + &quot;log&quot;
							+ Constants.FILE_SEPERATOR + fileName;
<span class="nc" id="L46">					File configFile = new File(filePath);</span>
<span class="nc bnc" id="L47" title="All 2 branches missed.">					if (configFile.exists()</span>
<span class="nc bnc" id="L48" title="All 2 branches missed.">							&amp;&amp; configFile.length() &gt; maxFileSize)</span>
					{
<span class="nc" id="L50">						File newFile = new File(filePath</span>
<span class="nc" id="L51">								+ Constants.getDateAsString());</span>
<span class="nc bnc" id="L52" title="All 2 branches missed.">						if (!configFile.renameTo(newFile))</span>
<span class="nc" id="L53">							Trace.error(&quot;Trace file could not be renamed.&quot;);</span>
					} // if (configFile.exists() &amp;&amp;
						// configFile.length()&gt;maxFileSize)
				} // if (maxFileSize&gt;0)
			} // if (fileName!=null)
		} // try
<span class="nc" id="L59">		catch (XException e)</span>
		{ // Any exception during accessing the configuration is ignored.
<span class="nc" id="L61">		} // catch</span>
<span class="nc" id="L62">	} // main(String[] args)</span>

} // TraceFileRenamer
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>