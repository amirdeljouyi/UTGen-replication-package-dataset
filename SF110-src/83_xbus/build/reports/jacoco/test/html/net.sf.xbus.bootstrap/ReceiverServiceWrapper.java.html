<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ReceiverServiceWrapper.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">83_xbus</a> &gt; <a href="index.source.html" class="el_package">net.sf.xbus.bootstrap</a> &gt; <span class="el_source">ReceiverServiceWrapper.java</span></div><h1>ReceiverServiceWrapper.java</h1><pre class="source lang-java linenums">package net.sf.xbus.bootstrap;

import net.sf.xbus.base.core.XException;
import net.sf.xbus.base.core.reflection.ReflectionSupport;
import net.sf.xbus.base.core.reflection.XBUSClassLoader;
import net.sf.xbus.base.core.trace.Trace;

import org.tanukisoftware.wrapper.WrapperListener;
import org.tanukisoftware.wrapper.WrapperManager;

/**
 * Starts the {@link net.sf.xbus.technical.ReceiverService} as a background
 * service, using the {@link net.sf.xbus.base.core.reflection.XBUSClassLoader}.
 * &lt;p&gt;
 * It works together with the Java Service Wrapper from Silveregg Technologies
 * to start it as a service in Windows NT, Linux or Solaris. This is an
 * open-source packages which can be found at SourceForge.
 */

<span class="nc" id="L20">public class ReceiverServiceWrapper implements WrapperListener</span>
{
	/**
	 * Start the application. If the JVM was launched from the native Wrapper
	 * then the application will wait for the native Wrapper to call the
	 * application's start method. Otherwise the start method will be called
	 * immediately.
	 */
	public static void main(String[] args)
	{
<span class="nc" id="L30">		WrapperManager.start(new ReceiverServiceWrapper(), args);</span>
<span class="nc" id="L31">	}</span>

	/**
	 * Called when the WrapperManager is signaled by the native wrapper code
	 * that it can start its application. The
	 * {@link net.sf.xbus.technical.ReceiverService} will be started.
	 * 
	 * @param arg0 not used
	 * @return NULL if the &lt;code&gt;ReceiverService&lt;/code&gt; have been started,
	 *         otherwise 1
	 */
	public Integer start(String[] arg0)
	{
<span class="nc" id="L44">		Thread.currentThread().setContextClassLoader(</span>
<span class="nc" id="L45">				XBUSClassLoader.getInstance(Thread.currentThread()</span>
<span class="nc" id="L46">						.getContextClassLoader()));</span>

		try
		{
<span class="nc" id="L50">			Object obj = ReflectionSupport</span>
<span class="nc" id="L51">					.createObject(&quot;net.sf.xbus.technical.ReceiverService&quot;);</span>
<span class="nc" id="L52">			ReflectionSupport.callMethod(&quot;startWithoutServletEngine&quot;, obj,</span>
					null, null);
		}
<span class="nc" id="L55">		catch (XException e)</span>
		{
<span class="nc" id="L57">			return new Integer(1);</span>
<span class="nc" id="L58">		}</span>

<span class="nc" id="L60">		return null;</span>
	}

	/**
	 * Called when the application is shutting down. The
	 * {@link net.sf.xbus.technical.ReceiverService} will be stopped.
	 * 
	 * @param arg0 not used
	 * @return the exit code to actually return to the OS&lt;br&gt;
	 *         (1 - if there are any problems during shutdown, otherwise 0).
	 */
	public int stop(int arg0)
	{
<span class="nc" id="L73">		Trace.always(&quot;Stopping ReceiverServiceWrapper...&quot;);</span>

		try
		{
<span class="nc" id="L77">			ReceiverServiceAdministratorBootstrap.shutdown();</span>
		}
<span class="nc" id="L79">		catch (XException e)</span>
		{
<span class="nc" id="L81">			return 1;</span>
<span class="nc" id="L82">		}</span>

<span class="nc" id="L84">		Trace.always(&quot;ReceiverServiceWrapper stopped&quot;);</span>
<span class="nc" id="L85">		return 0;</span>
	}

	/**
	 * Called whenever the native wrapper code traps a system control signal
	 * against the Java process. All signals will be ignored.
	 */
	public void controlEvent(int arg0)
	{
<span class="nc" id="L94">		Trace.info(&quot;ReceiverServiceWrapper received controlEvent &quot; + arg0);</span>
<span class="nc" id="L95">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>