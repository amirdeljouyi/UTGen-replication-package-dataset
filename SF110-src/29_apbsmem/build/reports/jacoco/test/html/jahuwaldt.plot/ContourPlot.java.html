<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ContourPlot.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">29_apbsmem</a> &gt; <a href="index.source.html" class="el_package">jahuwaldt.plot</a> &gt; <span class="el_source">ContourPlot.java</span></div><h1>ContourPlot.java</h1><pre class="source lang-java linenums">/*
*   ContourPlot  -- A simple 2D contour plot of gridded 3D data.
*
*   Copyright (C) 2000-2002 by Joseph A. Huwaldt &lt;jhuwaldt@knology.net&gt;.
*   All rights reserved.
*   
*   This library is free software; you can redistribute it and/or
*   modify it under the terms of the GNU Library General Public
*   License as published by the Free Software Foundation; either
*   version 2 of the License, or (at your option) any later version.
*   
*   This library is distributed in the hope that it will be useful,
*   but WITHOUT ANY WARRANTY; without even the implied warranty of
*   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
*   Library General Public License for more details.
**/
package jahuwaldt.plot;

import java.awt.*;
import javax.swing.*;
import java.util.*;
import java.text.NumberFormat;


/**
*  &lt;p&gt; An object that represents a simple 2D contour plot
*      of 3D data.
*  &lt;/p&gt;
*  &lt;p&gt; Grid styles, axis formats, and axis labels can
*      be changed by accessing this object's axes and
*      making the changes there.  Then call repaint()
*      on the component containing this plot.
*  &lt;/p&gt;
*  &lt;p&gt; This object's run list contains the contour lines
*      being plotted.  Each run represents a contour level.
*  &lt;/p&gt;
*
*  &lt;p&gt;  Modified by:  Joseph A. Huwaldt  &lt;/p&gt;
*
*  @author  Joseph A. Huwaldt   Date:  November 12, 2000
*  @version November 20, 2000
**/
public class ContourPlot extends SimplePlotXY {

	//	Debug flag.
	private static final boolean DEBUG = false;
	
	//	The contour paths displayed in this plot.
<span class="nc" id="L49">	private ContourPath[] paths = null;</span>
	
	//-------------------------------------------------------------------------
	/**
	*  Only subclasses can access the default constructor.
	**/
<span class="nc" id="L55">	protected ContourPlot() { }</span>
	
	/**
	*  Creates an contour plot of the specified gridded, 3D, data.
	*
	*  @param  xArr     A 2D array of X coordinate values.
	*  @param  yArr     A 2D array of Y coordinate values.
	*  @param  zArr     A 2D array of Z coordinate values.
	*  @param  nc       The number of contour levels to plot.
	*  @param  intType  Indicates if the intervals should be log (true),
	*                   or linear (false).
	*  @param  title    The title to be displayed across the top
	*                   of the plot.
	*  @param  xLabel   The label to be displayed along the X-axis.
	*  @param  yLabel   The label to be displayed along the Y-axis.
	*  @param  xFormat  The number format to be used for the X axis
	*                   tick mark labels.
	*  @param  yFormat  The number format to be used for the Y axis
	*                   tick mark labels.
	**/
	public ContourPlot( double[][] xArr, double[][] yArr, double[][] zArr, int nc, boolean intType,
						String title, String xLabel, String yLabel,
<span class="nc" id="L77">						NumberFormat xFormat, NumberFormat yFormat )  {</span>

<span class="nc" id="L79">		this.setTitle(title);</span>
		
<span class="nc" id="L81">		createPlot(xArr, yArr, zArr, xLabel, yLabel, xFormat, yFormat, nc, intType);</span>
		
<span class="nc" id="L83">	}</span>

	private void createPlot( double[][] xArr, double[][] yArr, double[][] zArr,
						String xLabel, String yLabel,
						NumberFormat xFormat, NumberFormat yFormat,
						int nc, boolean logIntervals) {
		try {
		
			//	Generate the contours.
<span class="nc" id="L92">			ContourGenerator cg = new ContourGenerator(xArr, yArr, zArr, nc, logIntervals);</span>
<span class="nc" id="L93">			paths = cg.getContours();</span>
<span class="nc" id="L94">			int npaths = paths.length;</span>
		
			if (DEBUG) {
				System.out.println(&quot;Number of contours = &quot; + nc);
				System.out.println(&quot;Number of contour paths = &quot; + npaths);
			}
			
			//	Get this plots list of runs.
<span class="nc" id="L102">			PlotRunList runs = this.getRuns();</span>
<span class="nc" id="L103">			runs.clear();</span>
		
			//	Create an empty run for each contour level.
<span class="nc bnc" id="L106" title="All 2 branches missed.">			for (int i=0; i &lt; nc; ++i)</span>
<span class="nc" id="L107">				runs.add( new PlotRun() );</span>
		
			//	Loop over all the contour paths, adding them to the appropriate
			//	contour level.
<span class="nc bnc" id="L111" title="All 2 branches missed.">			for (int j=0; j &lt; npaths; ++j) {</span>
				//	Retrieve the contour path data.
<span class="nc" id="L113">				double[] xData = paths[j].getAllX();</span>
<span class="nc" id="L114">				double[] yData = paths[j].getAllY();</span>
<span class="nc" id="L115">				int levelIndex = paths[j].getLevelIndex();</span>
			
				if (DEBUG) {
					System.out.println();
					System.out.println(&quot;LevelIdx = &quot; + levelIndex);
				}
				
				//	Retrieve the appropriate run.
<span class="nc" id="L123">				PlotRun run = (PlotRun)runs.get(levelIndex);</span>
			
				//	Add this path the the retrieved run, one data point at a time.
<span class="nc" id="L126">				int numPoints = xData.length;</span>
<span class="nc bnc" id="L127" title="All 2 branches missed.">				for (int i=0; i &lt; numPoints; ++i) {</span>
<span class="nc bnc" id="L128" title="All 2 branches missed.">					run.add( new PlotDatum(xData[i], yData[i], i != 0) );</span>
					if (DEBUG)
						System.out.println(&quot;X = &quot; + (float)xData[i] + &quot;,  Y = &quot; + (float)yData[i]);
				}
			}
			
<span class="nc" id="L134">		} catch (InterruptedException e) {</span>
			//	Shouldn't be possible here.
<span class="nc" id="L136">			e.printStackTrace();</span>
<span class="nc" id="L137">		}</span>
		
		//	Create our plot axes and add them to this plot.
<span class="nc" id="L140">		PlotAxis axis = new PlotXAxis(xLabel, null, xFormat, PlotAxis.kMajorGrid);</span>
<span class="nc" id="L141">		this.setHorizontalAxis(axis);</span>
<span class="nc" id="L142">		axis = new PlotYAxis(yLabel, null, yFormat, PlotAxis.kMajorGrid);</span>
<span class="nc" id="L143">		this.setVerticalAxis(axis);</span>
		
<span class="nc" id="L145">	}</span>

	/**
	*  Colorize the contours by linearly interpolating between
	*  the specified colors for this plot's range of contour levels.
	**/
	public void colorizeContours(Color lowColor, Color highColor) {
		
		//	Find the range of levels in the contours.
<span class="nc" id="L154">		double minLevel = Double.MAX_VALUE;</span>
<span class="nc" id="L155">		double maxLevel = -minLevel;</span>
<span class="nc" id="L156">		int npaths = paths.length;</span>
<span class="nc bnc" id="L157" title="All 2 branches missed.">		for (int i=0; i &lt; npaths; ++i) {</span>
<span class="nc" id="L158">			double level = paths[i].getAttributes().getLevel();</span>
<span class="nc" id="L159">			minLevel = Math.min(minLevel, level);</span>
<span class="nc" id="L160">			maxLevel = Math.max(maxLevel, level);</span>
		}
		
		//	Now assign the colors.
<span class="nc" id="L164">		PlotRunList runs = getRuns();</span>
<span class="nc bnc" id="L165" title="All 2 branches missed.">		for (int i=0; i &lt; npaths; ++i) {</span>
			//	Extract contour path information.
<span class="nc" id="L167">			double level = paths[i].getAttributes().getLevel();</span>
<span class="nc" id="L168">			int levelIndex = paths[i].getLevelIndex();</span>
			
			//	Retrieve the appropriate run.
<span class="nc" id="L171">			PlotRun run = (PlotRun)runs.get(levelIndex);</span>
			
			//	Colorize the run.
<span class="nc" id="L174">			run.setLineColor(interpColors(lowColor, highColor, minLevel, maxLevel, level));</span>
		}
<span class="nc" id="L176">	}</span>
	
	/**
	*  Interpolate the colors for the contour level.
	**/
	private Color interpColors(Color lowColor, Color highColor,
						double minLevel, double maxLevel, double level) {
<span class="nc" id="L183">		level -= minLevel;</span>
<span class="nc" id="L184">		double range = maxLevel - minLevel;</span>
<span class="nc" id="L185">		double temp = range - level;</span>
		
<span class="nc" id="L187">		Color color = new Color(</span>
<span class="nc" id="L188">			(int)(( temp*lowColor.getRed() + level*highColor.getRed() )/range),</span>
<span class="nc" id="L189">			(int)(( temp*lowColor.getGreen() + level*highColor.getGreen() )/range),</span>
<span class="nc" id="L190">			(int)(( temp*lowColor.getBlue() + level*highColor.getBlue() )/range) );</span>
		
<span class="nc" id="L192">		return color;</span>
	}
	
	/**
	*  Make a copy of this ContourPlot object.
	*
	*  @return  Returns a clone of this object.
	**/
	public Object clone() {
<span class="nc" id="L201">		ContourPlot newObject = null;</span>
		
		// Make a shallow copy of this object.
<span class="nc" id="L204">		newObject = (ContourPlot) super.clone();</span>

		// Make a copy of this object's data structures.
<span class="nc" id="L207">		int length = this.paths.length;</span>
<span class="nc" id="L208">		newObject.paths = new ContourPath[length];</span>
<span class="nc bnc" id="L209" title="All 2 branches missed.">		for (int i=0; i &lt; length; ++i)</span>
<span class="nc" id="L210">			newObject.paths[i] = (ContourPath)this.paths[i].clone();</span>

		// Output the newly cloned object.
<span class="nc" id="L213">		return newObject;</span>
	}

}

</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>