<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PlotAxis.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">29_apbsmem</a> &gt; <a href="index.source.html" class="el_package">jahuwaldt.plot</a> &gt; <span class="el_source">PlotAxis.java</span></div><h1>PlotAxis.java</h1><pre class="source lang-java linenums">/*
*   PlotAxis  -- Represents a generic plot axis.
*
*   Copyright (C) 2000-2002 by Joseph A. Huwaldt &lt;jhuwaldt@knology.net&gt;.
*   All rights reserved.
*   
*   This library is free software; you can redistribute it and/or
*   modify it under the terms of the GNU Library General Public
*   License as published by the Free Software Foundation; either
*   version 2 of the License, or (at your option) any later version.
*   
*   This library is distributed in the hope that it will be useful,
*   but WITHOUT ANY WARRANTY; without even the implied warranty of
*   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
*   Library General Public License for more details.
**/
package jahuwaldt.plot;

import java.text.*;
import java.util.*;
import java.awt.*;


/**
*  &lt;p&gt; This class represents an generic plot axis.
*      Subtypes should specify if they are X or Y
*      axis types.
*  &lt;/p&gt;
*
*  &lt;p&gt;  Modified by:  Joseph A. Huwaldt  &lt;/p&gt;
*
*  @author  Joseph A. Huwaldt   Date:  September 13, 2000
*  @version January 10, 2001
**/
public abstract class PlotAxis extends Object implements Cloneable, java.io.Serializable {

	//	Debug flag.
	private static final boolean DEBUG = false;
	
	/**
	*  Size of minor tick marks in pixels.  Major tick
	*  marks are 3 times bigger.
	**/
	public static final int kTick = 5;
	
	/**
	*  Grid style indicating that no grid should be drawn.
	**/
	public static final int kNoGrid = 0;
	
	/**
	*  Grid style indicating that only the tick marks should be drawn.
	**/
	public static final int kTickMarksOnly = 1;
	
	/**
	*  Grid style indicating that the grid should be drawn on the
	*  major tick marks.
	**/
	public static final int kMajorGrid = 2;
	
	
	/**
	*  Indicates if the upper and lower bounds are manually
	*  input or automatically calculated.
	**/
	protected boolean manualLB, manualUB;
	
	/**
	*  Indicates if the tick mark step size is manually input
	*  or automatically calculated.
	**/
	protected boolean manualQuant;
	
	/**
	*  Scaling coefficients between data and screen coordinates.
	**/
<span class="nc" id="L78">	protected double xA = 1., xB = 1.;</span>

	/**
	*  Lower and upper bounds on this axis.
	**/
<span class="nc" id="L83">	protected double aLB = Double.MAX_VALUE, aUB = -Double.MAX_VALUE;</span>
	
	/**
	*  The tick mark step size in data coordinates.
	**/
	protected double quantum;
	
	/**
	*  The grid style (0=no grid, 1=tick marks only, 2=grid on major tickmarks).
	**/
<span class="nc" id="L93">	protected int gridStyle = kTickMarksOnly;</span>
	
	/**
	*  The axis scale transformation function is in this object.
	**/
<span class="nc" id="L98">	protected PlotAxisScale scale = new LinearAxisScale();</span>
	
	/**
	*  The number format used for the axis number labels.  The default
	*  decimal format is used if nothing is specified.
	**/
<span class="nc" id="L104">	protected NumberFormat nf = (DecimalFormat)NumberFormat.getInstance();</span>
	
	/**
	*  The label for this plot axis.
	**/
	protected String label;
	
	
	//-------------------------------------------------------------------------
	/**
	*  Create a new plot axis using the default settings.  Can only
	*  be accessed from sub-classes.
	**/
<span class="nc" id="L117">	protected PlotAxis() { }</span>
	
	/**
	*  Create a plot axis with the label, axis scale transformation,
	*  number format and grid style specified.
	*
	*  @param label      The label to place on this axis.  If null is passed
	*                    no label is drawn.
	*  @param scale      Object indicating if the axis scale type.
	*  @param nf         The object used to format the axis numbers.
	*                    If null is passed, the default decimal format is used.
	*  @param gridStyle  The grid style to use.  Should be one of the constants
	*                    provided by this class.
	**/
<span class="nc" id="L131">	protected PlotAxis( String label, PlotAxisScale scale, NumberFormat nf, int gridStyle ) {</span>
<span class="nc" id="L132">		this.label = label;</span>
		
<span class="nc bnc" id="L134" title="All 2 branches missed.">		if (scale != null)</span>
<span class="nc" id="L135">			this.scale = scale;</span>
			
<span class="nc bnc" id="L137" title="All 2 branches missed.">		if (nf != null)</span>
<span class="nc" id="L138">			this.nf = nf;</span>
		
<span class="nc" id="L140">		this.gridStyle = gridStyle;</span>
		
<span class="nc" id="L142">	}</span>

	//-------------------------------------------------------------------------
	/**
	*  Set the label used by this plot axis.  If null is passed,
	*  no label is drawn.
	**/
	public void setLabel(String newLabel) {
<span class="nc" id="L150">		label = newLabel;</span>
<span class="nc" id="L151">	}</span>

	/**
	*  Return the label used by this plot axis.
	**/
	public String getLabel() {
<span class="nc" id="L157">		return label;</span>
	}

	/**
	*  Set the axis scale type used by this axis.  If null is
	*  passed, the scale will default to a linear scale.
	**/
	public void setScale(PlotAxisScale scale) {
<span class="nc bnc" id="L165" title="All 2 branches missed.">		if (scale == null)</span>
<span class="nc" id="L166">			this.scale = new LinearAxisScale();</span>
		else
<span class="nc" id="L168">			this.scale = scale;</span>
<span class="nc" id="L169">	}</span>
	
	/**
	*  Return the axis scale used by this plot axis.
	**/
	public PlotAxisScale getScale() {
<span class="nc" id="L175">		return scale;</span>
	}
	
	/**
	*  Set the number format used to format the axis numbers for this axis.
	*  If null is passed, the default decimal format is used.
	**/
	public void setNumberFormat( NumberFormat format ) {
<span class="nc bnc" id="L183" title="All 2 branches missed.">		if (format == null)</span>
<span class="nc" id="L184">			nf = (DecimalFormat)NumberFormat.getInstance();</span>
		else
<span class="nc" id="L186">			nf = format;</span>
<span class="nc" id="L187">	}</span>

	/**
	*  Return the number format used by this plot axis.
	**/
	public NumberFormat getNumberFormat() {
<span class="nc" id="L193">		return nf;</span>
	}

	/**
	*  Set the grid style used by this plot axis.  The grid style
	*  should be one of the constants supplied by this class.
	**/
	public void setGridStyle( int style ) {
<span class="nc" id="L201">		gridStyle = style;</span>
<span class="nc" id="L202">	}</span>

	/**
	*  Return the grid style used by this plot axis.
	**/
	public int getGridStyle() {
<span class="nc" id="L208">		return gridStyle;</span>
	}

	/**
	*  Sets whether or not this scale has a manually
	*  or automatically set lower bounds.
	**/
	public void manualLowerBounds(boolean flag) {
<span class="nc" id="L216">		manualLB = flag;</span>
<span class="nc" id="L217">	}</span>
	
	/**
	*  Set the lower (most negative) limit of the axis.
	**/
	public void setLowerBounds(double value) {
<span class="nc" id="L223">		aLB = value;</span>
<span class="nc" id="L224">	}</span>
	
	/**
	*  Return the lower bounds of the axis.
	**/
	public double getLowerBounds() {
<span class="nc" id="L230">		return aLB;</span>
	}
	
	/**
	*  Return the axis lower bound as a formatted
	*  string using the current format.
	**/
	public String lowerBoundsAsString() {
<span class="nc" id="L238">		return nf.format((float)aLB);</span>
	}
	
	/**
	*  Sets whether or not this scale has a manually
	*  or automatically set upper bounds.
	**/
	public void manualUpperBounds(boolean flag) {
<span class="nc" id="L246">		manualUB = flag;</span>
<span class="nc" id="L247">	}</span>
	
	/**
	*  Set the upper (most positive) limit of the axis.
	**/
	public void setUpperBounds(double value) {
<span class="nc" id="L253">		aUB = value;</span>
<span class="nc" id="L254">	}</span>
	
	/**
	*  Return the upper bounds of the axis.
	**/
	public double getUpperBounds() {
<span class="nc" id="L260">		return aUB;</span>
	}
	
	/**
	*  Return the axis upper bound as a formatted
	*  string using the current format.
	**/
	public String upperBoundsAsString() {
<span class="nc" id="L268">		return nf.format((float)aUB);</span>
	}
	
	/**
	*  Sets whether or not this scale has a manually
	*  or automatically set tick mark step size.
	**/
	public void manualTickStepSize(boolean flag) {
<span class="nc" id="L276">		manualQuant = flag;</span>
<span class="nc" id="L277">	}</span>
	
	/**
	*  Set the tick mark step size for this axis.
	**/
	public void setTickStepSize(double value) {
<span class="nc" id="L283">		quantum = value;</span>
<span class="nc" id="L284">	}</span>
	
	/**
	*  Return the tick mark step size for this axis.
	**/
	public double getTickStepSize() {
<span class="nc" id="L290">		return quantum;</span>
	}
	
	/**
	*  Set the upper and lower bounds for this
	*  axis based on the data in the runs input.
	*  If the axis bounds have been set to be manually
	*  input, this method will do nothing.
	*
	*  @param runs  A list of runs to be plotted.
	**/
	public abstract void setAxisBounds(PlotRunList runs);
	
	/**
	*  Scale the axis data so that it fits within the plot
	*  area and pick a tick mark spacing.  If the tick
	*  mark spacing has been set to manually input,
	*  it will not be modified.
	*
	*  @param  plotFrame  The bounding rectangle for the data area
	*                     of the plot (overall bounds minus area for
	*                     titles, labels, etc).
	**/
	public void setSize(Rectangle plotFrame) {
	
		if (DEBUG)
			System.out.println(&quot;In PlotAxis.setSize()...&quot;);
		
		//	Find good axis limits and tick mark step sizes.
<span class="nc" id="L319">		setAxisTickLimits();</span>
		
		//	Scale the axes to fit in the plot frame.
<span class="nc" id="L322">		resizeAxis(plotFrame);</span>
		
<span class="nc" id="L324">	}</span>
	
	/**
	*  Sets the axis tick mark step size and tick mark limits.
	*  If the tick mark spacing has been set to be manually
	*  input, this method will do nothing.
	**/
	protected void setAxisTickLimits() {
<span class="nc bnc" id="L332" title="All 2 branches missed.">		if (manualQuant)	return;</span>
		
		if (DEBUG)
			System.out.println(&quot;In PlotAxis.setAxisTickLimits()...&quot;);
		
<span class="nc" id="L337">		boolean lbf = manualLB;</span>
<span class="nc" id="L338">		boolean ubf = manualUB;</span>
		
<span class="nc" id="L340">		double sign = 1.;			//	Start by assuming that positive is to the right.</span>
<span class="nc" id="L341">		double lb = aLB;</span>
<span class="nc" id="L342">		double ub = aUB;</span>
<span class="nc" id="L343">		double delta = aUB - aLB;</span>
		
<span class="nc bnc" id="L345" title="All 2 branches missed.">		if (delta &lt; 0.) {</span>
		
			//	Scale is reversed (positive to the left).
<span class="nc" id="L348">			sign = -1;</span>
			
			//	Swap upper and lower bounds.
<span class="nc" id="L351">			double temp = lb;</span>
<span class="nc" id="L352">			lb = ub;</span>
<span class="nc" id="L353">			ub = temp;</span>
			
			//	Swap upper and lower manually input flags too.
<span class="nc" id="L356">			boolean btemp = lbf;</span>
<span class="nc" id="L357">			lbf = ubf;</span>
<span class="nc" id="L358">			ubf = btemp;</span>
		
		}
		
		//	Find good axis limits for this axis scale.
<span class="nc" id="L363">		AxisLimitData limData = scale.findGoodLimits(lb, ub);</span>
		
		//	Save off axis limits.
<span class="nc bnc" id="L366" title="All 2 branches missed.">		if (!manualLB)</span>
<span class="nc bnc" id="L367" title="All 2 branches missed.">			if (sign &gt; 0)</span>
<span class="nc" id="L368">				aLB = limData.lb;</span>
			else
<span class="nc" id="L370">				aLB = limData.ub;</span>
		
<span class="nc bnc" id="L372" title="All 2 branches missed.">		if (!manualUB)</span>
<span class="nc bnc" id="L373" title="All 2 branches missed.">			if (sign &gt; 0)</span>
<span class="nc" id="L374">				aUB = limData.ub;</span>
			else
<span class="nc" id="L376">				aUB = limData.lb;</span>
		
		//	Save off tick mark spacing.
<span class="nc" id="L379">		quantum = sign*limData.quantum;</span>
<span class="nc" id="L380">	}</span>
	
	/**
	*  Scale this axis so that it fits inside of the specified
	*  plot frame rectangle.  Horizontal axes must fit inside
	*  the width of the frame and vertical axes must fit inside
	*  the height of the frame.
	*
	*  @param  plotFrame  The bounding rectangle for the data area
	*                     of the plot (overall bounds minus area for
	*                     titles, labels, etc).
	**/
	protected abstract void resizeAxis(Rectangle plotFrame);
	
	/**
	*  Renders this plot axis and grid (based on grid
	*  style) into the specified graphics context.
	*
	*  @param  gc      The graphics context we are drawing into.
	*  @param  comp    The component that we are drawing into.
	*  @param  bounds  The bounding rectangle for the data area
	*                  of the plot (overall bounds minus area for titles,
	*                  labels, etc).
	**/
	public abstract void draw(Graphics gc, Component comp, Rectangle bounds);
	
	
	/**
	*  Scales a given data point to the plot coordinates.
	*  The screen coordinate along this axis for the input
	*  data point is returned.
	**/
	public int scaleCoord(double x) {
<span class="nc" id="L413">		return( (int)(xA*scale.func(x) + xB) );</span>
	}


	/**
	*  Make a copy of this PlotAxis object.
	*
	*  @return  Returns a clone of this object.
	**/
	public Object clone() {
<span class="nc" id="L423">		PlotAxis newObject = null;</span>
		
		try {
			// Make a shallow copy of this object.
<span class="nc" id="L427">			newObject = (PlotAxis) super.clone();</span>

			// There is no &quot;deep&quot; data to be cloned.

<span class="nc" id="L431">		} catch (CloneNotSupportedException e) {</span>
			// Can't happen.
<span class="nc" id="L433">			e.printStackTrace();</span>
<span class="nc" id="L434">		}</span>
		
		// Output the newly cloned object.
<span class="nc" id="L437">		return newObject;</span>
	}

}


</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>