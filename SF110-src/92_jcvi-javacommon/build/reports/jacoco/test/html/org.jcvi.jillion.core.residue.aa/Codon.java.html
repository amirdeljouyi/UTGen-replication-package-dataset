<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Codon.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">92_jcvi-javacommon</a> &gt; <a href="index.source.html" class="el_package">org.jcvi.jillion.core.residue.aa</a> &gt; <span class="el_source">Codon.java</span></div><h1>Codon.java</h1><pre class="source lang-java linenums">/*******************************************************************************
 * Copyright (c) 2013 J. Craig Venter Institute.
 * 	This file is part of Jillion
 * 
 * 	 Jillion is free software: you can redistribute it and/or modify
 * 	it under the terms of the GNU General Public License as published by
 * 	the Free Software Foundation, either version 3 of the License, or
 * 	(at your option) any later version.
 * 	
 * 	 Jillion is distributed in the hope that it will be useful,
 * 	but WITHOUT ANY WARRANTY; without even the implied warranty of
 * 	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * 	GNU General Public License for more details.
 * 	
 * 	You should have received a copy of the GNU General Public License
 * 	along with  Jillion.  If not, see http://www.gnu.org/licenses
 * 
 * Contributors:
 *     Danny Katzel - initial API and implementation
 ******************************************************************************/
package org.jcvi.jillion.core.residue.aa;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.Map.Entry;

import org.jcvi.jillion.core.Range;
import org.jcvi.jillion.core.residue.nt.Nucleotide;
import org.jcvi.jillion.core.residue.nt.NucleotideSequence;
import org.jcvi.jillion.core.residue.nt.NucleotideSequenceBuilder;
import org.jcvi.jillion.core.util.MapUtil;

/**
 * A &lt;code&gt;Codon&lt;/code&gt; represents a triplet of {@link Nucleotide}s which specify an 
 * amino acid.  
 *
 * @author dkatzel
 * @author jsitz@jcvi.org
 */
public final class Codon
{
    
    private static final Codon START_CODON;
    private static final List&lt;Codon&gt; STOP_CODONS;
    private static final Map&lt;List&lt;Nucleotide&gt;, Codon&gt; CODON_MAP;
    
    private static final Map&lt;String, AminoAcid&gt; AMINO_ACID_MAP;
    /** An array of three glyphs representing the codon. */
    private final Nucleotide[] codonGlyphs;
    /**
     * The AminoAcid this Codon translates into.
     */
    private final AminoAcid aminoAcid;
    
    static{
<span class="nc" id="L60">        int mapSize = MapUtil.computeMinHashMapSizeWithoutRehashing(175);</span>
<span class="nc" id="L61">		AMINO_ACID_MAP = new HashMap&lt;String, AminoAcid&gt;(mapSize);</span>
        
<span class="nc" id="L63">        AMINO_ACID_MAP.put(&quot;TTC&quot;, AminoAcid.Phenylalanine);</span>
<span class="nc" id="L64">        AMINO_ACID_MAP.put(&quot;TTT&quot;, AminoAcid.Phenylalanine);</span>
<span class="nc" id="L65">        AMINO_ACID_MAP.put(&quot;TTY&quot;, AminoAcid.Phenylalanine);</span>
        
<span class="nc" id="L67">        AMINO_ACID_MAP.put(&quot;TCT&quot;, AminoAcid.Serine);</span>
<span class="nc" id="L68">        AMINO_ACID_MAP.put(&quot;TCC&quot;, AminoAcid.Serine);</span>
<span class="nc" id="L69">        AMINO_ACID_MAP.put(&quot;TCA&quot;, AminoAcid.Serine);</span>
<span class="nc" id="L70">        AMINO_ACID_MAP.put(&quot;TCG&quot;, AminoAcid.Serine);</span>
<span class="nc" id="L71">        AMINO_ACID_MAP.put(&quot;TCN&quot;, AminoAcid.Serine);</span>
<span class="nc" id="L72">        AMINO_ACID_MAP.put(&quot;TCM&quot;, AminoAcid.Serine);</span>
<span class="nc" id="L73">        AMINO_ACID_MAP.put(&quot;TCR&quot;, AminoAcid.Serine);</span>
<span class="nc" id="L74">        AMINO_ACID_MAP.put(&quot;TCW&quot;, AminoAcid.Serine);</span>
<span class="nc" id="L75">        AMINO_ACID_MAP.put(&quot;TCS&quot;, AminoAcid.Serine);</span>
<span class="nc" id="L76">        AMINO_ACID_MAP.put(&quot;TCY&quot;, AminoAcid.Serine);</span>
<span class="nc" id="L77">        AMINO_ACID_MAP.put(&quot;TCK&quot;, AminoAcid.Serine);</span>
<span class="nc" id="L78">        AMINO_ACID_MAP.put(&quot;TCV&quot;, AminoAcid.Serine);</span>
<span class="nc" id="L79">        AMINO_ACID_MAP.put(&quot;TCH&quot;, AminoAcid.Serine);</span>
<span class="nc" id="L80">        AMINO_ACID_MAP.put(&quot;TCD&quot;, AminoAcid.Serine);</span>
<span class="nc" id="L81">        AMINO_ACID_MAP.put(&quot;TCB&quot;, AminoAcid.Serine);</span>
        
<span class="nc" id="L83">        AMINO_ACID_MAP.put(&quot;TAT&quot;, AminoAcid.Tyrosine);</span>
<span class="nc" id="L84">        AMINO_ACID_MAP.put(&quot;TAC&quot;, AminoAcid.Tyrosine);</span>
<span class="nc" id="L85">        AMINO_ACID_MAP.put(&quot;TAY&quot;, AminoAcid.Tyrosine);</span>
        //stops
<span class="nc" id="L87">        AMINO_ACID_MAP.put(&quot;TAA&quot;, null);</span>
<span class="nc" id="L88">        AMINO_ACID_MAP.put(&quot;TAG&quot;, null);</span>
<span class="nc" id="L89">        AMINO_ACID_MAP.put(&quot;TAR&quot;, null);</span>
        //start
<span class="nc" id="L91">        AMINO_ACID_MAP.put(&quot;TGA&quot;, null);        </span>
        
<span class="nc" id="L93">        AMINO_ACID_MAP.put(&quot;TGT&quot;, AminoAcid.Cysteine);</span>
<span class="nc" id="L94">        AMINO_ACID_MAP.put(&quot;TGC&quot;, AminoAcid.Cysteine);</span>
<span class="nc" id="L95">        AMINO_ACID_MAP.put(&quot;TGY&quot;, AminoAcid.Cysteine);        </span>
        
<span class="nc" id="L97">        AMINO_ACID_MAP.put(&quot;TGG&quot;, AminoAcid.Tryptophan);</span>
        
<span class="nc" id="L99">        AMINO_ACID_MAP.put(&quot;CTT&quot;, AminoAcid.Leucine);</span>
<span class="nc" id="L100">        AMINO_ACID_MAP.put(&quot;CTC&quot;, AminoAcid.Leucine);</span>
<span class="nc" id="L101">        AMINO_ACID_MAP.put(&quot;CTA&quot;, AminoAcid.Leucine);</span>
<span class="nc" id="L102">        AMINO_ACID_MAP.put(&quot;CTG&quot;, AminoAcid.Leucine);</span>
<span class="nc" id="L103">        AMINO_ACID_MAP.put(&quot;CTM&quot;, AminoAcid.Leucine);</span>
<span class="nc" id="L104">        AMINO_ACID_MAP.put(&quot;CTR&quot;, AminoAcid.Leucine);</span>
<span class="nc" id="L105">        AMINO_ACID_MAP.put(&quot;CTW&quot;, AminoAcid.Leucine);</span>
<span class="nc" id="L106">        AMINO_ACID_MAP.put(&quot;CTS&quot;, AminoAcid.Leucine);</span>
<span class="nc" id="L107">        AMINO_ACID_MAP.put(&quot;CTY&quot;, AminoAcid.Leucine);</span>
<span class="nc" id="L108">        AMINO_ACID_MAP.put(&quot;CTK&quot;, AminoAcid.Leucine);</span>
<span class="nc" id="L109">        AMINO_ACID_MAP.put(&quot;CTV&quot;, AminoAcid.Leucine);</span>
<span class="nc" id="L110">        AMINO_ACID_MAP.put(&quot;CTH&quot;, AminoAcid.Leucine);</span>
<span class="nc" id="L111">        AMINO_ACID_MAP.put(&quot;CTD&quot;, AminoAcid.Leucine);</span>
<span class="nc" id="L112">        AMINO_ACID_MAP.put(&quot;CTB&quot;, AminoAcid.Leucine);</span>
<span class="nc" id="L113">        AMINO_ACID_MAP.put(&quot;CTN&quot;, AminoAcid.Leucine);</span>
        
<span class="nc" id="L115">        AMINO_ACID_MAP.put(&quot;TTA&quot;, AminoAcid.Leucine);</span>
<span class="nc" id="L116">        AMINO_ACID_MAP.put(&quot;TTG&quot;, AminoAcid.Leucine);</span>
<span class="nc" id="L117">        AMINO_ACID_MAP.put(&quot;TTR&quot;, AminoAcid.Leucine);</span>
        
<span class="nc" id="L119">        AMINO_ACID_MAP.put(&quot;YTA&quot;, AminoAcid.Leucine);</span>
<span class="nc" id="L120">        AMINO_ACID_MAP.put(&quot;YTG&quot;, AminoAcid.Leucine);</span>
<span class="nc" id="L121">        AMINO_ACID_MAP.put(&quot;YTR&quot;, AminoAcid.Leucine);</span>
        
<span class="nc" id="L123">        AMINO_ACID_MAP.put(&quot;CCT&quot;, AminoAcid.Proline);</span>
<span class="nc" id="L124">        AMINO_ACID_MAP.put(&quot;CCC&quot;, AminoAcid.Proline);</span>
<span class="nc" id="L125">        AMINO_ACID_MAP.put(&quot;CCA&quot;, AminoAcid.Proline);</span>
<span class="nc" id="L126">        AMINO_ACID_MAP.put(&quot;CCG&quot;, AminoAcid.Proline);</span>
<span class="nc" id="L127">        AMINO_ACID_MAP.put(&quot;CCM&quot;, AminoAcid.Proline);</span>
<span class="nc" id="L128">        AMINO_ACID_MAP.put(&quot;CCR&quot;, AminoAcid.Proline);</span>
<span class="nc" id="L129">        AMINO_ACID_MAP.put(&quot;CCW&quot;, AminoAcid.Proline);</span>
<span class="nc" id="L130">        AMINO_ACID_MAP.put(&quot;CCS&quot;, AminoAcid.Proline);</span>
<span class="nc" id="L131">        AMINO_ACID_MAP.put(&quot;CCY&quot;, AminoAcid.Proline);</span>
<span class="nc" id="L132">        AMINO_ACID_MAP.put(&quot;CCK&quot;, AminoAcid.Proline);</span>
<span class="nc" id="L133">        AMINO_ACID_MAP.put(&quot;CCV&quot;, AminoAcid.Proline);</span>
<span class="nc" id="L134">        AMINO_ACID_MAP.put(&quot;CCH&quot;, AminoAcid.Proline);</span>
<span class="nc" id="L135">        AMINO_ACID_MAP.put(&quot;CCD&quot;, AminoAcid.Proline);</span>
<span class="nc" id="L136">        AMINO_ACID_MAP.put(&quot;CCB&quot;, AminoAcid.Proline);</span>
<span class="nc" id="L137">        AMINO_ACID_MAP.put(&quot;CCN&quot;, AminoAcid.Proline);</span>
        
<span class="nc" id="L139">        AMINO_ACID_MAP.put(&quot;CAT&quot;, AminoAcid.Histidine);</span>
<span class="nc" id="L140">        AMINO_ACID_MAP.put(&quot;CAC&quot;, AminoAcid.Histidine);</span>
<span class="nc" id="L141">        AMINO_ACID_MAP.put(&quot;CAY&quot;, AminoAcid.Histidine);</span>
        
<span class="nc" id="L143">        AMINO_ACID_MAP.put(&quot;CAA&quot;, AminoAcid.Glutamine);</span>
<span class="nc" id="L144">        AMINO_ACID_MAP.put(&quot;CAG&quot;, AminoAcid.Glutamine); </span>
<span class="nc" id="L145">        AMINO_ACID_MAP.put(&quot;CAR&quot;, AminoAcid.Glutamine);</span>
        
<span class="nc" id="L147">        AMINO_ACID_MAP.put(&quot;CGT&quot;, AminoAcid.Arginine);</span>
<span class="nc" id="L148">        AMINO_ACID_MAP.put(&quot;CGC&quot;, AminoAcid.Arginine);</span>
<span class="nc" id="L149">        AMINO_ACID_MAP.put(&quot;CGA&quot;, AminoAcid.Arginine);</span>
<span class="nc" id="L150">        AMINO_ACID_MAP.put(&quot;CGG&quot;, AminoAcid.Arginine);</span>
<span class="nc" id="L151">        AMINO_ACID_MAP.put(&quot;CGM&quot;, AminoAcid.Arginine);</span>
<span class="nc" id="L152">        AMINO_ACID_MAP.put(&quot;CGR&quot;, AminoAcid.Arginine);</span>
<span class="nc" id="L153">        AMINO_ACID_MAP.put(&quot;CGW&quot;, AminoAcid.Arginine);</span>
<span class="nc" id="L154">        AMINO_ACID_MAP.put(&quot;CGS&quot;, AminoAcid.Arginine);</span>
<span class="nc" id="L155">        AMINO_ACID_MAP.put(&quot;CGY&quot;, AminoAcid.Arginine);</span>
<span class="nc" id="L156">        AMINO_ACID_MAP.put(&quot;CGK&quot;, AminoAcid.Arginine);</span>
<span class="nc" id="L157">        AMINO_ACID_MAP.put(&quot;CGV&quot;, AminoAcid.Arginine);</span>
<span class="nc" id="L158">        AMINO_ACID_MAP.put(&quot;CGH&quot;, AminoAcid.Arginine);</span>
<span class="nc" id="L159">        AMINO_ACID_MAP.put(&quot;CGD&quot;, AminoAcid.Arginine);</span>
<span class="nc" id="L160">        AMINO_ACID_MAP.put(&quot;CGB&quot;, AminoAcid.Arginine);</span>
<span class="nc" id="L161">        AMINO_ACID_MAP.put(&quot;CGN&quot;, AminoAcid.Arginine);</span>
        
<span class="nc" id="L163">        AMINO_ACID_MAP.put(&quot;AGA&quot;, AminoAcid.Arginine);</span>
<span class="nc" id="L164">        AMINO_ACID_MAP.put(&quot;AGG&quot;, AminoAcid.Arginine);</span>
<span class="nc" id="L165">        AMINO_ACID_MAP.put(&quot;AGR&quot;, AminoAcid.Arginine);</span>
        
<span class="nc" id="L167">        AMINO_ACID_MAP.put(&quot;MGA&quot;, AminoAcid.Arginine);</span>
<span class="nc" id="L168">        AMINO_ACID_MAP.put(&quot;MGG&quot;, AminoAcid.Arginine);</span>
<span class="nc" id="L169">        AMINO_ACID_MAP.put(&quot;MGR&quot;, AminoAcid.Arginine);</span>
        
        
<span class="nc" id="L172">        AMINO_ACID_MAP.put(&quot;ATT&quot;, AminoAcid.Isoleucine);</span>
<span class="nc" id="L173">        AMINO_ACID_MAP.put(&quot;ATC&quot;, AminoAcid.Isoleucine);</span>
<span class="nc" id="L174">        AMINO_ACID_MAP.put(&quot;ATA&quot;, AminoAcid.Isoleucine);</span>
<span class="nc" id="L175">        AMINO_ACID_MAP.put(&quot;ATY&quot;, AminoAcid.Isoleucine);</span>
<span class="nc" id="L176">        AMINO_ACID_MAP.put(&quot;ATW&quot;, AminoAcid.Isoleucine);</span>
<span class="nc" id="L177">        AMINO_ACID_MAP.put(&quot;ATM&quot;, AminoAcid.Isoleucine);</span>
<span class="nc" id="L178">        AMINO_ACID_MAP.put(&quot;ATH&quot;, AminoAcid.Isoleucine);</span>
        
<span class="nc" id="L180">        AMINO_ACID_MAP.put(&quot;ATG&quot;, AminoAcid.Methionine);</span>
        
<span class="nc" id="L182">        AMINO_ACID_MAP.put(&quot;ACT&quot;, AminoAcid.Threonine);</span>
<span class="nc" id="L183">        AMINO_ACID_MAP.put(&quot;ACC&quot;, AminoAcid.Threonine);</span>
<span class="nc" id="L184">        AMINO_ACID_MAP.put(&quot;ACA&quot;, AminoAcid.Threonine);</span>
<span class="nc" id="L185">        AMINO_ACID_MAP.put(&quot;ACG&quot;, AminoAcid.Threonine);</span>
<span class="nc" id="L186">        AMINO_ACID_MAP.put(&quot;ACM&quot;, AminoAcid.Threonine);</span>
<span class="nc" id="L187">        AMINO_ACID_MAP.put(&quot;ACR&quot;, AminoAcid.Threonine);</span>
<span class="nc" id="L188">        AMINO_ACID_MAP.put(&quot;ACW&quot;, AminoAcid.Threonine);</span>
<span class="nc" id="L189">        AMINO_ACID_MAP.put(&quot;ACS&quot;, AminoAcid.Threonine);</span>
<span class="nc" id="L190">        AMINO_ACID_MAP.put(&quot;ACY&quot;, AminoAcid.Threonine);</span>
<span class="nc" id="L191">        AMINO_ACID_MAP.put(&quot;ACK&quot;, AminoAcid.Threonine);</span>
<span class="nc" id="L192">        AMINO_ACID_MAP.put(&quot;ACV&quot;, AminoAcid.Threonine);</span>
<span class="nc" id="L193">        AMINO_ACID_MAP.put(&quot;ACH&quot;, AminoAcid.Threonine);</span>
<span class="nc" id="L194">        AMINO_ACID_MAP.put(&quot;ACD&quot;, AminoAcid.Threonine);</span>
<span class="nc" id="L195">        AMINO_ACID_MAP.put(&quot;ACB&quot;, AminoAcid.Threonine);</span>
<span class="nc" id="L196">        AMINO_ACID_MAP.put(&quot;ACN&quot;, AminoAcid.Threonine);</span>
        
<span class="nc" id="L198">        AMINO_ACID_MAP.put(&quot;AAT&quot;, AminoAcid.Asparagine);</span>
<span class="nc" id="L199">        AMINO_ACID_MAP.put(&quot;AAC&quot;, AminoAcid.Asparagine);</span>
<span class="nc" id="L200">        AMINO_ACID_MAP.put(&quot;AAY&quot;, AminoAcid.Asparagine);</span>
        
<span class="nc" id="L202">        AMINO_ACID_MAP.put(&quot;AAA&quot;, AminoAcid.Lysine);</span>
<span class="nc" id="L203">        AMINO_ACID_MAP.put(&quot;AAG&quot;, AminoAcid.Lysine);</span>
<span class="nc" id="L204">        AMINO_ACID_MAP.put(&quot;AAR&quot;, AminoAcid.Lysine);</span>
        
<span class="nc" id="L206">        AMINO_ACID_MAP.put(&quot;AGT&quot;, AminoAcid.Serine);</span>
<span class="nc" id="L207">        AMINO_ACID_MAP.put(&quot;AGC&quot;, AminoAcid.Serine);</span>
<span class="nc" id="L208">        AMINO_ACID_MAP.put(&quot;AGY&quot;, AminoAcid.Serine);</span>
        
<span class="nc" id="L210">        AMINO_ACID_MAP.put(&quot;GTT&quot;, AminoAcid.Valine);</span>
<span class="nc" id="L211">        AMINO_ACID_MAP.put(&quot;GTC&quot;, AminoAcid.Valine);</span>
<span class="nc" id="L212">        AMINO_ACID_MAP.put(&quot;GTA&quot;, AminoAcid.Valine);</span>
<span class="nc" id="L213">        AMINO_ACID_MAP.put(&quot;GTG&quot;, AminoAcid.Valine);</span>
<span class="nc" id="L214">        AMINO_ACID_MAP.put(&quot;GTM&quot;, AminoAcid.Valine);</span>
<span class="nc" id="L215">        AMINO_ACID_MAP.put(&quot;GTR&quot;, AminoAcid.Valine);</span>
<span class="nc" id="L216">        AMINO_ACID_MAP.put(&quot;GTW&quot;, AminoAcid.Valine);</span>
<span class="nc" id="L217">        AMINO_ACID_MAP.put(&quot;GTS&quot;, AminoAcid.Valine);</span>
<span class="nc" id="L218">        AMINO_ACID_MAP.put(&quot;GTY&quot;, AminoAcid.Valine);</span>
<span class="nc" id="L219">        AMINO_ACID_MAP.put(&quot;GTK&quot;, AminoAcid.Valine);</span>
<span class="nc" id="L220">        AMINO_ACID_MAP.put(&quot;GTV&quot;, AminoAcid.Valine);</span>
<span class="nc" id="L221">        AMINO_ACID_MAP.put(&quot;GTH&quot;, AminoAcid.Valine);</span>
<span class="nc" id="L222">        AMINO_ACID_MAP.put(&quot;GTD&quot;, AminoAcid.Valine);</span>
<span class="nc" id="L223">        AMINO_ACID_MAP.put(&quot;GTB&quot;, AminoAcid.Valine);</span>
<span class="nc" id="L224">        AMINO_ACID_MAP.put(&quot;GTN&quot;, AminoAcid.Valine);</span>
        
<span class="nc" id="L226">        AMINO_ACID_MAP.put(&quot;GCT&quot;, AminoAcid.Alanine);</span>
<span class="nc" id="L227">        AMINO_ACID_MAP.put(&quot;GCC&quot;, AminoAcid.Alanine);</span>
<span class="nc" id="L228">        AMINO_ACID_MAP.put(&quot;GCA&quot;, AminoAcid.Alanine);</span>
<span class="nc" id="L229">        AMINO_ACID_MAP.put(&quot;GCG&quot;, AminoAcid.Alanine);</span>
<span class="nc" id="L230">        AMINO_ACID_MAP.put(&quot;GCM&quot;, AminoAcid.Alanine);</span>
<span class="nc" id="L231">        AMINO_ACID_MAP.put(&quot;GCR&quot;, AminoAcid.Alanine);</span>
<span class="nc" id="L232">        AMINO_ACID_MAP.put(&quot;GCW&quot;, AminoAcid.Alanine);</span>
<span class="nc" id="L233">        AMINO_ACID_MAP.put(&quot;GCS&quot;, AminoAcid.Alanine);</span>
<span class="nc" id="L234">        AMINO_ACID_MAP.put(&quot;GCY&quot;, AminoAcid.Alanine);</span>
<span class="nc" id="L235">        AMINO_ACID_MAP.put(&quot;GCK&quot;, AminoAcid.Alanine);</span>
<span class="nc" id="L236">        AMINO_ACID_MAP.put(&quot;GCV&quot;, AminoAcid.Alanine);</span>
<span class="nc" id="L237">        AMINO_ACID_MAP.put(&quot;GCH&quot;, AminoAcid.Alanine);</span>
<span class="nc" id="L238">        AMINO_ACID_MAP.put(&quot;GCD&quot;, AminoAcid.Alanine);</span>
<span class="nc" id="L239">        AMINO_ACID_MAP.put(&quot;GCB&quot;, AminoAcid.Alanine);</span>
<span class="nc" id="L240">        AMINO_ACID_MAP.put(&quot;GCN&quot;, AminoAcid.Alanine);</span>
        
<span class="nc" id="L242">        AMINO_ACID_MAP.put(&quot;GAT&quot;, AminoAcid.Aspartic_Acid);</span>
<span class="nc" id="L243">        AMINO_ACID_MAP.put(&quot;GAC&quot;, AminoAcid.Aspartic_Acid);</span>
<span class="nc" id="L244">        AMINO_ACID_MAP.put(&quot;GAY&quot;, AminoAcid.Aspartic_Acid);</span>
        
<span class="nc" id="L246">        AMINO_ACID_MAP.put(&quot;GAA&quot;, AminoAcid.Glutamic_Acid);</span>
<span class="nc" id="L247">        AMINO_ACID_MAP.put(&quot;GAG&quot;, AminoAcid.Glutamic_Acid);</span>
<span class="nc" id="L248">        AMINO_ACID_MAP.put(&quot;GAR&quot;, AminoAcid.Glutamic_Acid);</span>
        
<span class="nc" id="L250">        AMINO_ACID_MAP.put(&quot;GGT&quot;, AminoAcid.Glycine);</span>
<span class="nc" id="L251">        AMINO_ACID_MAP.put(&quot;GGC&quot;, AminoAcid.Glycine);</span>
<span class="nc" id="L252">        AMINO_ACID_MAP.put(&quot;GGA&quot;, AminoAcid.Glycine);</span>
<span class="nc" id="L253">        AMINO_ACID_MAP.put(&quot;GGG&quot;, AminoAcid.Glycine);</span>
<span class="nc" id="L254">        AMINO_ACID_MAP.put(&quot;GGM&quot;, AminoAcid.Glycine);</span>
<span class="nc" id="L255">        AMINO_ACID_MAP.put(&quot;GGR&quot;, AminoAcid.Glycine);</span>
<span class="nc" id="L256">        AMINO_ACID_MAP.put(&quot;GGW&quot;, AminoAcid.Glycine);</span>
<span class="nc" id="L257">        AMINO_ACID_MAP.put(&quot;GGS&quot;, AminoAcid.Glycine);</span>
<span class="nc" id="L258">        AMINO_ACID_MAP.put(&quot;GGY&quot;, AminoAcid.Glycine);</span>
<span class="nc" id="L259">        AMINO_ACID_MAP.put(&quot;GGK&quot;, AminoAcid.Glycine);</span>
<span class="nc" id="L260">        AMINO_ACID_MAP.put(&quot;GGV&quot;, AminoAcid.Glycine);</span>
<span class="nc" id="L261">        AMINO_ACID_MAP.put(&quot;GGH&quot;, AminoAcid.Glycine);</span>
<span class="nc" id="L262">        AMINO_ACID_MAP.put(&quot;GGD&quot;, AminoAcid.Glycine);</span>
<span class="nc" id="L263">        AMINO_ACID_MAP.put(&quot;GGB&quot;, AminoAcid.Glycine);</span>
<span class="nc" id="L264">        AMINO_ACID_MAP.put(&quot;GGN&quot;, AminoAcid.Glycine);</span>
        
<span class="nc" id="L266">        CODON_MAP = new HashMap&lt;List&lt;Nucleotide&gt;, Codon&gt;(mapSize);</span>
<span class="nc bnc" id="L267" title="All 2 branches missed.">        for(Entry&lt;String, AminoAcid&gt; entry : AMINO_ACID_MAP.entrySet()){</span>
<span class="nc" id="L268">            List&lt;Nucleotide&gt; codon = asList(new NucleotideSequenceBuilder(entry.getKey()));</span>
<span class="nc" id="L269">            CODON_MAP.put(codon, new Codon(codon.get(0),codon.get(1),codon.get(2), </span>
<span class="nc" id="L270">                    entry.getValue()));</span>
<span class="nc" id="L271">        }</span>
        
<span class="nc" id="L273">        START_CODON= Codon.getCodonFor(&quot;ATG&quot;);</span>
<span class="nc" id="L274">        STOP_CODONS= Arrays.asList(</span>
<span class="nc" id="L275">                Codon.getCodonFor(&quot;TAA&quot;),</span>
<span class="nc" id="L276">                Codon.getCodonFor(&quot;TAG&quot;),</span>
<span class="nc" id="L277">                Codon.getCodonFor(&quot;TAR&quot;),</span>
<span class="nc" id="L278">                Codon.getCodonFor(&quot;TGA&quot;),</span>
<span class="nc" id="L279">                Codon.getCodonFor(&quot;TRA&quot;));</span>
<span class="nc" id="L280">    }</span>
    
    private static List&lt;Nucleotide&gt; asList(NucleotideSequenceBuilder builder){
<span class="nc" id="L283">    	List&lt;Nucleotide&gt; list = new ArrayList&lt;Nucleotide&gt;((int)builder.getLength());</span>
<span class="nc bnc" id="L284" title="All 2 branches missed.">    	for(Nucleotide n : builder){</span>
<span class="nc" id="L285">    		list.add(n);</span>
<span class="nc" id="L286">    	}</span>
<span class="nc" id="L287">    	return list;</span>
    }
   
    protected static final Map&lt;List&lt;Nucleotide&gt;, Codon&gt; getCodonMap() {
<span class="nc" id="L291">        return CODON_MAP;</span>
    }
    public static List&lt;Codon&gt; getCodonsFor(String basecalls){
<span class="nc" id="L294">        return getCodonsFor(basecalls, Frame.ZERO);</span>
    }
    public static List&lt;Codon&gt; getCodonsFor(String basecalls, Frame frame){
<span class="nc bnc" id="L297" title="All 2 branches missed.">        if(frame ==null){</span>
<span class="nc" id="L298">            throw new IllegalArgumentException(&quot;frame can not be null&quot;);</span>
        }
<span class="nc" id="L300">        List&lt;Codon&gt; codons = new ArrayList&lt;Codon&gt;(basecalls.length()/3 );</span>
<span class="nc bnc" id="L301" title="All 2 branches missed.">        for(int i=frame.getFrame(); i&lt;=basecalls.length()-3; i+=3){</span>
<span class="nc" id="L302">            codons.add(getCodonFor(basecalls.substring(i, i+3)));</span>
        }
<span class="nc" id="L304">        return codons;</span>
    }
    public static List&lt;Codon&gt; getCodonsFor(NucleotideSequence basecalls){
<span class="nc" id="L307">       return getCodonsFor(basecalls,Frame.ZERO);</span>
    }
    public static List&lt;Codon&gt; getCodonsFor(NucleotideSequence basecalls, Frame frame){
<span class="nc" id="L310">        String ungappedString = new NucleotideSequenceBuilder(basecalls)</span>
<span class="nc" id="L311">        								.ungap()</span>
<span class="nc" id="L312">        								.toString();</span>
<span class="nc" id="L313">    	return getCodonsFor(ungappedString,frame);</span>
     }
    public static Codon getCodonFor(Nucleotide base1, Nucleotide base2, Nucleotide base3){
<span class="nc" id="L316">        return getCodonFor(Arrays.asList(base1,base2,base3));</span>
        
    }
    public static Codon getCodonFor(String triplet){
<span class="nc bnc" id="L320" title="All 2 branches missed.">        if(triplet.length() !=3){</span>
<span class="nc" id="L321">            throw new IllegalArgumentException(&quot;triplet must have 3 bases&quot;);</span>
        }
<span class="nc" id="L323">        return getCodonFor(asList(new NucleotideSequenceBuilder(triplet.substring(0, 3))));</span>
    }
    public static Codon getCodonFor(List&lt;Nucleotide&gt; triplet){
<span class="nc" id="L326">        return getCodonByOffset(triplet,0);</span>
    }
    public static Codon getCodonFor(NucleotideSequence triplet){
<span class="nc" id="L329">        return getCodonByOffset(triplet, 0);</span>
    }
    
    public static Codon getCodonByOffset(String basecalls, int offset){
<span class="nc" id="L333">        final String triplet = basecalls.substring(offset,offset+3);</span>
<span class="nc" id="L334">        return getCodonByOffset(</span>
<span class="nc" id="L335">                asList(new NucleotideSequenceBuilder(triplet)),</span>
                0);
    }
    public static Codon getCodonByOffset(NucleotideSequence basecalls, int offset){
<span class="nc bnc" id="L339" title="All 2 branches missed.">        if(offset&lt;0){</span>
<span class="nc" id="L340">            throw new IllegalArgumentException(&quot;offset must be &gt;=0 &quot;+ offset);</span>
        }
<span class="nc bnc" id="L342" title="All 2 branches missed.">        if(basecalls.getLength()&lt;offset+3){</span>
<span class="nc" id="L343">            throw new IllegalArgumentException(&quot;must have at least 3 nucleotides after given offset &quot;+ (basecalls.getLength()-(offset+3)));</span>
        }
<span class="nc" id="L345">        List&lt;Nucleotide&gt; list = new ArrayList&lt;Nucleotide&gt;(3);</span>
<span class="nc" id="L346">        Iterator&lt;Nucleotide&gt; iter = basecalls.iterator(new Range.Builder(3).shift(offset).build());</span>
<span class="nc" id="L347">        list.add(iter.next());</span>
<span class="nc" id="L348">        list.add(iter.next());</span>
<span class="nc" id="L349">        list.add(iter.next());</span>
<span class="nc" id="L350">        return CODON_MAP.get(list);</span>
    }
    public static Codon getCodonByOffset(List&lt;Nucleotide&gt; bases, int offset){
<span class="nc bnc" id="L353" title="All 2 branches missed.">        if(offset&lt;0){</span>
<span class="nc" id="L354">            throw new IllegalArgumentException(&quot;offset must be &gt;=0 &quot;+ offset);</span>
        }
<span class="nc bnc" id="L356" title="All 2 branches missed.">        if(bases.size()&lt;offset+3){</span>
<span class="nc" id="L357">            throw new IllegalArgumentException(&quot;must have at least 3 nucleotides after given offset &quot;+ (bases.size()-(offset+3)));</span>
        }
<span class="nc" id="L359">        return CODON_MAP.get(bases.subList(offset, offset+3));</span>
    }
    /**
     * Creates a new &lt;code&gt;Codon&lt;/code&gt;.
     */
    private Codon(Nucleotide base1, Nucleotide base2, Nucleotide base3, AminoAcid aminoAcid)
<span class="nc" id="L365">    {</span>
<span class="nc" id="L366">        this.codonGlyphs = new Nucleotide[]{base1,base2,base3};</span>
<span class="nc" id="L367">        this.aminoAcid = aminoAcid;</span>
<span class="nc" id="L368">    }</span>
    
    
    /**
     * Get the Amino Acid that is translated from this Codon.
     * @return the AminoAcid, this will be {@code null} for 
     * stop codons.
     */
    public AminoAcid getAminoAcid() {
<span class="nc" id="L377">        return aminoAcid;</span>
    }
    

    @Override
    public int hashCode() {
<span class="nc" id="L383">        final int prime = 31;</span>
<span class="nc" id="L384">        int result = 1;</span>
<span class="nc" id="L385">        result = prime * result + Arrays.hashCode(codonGlyphs);</span>
<span class="nc" id="L386">        return result;</span>
    }
    @Override
    public boolean equals(Object obj) {
<span class="nc bnc" id="L390" title="All 2 branches missed.">        if (this == obj) {</span>
<span class="nc" id="L391">            return true;</span>
        }
<span class="nc bnc" id="L393" title="All 2 branches missed.">        if (!(obj instanceof Codon)) {</span>
<span class="nc" id="L394">            return false;</span>
        }
<span class="nc" id="L396">        Codon other = (Codon) obj;</span>
<span class="nc" id="L397">        return Arrays.equals(codonGlyphs, other.codonGlyphs);</span>
    }
    
    
    /**
	 * @return the codonGlyphs
	 */
	public List&lt;Nucleotide&gt; getNucleotides() {
<span class="nc" id="L405">		List&lt;Nucleotide&gt; triplet = new ArrayList&lt;Nucleotide&gt;(3);</span>
<span class="nc bnc" id="L406" title="All 2 branches missed.">		for(int i=0; i&lt; 3; i++){</span>
<span class="nc" id="L407">			triplet.add(codonGlyphs[i]);</span>
		}
<span class="nc" id="L409">		return triplet;</span>
	}
	/* (non-Javadoc)
     * @see java.lang.Object#toString()
     */
    @Override
    public String toString()
    {
<span class="nc" id="L417">        final StringBuilder str = new StringBuilder(&quot;[&quot;);</span>

<span class="nc bnc" id="L419" title="All 2 branches missed.">        for (final Nucleotide nucleotide : this.codonGlyphs)</span>
        {
<span class="nc" id="L421">            str.append(nucleotide.getCharacter());</span>
        }
<span class="nc" id="L423">        str.append(']');</span>
<span class="nc" id="L424">        return str.toString();</span>
    }
    /**
     * Is this Codon instance the start codon?
     * @return {@code true} if this Codon is the start codon; {@code false}
     * otherwise.
     */
    public boolean isStartCodon(){
<span class="nc" id="L432">        return equals(START_CODON);</span>
    }
    /**
     * Is this Codon instance a stop codon?
     * @return {@code true} if this Codon is a stop codon; {@code false}
     * otherwise.
     */
    public boolean isStopCodon(){
<span class="nc bnc" id="L440" title="All 2 branches missed.">        for(Codon stopCodon : STOP_CODONS){</span>
<span class="nc bnc" id="L441" title="All 2 branches missed.">            if(equals(stopCodon)){</span>
<span class="nc" id="L442">                return true;</span>
            }
<span class="nc" id="L444">        }</span>
<span class="nc" id="L445">        return false;</span>
    }
    /**
     * Get the Codon instance that represents the Start Codon.
     * @return the Codon that represents a start Codon (not null).
     */
    public static Codon getStartCodon() {
<span class="nc" id="L452">        return START_CODON;</span>
    }
    /**
     * Get the List of the stop codons.
     * @return a list containing the stop codons (not null).
     */
    public static List&lt;Codon&gt; getStopCodons() {
<span class="nc" id="L459">        return STOP_CODONS;</span>
    }
    
<span class="nc" id="L462">    public static enum Frame{</span>
<span class="nc" id="L463">        ZERO(0),</span>
<span class="nc" id="L464">        ONE(1),</span>
<span class="nc" id="L465">        TWO(2);</span>
        
        private int frame;
        
        public  final int getFrame() {
<span class="nc" id="L470">            return frame;</span>
        }
<span class="nc" id="L472">        Frame(int frame){</span>
<span class="nc" id="L473">            this.frame = frame;</span>
<span class="nc" id="L474">        }</span>
        /**
         * Parse a {@link Frame} from the given int value.
         * Valid values are &lt;code&gt;0&lt;/code&gt; to &lt;code&gt;2&lt;/code&gt;
         * inclusive.
         * @param frame
         * @return a {@link Frame}
         * @throws IllegalArgumentException if &lt;code&gt; frame &lt; 0 || frame &gt; 2&lt;/code&gt;
         */
        public static Frame parseFrame(int frame){
<span class="nc bnc" id="L484" title="All 2 branches missed.">            for(Frame f : Frame.values()){</span>
<span class="nc bnc" id="L485" title="All 2 branches missed.">                if(f.frame == frame){</span>
<span class="nc" id="L486">                    return f;</span>
                }
            }
         
<span class="nc" id="L490">            throw new IllegalArgumentException(&quot;unable to parse frame &quot; + frame);</span>
        }
    }
    
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>