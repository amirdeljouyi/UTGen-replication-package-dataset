<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TasmContigBuilder.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">92_jcvi-javacommon</a> &gt; <a href="index.source.html" class="el_package">org.jcvi.jillion.assembly.tigr.tasm</a> &gt; <span class="el_source">TasmContigBuilder.java</span></div><h1>TasmContigBuilder.java</h1><pre class="source lang-java linenums">/*******************************************************************************
 * Copyright (c) 2013 J. Craig Venter Institute.
 * 	This file is part of Jillion
 * 
 * 	 Jillion is free software: you can redistribute it and/or modify
 * 	it under the terms of the GNU General Public License as published by
 * 	the Free Software Foundation, either version 3 of the License, or
 * 	(at your option) any later version.
 * 	
 * 	 Jillion is distributed in the hope that it will be useful,
 * 	but WITHOUT ANY WARRANTY; without even the implied warranty of
 * 	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * 	GNU General Public License for more details.
 * 	
 * 	You should have received a copy of the GNU General Public License
 * 	along with  Jillion.  If not, see http://www.gnu.org/licenses
 * 
 * Contributors:
 *     Danny Katzel - initial API and implementation
 ******************************************************************************/
package org.jcvi.jillion.assembly.tigr.tasm;

import java.util.Collection;
import java.util.Date;
import java.util.LinkedHashSet;
import java.util.Set;

import org.jcvi.jillion.assembly.AssembledRead;
import org.jcvi.jillion.assembly.AssembledReadBuilder;
import org.jcvi.jillion.assembly.Contig;
import org.jcvi.jillion.core.Direction;
import org.jcvi.jillion.core.Range;
import org.jcvi.jillion.core.io.IOUtil;
import org.jcvi.jillion.core.residue.nt.NucleotideSequence;
import org.jcvi.jillion.core.util.Builder;
import org.jcvi.jillion.core.util.iter.StreamingIterator;
import org.jcvi.jillion.internal.assembly.AbstractContigBuilder;
import org.jcvi.jillion.internal.assembly.DefaultContig;
/**
 * {@code TasmContigBuilder} is a {@link Builder}
 * for {@link TasmContig}s that allows
 * creating {@link TasmContig} objects read by read by adding assembled reads
 * and setting a consensus.  An {@link TasmContigBuilder}
 * can be used to create {@link TasmContig}s that 
 * have been created by an assembler or can be used
 * to create contigs from &quot;scratch&quot;.
 * There are additional methods to allow
 * the contig consensus or underlying
 * reads to be modified before
 * the creation of the {@link TasmContig} instance
 * (which is immutable).
 * @author dkatzel
 *
 *
 */
public class TasmContigBuilder extends AbstractContigBuilder&lt;TasmAssembledRead, TasmContig&gt;{
	private Long celeraAssemblerId;
	private String comment, commonName;
	private Integer sampleId;
	private Long asmblId;
	
	private String editPerson;
	private Long editDate;
	private String assemblyMethod;
	private boolean isCircular;
	
    /**
     * Create a new TasmContigBuilder instance setting the
     * contig id and contig consensus.  If the contig id
     * is a positive numeric, then the TigrProjectAssemblyId
     * will also be set to the contig id.  This can
     * be changed by calling {@link #setTigrProjectAssemblyId(Long)}.
     * All other {@link TasmContig} optional specific attributes
     * will be set to the default values of {@code null}
     * or {@code false}.
     * @param id the contig id; can not be null.
     * @param consensus the contig consensus; can not be null.
     * @throws NullPointerException if either id or consensus
     * are null.
     */
    public TasmContigBuilder(String id, NucleotideSequence consensus) {
<span class="nc" id="L82">    	super(id,consensus);</span>
    	try{
<span class="nc" id="L84">    		long asmblId =Long.parseLong(id);</span>
<span class="nc bnc" id="L85" title="All 2 branches missed.">    		if(asmblId &gt;0){</span>
<span class="nc" id="L86">    			setTigrProjectAssemblyId(asmblId);</span>
    		}
<span class="nc" id="L88">    	}catch(Exception e){</span>
    		//must not be an assemble id
<span class="nc" id="L90">    	}</span>
<span class="nc" id="L91">    }</span>
    /**
     * Create a new TasmContigBuilder instance setting the
     * initial contig state to have 
     * the same contig, id, and underlying reads
     * as the given contig. If the contig id
     * is a positive numeric, then the TigrProjectAssemblyId
     * will also be set to the contig id.  This can
     * be changed by calling {@link #setTigrProjectAssemblyId(Long)}.
     * All other {@link TasmContig} optional specific attributes
     * will be set to the default values of {@code null}
     * or {@code false}.
     * @param copy the contig to copy; can not be null.
     * @throws NullPointerException if copy is null.
     */
    public  TasmContigBuilder(Contig&lt;? extends AssembledRead&gt; copy){
<span class="nc" id="L107">    	this(copy.getId(), copy.getConsensusSequence());</span>
<span class="nc" id="L108">        StreamingIterator&lt;? extends AssembledRead&gt; iter =null;</span>
        try{
<span class="nc" id="L110">        	 iter = copy.getReadIterator();</span>
<span class="nc bnc" id="L111" title="All 2 branches missed.">        	 while(iter.hasNext()){</span>
<span class="nc" id="L112">        		 AssembledRead read = iter.next();</span>
<span class="nc" id="L113">        		 addRead(new TasmAssembledReadAdapter(read));</span>
<span class="nc" id="L114">        	 }</span>
        }finally{
<span class="nc" id="L116">        	IOUtil.closeAndIgnoreErrors(iter);</span>
        }
<span class="nc" id="L118">    }</span>
    /**
     * Create a new Builder instance with
     * the initial state of a copy of the given {@link TasmContig}.
     * The contig id, consensus, underlying reads and all tasm
     * specific attributes will be identical to the values
     * of the input {@link TasmContig}.  These initial 
     * values may be changed by the mutator methods
     * of this class.
     * 
     * @param copy the TasmContig to copy; can not be null.
     * @throws NullPointerException if copy is null.
     */
    public  TasmContigBuilder(TasmContig copy){
<span class="nc" id="L132">        this(copy.getId(), copy.getConsensusSequence());</span>
<span class="nc" id="L133">        StreamingIterator&lt;TasmAssembledRead&gt; iter =null;</span>
        try{
<span class="nc" id="L135">        	 iter = copy.getReadIterator();</span>
<span class="nc bnc" id="L136" title="All 2 branches missed.">        	 while(iter.hasNext()){</span>
<span class="nc" id="L137">        		 TasmAssembledRead read = iter.next();</span>
<span class="nc" id="L138">        		 addRead(read);</span>
<span class="nc" id="L139">        	 }</span>
        }finally{
<span class="nc" id="L141">        	IOUtil.closeAndIgnoreErrors(iter);</span>
        }
<span class="nc" id="L143">        this.celeraAssemblerId = copy.getCeleraAssemblerId();</span>
<span class="nc" id="L144">        this.sampleId = copy.getSampleId();</span>
<span class="nc" id="L145">        this.asmblId = copy.getTigrProjectAssemblyId();</span>
        
<span class="nc" id="L147">        this.assemblyMethod = copy.getAssemblyMethod();</span>
<span class="nc" id="L148">        this.comment = copy.getComment();</span>
<span class="nc" id="L149">        this.commonName = copy.getCommonName();</span>
<span class="nc" id="L150">        this.editDate = Long.valueOf(copy.getEditDate().getTime());</span>
<span class="nc" id="L151">        this.editPerson = copy.getEditPerson();</span>
<span class="nc" id="L152">        this.isCircular = copy.isCircular();</span>
<span class="nc" id="L153">     }</span>
   
   
    @Override
    public TasmContigBuilder addRead(String id, int offset,Range validRange, String basecalls, Direction dir, int fullUngappedLength){            
<span class="nc bnc" id="L158" title="All 2 branches missed.">        if(offset &lt;0){</span>
<span class="nc" id="L159">            throw new IllegalArgumentException(&quot;circular reads not supported&quot;);</span>
            
          }
<span class="nc" id="L162">        super.addRead(id, offset, validRange, basecalls, dir,fullUngappedLength);</span>
<span class="nc" id="L163">        return this;            </span>
    }
    
   
   
   
    @SuppressWarnings(&quot;unchecked&quot;)
	@Override
	public Collection&lt;TasmAssembledReadBuilder&gt; getAllAssembledReadBuilders() {
<span class="nc" id="L172">		return (Collection&lt;TasmAssembledReadBuilder&gt;) super.getAllAssembledReadBuilders();</span>
	}
	@Override
	public TasmAssembledReadBuilder getAssembledReadBuilder(
			String readId) {
<span class="nc" id="L177">		return (TasmAssembledReadBuilder)super.getAssembledReadBuilder(readId);</span>
	}
	/**
     * Sets the {@link TasmContigAttribute#COMMENT}
     * attribute for this adapted contig.  Calling this method
     * multiple times will overwrite previous entries with the current
     * entry. Setting the value to {@code null} will remove the current
     * entry (the type can later be re-added by calling this method 
     * again with a non-null value).
     * @param comment the value of the comment to set;
     * if this value is null, then the contig should not
     * have this attribute.
     * @return this.
     */
    public TasmContigBuilder withComment(String comment){
<span class="nc" id="L192">       this.comment=comment;</span>
<span class="nc" id="L193">        return this;</span>
    }
    /**
     * Sets the {@link TasmContigAttribute#COM_NAME}
     * attribute for this adapted contig.  Calling this method
     * multiple times will overwrite previous entries with the current
     * entry. Setting the value to {@code null} will remove the current
     * entry (the type can later be re-added by calling this method 
     * again with a non-null value).
     * @param commonName the value of the com-name to set;
     * if this value is null, then the contig should not
     * have this attribute.
     * @return this.
     */
    public TasmContigBuilder withCommonName(String commonName){
<span class="nc" id="L208">       this.commonName = commonName;</span>
<span class="nc" id="L209">        return this;</span>
    }
    /**
     * Sets the {@link TasmContigAttribute#CA_CONTIG_ID}
     * attribute for this adapted contig.  Calling this method
     * multiple times will overwrite previous entries with the current
     * entry. Setting the value to {@code null} will remove the current
     * entry (the type can later be re-added by calling this method 
     * again with a non-null value). As of 2006, All contigs
     * should get a CA Contig Id set to a UID.
     * @param caId the value of the Celera Assembler Contig Id to set;
     * if this value is null, then the contig should not
     * have this attribute.
     * @return this.
     */
    public TasmContigBuilder withCeleraAssemblerContigId(Long caId){
<span class="nc bnc" id="L225" title="All 2 branches missed.">    	if(caId==null){</span>
<span class="nc" id="L226">    		this.celeraAssemblerId = null;</span>
    	}else{
<span class="nc" id="L228">    		this.celeraAssemblerId = caId;</span>
    	}
<span class="nc" id="L230">        return this;</span>
    }
    
    /**
     * Sets the {@link TasmContigAttribute#BAC_ID}
     * attribute for this adapted contig.  Calling this method
     * multiple times will overwrite previous entries with the current
     * entry. Setting the value to {@code null} will remove the current
     * entry (the type can later be re-added by calling this method 
     * again with a non-null value). 
     * @param sampleId the value of the sample id to set;
     * may be null if this contig does not have a 
     * sample id.
     * @return this.
     */
    public TasmContigBuilder setSampleId(String sampleId){
<span class="nc bnc" id="L246" title="All 2 branches missed.">       if(sampleId==null){</span>
<span class="nc" id="L247">    	   this.sampleId = null;</span>
       }else{
<span class="nc" id="L249">    	   this.sampleId = Integer.parseInt(sampleId);</span>
       }
<span class="nc" id="L251">        return this;</span>
    }
	/**
	 * Sets the assembly method
	 * attribute for this adapted contig.  Calling this method
	 * multiple times will overwrite previous entries with the current
	 * entry. Setting the value to {@code null} will remove the current
	 * entry (the method can later be re-added by calling this method 
	 * again with a non-null value).
	 * @param method the value of the method to set;
	 * if this value is null, then the contig should not
	 * have this attribute.
	 * @return this.
	 */
	public TasmContigBuilder withMethod(String method){
<span class="nc" id="L266">		this.assemblyMethod = method;</span>
<span class="nc" id="L267">		return this;</span>
	}

	/**
	 * Sets the edit person and edit date attributes for this contig.
	 * Calling this method
	 * multiple times will overwrite previous entries with the current
	 * entries. Setting &lt;strong&gt;EITHER&lt;/strong&gt; value to {@code null} will remove the current
	 * entries (the attributes can later be re-added by calling this method 
	 * again with a non-null values).
	 * @param editPerson the person who last made an edit
	 * to this contig. 
	 * @param editDate the date that this contig was last edited
	 * (by the editPerson)
	 * @return this.
	 */
	public TasmContigBuilder withEditInfo(String editPerson, Date editDate){
<span class="nc bnc" id="L284" title="All 4 branches missed.">		if(editPerson ==null || editDate ==null){</span>
<span class="nc" id="L285">			this.editPerson = null;</span>
<span class="nc" id="L286">			this.editDate = null;</span>
		}else{
<span class="nc" id="L288">			this.editDate = Long.valueOf(editDate.getTime());</span>
<span class="nc" id="L289">			this.editPerson = editPerson;</span>
		}
<span class="nc" id="L291">		return this;</span>
	}

	public TasmContigBuilder isCircular(boolean isCircular){
<span class="nc" id="L295">		this.isCircular = isCircular;</span>
<span class="nc" id="L296">		return this;</span>
	}
	
	public TasmContigBuilder setTigrProjectAssemblyId(Long asmblId){
<span class="nc" id="L300">		this.asmblId = asmblId;</span>
<span class="nc" id="L301">		return this;</span>
	}
    @Override
    public DefaultTasmContig build() {
<span class="nc bnc" id="L305" title="All 2 branches missed.">    	 if(consensusCaller !=null){</span>
<span class="nc" id="L306"> 			recallConsensusNow();</span>
         }
<span class="nc" id="L308">        Set&lt;TasmAssembledRead&gt; reads = new LinkedHashSet&lt;TasmAssembledRead&gt;();</span>
<span class="nc bnc" id="L309" title="All 2 branches missed.">        for(AssembledReadBuilder&lt;TasmAssembledRead&gt; builder : getAllAssembledReadBuilders()){              </span>
<span class="nc" id="L310">            reads.add(builder.build());</span>
<span class="nc" id="L311">        }</span>
<span class="nc" id="L312">        return new DefaultTasmContig(this, reads);</span>
    }

    
    /**
    * {@inheritDoc}
    */
    @Override
    protected TasmAssembledReadBuilder createPlacedReadBuilder(
            TasmAssembledRead read) {
<span class="nc" id="L322">        TasmAssembledReadBuilder builder =DefaultTasmAssembledRead.createBuilder(</span>
<span class="nc" id="L323">                getConsensusBuilder().build(), </span>
<span class="nc" id="L324">                read.getId(), </span>
<span class="nc" id="L325">                read.getNucleotideSequence().toString(), </span>
<span class="nc" id="L326">                (int)read.getGappedStartOffset(), </span>
<span class="nc" id="L327">                read.getDirection(), </span>
<span class="nc" id="L328">                read.getReadInfo().getValidRange(),</span>
<span class="nc" id="L329">                read.getReadInfo().getUngappedFullLength());</span>

<span class="nc" id="L331">        return builder;</span>
    }
    /**
    * {@inheritDoc}
    */
    @Override
    protected TasmAssembledReadBuilder createPlacedReadBuilder(
            String id, int offset, Range validRange, String basecalls,
            Direction dir, int fullUngappedLength) {
<span class="nc" id="L340">        return DefaultTasmAssembledRead.createBuilder(</span>
<span class="nc" id="L341">                getConsensusBuilder().build(), </span>
                id, 
                basecalls, 
                offset, 
                dir, 
                validRange,
                fullUngappedLength);
    }
    /**
     * {@code DefaultTasmContig} is a {@link Contig}
     * implementation for TIGR Assembler contig data.
     * @author dkatzel
     *
     *
     */
    private static final class DefaultTasmContig implements TasmContig{
    	private final Long celeraAssemblerId;
    	private final String comment, commonName;
    	private final Integer sampleId;
    	private final Long asmblId;
    	
    	private final String editPerson;
    	private final Long editDate;
    	private final String assemblyMethod;
    	private final double avgCoverage;
    	private final boolean isCircular;
    	
        private final Contig&lt;TasmAssembledRead&gt; contig;
        /**
         * @param id
         * @param consensus
         * @param placedReads
         * @param circular
         */
<span class="nc" id="L375">        private DefaultTasmContig(TasmContigBuilder builder, Set&lt;TasmAssembledRead&gt; reads) {</span>
<span class="nc" id="L376">            contig = new DefaultContig&lt;TasmAssembledRead&gt;(builder.getContigId(),</span>
<span class="nc" id="L377">            		builder.getConsensusBuilder().build(),reads);</span>
<span class="nc" id="L378">            long numberOfReads = contig.getNumberOfReads();</span>
<span class="nc bnc" id="L379" title="All 2 branches missed.">            if(numberOfReads &gt;0){</span>
<span class="nc" id="L380">    	        long totalNumberOfReadBases=0L;</span>
    	        
<span class="nc bnc" id="L382" title="All 2 branches missed.">    	        for(TasmAssembledRead read : reads){</span>
<span class="nc" id="L383">    	        	totalNumberOfReadBases+=read.getNucleotideSequence().getUngappedLength();</span>
<span class="nc" id="L384">    	        }</span>
    	       
<span class="nc" id="L386">    			avgCoverage = totalNumberOfReadBases/(double) contig.getConsensusSequence().getUngappedLength();</span>
<span class="nc" id="L387">            }else{</span>
<span class="nc" id="L388">            	avgCoverage=0D;</span>
            }
<span class="nc" id="L390">    		this.sampleId = builder.sampleId;</span>
<span class="nc" id="L391">    		this.celeraAssemblerId = builder.celeraAssemblerId;</span>
<span class="nc" id="L392">    		this.editDate = builder.editDate;</span>
<span class="nc" id="L393">    		this.editPerson = builder.editPerson;</span>
<span class="nc" id="L394">    		this.comment = builder.comment;</span>
<span class="nc" id="L395">    		this.commonName = builder.commonName;</span>
<span class="nc" id="L396">    		this.assemblyMethod = builder.assemblyMethod;</span>
<span class="nc" id="L397">    		this.isCircular = builder.isCircular;</span>
<span class="nc" id="L398">    		this.asmblId = builder.asmblId;</span>
<span class="nc" id="L399">        }</span>

    	@Override
    	public String getId() {
<span class="nc" id="L403">    		return contig.getId();</span>
    	}

    	@Override
    	public double getAvgCoverage() {
<span class="nc" id="L408">    		return avgCoverage;</span>
    	}
    	@Override
    	public Integer getSampleId() {
<span class="nc" id="L412">    		return sampleId;</span>
    	}

    	@Override
    	public Long getCeleraAssemblerId() {
<span class="nc" id="L417">    		return celeraAssemblerId;</span>
    	}

    	@Override
    	public Long getTigrProjectAssemblyId() {
<span class="nc" id="L422">    		return asmblId;</span>
    	}

    	@Override
    	public String getAssemblyMethod() {
<span class="nc" id="L427">    		return assemblyMethod;</span>
    	}

    	@Override
    	public String getComment() {
<span class="nc" id="L432">    		return comment;</span>
    	}

    	@Override
    	public String getCommonName() {
<span class="nc" id="L437">    		return commonName;</span>
    	}

    	@Override
    	public String getEditPerson() {
<span class="nc" id="L442">    		return editPerson;</span>
    	}


    	@Override
    	public Date getEditDate() {
<span class="nc" id="L448">    		return new Date(editDate);</span>
    	}
    	@Override
    	public boolean isCircular() {
<span class="nc" id="L452">    		return isCircular;</span>
    	}


    	@Override
    	public long getNumberOfReads() {
<span class="nc" id="L458">    		return contig.getNumberOfReads();</span>
    	}



    	@Override
    	public NucleotideSequence getConsensusSequence() {
<span class="nc" id="L465">    		return contig.getConsensusSequence();</span>
    	}



    	@Override
    	public TasmAssembledRead getRead(String id) {
<span class="nc" id="L472">    		return contig.getRead(id);</span>
    	}



    	@Override
    	public boolean containsRead(String readId) {
<span class="nc" id="L479">    		return contig.containsRead(readId);</span>
    	}



    	@Override
    	public StreamingIterator&lt;TasmAssembledRead&gt; getReadIterator() {
<span class="nc" id="L486">    		return contig.getReadIterator();</span>
    	}


        


    	


    	@Override
    	public int hashCode() {
<span class="nc" id="L498">    		final int prime = 31;</span>
<span class="nc" id="L499">    		int result = 1;</span>
<span class="nc bnc" id="L500" title="All 2 branches missed.">    		result = prime * result + ((asmblId == null) ? 0 : asmblId.hashCode());</span>
<span class="nc bnc" id="L501" title="All 2 branches missed.">    		result = prime * result</span>
<span class="nc" id="L502">    				+ ((assemblyMethod == null) ? 0 : assemblyMethod.hashCode());</span>
    		long temp;
<span class="nc" id="L504">    		temp = Double.doubleToLongBits(avgCoverage);</span>
<span class="nc" id="L505">    		result = prime * result + (int) (temp ^ (temp &gt;&gt;&gt; 32));</span>
<span class="nc bnc" id="L506" title="All 2 branches missed.">    		result = prime</span>
    				* result
    				+ ((celeraAssemblerId == null) ? 0 : celeraAssemblerId
<span class="nc" id="L509">    						.hashCode());</span>
<span class="nc bnc" id="L510" title="All 2 branches missed.">    		result = prime * result + ((comment == null) ? 0 : comment.hashCode());</span>
<span class="nc bnc" id="L511" title="All 2 branches missed.">    		result = prime * result</span>
<span class="nc" id="L512">    				+ ((commonName == null) ? 0 : commonName.hashCode());</span>
<span class="nc bnc" id="L513" title="All 2 branches missed.">    		result = prime * result + ((contig == null) ? 0 : contig.hashCode());</span>
<span class="nc bnc" id="L514" title="All 2 branches missed.">    		result = prime * result</span>
<span class="nc" id="L515">    				+ ((editDate == null) ? 0 : editDate.hashCode());</span>
<span class="nc bnc" id="L516" title="All 2 branches missed.">    		result = prime * result</span>
<span class="nc" id="L517">    				+ ((editPerson == null) ? 0 : editPerson.hashCode());</span>
<span class="nc bnc" id="L518" title="All 2 branches missed.">    		result = prime * result + (isCircular ? 1231 : 1237);</span>
<span class="nc bnc" id="L519" title="All 2 branches missed.">    		result = prime * result</span>
<span class="nc" id="L520">    				+ ((sampleId == null) ? 0 : sampleId.hashCode());</span>
<span class="nc" id="L521">    		return result;</span>
    	}

    	@Override
    	public boolean equals(Object obj) {
<span class="nc bnc" id="L526" title="All 2 branches missed.">    		if (this == obj) {</span>
<span class="nc" id="L527">    			return true;</span>
    		}
<span class="nc bnc" id="L529" title="All 2 branches missed.">    		if (obj == null) {</span>
<span class="nc" id="L530">    			return false;</span>
    		}
<span class="nc bnc" id="L532" title="All 2 branches missed.">    		if (!(obj instanceof TasmContig)) {</span>
<span class="nc" id="L533">    			return false;</span>
    		}
<span class="nc" id="L535">    		TasmContig other = (TasmContig) obj;</span>
<span class="nc bnc" id="L536" title="All 2 branches missed.">    		if (!contig.getId().equals(other.getId())) {</span>
<span class="nc" id="L537">    			return false;</span>
    		}
<span class="nc bnc" id="L539" title="All 2 branches missed.">    		if (!contig.getConsensusSequence().equals(other.getConsensusSequence())) {</span>
<span class="nc" id="L540">    			return false;</span>
    		}
<span class="nc bnc" id="L542" title="All 2 branches missed.">    		if (contig.getNumberOfReads()!=other.getNumberOfReads()) {</span>
<span class="nc" id="L543">    			return false;</span>
    		}
<span class="nc" id="L545">    		StreamingIterator&lt;TasmAssembledRead&gt; readIter=null;</span>
    		try{
<span class="nc" id="L547">    			readIter = contig.getReadIterator();</span>
<span class="nc bnc" id="L548" title="All 2 branches missed.">    			while(readIter.hasNext()){</span>
<span class="nc" id="L549">    				TasmAssembledRead read = readIter.next();</span>
<span class="nc" id="L550">    				String readId = read.getId();</span>
<span class="nc bnc" id="L551" title="All 2 branches missed.">    				if(!other.containsRead(readId)){</span>
<span class="nc" id="L552">    					return false;</span>
    				}
<span class="nc bnc" id="L554" title="All 2 branches missed.">    				if(!read.equals(other.getRead(readId))){</span>
<span class="nc" id="L555">    					return false;</span>
    				}
<span class="nc" id="L557">    			}</span>
    		}finally{
<span class="nc" id="L559">    			IOUtil.closeAndIgnoreErrors(readIter);</span>
    		}			
<span class="nc bnc" id="L561" title="All 2 branches missed.">    		if (asmblId == null) {</span>
<span class="nc bnc" id="L562" title="All 2 branches missed.">    			if (other.getTigrProjectAssemblyId() != null) {</span>
<span class="nc" id="L563">    				return false;</span>
    			}
<span class="nc bnc" id="L565" title="All 2 branches missed.">    		} else if (!asmblId.equals(other.getTigrProjectAssemblyId())) {</span>
<span class="nc" id="L566">    			return false;</span>
    		}
<span class="nc bnc" id="L568" title="All 2 branches missed.">    		if (assemblyMethod == null) {</span>
<span class="nc bnc" id="L569" title="All 2 branches missed.">    			if (other.getAssemblyMethod() != null) {</span>
<span class="nc" id="L570">    				return false;</span>
    			}
<span class="nc bnc" id="L572" title="All 2 branches missed.">    		} else if (!assemblyMethod.equals(other.getAssemblyMethod())) {</span>
<span class="nc" id="L573">    			return false;</span>
    		}
<span class="nc" id="L575">    		if (Double.doubleToLongBits(avgCoverage) != Double</span>
<span class="nc bnc" id="L576" title="All 2 branches missed.">    				.doubleToLongBits(other.getAvgCoverage())) {</span>
<span class="nc" id="L577">    			return false;</span>
    		}
<span class="nc bnc" id="L579" title="All 2 branches missed.">    		if (celeraAssemblerId == null) {</span>
<span class="nc bnc" id="L580" title="All 2 branches missed.">    			if (other.getCeleraAssemblerId() != null) {</span>
<span class="nc" id="L581">    				return false;</span>
    			}
<span class="nc bnc" id="L583" title="All 2 branches missed.">    		} else if (!celeraAssemblerId.equals(other.getCeleraAssemblerId())) {</span>
<span class="nc" id="L584">    			return false;</span>
    		}
<span class="nc bnc" id="L586" title="All 2 branches missed.">    		if (comment == null) {</span>
<span class="nc bnc" id="L587" title="All 2 branches missed.">    			if (other.getComment() != null) {</span>
<span class="nc" id="L588">    				return false;</span>
    			}
<span class="nc bnc" id="L590" title="All 2 branches missed.">    		} else if (!comment.equals(other.getComment())) {</span>
<span class="nc" id="L591">    			return false;</span>
    		}
<span class="nc bnc" id="L593" title="All 2 branches missed.">    		if (commonName == null) {</span>
<span class="nc bnc" id="L594" title="All 2 branches missed.">    			if (other.getCommonName() != null) {</span>
<span class="nc" id="L595">    				return false;</span>
    			}
<span class="nc bnc" id="L597" title="All 2 branches missed.">    		} else if (!commonName.equals(other.getCommonName())) {</span>
<span class="nc" id="L598">    			return false;</span>
    		}
    		
<span class="nc bnc" id="L601" title="All 2 branches missed.">    		if (editDate == null) {</span>
<span class="nc bnc" id="L602" title="All 2 branches missed.">    			if (other.getEditDate() != null) {</span>
<span class="nc" id="L603">    				return false;</span>
    			}
<span class="nc bnc" id="L605" title="All 2 branches missed.">    		} else if (editDate.longValue()!=other.getEditDate().getTime()) {</span>
<span class="nc" id="L606">    			return false;</span>
    		}
<span class="nc bnc" id="L608" title="All 2 branches missed.">    		if (editPerson == null) {</span>
<span class="nc bnc" id="L609" title="All 2 branches missed.">    			if (other.getEditPerson() != null) {</span>
<span class="nc" id="L610">    				return false;</span>
    			}
<span class="nc bnc" id="L612" title="All 2 branches missed.">    		} else if (!editPerson.equals(other.getEditPerson())) {</span>
<span class="nc" id="L613">    			return false;</span>
    		}
<span class="nc bnc" id="L615" title="All 2 branches missed.">    		if (isCircular != other.isCircular()) {</span>
<span class="nc" id="L616">    			return false;</span>
    		}
<span class="nc bnc" id="L618" title="All 2 branches missed.">    		if (sampleId == null) {</span>
<span class="nc bnc" id="L619" title="All 2 branches missed.">    			if (other.getSampleId() != null) {</span>
<span class="nc" id="L620">    				return false;</span>
    			}
<span class="nc bnc" id="L622" title="All 2 branches missed.">    		} else if (!sampleId.equals(other.getSampleId())) {</span>
<span class="nc" id="L623">    			return false;</span>
    		}
<span class="nc" id="L625">    		return true;</span>
    	}

    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>