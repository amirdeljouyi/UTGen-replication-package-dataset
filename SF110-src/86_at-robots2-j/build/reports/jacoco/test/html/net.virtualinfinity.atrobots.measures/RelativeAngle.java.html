<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>RelativeAngle.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">86_at-robots2-j</a> &gt; <a href="index.source.html" class="el_package">net.virtualinfinity.atrobots.measures</a> &gt; <span class="el_source">RelativeAngle.java</span></div><h1>RelativeAngle.java</h1><pre class="source lang-java linenums">package net.virtualinfinity.atrobots.measures;

/**
 * Represents an amount of rotation.
 *
 * @author Daniel Pitts
 */
public class RelativeAngle implements Comparable&lt;RelativeAngle&gt; {
    public static final RelativeAngle HALF_CIRCLE;
    public static final RelativeAngle FULL_CIRCLE;
<span class="fc" id="L11">    private static final RelativeAngle[] bygreeTable = new RelativeAngle[256];</span>

    static {
<span class="fc bfc" id="L14" title="All 2 branches covered.">        for (int bygree = 0; bygree &lt; 256; ++bygree) {</span>
<span class="fc" id="L15">            final double radians = RelativeAngle.bygreesToRadians(bygree);</span>
<span class="fc" id="L16">            bygreeTable[bygree] = new RelativeBygreeAngle(bygree, (byte) bygree, radians, radiansToDegrees(radians));</span>
        }
<span class="fc" id="L18">        HALF_CIRCLE = RelativeAngle.fromBygrees(128);</span>
<span class="fc" id="L19">        FULL_CIRCLE = RelativeAngle.fromBygrees(256);</span>
<span class="fc" id="L20">    }</span>

    private final double radians;

<span class="fc" id="L24">    private RelativeAngle(double radians) {</span>
<span class="fc" id="L25">        this.radians = radians;</span>
<span class="fc" id="L26">    }</span>

    private double cosine() {
<span class="nc" id="L29">        return Math.cos(radians);</span>
    }

    private double sine() {
<span class="nc" id="L33">        return Math.sin(radians);</span>
    }

    public static RelativeAngle fromRadians(double radians) {
<span class="fc" id="L37">        return new RelativeAngle(radians);</span>
    }

    public RelativeAngle plus(RelativeAngle angle) {
<span class="nc" id="L41">        return fromRadians(getRadians() + angle.getRadians());</span>
    }

    public double getRadians() {
<span class="nc" id="L45">        return radians;</span>
    }

    public RelativeAngle normalize() {
<span class="nc bnc" id="L49" title="All 4 branches missed.">        if (radians &gt;= Math.PI * 2 || radians &lt; 0) {</span>
<span class="nc" id="L50">            return fromRadians(Math.atan2(sine(), cosine()));</span>
        }
<span class="nc" id="L52">        return this;</span>
    }

    public int getBygrees() {
<span class="nc" id="L56">        return (int) Math.round(radians * 128 / Math.PI) &amp; 255;</span>
    }

    public static RelativeAngle fromBygrees(int value) {
<span class="fc bfc" id="L60" title="All 2 branches covered.">        if (value &lt;= 255) {</span>
<span class="fc bfc" id="L61" title="All 2 branches covered.">            if (value &gt;= 0) {</span>
<span class="fc" id="L62">                return bygreeTable[value];</span>
            }
<span class="pc bpc" id="L64" title="1 of 2 branches missed.">            if (value &gt;= -255) {</span>
<span class="fc" id="L65">                return bygreeTable[-value].negate();</span>
            }
        }
<span class="fc" id="L68">        return new RelativeBygreeAngle(value, (byte) value, bygreesToRadians(value), radiansToDegrees(value));</span>
    }

    private RelativeAngle negate() {
<span class="fc" id="L72">        return fromRadians(-radians);</span>
    }

    private static double bygreesToRadians(int value) {
<span class="fc" id="L76">        return value * Math.PI / 128;</span>
    }

    public byte getSignedBygrees() {
<span class="nc" id="L80">        return (byte) getBygrees();</span>
    }

    public String toString() {
<span class="nc" id="L84">        return getRadians() + &quot;r/&quot; + getBygrees();</span>
    }

    public int compareTo(RelativeAngle angle) {
<span class="nc" id="L88">        return Double.compare(getRadians(), angle.getRadians());</span>
    }

    public double getDegrees() {
<span class="nc" id="L92">        return radiansToDegrees(getRadians());</span>
    }

    private static double radiansToDegrees(double radians) {
<span class="fc" id="L96">        return radians * 180 / Math.PI;</span>
    }

    public double dividedBy(RelativeAngle relativeAngle) {
<span class="nc" id="L100">        return radians / relativeAngle.radians;</span>
    }

    boolean isExactBygrees() {
<span class="nc" id="L104">        return false;</span>
    }

    public RelativeAngle dividedBy(double scale) {
<span class="nc" id="L108">        return fromRadians(radians / scale);</span>
    }

    public RelativeAngle times(int scale) {
<span class="nc" id="L112">        return fromRadians(radians * scale);</span>
    }

    public RelativeAngle times(double scale) {
<span class="nc" id="L116">        return fromRadians(radians * scale);</span>
    }

    private static class RelativeBygreeAngle extends RelativeAngle {
        private final int bygree;
        private final byte signedBygree;
        private final double degrees;

        public RelativeBygreeAngle(int bygree, byte signedBygree, double radians, double degrees) {
<span class="fc" id="L125">            super(radians);</span>
<span class="fc" id="L126">            this.bygree = bygree;</span>
<span class="fc" id="L127">            this.signedBygree = signedBygree;</span>
<span class="fc" id="L128">            this.degrees = degrees;</span>
<span class="fc" id="L129">        }</span>

        @Override
        public RelativeAngle normalize() {
<span class="nc" id="L133">            return bygreeTable[bygree &amp; 255];</span>
        }

        @Override
        public int getBygrees() {
<span class="nc" id="L138">            return bygree;</span>
        }

        @Override
        public byte getSignedBygrees() {
<span class="nc" id="L143">            return signedBygree;</span>
        }

        @Override
        public double getDegrees() {
<span class="nc" id="L148">            return degrees;</span>
        }

        @Override
        boolean isExactBygrees() {
<span class="nc" id="L153">            return true;</span>
        }

        @Override
        public RelativeAngle times(int scale) {
<span class="nc" id="L158">            return fromBygrees(bygree * scale);</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>