<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ViewActions.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">43_lilith</a> &gt; <a href="index.source.html" class="el_package">de.huxhorn.lilith.swing</a> &gt; <span class="el_source">ViewActions.java</span></div><h1>ViewActions.java</h1><pre class="source lang-java linenums">/*
 * Lilith - a log event viewer.
 * Copyright (C) 2007-2009 Joern Huxhorn
 * 
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.
 */
package de.huxhorn.lilith.swing;

import de.huxhorn.lilith.data.access.AccessEvent;
import de.huxhorn.lilith.data.eventsource.EventWrapper;
import de.huxhorn.lilith.data.eventsource.SourceIdentifier;
import de.huxhorn.lilith.data.logging.ExtendedStackTraceElement;
import de.huxhorn.lilith.data.logging.LoggingEvent;
import de.huxhorn.lilith.data.logging.Marker;
import de.huxhorn.lilith.data.logging.Message;
import de.huxhorn.lilith.data.logging.ThrowableInfo;
import de.huxhorn.lilith.engine.EventSource;
import de.huxhorn.lilith.services.sender.EventSender;
import de.huxhorn.lilith.swing.table.EventWrapperViewTable;
import de.huxhorn.lilith.swing.table.model.PersistentTableColumnModel;
import de.huxhorn.sulky.conditions.Condition;
import de.huxhorn.sulky.swing.KeyStrokes;

import org.simplericity.macify.eawt.Application;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;
import java.io.Serializable;
import java.net.URL;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.SortedMap;
import java.util.TreeMap;

import javax.swing.*;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;
import javax.swing.table.TableColumn;

/**
 * This class needs cleanup...... remove duplicated logic, make ToolBar/Menu configurable...
 */
public class ViewActions
{
<span class="nc" id="L63">	private final Logger logger = LoggerFactory.getLogger(ViewActions.class);</span>

	/**
	 * Taken over from Action.SELECTED_KEY for 1.5 compatibility.
	 * Does not work with 1.5 :( I was really sure that there was some selected event...
	 */
	//private static final String SELECTED_KEY = &quot;SwingSelectedKey&quot;;

	private static final Icon EMPTY_16_ICON;

	private static final Icon CLEAR_MENU_ICON;
	private static final Icon ATTACH_MENU_ICON;
	private static final Icon DETACH_MENU_ICON;
	private static final Icon PAUSED_MENU_ICON;
	private static final Icon UNPAUSED_MENU_ICON;
	private static final Icon FIND_MENU_ITEM;
	private static final Icon STATISTICS_MENU_ICON;
	private static final Icon DISCONNECT_MENU_ICON;
	private static final Icon TAIL_MENU_ICON;
	private static final Icon FIND_NEXT_MENU_ICON;
	private static final Icon FIND_PREV_MENU_ICON;
	private static final Icon HELP_MENU_ICON;
	private static final Icon OPEN_INACTIVE_MENU_ICON;
	private static final Icon EXIT_MENU_ICON;
	private static final Icon PREFERENCES_MENU_ICON;

	private static final Icon CLEAR_TOOLBAR_ICON;
	private static final Icon ATTACH_TOOLBAR_ICON;
	private static final Icon DETACH_TOOLBAR_ICON;
	private static final Icon PAUSED_TOOLBAR_ICON;
	private static final Icon UNPAUSED_TOOLBAR_ICON;
	private static final Icon FIND_TOOLBAR_ICON;
	private static final Icon STATISTICS_TOOLBAR_ICON;
	private static final Icon DISCONNECT_TOOLBAR_ICON;
	private static final Icon TAIL_TOOLBAR_ICON;

	private static final Icon PREFERENCES_TOOLBAR_ICON;

	// TODO: Resource classes
	// TODO: Separate Toolbar and Menu creation.
	// TODO: toolbar action, menu action =&gt; same action
	static
	{
		Icon icon;
		{
<span class="nc" id="L108">			URL url = ViewActions.class.getResource(&quot;/otherGraphics/empty16.png&quot;);</span>
<span class="nc bnc" id="L109" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L111">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L115">				icon = null;</span>
			}
		}
<span class="nc" id="L118">		EMPTY_16_ICON = icon;</span>

		{
<span class="nc" id="L121">			URL url = ViewActions.class.getResource(&quot;/tango/16x16/actions/edit-clear.png&quot;);</span>
<span class="nc bnc" id="L122" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L124">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L128">				icon = null;</span>
			}
		}
<span class="nc" id="L131">		CLEAR_MENU_ICON = icon;</span>

		{
<span class="nc" id="L134">			URL url = ViewActions.class.getResource(&quot;/tango/32x32/actions/edit-clear.png&quot;);</span>
<span class="nc bnc" id="L135" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L137">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L141">				icon = null;</span>
			}
		}
<span class="nc" id="L144">		CLEAR_TOOLBAR_ICON = icon;</span>

		{
<span class="nc" id="L147">			URL url = ViewActions.class.getResource(&quot;/tango/16x16/actions/edit-undo.png&quot;);</span>
<span class="nc bnc" id="L148" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L150">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L154">				icon = null;</span>
			}
		}
<span class="nc" id="L157">		ATTACH_MENU_ICON = icon;</span>

		{
<span class="nc" id="L160">			URL url = ViewActions.class.getResource(&quot;/tango/16x16/actions/edit-redo.png&quot;);</span>
<span class="nc bnc" id="L161" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L163">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L167">				icon = null;</span>
			}
		}
<span class="nc" id="L170">		DETACH_MENU_ICON = icon;</span>

		{
<span class="nc" id="L173">			URL url = ViewActions.class.getResource(&quot;/tango/32x32/actions/edit-undo.png&quot;);</span>
<span class="nc bnc" id="L174" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L176">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L180">				icon = null;</span>
			}
		}
<span class="nc" id="L183">		ATTACH_TOOLBAR_ICON = icon;</span>

		{
<span class="nc" id="L186">			URL url = ViewActions.class.getResource(&quot;/tango/32x32/actions/edit-redo.png&quot;);</span>
<span class="nc bnc" id="L187" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L189">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L193">				icon = null;</span>
			}
		}
<span class="nc" id="L196">		DETACH_TOOLBAR_ICON = icon;</span>

		{
<span class="nc" id="L199">			URL url = ViewActions.class.getResource(&quot;/tango/16x16/actions/media-playback-start.png&quot;);</span>
<span class="nc bnc" id="L200" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L202">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L206">				icon = null;</span>
			}
		}
<span class="nc" id="L209">		PAUSED_MENU_ICON = icon;</span>

		{
<span class="nc" id="L212">			URL url = ViewActions.class.getResource(&quot;/tango/16x16/actions/media-playback-pause.png&quot;);</span>
<span class="nc bnc" id="L213" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L215">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L219">				icon = null;</span>
			}
		}
<span class="nc" id="L222">		UNPAUSED_MENU_ICON = icon;</span>

		{
<span class="nc" id="L225">			URL url = ViewActions.class.getResource(&quot;/tango/32x32/actions/media-playback-start.png&quot;);</span>
<span class="nc bnc" id="L226" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L228">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L232">				icon = null;</span>
			}
		}
<span class="nc" id="L235">		PAUSED_TOOLBAR_ICON = icon;</span>

		{
<span class="nc" id="L238">			URL url = ViewActions.class.getResource(&quot;/tango/32x32/actions/media-playback-pause.png&quot;);</span>
<span class="nc bnc" id="L239" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L241">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L245">				icon = null;</span>
			}
		}
<span class="nc" id="L248">		UNPAUSED_TOOLBAR_ICON = icon;</span>

		{
<span class="nc" id="L251">			URL url = ViewActions.class.getResource(&quot;/tango/16x16/actions/edit-find.png&quot;);</span>
<span class="nc bnc" id="L252" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L254">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L258">				icon = null;</span>
			}
		}
<span class="nc" id="L261">		FIND_MENU_ITEM = icon;</span>

		{
<span class="nc" id="L264">			URL url = ViewActions.class.getResource(&quot;/tango/32x32/actions/edit-find.png&quot;);</span>
<span class="nc bnc" id="L265" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L267">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L271">				icon = null;</span>
			}
		}
<span class="nc" id="L274">		FIND_TOOLBAR_ICON = icon;</span>

		{
<span class="nc" id="L277">			URL url = ViewActions.class.getResource(&quot;/tango/16x16/apps/utilities-system-monitor.png&quot;);</span>
<span class="nc bnc" id="L278" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L280">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L284">				icon = null;</span>
			}
		}
<span class="nc" id="L287">		STATISTICS_MENU_ICON = icon;</span>

		{
<span class="nc" id="L290">			URL url = ViewActions.class.getResource(&quot;/tango/32x32/apps/utilities-system-monitor.png&quot;);</span>
<span class="nc bnc" id="L291" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L293">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L297">				icon = null;</span>
			}
		}
<span class="nc" id="L300">		STATISTICS_TOOLBAR_ICON = icon;</span>

		{
<span class="nc" id="L303">			URL url = ViewActions.class.getResource(&quot;/tango/16x16/actions/media-eject.png&quot;);</span>
<span class="nc bnc" id="L304" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L306">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L310">				icon = null;</span>
			}
		}
<span class="nc" id="L313">		DISCONNECT_MENU_ICON = icon;</span>

		{
<span class="nc" id="L316">			URL url = ViewActions.class.getResource(&quot;/tango/32x32/actions/media-eject.png&quot;);</span>
<span class="nc bnc" id="L317" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L319">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L323">				icon = null;</span>
			}
		}
<span class="nc" id="L326">		DISCONNECT_TOOLBAR_ICON = icon;</span>

		{
<span class="nc" id="L329">			URL url = ViewActions.class.getResource(&quot;/tango/16x16/actions/go-down.png&quot;);</span>
<span class="nc bnc" id="L330" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L332">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L336">				icon = null;</span>
			}
		}
<span class="nc" id="L339">		FIND_NEXT_MENU_ICON = icon;</span>

		{
<span class="nc" id="L342">			URL url = ViewActions.class.getResource(&quot;/tango/16x16/actions/go-up.png&quot;);</span>
<span class="nc bnc" id="L343" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L345">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L349">				icon = null;</span>
			}
		}
<span class="nc" id="L352">		FIND_PREV_MENU_ICON = icon;</span>

		{
<span class="nc" id="L355">			URL url = ViewActions.class.getResource(&quot;/tango/16x16/actions/go-bottom.png&quot;);</span>
<span class="nc bnc" id="L356" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L358">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L362">				icon = null;</span>
			}

		}
<span class="nc" id="L366">		TAIL_MENU_ICON = icon;</span>

		{
<span class="nc" id="L369">			URL url = ViewActions.class.getResource(&quot;/tango/32x32/actions/go-bottom.png&quot;);</span>
<span class="nc bnc" id="L370" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L372">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L376">				icon = null;</span>
			}

		}
<span class="nc" id="L380">		TAIL_TOOLBAR_ICON = icon;</span>

		{
<span class="nc" id="L383">			URL url = ViewActions.class.getResource(&quot;/tango/16x16/apps/help-browser.png&quot;);</span>

<span class="nc bnc" id="L385" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L387">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L391">				icon = null;</span>
			}
		}
<span class="nc" id="L394">		HELP_MENU_ICON = icon;</span>

		{
<span class="nc" id="L397">			URL url = ViewActions.class.getResource(&quot;/tango/16x16/actions/document-open.png&quot;);</span>
<span class="nc bnc" id="L398" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L400">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L404">				icon = null;</span>
			}
		}
<span class="nc" id="L407">		OPEN_INACTIVE_MENU_ICON = icon;</span>

		{
<span class="nc" id="L410">			URL url = ViewActions.class.getResource(&quot;/tango/16x16/actions/system-log-out.png&quot;);</span>
<span class="nc bnc" id="L411" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L413">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L417">				icon = null;</span>
			}
		}
<span class="nc" id="L420">		EXIT_MENU_ICON = icon;</span>

		{
<span class="nc" id="L423">			URL url = ViewActions.class.getResource(&quot;/tango/16x16/categories/preferences-system.png&quot;);</span>
<span class="nc bnc" id="L424" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L426">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L430">				icon = null;</span>
			}
		}
<span class="nc" id="L433">		PREFERENCES_MENU_ICON = icon;</span>

		{
<span class="nc" id="L436">			URL url = ViewActions.class.getResource(&quot;/tango/32x32/categories/preferences-system.png&quot;);</span>
<span class="nc bnc" id="L437" title="All 2 branches missed.">			if(url != null)</span>
			{
<span class="nc" id="L439">				icon = new ImageIcon(url);</span>
			}
			else
			{
<span class="nc" id="L443">				icon = null;</span>
			}
		}
<span class="nc" id="L446">		PREFERENCES_TOOLBAR_ICON = icon;</span>
<span class="nc" id="L447">	}</span>


	private JToolBar toolbar;
	private JMenuBar menubar;

	private MainFrame mainFrame;
	private ViewContainer viewContainer;
	private JToggleButton scrollToBottomButton;
	private AttachToolBarAction attachToolBarAction;
	private AttachMenuAction attachMenuAction;
	private DisconnectToolBarAction disconnectToolBarAction;
	private DisconnectMenuAction disconnectMenuAction;
	private PauseToolBarAction pauseToolBarAction;
	private PauseMenuAction pauseMenuAction;
	private FindPreviousAction findPreviousAction;
	private FindNextAction findNextAction;
	private ResetFindAction resetFindAction;
	private ScrollToBottomMenuAction scrollToBottomMenuAction;
	private EditSourceNameMenuAction editSourceNameMenuAction;
	private SaveLayoutAction saveLayoutAction;
	private ResetLayoutAction resetLayoutAction;
	private EditConditionMenuAction editConditionMenuAction;

	private NextTabAction nextTabAction;
	private PreviousTabAction previousTabAction;
	private CloseFilterAction closeFilterAction;
	private CloseOtherFiltersAction closeOtherFiltersAction;
	private CloseAllFiltersAction closeAllFiltersAction;

	//private ClearAndRemoveInactiveAction clearAndRemoveInactiveAction;
	private RemoveInactiveAction removeInactiveAction;
	private CloseAllAction closeAllAction;
	private CloseAllOtherAction closeAllOtherAction;
	private MinimizeAllAction minimizeAllAction;
	private MinimizeAllOtherAction minimizeAllOtherAction;

	private JMenuItem removeInactiveItem;
	//private JMenuItem clearAndRemoveInactiveItem;

	private JMenu windowMenu;
	private AboutAction aboutAction;
	private PreferencesMenuAction preferencesMenuAction;
	private FindMenuAction findMenuAction;
	private JMenu searchMenu;
	private JMenu viewMenu;
	private JMenu columnsMenu;
	private ClearMenuAction clearMenuAction;
	private FocusMessageAction focusMessageAction;
	private FocusEventsAction focusEventsAction;
	private StatisticsMenuAction statisticsMenuAction;
	private ChangeListener containerChangeListener;
	private ScrollToBottomToolBarAction scrollToBottomToolBarAction;
	private ClearToolBarAction clearToolBarAction;
	private FindToolBarAction findToolBarAction;
	private StatisticsToolBarAction statisticsToolBarAction;
	private CopySelectionAction copySelectionAction;
	private CopyEventAction copyEventAction;
	private CopyLoggingMessageAction copyLoggingMessageAction;
	private CopyLoggingThrowableAction copyLoggingThrowableAction;
	private CopyLoggingCallStackAction copyLoggingCallStackAction;
	private CopyLoggingMarkerAction copyLoggingMarkerAction;
	private CopyLoggingMdcAction copyLoggingMdcAction;
	private CopyLoggingNdcAction copyLoggingNdcAction;
	private CopyLoggerNameAction copyLoggerNameAction;
	private CopyAccessUriAction copyAccessUriAction;
	private ShowUnfilteredEventAction showUnfilteredEventAction;
	private JPopupMenu popup;
	private GotoSourceAction gotoSourceAction;
	private JMenu sendToMenuItem;
	private PropertyChangeListener containerPropertyChangeListener;
	private EventWrapper eventWrapper;
	private JMenuItem showTaskManagerItem;
	private JMenuItem closeAllItem;
	private JMenuItem minimizeAllItem;
	private JMenuItem closeAllOtherItem;
	private JMenuItem minimizeAllOtherItem;
	private JMenu editMenu;


	public ViewActions(MainFrame mainFrame, ViewContainer viewContainer)
	{
<span class="nc" id="L529">		this(mainFrame);</span>
<span class="nc" id="L530">		setViewContainer(viewContainer);</span>
<span class="nc" id="L531">	}</span>

	public ViewActions(MainFrame mainFrame)
<span class="nc" id="L534">	{</span>
<span class="nc" id="L535">		this.mainFrame = mainFrame;</span>

<span class="nc" id="L537">		containerChangeListener = new ChangeListener()</span>
<span class="nc" id="L538">		{</span>
			/**
			 * Invoked when the target of the listener has changed its state.
			 *
			 * @param e a ChangeEvent object
			 */
			public void stateChanged(ChangeEvent e)
			{
<span class="nc" id="L546">				updateActions();</span>
<span class="nc" id="L547">			}</span>
		};

<span class="nc" id="L550">		containerPropertyChangeListener = new PropertyChangeListener()</span>
<span class="nc" id="L551">		{</span>

			/**
			 * This method gets called when a bound property is changed.
			 *
			 * @param evt A PropertyChangeEvent object describing the event source
			 *            and the property that has changed.
			 */

			public void propertyChange(PropertyChangeEvent evt)
			{
<span class="nc bnc" id="L562" title="All 2 branches missed.">				if(ViewContainer.SELECTED_EVENT_PROPERTY_NAME.equals(evt.getPropertyName()))</span>
				{
<span class="nc" id="L564">					setEventWrapper((EventWrapper) evt.getNewValue());</span>
				}

<span class="nc" id="L567">			}</span>
		};
		// ##### Menu Actions #####
		// File
<span class="nc" id="L571">		OpenMenuAction openMenuAction = new OpenMenuAction();</span>
<span class="nc" id="L572">		OpenInactiveLogMenuAction openInactiveLogMenuAction = new OpenInactiveLogMenuAction();</span>
<span class="nc" id="L573">		ImportMenuAction importMenuAction = new ImportMenuAction();</span>
<span class="nc" id="L574">		CleanAllInactiveLogsMenuAction cleanAllInactiveLogsMenuAction = new CleanAllInactiveLogsMenuAction();</span>
<span class="nc" id="L575">		preferencesMenuAction = new PreferencesMenuAction();</span>
<span class="nc" id="L576">		ExitMenuAction exitMenuAction = new ExitMenuAction();</span>

		// Edit
<span class="nc" id="L579">		showUnfilteredEventAction = new ShowUnfilteredEventAction();</span>
<span class="nc" id="L580">		gotoSourceAction = new GotoSourceAction();</span>
<span class="nc" id="L581">		copySelectionAction = new CopySelectionAction();</span>
<span class="nc" id="L582">		copyEventAction = new CopyEventAction();</span>
<span class="nc" id="L583">		copyLoggingMessageAction = new CopyLoggingMessageAction();</span>
<span class="nc" id="L584">		copyLoggerNameAction = new CopyLoggerNameAction();</span>
<span class="nc" id="L585">		copyLoggingThrowableAction = new CopyLoggingThrowableAction();</span>
<span class="nc" id="L586">		copyLoggingCallStackAction = new CopyLoggingCallStackAction();</span>
<span class="nc" id="L587">		copyLoggingMarkerAction = new CopyLoggingMarkerAction();</span>
<span class="nc" id="L588">		copyLoggingMdcAction = new CopyLoggingMdcAction();</span>
<span class="nc" id="L589">		copyLoggingNdcAction = new CopyLoggingNdcAction();</span>
<span class="nc" id="L590">		copyAccessUriAction = new CopyAccessUriAction();</span>


		// Search
<span class="nc" id="L594">		findMenuAction = new FindMenuAction();</span>
<span class="nc" id="L595">		findPreviousAction = new FindPreviousAction();</span>
<span class="nc" id="L596">		findNextAction = new FindNextAction();</span>
<span class="nc" id="L597">		resetFindAction = new ResetFindAction();</span>

		// View
<span class="nc" id="L600">		scrollToBottomMenuAction = new ScrollToBottomMenuAction();</span>
<span class="nc" id="L601">		pauseMenuAction = new PauseMenuAction();</span>
<span class="nc" id="L602">		clearMenuAction = new ClearMenuAction();</span>
<span class="nc" id="L603">		attachMenuAction = new AttachMenuAction();</span>
<span class="nc" id="L604">		disconnectMenuAction = new DisconnectMenuAction();</span>

<span class="nc" id="L606">		focusMessageAction = new FocusMessageAction();</span>
<span class="nc" id="L607">		focusEventsAction = new FocusEventsAction();</span>

<span class="nc" id="L609">		statisticsMenuAction = new StatisticsMenuAction();</span>
<span class="nc" id="L610">		editSourceNameMenuAction = new EditSourceNameMenuAction();</span>
<span class="nc" id="L611">		saveLayoutAction = new SaveLayoutAction();</span>
<span class="nc" id="L612">		resetLayoutAction = new ResetLayoutAction();</span>
<span class="nc" id="L613">		editConditionMenuAction = new EditConditionMenuAction();</span>

<span class="nc" id="L615">		previousTabAction = new PreviousTabAction();</span>
<span class="nc" id="L616">		nextTabAction = new NextTabAction();</span>
<span class="nc" id="L617">		closeFilterAction = new CloseFilterAction();</span>
<span class="nc" id="L618">		closeOtherFiltersAction = new CloseOtherFiltersAction();</span>
<span class="nc" id="L619">		closeAllFiltersAction = new CloseAllFiltersAction();</span>

		// Window
<span class="nc" id="L622">		ShowTaskManagerAction showTaskManagerAction = new ShowTaskManagerAction();</span>
<span class="nc" id="L623">		closeAllAction = new CloseAllAction();</span>
<span class="nc" id="L624">		closeAllOtherAction = new CloseAllOtherAction();</span>
<span class="nc" id="L625">		minimizeAllAction = new MinimizeAllAction();</span>
<span class="nc" id="L626">		minimizeAllOtherAction = new MinimizeAllOtherAction();</span>
<span class="nc" id="L627">		removeInactiveAction = new RemoveInactiveAction();</span>
		//clearAndRemoveInactiveAction=new ClearAndRemoveInactiveAction();

		// Help
<span class="nc" id="L631">		KeyboardHelpAction keyboardHelpAction = new KeyboardHelpAction();</span>
<span class="nc" id="L632">		DebugAction debugAction = new DebugAction();</span>
<span class="nc" id="L633">		aboutAction = new AboutAction();</span>
<span class="nc" id="L634">		CheckForUpdateAction checkForUpdateAction = new CheckForUpdateAction();</span>

		// ##### ToolBar Actions #####
<span class="nc" id="L637">		scrollToBottomToolBarAction = new ScrollToBottomToolBarAction();</span>
<span class="nc" id="L638">		pauseToolBarAction = new PauseToolBarAction();</span>
<span class="nc" id="L639">		clearToolBarAction = new ClearToolBarAction();</span>
<span class="nc" id="L640">		findToolBarAction = new FindToolBarAction();</span>
<span class="nc" id="L641">		statisticsToolBarAction = new StatisticsToolBarAction();</span>
<span class="nc" id="L642">		attachToolBarAction = new AttachToolBarAction();</span>
<span class="nc" id="L643">		PreferencesToolBarAction preferencesToolBarAction = new PreferencesToolBarAction();</span>
<span class="nc" id="L644">		disconnectToolBarAction = new DisconnectToolBarAction();</span>

<span class="nc" id="L646">		showTaskManagerItem = new JMenuItem(showTaskManagerAction);</span>
<span class="nc" id="L647">		closeAllItem = new JMenuItem(closeAllAction);</span>
<span class="nc" id="L648">		closeAllOtherItem = new JMenuItem(closeAllOtherAction);</span>
<span class="nc" id="L649">		minimizeAllItem = new JMenuItem(minimizeAllAction);</span>
<span class="nc" id="L650">		minimizeAllOtherItem = new JMenuItem(minimizeAllOtherAction);</span>
<span class="nc" id="L651">		removeInactiveItem = new JMenuItem(removeInactiveAction);</span>
		//clearAndRemoveInactiveItem = new JMenuItem(clearAndRemoveInactiveAction);

<span class="nc" id="L654">		toolbar = new JToolBar(SwingConstants.HORIZONTAL);</span>
<span class="nc" id="L655">		toolbar.setFloatable(false);</span>


<span class="nc" id="L658">		scrollToBottomButton = new JToggleButton(scrollToBottomToolBarAction);</span>
<span class="nc" id="L659">		toolbar.add(scrollToBottomButton);</span>

<span class="nc" id="L661">		JButton pauseButton = new JButton(pauseToolBarAction);</span>
<span class="nc" id="L662">		toolbar.add(pauseButton);</span>

<span class="nc" id="L664">		JButton clearButton = new JButton(clearToolBarAction);</span>
<span class="nc" id="L665">		toolbar.add(clearButton);</span>

<span class="nc" id="L667">		JButton findButton = new JButton(findToolBarAction);</span>
<span class="nc" id="L668">		toolbar.add(findButton);</span>

<span class="nc" id="L670">		JButton disconnectButton = new JButton(disconnectToolBarAction);</span>
<span class="nc" id="L671">		toolbar.add(disconnectButton);</span>

<span class="nc" id="L673">		toolbar.addSeparator();</span>

<span class="nc" id="L675">		JButton statisticsButton = new JButton(statisticsToolBarAction);</span>
<span class="nc" id="L676">		toolbar.add(statisticsButton);</span>

<span class="nc" id="L678">		toolbar.addSeparator();</span>

<span class="nc" id="L680">		JButton attachButton = new JButton(attachToolBarAction);</span>
<span class="nc" id="L681">		toolbar.add(attachButton);</span>

<span class="nc" id="L683">		toolbar.addSeparator();</span>

<span class="nc" id="L685">		JButton preferencesButton = new JButton(preferencesToolBarAction);</span>
<span class="nc" id="L686">		toolbar.add(preferencesButton);</span>

<span class="nc" id="L688">		Application app = mainFrame.getApplication();</span>

<span class="nc" id="L690">		menubar = new JMenuBar();</span>

		// File
<span class="nc" id="L693">		JMenu fileMenu = new JMenu(&quot;File&quot;);</span>
<span class="nc" id="L694">		fileMenu.setMnemonic('f');</span>
<span class="nc" id="L695">		fileMenu.add(new JMenuItem(openMenuAction));</span>
<span class="nc" id="L696">		fileMenu.add(new JMenuItem(openInactiveLogMenuAction));</span>
<span class="nc" id="L697">		fileMenu.add(new JMenuItem(cleanAllInactiveLogsMenuAction));</span>
<span class="nc" id="L698">		fileMenu.add(new JMenuItem(importMenuAction));</span>
<span class="nc bnc" id="L699" title="All 2 branches missed.">		if(!app.isMac())</span>
		{
<span class="nc" id="L701">			fileMenu.addSeparator();</span>
<span class="nc" id="L702">			fileMenu.add(new JMenuItem(preferencesMenuAction));</span>
<span class="nc" id="L703">			fileMenu.addSeparator();</span>
<span class="nc" id="L704">			fileMenu.add(new JMenuItem(exitMenuAction));</span>
		}

		// Edit
<span class="nc" id="L708">		editMenu = new JMenu(&quot;Edit&quot;);</span>
<span class="nc" id="L709">		editMenu.setMnemonic('e');</span>
<span class="nc" id="L710">		editMenu.add(copySelectionAction);</span>
<span class="nc" id="L711">		editMenu.addSeparator();</span>
<span class="nc" id="L712">		editMenu.add(copyEventAction);</span>
<span class="nc" id="L713">		editMenu.addSeparator();</span>
<span class="nc" id="L714">		editMenu.add(copyLoggingMessageAction);</span>
<span class="nc" id="L715">		editMenu.add(copyLoggerNameAction);</span>
<span class="nc" id="L716">		editMenu.add(copyLoggingThrowableAction);</span>
<span class="nc" id="L717">		editMenu.add(copyLoggingCallStackAction);</span>
<span class="nc" id="L718">		editMenu.add(copyLoggingMarkerAction);</span>
<span class="nc" id="L719">		editMenu.add(copyLoggingMdcAction);</span>
<span class="nc" id="L720">		editMenu.add(copyLoggingNdcAction);</span>
<span class="nc" id="L721">		editMenu.addSeparator();</span>
<span class="nc" id="L722">		editMenu.add(copyAccessUriAction);</span>

		// Search
<span class="nc" id="L725">		searchMenu = new JMenu(&quot;Search&quot;);</span>
<span class="nc" id="L726">		searchMenu.setMnemonic('s');</span>
<span class="nc" id="L727">		searchMenu.add(findMenuAction);</span>
<span class="nc" id="L728">		searchMenu.add(resetFindAction);</span>
<span class="nc" id="L729">		searchMenu.add(findPreviousAction);</span>
<span class="nc" id="L730">		searchMenu.add(findNextAction);</span>

		// View
<span class="nc" id="L733">		viewMenu = new JMenu(&quot;View&quot;);</span>
<span class="nc" id="L734">		viewMenu.setMnemonic('v');</span>
<span class="nc" id="L735">		JMenuItem scrollToBottomMenuItem = new JMenuItem(scrollToBottomMenuAction);</span>
<span class="nc" id="L736">		viewMenu.add(scrollToBottomMenuItem);</span>
<span class="nc" id="L737">		viewMenu.add(pauseMenuAction);</span>
<span class="nc" id="L738">		viewMenu.add(clearMenuAction);</span>
<span class="nc" id="L739">		viewMenu.add(attachMenuAction);</span>
<span class="nc" id="L740">		viewMenu.add(disconnectMenuAction);</span>
<span class="nc" id="L741">		viewMenu.add(focusEventsAction);</span>
<span class="nc" id="L742">		viewMenu.add(focusMessageAction);</span>
<span class="nc" id="L743">		viewMenu.add(statisticsMenuAction);</span>
<span class="nc" id="L744">		viewMenu.add(editSourceNameMenuAction);</span>
<span class="nc" id="L745">		viewMenu.add(editConditionMenuAction);</span>
<span class="nc" id="L746">		viewMenu.addSeparator();</span>
<span class="nc" id="L747">		JMenu layoutMenu = new JMenu(&quot;Layout&quot;);</span>
<span class="nc" id="L748">		columnsMenu = new JMenu(&quot;Columns&quot;);</span>
<span class="nc" id="L749">		layoutMenu.add(columnsMenu);</span>
<span class="nc" id="L750">		layoutMenu.addSeparator();</span>
<span class="nc" id="L751">		layoutMenu.add(saveLayoutAction);</span>
<span class="nc" id="L752">		layoutMenu.add(resetLayoutAction);</span>
<span class="nc" id="L753">		viewMenu.add(layoutMenu);</span>
<span class="nc" id="L754">		viewMenu.addSeparator();</span>
<span class="nc" id="L755">		viewMenu.add(previousTabAction);</span>
<span class="nc" id="L756">		viewMenu.add(nextTabAction);</span>
<span class="nc" id="L757">		viewMenu.addSeparator();</span>
<span class="nc" id="L758">		viewMenu.add(closeFilterAction);</span>
<span class="nc" id="L759">		viewMenu.add(closeOtherFiltersAction);</span>
<span class="nc" id="L760">		viewMenu.add(closeAllFiltersAction);</span>

		// Window
<span class="nc" id="L763">		windowMenu = new JMenu(&quot;Window&quot;);</span>
<span class="nc" id="L764">		windowMenu.setMnemonic('w');</span>

		// Help
<span class="nc" id="L767">		JMenu helpMenu = new JMenu(&quot;Help&quot;);</span>
<span class="nc" id="L768">		helpMenu.setMnemonic('h');</span>

<span class="nc" id="L770">		helpMenu.add(new JMenuItem(keyboardHelpAction));</span>
<span class="nc" id="L771">		helpMenu.add(new JMenuItem(checkForUpdateAction));</span>
<span class="nc" id="L772">		helpMenu.addSeparator();</span>
<span class="nc" id="L773">		helpMenu.add(new JMenuItem(debugAction));</span>
<span class="nc bnc" id="L774" title="All 2 branches missed.">		if(!app.isMac())</span>
		{
<span class="nc" id="L776">			helpMenu.addSeparator();</span>
<span class="nc" id="L777">			helpMenu.add(new JMenuItem(aboutAction));</span>
		}


<span class="nc" id="L781">		menubar.add(fileMenu);</span>
<span class="nc" id="L782">		menubar.add(editMenu);</span>
<span class="nc" id="L783">		menubar.add(searchMenu);</span>
<span class="nc" id="L784">		menubar.add(viewMenu);</span>
<span class="nc" id="L785">		menubar.add(windowMenu);</span>
<span class="nc" id="L786">		menubar.add(helpMenu);</span>

<span class="nc" id="L788">		updateWindowMenu();</span>
<span class="nc" id="L789">		updateActions();</span>
<span class="nc" id="L790">	}</span>

	public PreferencesMenuAction getPreferencesAction()
	{
<span class="nc" id="L794">		return preferencesMenuAction;</span>
	}

	public JToolBar getToolbar()
	{
<span class="nc" id="L799">		return toolbar;</span>
	}

	public JMenuBar getMenuBar()
	{
<span class="nc" id="L804">		return menubar;</span>
	}

	public void setViewContainer(ViewContainer viewContainer)
	{
<span class="nc bnc" id="L809" title="All 2 branches missed.">		if(this.viewContainer != viewContainer)</span>
		{
<span class="nc bnc" id="L811" title="All 2 branches missed.">			if(this.viewContainer != null)</span>
			{
<span class="nc" id="L813">				this.viewContainer.removeChangeListener(containerChangeListener);</span>
<span class="nc" id="L814">				this.viewContainer.removePropertyChangeListener(containerPropertyChangeListener);</span>
			}
<span class="nc" id="L816">			this.viewContainer = viewContainer;</span>
<span class="nc bnc" id="L817" title="All 2 branches missed.">			if(this.viewContainer != null)</span>
			{
<span class="nc" id="L819">				this.viewContainer.addChangeListener(containerChangeListener);</span>
<span class="nc" id="L820">				this.viewContainer.addPropertyChangeListener(containerPropertyChangeListener);</span>

<span class="nc" id="L822">				EventWrapperViewPanel view = viewContainer.getSelectedView();</span>

<span class="nc" id="L824">				setEventWrapper(this.viewContainer.getSelectedEvent());</span>
			}
<span class="nc" id="L826">			updateActions();</span>
		}
<span class="nc" id="L828">	}</span>

	public ViewContainer getViewContainer()
	{
<span class="nc" id="L832">		return viewContainer;</span>
	}

	public void updateWindowMenu()
	{
<span class="nc" id="L837">		updateWindowMenu(windowMenu);</span>
<span class="nc" id="L838">	}</span>

	public void updateActions()
	{
<span class="nc" id="L842">		boolean hasView = false;</span>
<span class="nc" id="L843">		boolean hasFilter = false;</span>
<span class="nc" id="L844">		boolean isActive = false;</span>
<span class="nc" id="L845">		boolean hasFilteredBuffer = false;</span>
<span class="nc" id="L846">		EventSource eventSource = null;</span>
<span class="nc bnc" id="L847" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L849">			hasView = true;</span>
<span class="nc" id="L850">			EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L851" title="All 2 branches missed.">			if(eventWrapperViewPanel != null)</span>
			{
<span class="nc" id="L853">				eventSource = eventWrapperViewPanel.getEventSource();</span>
<span class="nc bnc" id="L854" title="All 2 branches missed.">				hasFilter = eventWrapperViewPanel.getFilterCondition() != null;</span>
<span class="nc bnc" id="L855" title="All 2 branches missed.">				isActive = eventWrapperViewPanel.getState() == LoggingViewState.ACTIVE;</span>
<span class="nc bnc" id="L856" title="All 2 branches missed.">				hasFilteredBuffer = eventWrapperViewPanel.getBufferCondition() != null;</span>
			}
<span class="nc" id="L858">			copySelectionAction.setView(eventWrapperViewPanel);</span>
		}

<span class="nc bnc" id="L861" title="All 2 branches missed.">		if(logger.isDebugEnabled())</span>
		{
<span class="nc" id="L863">			logger</span>
<span class="nc" id="L864">				.debug(&quot;updateActions() eventSource={}, hasFilteredBuffer={}&quot;, new Object[]{eventSource, hasFilteredBuffer});</span>
		}
		// Edit
<span class="nc" id="L867">		editMenu.setEnabled(hasView);</span>


		// Search
<span class="nc" id="L871">		searchMenu.setEnabled(hasView);</span>
<span class="nc" id="L872">		findMenuAction.setEnabled(hasView);</span>
<span class="nc" id="L873">		resetFindAction.setEnabled(hasFilter);</span>
<span class="nc" id="L874">		findPreviousAction.setEnabled(hasFilter);</span>
<span class="nc" id="L875">		findNextAction.setEnabled(hasFilter);</span>

		// View
<span class="nc" id="L878">		viewMenu.setEnabled(hasView);</span>
<span class="nc" id="L879">		scrollToBottomMenuAction.setEnabled(hasView);</span>
<span class="nc" id="L880">		editSourceNameMenuAction.setEnabled(hasView);</span>
<span class="nc" id="L881">		saveLayoutAction.setEnabled(hasView);</span>
<span class="nc" id="L882">		resetLayoutAction.setEnabled(hasView);</span>
<span class="nc" id="L883">		editConditionMenuAction.setEnabled(hasView);</span>
<span class="nc" id="L884">		pauseMenuAction.setEnabled(hasView);</span>
<span class="nc bnc" id="L885" title="All 4 branches missed.">		clearMenuAction.setEnabled(hasView &amp;&amp; !hasFilteredBuffer);</span>
<span class="nc" id="L886">		attachMenuAction.setEnabled(hasView);</span>
<span class="nc" id="L887">		disconnectMenuAction.setEnabled(isActive);</span>
<span class="nc" id="L888">		focusEventsAction.setEnabled(hasView);</span>
<span class="nc" id="L889">		focusMessageAction.setEnabled(hasView);</span>
<span class="nc" id="L890">		statisticsMenuAction.setEnabled(hasView);</span>
<span class="nc" id="L891">		updateShowHideMenu();</span>
<span class="nc" id="L892">		previousTabAction.updateAction();</span>
<span class="nc" id="L893">		nextTabAction.updateAction();</span>
<span class="nc" id="L894">		closeFilterAction.setEnabled(hasView);</span>
<span class="nc" id="L895">		closeOtherFiltersAction.setEnabled(hasView);</span>
<span class="nc" id="L896">		closeAllFiltersAction.setEnabled(hasView);</span>

<span class="nc" id="L898">		disconnectToolBarAction.setEnabled(isActive);</span>

<span class="nc" id="L900">		scrollToBottomMenuAction.updateAction();</span>
<span class="nc" id="L901">		editSourceNameMenuAction.updateAction();</span>
<span class="nc" id="L902">		editConditionMenuAction.updateAction();</span>
<span class="nc" id="L903">		pauseMenuAction.updateAction();</span>
<span class="nc" id="L904">		attachMenuAction.updateAction();</span>
<span class="nc" id="L905">		closeFilterAction.updateAction();</span>
<span class="nc" id="L906">		closeOtherFiltersAction.updateAction();</span>
<span class="nc" id="L907">		closeAllFiltersAction.updateAction();</span>

<span class="nc" id="L909">		scrollToBottomButton.setSelected(isScrollingToBottom());</span>
<span class="nc" id="L910">		pauseToolBarAction.updateAction();</span>
<span class="nc" id="L911">		attachToolBarAction.updateAction();</span>

<span class="nc" id="L913">		scrollToBottomToolBarAction.setEnabled(hasView);</span>
<span class="nc" id="L914">		pauseToolBarAction.setEnabled(hasView);</span>
<span class="nc bnc" id="L915" title="All 4 branches missed.">		clearToolBarAction.setEnabled(hasView &amp;&amp; !hasFilteredBuffer);</span>
<span class="nc" id="L916">		findToolBarAction.setEnabled(hasView);</span>
<span class="nc" id="L917">		statisticsToolBarAction.setEnabled(hasView);</span>
<span class="nc" id="L918">		attachToolBarAction.setEnabled(hasView);</span>
<span class="nc" id="L919">		disconnectToolBarAction.setEnabled(isActive);</span>

<span class="nc bnc" id="L921" title="All 2 branches missed.">		if(eventSource != null)</span>
		{
<span class="nc bnc" id="L923" title="All 2 branches missed.">			showUnfilteredEventAction.setEnabled((eventSource.getFilter() != null));</span>
		}
		else
		{
<span class="nc" id="L927">			showUnfilteredEventAction.setEnabled(false);</span>
		}
<span class="nc" id="L929">	}</span>

	private void updateShowHideMenu()
	{
<span class="nc" id="L933">		columnsMenu.removeAll();</span>
<span class="nc bnc" id="L934" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L936">			EventWrapperViewPanel&lt;?&gt; viewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L937" title="All 2 branches missed.">			if(viewPanel != null)</span>
			{
<span class="nc" id="L939">				EventWrapperViewTable&lt;?&gt; table = viewPanel.getTable();</span>
<span class="nc bnc" id="L940" title="All 2 branches missed.">				if(table != null)</span>
				{
<span class="nc" id="L942">					PersistentTableColumnModel tableColumnModel = table.getTableColumnModel();</span>
<span class="nc" id="L943">					List&lt;PersistentTableColumnModel.TableColumnLayoutInfo&gt; cli = tableColumnModel</span>
<span class="nc" id="L944">						.getColumnLayoutInfos();</span>
<span class="nc bnc" id="L945" title="All 2 branches missed.">					for(PersistentTableColumnModel.TableColumnLayoutInfo current : cli)</span>
					{
<span class="nc" id="L947">						boolean visible = current.isVisible();</span>
<span class="nc" id="L948">						JCheckBoxMenuItem cbmi = new JCheckBoxMenuItem(new ShowHideAction(tableColumnModel, current.getColumnName(), visible));</span>
<span class="nc" id="L949">						cbmi.setSelected(visible);</span>
<span class="nc" id="L950">						columnsMenu.add(cbmi);</span>
<span class="nc" id="L951">					}</span>
				}
			}

		}
<span class="nc" id="L956">	}</span>

	void setShowingFilters(boolean showingFilters)
	{
<span class="nc bnc" id="L960" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L962">			EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L963" title="All 2 branches missed.">			if(eventWrapperViewPanel != null)</span>
			{
<span class="nc" id="L965">				eventWrapperViewPanel.setShowingFilters(showingFilters);</span>
			}
		}
<span class="nc" id="L968">	}</span>

	boolean isScrollingToBottom()
	{
<span class="nc bnc" id="L972" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L974">			EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L975" title="All 2 branches missed.">			if(eventWrapperViewPanel != null)</span>
			{
<span class="nc" id="L977">				return eventWrapperViewPanel.isScrollingToBottom();</span>
			}
		}
<span class="nc" id="L980">		return false;</span>
	}

	void setScrollingToBottom(boolean scrollingToBottom)
	{
<span class="nc bnc" id="L985" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L987">			EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L988" title="All 2 branches missed.">			if(eventWrapperViewPanel != null)</span>
			{
<span class="nc" id="L990">				eventWrapperViewPanel.setScrollingToBottom(scrollingToBottom);</span>
			}
		}
<span class="nc" id="L993">	}</span>


	boolean isPaused()
	{
<span class="nc bnc" id="L998" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L1000">			EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L1001" title="All 2 branches missed.">			if(eventWrapperViewPanel != null)</span>
			{
<span class="nc" id="L1003">				return eventWrapperViewPanel.isPaused();</span>
			}
		}
<span class="nc" id="L1006">		return false;</span>
	}

	void setPaused(boolean paused)
	{
<span class="nc bnc" id="L1011" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L1013">			EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L1014" title="All 2 branches missed.">			if(eventWrapperViewPanel != null)</span>
			{
<span class="nc" id="L1016">				eventWrapperViewPanel.setPaused(paused);</span>
			}
		}
<span class="nc" id="L1019">	}</span>

	void clear()
	{
<span class="nc bnc" id="L1023" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L1025">			EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L1026" title="All 2 branches missed.">			if(eventWrapperViewPanel != null)</span>
			{
<span class="nc" id="L1028">				eventWrapperViewPanel.clear();</span>
			}
		}
<span class="nc" id="L1031">	}</span>

	void focusTable()
	{
<span class="nc bnc" id="L1035" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L1037">			EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L1038" title="All 2 branches missed.">			if(eventWrapperViewPanel != null)</span>
			{
<span class="nc" id="L1040">				eventWrapperViewPanel.focusTable();</span>
			}
		}
<span class="nc" id="L1043">	}</span>

	private void editCondition()
	{
<span class="nc bnc" id="L1047" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L1049">			EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L1050" title="All 2 branches missed.">			if(eventWrapperViewPanel != null)</span>
			{
<span class="nc" id="L1052">				Condition condition = eventWrapperViewPanel.getCombinedCondition();</span>
<span class="nc bnc" id="L1053" title="All 2 branches missed.">				if(condition != null)</span>
				{
<span class="nc" id="L1055">					mainFrame.getPreferencesDialog().editCondition(condition);</span>
				}
			}
		}
<span class="nc" id="L1059">	}</span>

	private void editSourceName()
	{
<span class="nc bnc" id="L1063" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L1065">			EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L1066" title="All 2 branches missed.">			if(eventWrapperViewPanel != null)</span>
			{
<span class="nc" id="L1068">				String sourceIdentifier = eventWrapperViewPanel.getEventSource().getSourceIdentifier().getIdentifier();</span>
<span class="nc bnc" id="L1069" title="All 4 branches missed.">				if(!&quot;global&quot;.equals(sourceIdentifier) &amp;&amp; !&quot;Lilith&quot;.equals(sourceIdentifier))</span>
				{
<span class="nc" id="L1071">					mainFrame.getPreferencesDialog().editSourceName(sourceIdentifier);</span>
				}
			}
		}
<span class="nc" id="L1075">	}</span>

	private void attachDetach()
	{
<span class="nc" id="L1079">		ViewContainer container = getViewContainer();</span>
<span class="nc bnc" id="L1080" title="All 2 branches missed.">		if(container != null)</span>
		{
<span class="nc" id="L1082">			MainFrame mainFrame = container.getMainFrame();</span>
<span class="nc" id="L1083">			ViewWindow window = container.resolveViewWindow();</span>

<span class="nc bnc" id="L1085" title="All 2 branches missed.">			if(window instanceof JFrame)</span>
			{
<span class="nc" id="L1087">				window.closeWindow();</span>
<span class="nc" id="L1088">				mainFrame.showInternalFrame(container);</span>
			}
<span class="nc bnc" id="L1090" title="All 2 branches missed.">			else if(window instanceof JInternalFrame)</span>
			{
<span class="nc" id="L1092">				window.closeWindow();</span>
<span class="nc" id="L1093">				mainFrame.showFrame(container);</span>
			}
		}
<span class="nc bnc" id="L1096" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L1098">			EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L1099" title="All 2 branches missed.">			if(eventWrapperViewPanel != null)</span>
			{
<span class="nc" id="L1101">				eventWrapperViewPanel.scrollToEvent();</span>
			}
		}
<span class="nc" id="L1104">		focusTable();</span>
<span class="nc" id="L1105">	}</span>


	private void showStatistics()
	{
<span class="nc bnc" id="L1110" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L1112">			EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L1113" title="All 2 branches missed.">			if(eventWrapperViewPanel != null)</span>
			{
<span class="nc" id="L1115">				MainFrame mainFrame = viewContainer.getMainFrame();</span>
<span class="nc" id="L1116">				mainFrame.showStatistics(eventWrapperViewPanel.getEventSource().getSourceIdentifier());</span>
			}
		}
<span class="nc" id="L1119">	}</span>

	private void disconnect()
	{
<span class="nc bnc" id="L1123" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L1125">			EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L1126" title="All 2 branches missed.">			if(eventWrapperViewPanel != null)</span>
			{
<span class="nc" id="L1128">				eventWrapperViewPanel.closeConnection(eventWrapperViewPanel.getEventSource().getSourceIdentifier());</span>
			}
		}
<span class="nc" id="L1131">	}</span>

	private void focusMessage()
	{
<span class="nc bnc" id="L1135" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L1137">			EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L1138" title="All 2 branches missed.">			if(eventWrapperViewPanel != null)</span>
			{
<span class="nc" id="L1140">				eventWrapperViewPanel.focusMessagePane();</span>
			}
		}
<span class="nc" id="L1143">	}</span>

	private void focusEvents()
	{
<span class="nc bnc" id="L1147" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L1149">			EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L1150" title="All 2 branches missed.">			if(eventWrapperViewPanel != null)</span>
			{
<span class="nc" id="L1152">				eventWrapperViewPanel.focusTable();</span>
			}
		}
<span class="nc" id="L1155">	}</span>

	private void findNext()
	{
<span class="nc bnc" id="L1159" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L1161">			EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L1162" title="All 2 branches missed.">			if(eventWrapperViewPanel != null)</span>
			{
<span class="nc" id="L1164">				eventWrapperViewPanel</span>
<span class="nc" id="L1165">					.findNext(eventWrapperViewPanel.getSelectedRow(), eventWrapperViewPanel.getFilterCondition());</span>
			}
		}
<span class="nc" id="L1168">	}</span>


	private void findPrevious()
	{
<span class="nc bnc" id="L1173" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L1175">			EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L1176" title="All 2 branches missed.">			if(eventWrapperViewPanel != null)</span>
			{
<span class="nc" id="L1178">				eventWrapperViewPanel</span>
<span class="nc" id="L1179">					.findPrevious(eventWrapperViewPanel.getSelectedRow(), eventWrapperViewPanel.getFilterCondition());</span>
			}
		}
<span class="nc" id="L1182">	}</span>


	private void resetFind()
	{
<span class="nc bnc" id="L1187" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L1189">			EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L1190" title="All 2 branches missed.">			if(eventWrapperViewPanel != null)</span>
			{
<span class="nc" id="L1192">				eventWrapperViewPanel.resetFind();</span>
			}
		}
<span class="nc" id="L1195">	}</span>

	private void closeCurrentFilter()
	{
<span class="nc bnc" id="L1199" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L1201">			viewContainer.closeCurrentFilter();</span>
		}
<span class="nc" id="L1203">	}</span>

	private void closeOtherFilters()
	{
<span class="nc bnc" id="L1207" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L1209">			viewContainer.closeOtherFilters();</span>
		}
<span class="nc" id="L1211">	}</span>

	private void closeAllFilters()
	{
<span class="nc bnc" id="L1215" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L1217">			viewContainer.closeAllFilters();</span>
		}
<span class="nc" id="L1219">	}</span>


	private void previousTab()
	{
<span class="nc bnc" id="L1224" title="All 2 branches missed.">		if(logger.isDebugEnabled()) logger.debug(&quot;PreviousTab&quot;);</span>
<span class="nc bnc" id="L1225" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L1227">			int viewCount = viewContainer.getViewCount();</span>
<span class="nc" id="L1228">			int viewIndex = viewContainer.getViewIndex();</span>
<span class="nc bnc" id="L1229" title="All 2 branches missed.">			if(viewIndex &gt; -1)</span>
			{
<span class="nc" id="L1231">				int newView = viewIndex - 1;</span>
<span class="nc bnc" id="L1232" title="All 2 branches missed.">				if(newView &lt; 0)</span>
				{
<span class="nc" id="L1234">					newView = viewCount - 1;</span>
				}
<span class="nc bnc" id="L1236" title="All 4 branches missed.">				if(newView &gt;= 0 &amp;&amp; newView &lt; viewCount)</span>
				{
<span class="nc" id="L1238">					viewContainer.setViewIndex(newView);</span>
				}
			}
		}
<span class="nc" id="L1242">	}</span>

	private void nextTab()
	{
<span class="nc bnc" id="L1246" title="All 2 branches missed.">		if(logger.isDebugEnabled()) logger.debug(&quot;NextTab&quot;);</span>
<span class="nc bnc" id="L1247" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L1249">			int viewIndex = viewContainer.getViewIndex();</span>
<span class="nc" id="L1250">			int viewCount = viewContainer.getViewCount();</span>
<span class="nc bnc" id="L1251" title="All 2 branches missed.">			if(viewIndex &gt; -1)</span>
			{
<span class="nc" id="L1253">				int newView = viewIndex + 1;</span>
<span class="nc bnc" id="L1254" title="All 2 branches missed.">				if(newView &gt;= viewCount)</span>
				{
<span class="nc" id="L1256">					newView = 0;</span>
				}
<span class="nc bnc" id="L1258" title="All 2 branches missed.">				if(newView &gt;= 0)</span>
				{
<span class="nc" id="L1260">					viewContainer.setViewIndex(newView);</span>
				}
			}
		}
<span class="nc" id="L1264">	}</span>

	private void showUnfilteredEvent()
	{
<span class="nc bnc" id="L1268" title="All 2 branches missed.">		if(viewContainer != null)</span>
		{
<span class="nc" id="L1270">			EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L1271" title="All 2 branches missed.">			if(eventWrapperViewPanel != null)</span>
			{
<span class="nc" id="L1273">				eventWrapperViewPanel.showUnfilteredEvent();</span>
			}
		}
<span class="nc" id="L1276">	}</span>

	private void initPopup()
	{
<span class="nc" id="L1280">		popup = new JPopupMenu();</span>
<span class="nc" id="L1281">		JMenuItem showUnfilteredMenuItem = new JMenuItem(showUnfilteredEventAction);</span>
<span class="nc" id="L1282">		Font f = showUnfilteredMenuItem.getFont();</span>
<span class="nc" id="L1283">		Font boldFont = f.deriveFont(Font.BOLD);</span>
<span class="nc" id="L1284">		showUnfilteredMenuItem.setFont(boldFont);</span>

<span class="nc" id="L1286">		popup.add(showUnfilteredMenuItem);</span>

<span class="nc" id="L1288">		JMenu copyMenuItem = new JMenu(&quot;Copy...&quot;);</span>
<span class="nc" id="L1289">		popup.add(copyMenuItem);</span>
<span class="nc" id="L1290">		copyMenuItem.add(new JMenuItem(copySelectionAction));</span>
<span class="nc" id="L1291">		copyMenuItem.addSeparator();</span>
<span class="nc" id="L1292">		copyMenuItem.add(new JMenuItem(copyEventAction));</span>
<span class="nc" id="L1293">		copyMenuItem.addSeparator();</span>
<span class="nc" id="L1294">		copyMenuItem.add(new JMenuItem(copyLoggingMessageAction));</span>
<span class="nc" id="L1295">		copyMenuItem.add(new JMenuItem(copyLoggerNameAction));</span>
<span class="nc" id="L1296">		copyMenuItem.add(new JMenuItem(copyLoggingThrowableAction));</span>
<span class="nc" id="L1297">		copyMenuItem.add(new JMenuItem(copyLoggingCallStackAction));</span>
<span class="nc" id="L1298">		copyMenuItem.add(new JMenuItem(copyLoggingMarkerAction));</span>
<span class="nc" id="L1299">		copyMenuItem.add(new JMenuItem(copyLoggingMdcAction));</span>
<span class="nc" id="L1300">		copyMenuItem.add(new JMenuItem(copyLoggingNdcAction));</span>
<span class="nc" id="L1301">		copyMenuItem.addSeparator();</span>
<span class="nc" id="L1302">		copyMenuItem.add(new JMenuItem(copyAccessUriAction));</span>

<span class="nc" id="L1304">		sendToMenuItem = new JMenu(&quot;Send to...&quot;);</span>

<span class="nc" id="L1306">		popup.add(sendToMenuItem);</span>

<span class="nc" id="L1308">		JMenuItem gotoSourceMenuItem = new JMenuItem(gotoSourceAction);</span>
<span class="nc" id="L1309">		popup.add(gotoSourceMenuItem);</span>
<span class="nc" id="L1310">	}</span>

	private void setEventWrapper(EventWrapper wrapper)
	{
<span class="nc" id="L1314">		this.eventWrapper = wrapper;</span>
<span class="nc" id="L1315">		gotoSourceAction.setEventWrapper(wrapper);</span>
<span class="nc" id="L1316">		copyEventAction.setEventWrapper(wrapper);</span>
<span class="nc" id="L1317">		copyLoggingMessageAction.setEventWrapper(wrapper);</span>
<span class="nc" id="L1318">		copyLoggerNameAction.setEventWrapper(wrapper);</span>
<span class="nc" id="L1319">		copyLoggingThrowableAction.setEventWrapper(wrapper);</span>
<span class="nc" id="L1320">		copyLoggingCallStackAction.setEventWrapper(wrapper);</span>
<span class="nc" id="L1321">		copyLoggingMarkerAction.setEventWrapper(wrapper);</span>
<span class="nc" id="L1322">		copyLoggingMdcAction.setEventWrapper(wrapper);</span>
<span class="nc" id="L1323">		copyLoggingNdcAction.setEventWrapper(wrapper);</span>
<span class="nc" id="L1324">		copyAccessUriAction.setEventWrapper(wrapper);</span>
<span class="nc" id="L1325">	}</span>

	public void updateWindowMenu(JMenu windowMenu)
	{
		// must be executed later because the ancestor-change-event is fired
		// while parent is still != null...
		// see JComponent.removeNotify source for comment.
<span class="nc" id="L1332">		SwingUtilities.invokeLater(new UpdateWindowMenuRunnable(windowMenu));</span>
<span class="nc" id="L1333">	}</span>

	public ActionListener getAboutAction()
	{
<span class="nc" id="L1337">		return aboutAction;</span>
	}

	public void updatePopup()
	{
<span class="nc bnc" id="L1342" title="All 2 branches missed.">		if(popup == null)</span>
		{
<span class="nc" id="L1344">			initPopup();</span>
		}
<span class="nc" id="L1346">		sendToMenuItem.removeAll();</span>
<span class="nc bnc" id="L1347" title="All 2 branches missed.">		if(eventWrapper == null)</span>
		{
<span class="nc" id="L1349">			sendToMenuItem.setEnabled(false);</span>
		}
		else
		{
<span class="nc" id="L1353">			Serializable eventObj = eventWrapper.getEvent();</span>
<span class="nc bnc" id="L1354" title="All 2 branches missed.">			if(eventObj instanceof LoggingEvent)</span>
			{
<span class="nc" id="L1356">				Map&lt;String, EventSender&lt;LoggingEvent&gt;&gt; senders = mainFrame.getLoggingEventSenders();</span>
<span class="nc bnc" id="L1357" title="All 2 branches missed.">				if(logger.isDebugEnabled()) logger.debug(&quot;Senders: {}&quot;, senders);</span>
<span class="nc bnc" id="L1358" title="All 2 branches missed.">				if(senders.size() == 0)</span>
				{
<span class="nc" id="L1360">					sendToMenuItem.setEnabled(false);</span>
				}
				else
				{
<span class="nc" id="L1364">					sendToMenuItem.setEnabled(true);</span>
<span class="nc bnc" id="L1365" title="All 2 branches missed.">					for(Map.Entry&lt;String, EventSender&lt;LoggingEvent&gt;&gt; current : senders.entrySet())</span>
					{
						@SuppressWarnings({&quot;unchecked&quot;})
<span class="nc" id="L1368">						SendAction&lt;LoggingEvent&gt; action = new SendAction&lt;LoggingEvent&gt;(current.getKey(), current.getValue(), eventWrapper);</span>
<span class="nc" id="L1369">						JMenuItem menuItem = new JMenuItem(action);</span>
<span class="nc" id="L1370">						sendToMenuItem.add(menuItem);</span>
<span class="nc" id="L1371">					}</span>
				}
<span class="nc" id="L1373">			}</span>
<span class="nc bnc" id="L1374" title="All 2 branches missed.">			else if(eventObj instanceof AccessEvent)</span>
			{
<span class="nc" id="L1376">				Map&lt;String, EventSender&lt;AccessEvent&gt;&gt; senders = mainFrame.getAccessEventSenders();</span>
<span class="nc bnc" id="L1377" title="All 2 branches missed.">				if(logger.isDebugEnabled()) logger.debug(&quot;Senders: {}&quot;, senders);</span>
<span class="nc bnc" id="L1378" title="All 2 branches missed.">				if(senders.size() == 0)</span>
				{
<span class="nc" id="L1380">					sendToMenuItem.setEnabled(false);</span>
				}
				else
				{
<span class="nc" id="L1384">					sendToMenuItem.setEnabled(true);</span>
<span class="nc bnc" id="L1385" title="All 2 branches missed.">					for(Map.Entry&lt;String, EventSender&lt;AccessEvent&gt;&gt; current : senders.entrySet())</span>
					{
						@SuppressWarnings({&quot;unchecked&quot;})
<span class="nc" id="L1388">						SendAction&lt;AccessEvent&gt; action = new SendAction&lt;AccessEvent&gt;(current.getKey(), current.getValue(), eventWrapper);</span>
<span class="nc" id="L1389">						JMenuItem menuItem = new JMenuItem(action);</span>
<span class="nc" id="L1390">						sendToMenuItem.add(menuItem);</span>
<span class="nc" id="L1391">					}</span>
				}
<span class="nc" id="L1393">			}</span>
			else
			{
<span class="nc" id="L1396">				sendToMenuItem.setEnabled(false);</span>
			}
		}
<span class="nc" id="L1399">	}</span>

	public JPopupMenu getPopupMenu()
	{
<span class="nc" id="L1403">		updatePopup();</span>

<span class="nc" id="L1405">		return popup;</span>
	}

/*
	private class ClearAndRemoveInactiveAction
		extends AbstractAction
	{

		public ClearAndRemoveInactiveAction()
		{
			super(&quot;Clean and remove inactive&quot;);
			putValue(Action.SMALL_ICON, EMPTY_16_ICON);
			KeyStroke accelerator= KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS+&quot; shift R&quot;);
			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);
			putValue(Action.ACCELERATOR_KEY, accelerator);
			putValue(Action.MNEMONIC_KEY, Integer.valueOf('c'));
		}

		public void actionPerformed(ActionEvent e)
		{
			mainFrame.removeInactiveViews(false, true);
			mainFrame.updateWindowMenus();
		}
	}
*/

	private class RemoveInactiveAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -6662970580652310690L;

		public RemoveInactiveAction()
<span class="nc" id="L1437">		{</span>
<span class="nc" id="L1438">			super(&quot;Remove inactive&quot;);</span>
<span class="nc" id="L1439">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
<span class="nc" id="L1440">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; R&quot;);</span>
<span class="nc bnc" id="L1441" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L1442">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L1443">			putValue(Action.MNEMONIC_KEY, Integer.valueOf('r'));</span>
<span class="nc" id="L1444">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L1448">			mainFrame.removeInactiveViews(false, false);</span>
<span class="nc" id="L1449">			mainFrame.updateWindowMenus();</span>
<span class="nc" id="L1450">		}</span>
	}

	private class ShowTaskManagerAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -8228641057263498624L;

		public ShowTaskManagerAction()
<span class="nc" id="L1459">		{</span>
<span class="nc" id="L1460">			super(&quot;Task Manager&quot;);</span>
<span class="nc" id="L1461">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
			//KeyStroke accelerator= KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS+&quot; R&quot;);
			//if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);
			//putValue(Action.ACCELERATOR_KEY, accelerator);
			//putValue(Action.MNEMONIC_KEY, Integer.valueOf('r'));
<span class="nc" id="L1466">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L1470">			mainFrame.showTaskManager();</span>
<span class="nc" id="L1471">		}</span>
	}

	private class CloseAllAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -1587444647880660196L;

		public CloseAllAction()
<span class="nc" id="L1480">		{</span>
<span class="nc" id="L1481">			super(&quot;Close all&quot;);</span>
<span class="nc" id="L1482">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
			//KeyStroke accelerator= KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS+&quot; R&quot;);
			//if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);
			//putValue(Action.ACCELERATOR_KEY, accelerator);
			//putValue(Action.MNEMONIC_KEY, Integer.valueOf('r'));
<span class="nc" id="L1487">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L1491">			mainFrame.closeAllViews(null);</span>
<span class="nc" id="L1492">			mainFrame.updateWindowMenus();</span>
<span class="nc" id="L1493">		}</span>
	}

	private class CloseAllOtherAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -3031217070975763827L;

		public CloseAllOtherAction()
<span class="nc" id="L1502">		{</span>
<span class="nc" id="L1503">			super(&quot;Close all other&quot;);</span>
<span class="nc" id="L1504">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
			//KeyStroke accelerator= KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS+&quot; R&quot;);
			//if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);
			//putValue(Action.ACCELERATOR_KEY, accelerator);
			//putValue(Action.MNEMONIC_KEY, Integer.valueOf('r'));
<span class="nc" id="L1509">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L1513">			mainFrame.closeAllViews(viewContainer);</span>
<span class="nc" id="L1514">			mainFrame.updateWindowMenus();</span>
<span class="nc" id="L1515">		}</span>
	}

	private class MinimizeAllAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -8828005158469519472L;

		public MinimizeAllAction()
<span class="nc" id="L1524">		{</span>
<span class="nc" id="L1525">			super(&quot;Minimize all&quot;);</span>
<span class="nc" id="L1526">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
			//KeyStroke accelerator= KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS+&quot; R&quot;);
			//if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);
			//putValue(Action.ACCELERATOR_KEY, accelerator);
			//putValue(Action.MNEMONIC_KEY, Integer.valueOf('r'));
<span class="nc" id="L1531">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L1535">			mainFrame.minimizeAllViews(null);</span>
<span class="nc" id="L1536">			mainFrame.updateWindowMenus();</span>
<span class="nc" id="L1537">		}</span>
	}

	private class MinimizeAllOtherAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -2357859864329239268L;

		public MinimizeAllOtherAction()
<span class="nc" id="L1546">		{</span>
<span class="nc" id="L1547">			super(&quot;Minimize all other&quot;);</span>
<span class="nc" id="L1548">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
			//KeyStroke accelerator= KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS+&quot; R&quot;);
			//if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);
			//putValue(Action.ACCELERATOR_KEY, accelerator);
			//putValue(Action.MNEMONIC_KEY, Integer.valueOf('r'));
<span class="nc" id="L1553">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L1557">			mainFrame.minimizeAllViews(viewContainer);</span>
<span class="nc" id="L1558">			mainFrame.updateWindowMenus();</span>
<span class="nc" id="L1559">		}</span>
	}

	private class ClearToolBarAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -4713267797278778997L;

		public ClearToolBarAction()
<span class="nc" id="L1568">		{</span>
<span class="nc" id="L1569">			super();</span>
<span class="nc" id="L1570">			putValue(Action.SMALL_ICON, CLEAR_TOOLBAR_ICON);</span>
<span class="nc" id="L1571">			putValue(Action.SHORT_DESCRIPTION, &quot;Clear&quot;);</span>
<span class="nc" id="L1572">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L1576">			clear();</span>
<span class="nc" id="L1577">		}</span>
	}

	private class ClearMenuAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 776175842981192877L;

		public ClearMenuAction()
<span class="nc" id="L1586">		{</span>
<span class="nc" id="L1587">			super(&quot;Clear&quot;);</span>
<span class="nc" id="L1588">			putValue(Action.SMALL_ICON, CLEAR_MENU_ICON);</span>
<span class="nc" id="L1589">			putValue(Action.SHORT_DESCRIPTION, &quot;Clear this view.&quot;);</span>
<span class="nc" id="L1590">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L1594">			clear();</span>
<span class="nc" id="L1595">		}</span>
	}

	private class EditConditionMenuAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -8380709624103338783L;

		public EditConditionMenuAction()
<span class="nc" id="L1604">		{</span>
<span class="nc" id="L1605">			super(&quot;Add condition...&quot;);</span>
<span class="nc" id="L1606">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; I&quot;);</span>
<span class="nc bnc" id="L1607" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L1608">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L1609">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
<span class="nc" id="L1610">			putValue(Action.SHORT_DESCRIPTION, &quot;Add the condition of the current view.&quot;);</span>
<span class="nc" id="L1611">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L1615">			editCondition();</span>
<span class="nc" id="L1616">		}</span>

		public void updateAction()
		{
<span class="nc" id="L1620">			boolean enable = false;</span>
<span class="nc bnc" id="L1621" title="All 2 branches missed.">			if(viewContainer != null)</span>
			{
<span class="nc" id="L1623">				EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L1624" title="All 2 branches missed.">				if(eventWrapperViewPanel != null)</span>
				{
<span class="nc" id="L1626">					Condition condition = eventWrapperViewPanel.getCombinedCondition();</span>
<span class="nc bnc" id="L1627" title="All 2 branches missed.">					if(condition != null)</span>
					{
<span class="nc" id="L1629">						enable = true;</span>
					}
				}
			}
<span class="nc" id="L1633">			setEnabled(enable);</span>
<span class="nc" id="L1634">		}</span>
	}

	private class EditSourceNameMenuAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 2807692748192366344L;

		public EditSourceNameMenuAction()
<span class="nc" id="L1643">		{</span>
<span class="nc" id="L1644">			super(&quot;Edit source name...&quot;);</span>
<span class="nc" id="L1645">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; B&quot;);</span>
<span class="nc bnc" id="L1646" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L1647">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L1648">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
<span class="nc" id="L1649">			putValue(Action.SHORT_DESCRIPTION, &quot;Edit the source name of the current view.&quot;);</span>
<span class="nc" id="L1650">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L1654">			editSourceName();</span>
<span class="nc" id="L1655">		}</span>


		public void updateAction()
		{
<span class="nc" id="L1660">			boolean enable = false;</span>
<span class="nc bnc" id="L1661" title="All 2 branches missed.">			if(viewContainer != null)</span>
			{
<span class="nc" id="L1663">				EventWrapperViewPanel eventWrapperViewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L1664" title="All 2 branches missed.">				if(eventWrapperViewPanel != null)</span>
				{
<span class="nc" id="L1666">					String sourceIdentifier = eventWrapperViewPanel.getEventSource().getSourceIdentifier()</span>
<span class="nc" id="L1667">						.getIdentifier();</span>
<span class="nc bnc" id="L1668" title="All 4 branches missed.">					if(!&quot;global&quot;.equals(sourceIdentifier) &amp;&amp; !&quot;Lilith&quot;.equals(sourceIdentifier))</span>
					{
<span class="nc" id="L1670">						enable = true;</span>
					}
				}
			}
<span class="nc" id="L1674">			setEnabled(enable);</span>
<span class="nc" id="L1675">		}</span>
	}


	private class AttachMenuAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -6686061036755515933L;

<span class="nc" id="L1684">		private Icon attachIcon = ATTACH_MENU_ICON;</span>
<span class="nc" id="L1685">		private Icon detachIcon = DETACH_MENU_ICON;</span>

		public AttachMenuAction()
<span class="nc" id="L1688">		{</span>
<span class="nc" id="L1689">			super();</span>
<span class="nc" id="L1690">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; shift A&quot;);</span>
<span class="nc bnc" id="L1691" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L1692">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L1693">			updateAction();</span>
<span class="nc" id="L1694">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L1698">			attachDetach();</span>
<span class="nc" id="L1699">			updateAction();</span>
<span class="nc" id="L1700">		}</span>

		public void updateAction()
		{
<span class="nc" id="L1704">			ViewContainer container = getViewContainer();</span>
<span class="nc bnc" id="L1705" title="All 2 branches missed.">			if(container != null)</span>
			{
<span class="nc" id="L1707">				ViewWindow window = container.resolveViewWindow();</span>
<span class="nc bnc" id="L1708" title="All 2 branches missed.">				if(window instanceof JInternalFrame)</span>
				{
<span class="nc" id="L1710">					putValue(Action.SMALL_ICON, detachIcon);</span>
<span class="nc" id="L1711">					putValue(Action.NAME, &quot;Detach&quot;);</span>
				}
<span class="nc bnc" id="L1713" title="All 2 branches missed.">				else if(window instanceof JFrame)</span>
				{
<span class="nc" id="L1715">					putValue(Action.SMALL_ICON, attachIcon);</span>
<span class="nc" id="L1716">					putValue(Action.NAME, &quot;Attach&quot;);</span>
				}
			}

<span class="nc" id="L1720">		}</span>
	}


	private class AttachToolBarAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -6338324258055926639L;

<span class="nc" id="L1729">		private Icon attachIcon = ATTACH_TOOLBAR_ICON;</span>
<span class="nc" id="L1730">		private Icon detachIcon = DETACH_TOOLBAR_ICON;</span>

		public AttachToolBarAction()
<span class="nc" id="L1733">		{</span>
<span class="nc" id="L1734">			super();</span>
<span class="nc" id="L1735">			updateAction();</span>
<span class="nc" id="L1736">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L1740">			attachDetach();</span>
<span class="nc" id="L1741">			updateAction();</span>
<span class="nc" id="L1742">		}</span>

		public void updateAction()
		{
<span class="nc" id="L1746">			ViewContainer container = getViewContainer();</span>
<span class="nc bnc" id="L1747" title="All 2 branches missed.">			if(container != null)</span>
			{
<span class="nc" id="L1749">				ViewWindow window = container.resolveViewWindow();</span>
<span class="nc bnc" id="L1750" title="All 2 branches missed.">				if(window instanceof JInternalFrame)</span>
				{
<span class="nc" id="L1752">					putValue(Action.SMALL_ICON, detachIcon);</span>
<span class="nc" id="L1753">					putValue(Action.SHORT_DESCRIPTION, &quot;Detach&quot;);</span>
<span class="nc" id="L1754">					return;</span>
				}
<span class="nc bnc" id="L1756" title="All 2 branches missed.">				else if(window instanceof JFrame)</span>
				{
<span class="nc" id="L1758">					putValue(Action.SMALL_ICON, attachIcon);</span>
<span class="nc" id="L1759">					putValue(Action.SHORT_DESCRIPTION, &quot;Attach&quot;);</span>
<span class="nc" id="L1760">					return;</span>
				}
			}
			// update anyway
<span class="nc" id="L1764">			putValue(Action.SMALL_ICON, detachIcon);</span>
<span class="nc" id="L1765">			putValue(Action.SHORT_DESCRIPTION, &quot;Detach&quot;);</span>
<span class="nc" id="L1766">		}</span>
	}

	private class PauseMenuAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -5242236903640590549L;

<span class="nc" id="L1774">		private Icon pausedIcon = PAUSED_MENU_ICON;</span>
<span class="nc" id="L1775">		private Icon unpausedIcon = UNPAUSED_MENU_ICON;</span>

		public PauseMenuAction()
<span class="nc" id="L1778">		{</span>
<span class="nc" id="L1779">			super();</span>
<span class="nc" id="L1780">			updateAction();</span>
<span class="nc" id="L1781">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; P&quot;);</span>
<span class="nc bnc" id="L1782" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L1783">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L1784">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc bnc" id="L1788" title="All 2 branches missed.">			setPaused(!isPaused());</span>
<span class="nc" id="L1789">			updateAction();</span>
<span class="nc" id="L1790">			focusTable();</span>
<span class="nc" id="L1791">		}</span>

		public void updateAction()
		{
<span class="nc bnc" id="L1795" title="All 2 branches missed.">			if(isPaused())</span>
			{
<span class="nc" id="L1797">				putValue(Action.SMALL_ICON, pausedIcon);</span>
<span class="nc" id="L1798">				putValue(Action.NAME, &quot;Unpause&quot;);</span>
			}
			else
			{
<span class="nc" id="L1802">				putValue(Action.SMALL_ICON, unpausedIcon);</span>
<span class="nc" id="L1803">				putValue(Action.NAME, &quot;Pause&quot;);</span>
			}
<span class="nc" id="L1805">		}</span>
	}

	private class PauseToolBarAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -5118623805829814815L;

<span class="nc" id="L1813">		private Icon pausedIcon = PAUSED_TOOLBAR_ICON;</span>
<span class="nc" id="L1814">		private Icon unpausedIcon = UNPAUSED_TOOLBAR_ICON;</span>

		public PauseToolBarAction()
<span class="nc" id="L1817">		{</span>
<span class="nc" id="L1818">			super();</span>
<span class="nc" id="L1819">			updateAction();</span>
<span class="nc" id="L1820">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; P&quot;);</span>
<span class="nc bnc" id="L1821" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L1822">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L1823">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc bnc" id="L1827" title="All 2 branches missed.">			setPaused(!isPaused());</span>
<span class="nc" id="L1828">			updateAction();</span>
<span class="nc" id="L1829">			focusTable();</span>
<span class="nc" id="L1830">		}</span>

		public void updateAction()
		{
<span class="nc bnc" id="L1834" title="All 2 branches missed.">			if(isPaused())</span>
			{
<span class="nc" id="L1836">				putValue(Action.SMALL_ICON, pausedIcon);</span>
<span class="nc" id="L1837">				putValue(Action.SHORT_DESCRIPTION, &quot;Unpause&quot;);</span>
			}
			else
			{
<span class="nc" id="L1841">				putValue(Action.SMALL_ICON, unpausedIcon);</span>
<span class="nc" id="L1842">				putValue(Action.SHORT_DESCRIPTION, &quot;Pause&quot;);</span>
			}
<span class="nc" id="L1844">		}</span>
	}

	private class FindMenuAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 2241714830900044485L;

		public FindMenuAction()
<span class="nc" id="L1853">		{</span>
<span class="nc" id="L1854">			super(&quot;Find&quot;);</span>
<span class="nc" id="L1855">			putValue(Action.SMALL_ICON, FIND_MENU_ITEM);</span>
<span class="nc" id="L1856">			putValue(Action.SHORT_DESCRIPTION, &quot;Opens the Find panel.&quot;);</span>
<span class="nc" id="L1857">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; F&quot;);</span>
<span class="nc bnc" id="L1858" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L1859">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L1860">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L1864">			setShowingFilters(true);</span>
<span class="nc" id="L1865">		}</span>
	}

	private class FindToolBarAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -4080152597948489206L;

		public FindToolBarAction()
<span class="nc" id="L1874">		{</span>
<span class="nc" id="L1875">			super();</span>
<span class="nc" id="L1876">			putValue(Action.SMALL_ICON, FIND_TOOLBAR_ICON);</span>
<span class="nc" id="L1877">			putValue(Action.SHORT_DESCRIPTION, &quot;Find&quot;);</span>
<span class="nc" id="L1878">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; F&quot;);</span>
<span class="nc bnc" id="L1879" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L1880">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L1881">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L1885">			setShowingFilters(true);</span>
<span class="nc" id="L1886">		}</span>
	}

	private class StatisticsMenuAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -6336357605789928345L;

		public StatisticsMenuAction()
<span class="nc" id="L1895">		{</span>
<span class="nc" id="L1896">			super(&quot;Statistics&quot;);</span>
<span class="nc" id="L1897">			putValue(Action.SMALL_ICON, STATISTICS_MENU_ICON);</span>
<span class="nc" id="L1898">			putValue(Action.SHORT_DESCRIPTION, &quot;Statistics&quot;);</span>
<span class="nc" id="L1899">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L1903">			showStatistics();</span>
<span class="nc" id="L1904">		}</span>
	}

	private class StatisticsToolBarAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 2394035359331601001L;

		public StatisticsToolBarAction()
<span class="nc" id="L1913">		{</span>
<span class="nc" id="L1914">			super();</span>
<span class="nc" id="L1915">			putValue(Action.SMALL_ICON, STATISTICS_TOOLBAR_ICON);</span>
<span class="nc" id="L1916">			putValue(Action.SHORT_DESCRIPTION, &quot;Statistics&quot;);</span>
<span class="nc" id="L1917">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L1921">			showStatistics();</span>
<span class="nc" id="L1922">		}</span>
	}

	private class DisconnectMenuAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 8971640305824353589L;

		public DisconnectMenuAction()
<span class="nc" id="L1931">		{</span>
<span class="nc" id="L1932">			super(&quot;Disconnect&quot;);</span>
<span class="nc" id="L1933">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; shift D&quot;);</span>
<span class="nc bnc" id="L1934" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L1935">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L1936">			putValue(Action.SMALL_ICON, DISCONNECT_MENU_ICON);</span>
<span class="nc" id="L1937">			putValue(Action.SHORT_DESCRIPTION, &quot;Terminates this connection&quot;);</span>
<span class="nc" id="L1938">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L1942">			disconnect();</span>
<span class="nc" id="L1943">		}</span>
	}

	private class DisconnectToolBarAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -8665004340745035737L;

		public DisconnectToolBarAction()
<span class="nc" id="L1952">		{</span>
<span class="nc" id="L1953">			super();</span>
<span class="nc" id="L1954">			putValue(Action.SMALL_ICON, DISCONNECT_TOOLBAR_ICON);</span>
<span class="nc" id="L1955">			putValue(Action.SHORT_DESCRIPTION, &quot;Disconnect&quot;);</span>
<span class="nc" id="L1956">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L1960">			disconnect();</span>
<span class="nc" id="L1961">		}</span>
	}

	private class FocusMessageAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -421929316399318971L;

		public FocusMessageAction()
<span class="nc" id="L1970">		{</span>
<span class="nc" id="L1971">			super(&quot;Focus message&quot;);</span>
<span class="nc" id="L1972">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
<span class="nc" id="L1973">			putValue(Action.SHORT_DESCRIPTION, &quot;Focus detailed message view.&quot;);</span>
<span class="nc" id="L1974">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; M&quot;);</span>
<span class="nc bnc" id="L1975" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L1976">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L1977">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L1981">			focusMessage();</span>
<span class="nc" id="L1982">		}</span>
	}

	private class FocusEventsAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 4207817900003297701L;

		public FocusEventsAction()
<span class="nc" id="L1991">		{</span>
<span class="nc" id="L1992">			super(&quot;Focus events&quot;);</span>
<span class="nc" id="L1993">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
<span class="nc" id="L1994">			putValue(Action.SHORT_DESCRIPTION, &quot;Focus the table containing the events.&quot;);</span>
<span class="nc" id="L1995">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; E&quot;);</span>
<span class="nc bnc" id="L1996" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L1997">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L1998">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2002">			focusEvents();</span>
<span class="nc" id="L2003">		}</span>
	}

	private class FindNextAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 4771628062043742857L;

		public FindNextAction()
<span class="nc" id="L2012">		{</span>
<span class="nc" id="L2013">			super(&quot;Find next&quot;);</span>
<span class="nc" id="L2014">			putValue(Action.SMALL_ICON, FIND_NEXT_MENU_ICON);</span>
<span class="nc" id="L2015">			putValue(Action.SHORT_DESCRIPTION, &quot;Find next match of the current filter.&quot;);</span>
<span class="nc" id="L2016">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; shift G&quot;);</span>
<span class="nc bnc" id="L2017" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L2018">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L2019">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2023">			findNext();</span>
<span class="nc" id="L2024">		}</span>

	}

	private class FindPreviousAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -284066693780808511L;

		public FindPreviousAction()
<span class="nc" id="L2034">		{</span>
<span class="nc" id="L2035">			super(&quot;Find previous&quot;);</span>
<span class="nc" id="L2036">			putValue(Action.SMALL_ICON, FIND_PREV_MENU_ICON);</span>
<span class="nc" id="L2037">			putValue(Action.SHORT_DESCRIPTION, &quot;Find previous match of the current filter.&quot;);</span>
<span class="nc" id="L2038">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; G&quot;);</span>
<span class="nc bnc" id="L2039" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L2040">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L2041">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2045">			findPrevious();</span>
<span class="nc" id="L2046">		}</span>
	}

	private class ResetFindAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -1245378100755440576L;

		public ResetFindAction()
<span class="nc" id="L2055">		{</span>
<span class="nc" id="L2056">			super(&quot;Reset find&quot;);</span>
<span class="nc" id="L2057">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
<span class="nc" id="L2058">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; shift F&quot;);</span>
<span class="nc bnc" id="L2059" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L2060">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L2061">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2065">			resetFind();</span>
<span class="nc" id="L2066">		}</span>
	}

	private class ScrollToBottomMenuAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -6698886479454486019L;

<span class="nc" id="L2074">		private Icon selectedIcon = TAIL_MENU_ICON;</span>
<span class="nc" id="L2075">		private Icon unselectedIcon = EMPTY_16_ICON;</span>

		public ScrollToBottomMenuAction()
<span class="nc" id="L2078">		{</span>
<span class="nc" id="L2079">			super(&quot;Tail&quot;);</span>
<span class="nc" id="L2080">			updateAction();</span>
<span class="nc" id="L2081">			putValue(Action.SHORT_DESCRIPTION, &quot;Tail (\&quot;scroll to bottom\&quot;)&quot;);</span>
<span class="nc" id="L2082">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; T&quot;);</span>
<span class="nc bnc" id="L2083" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L2084">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L2085">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc bnc" id="L2089" title="All 2 branches missed.">			boolean tail = !isScrollingToBottom();</span>
<span class="nc" id="L2090">			setScrollingToBottom(tail);</span>
<span class="nc bnc" id="L2091" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;tail={}&quot;, tail);</span>
<span class="nc" id="L2092">			focusTable();</span>
<span class="nc" id="L2093">		}</span>

		public void updateAction()
		{
<span class="nc bnc" id="L2097" title="All 2 branches missed.">			if(isScrollingToBottom())</span>
			{
<span class="nc" id="L2099">				putValue(Action.SMALL_ICON, selectedIcon);</span>
			}
			else
			{
<span class="nc" id="L2103">				putValue(Action.SMALL_ICON, unselectedIcon);</span>
			}
<span class="nc" id="L2105">		}</span>
	}

	private class ScrollToBottomToolBarAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -7793074053120455264L;

		public ScrollToBottomToolBarAction()
<span class="nc" id="L2114">		{</span>
<span class="nc" id="L2115">			super();</span>
<span class="nc" id="L2116">			putValue(Action.SMALL_ICON, TAIL_TOOLBAR_ICON);</span>
<span class="nc" id="L2117">			putValue(Action.SHORT_DESCRIPTION, &quot;Tail (\&quot;scroll to bottom\&quot;)&quot;);</span>
<span class="nc" id="L2118">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; T&quot;);</span>
<span class="nc bnc" id="L2119" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L2120">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L2121">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc bnc" id="L2125" title="All 2 branches missed.">			boolean tail = !isScrollingToBottom();</span>
<span class="nc" id="L2126">			setScrollingToBottom(tail);</span>
<span class="nc bnc" id="L2127" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;tail={}&quot;, tail);</span>
<span class="nc" id="L2128">			focusTable();</span>
<span class="nc" id="L2129">		}</span>
	}

	private class CloseFilterAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -842677137302613585L;

		public CloseFilterAction()
<span class="nc" id="L2138">		{</span>
<span class="nc" id="L2139">			super(&quot;Close this filter&quot;);</span>
<span class="nc" id="L2140">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
<span class="nc" id="L2141">			putValue(Action.MNEMONIC_KEY, Integer.valueOf('c'));</span>
<span class="nc" id="L2142">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; W&quot;);</span>
<span class="nc bnc" id="L2143" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L2144">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L2145">		}</span>

		public void updateAction()
		{
<span class="nc bnc" id="L2149" title="All 2 branches missed.">			if(viewContainer != null)</span>
			{
<span class="nc" id="L2151">				int viewIndex = viewContainer.getViewIndex();</span>
<span class="nc bnc" id="L2152" title="All 2 branches missed.">				if(viewIndex &gt; 0)</span>
				{
<span class="nc" id="L2154">					setEnabled(true);</span>
				}
				else
				{
<span class="nc" id="L2158">					setEnabled(false);</span>
				}
<span class="nc" id="L2160">			}</span>
			else
			{
<span class="nc" id="L2163">				setEnabled(false);</span>
			}
<span class="nc" id="L2165">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2169">			closeCurrentFilter();</span>
<span class="nc" id="L2170">		}</span>

	}

	private class CloseOtherFiltersAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -6399148183817841417L;

		public CloseOtherFiltersAction()
<span class="nc" id="L2180">		{</span>
<span class="nc" id="L2181">			super(&quot;Close all other filters&quot;);</span>
<span class="nc" id="L2182">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
<span class="nc" id="L2183">			putValue(Action.MNEMONIC_KEY, Integer.valueOf('o'));</span>
<span class="nc" id="L2184">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; shift W&quot;);</span>
<span class="nc bnc" id="L2185" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L2186">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L2187">		}</span>

		public void updateAction()
		{
<span class="nc bnc" id="L2191" title="All 2 branches missed.">			if(viewContainer != null)</span>
			{
<span class="nc" id="L2193">				int viewIndex = viewContainer.getViewIndex();</span>
<span class="nc" id="L2194">				int viewCount = viewContainer.getViewCount();</span>
<span class="nc bnc" id="L2195" title="All 8 branches missed.">				if(viewIndex &gt; -1 &amp;&amp; ((viewIndex == 0 &amp;&amp; viewCount &gt; 1) || viewCount &gt; 2))</span>
				{
<span class="nc" id="L2197">					setEnabled(true);</span>
				}
				else
				{
<span class="nc" id="L2201">					setEnabled(false);</span>
				}
<span class="nc" id="L2203">			}</span>
			else
			{
<span class="nc" id="L2206">				setEnabled(false);</span>
			}
<span class="nc" id="L2208">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2212">			closeOtherFilters();</span>
<span class="nc" id="L2213">		}</span>

	}

	private class CloseAllFiltersAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 1212878326080544663L;

		public CloseAllFiltersAction()
<span class="nc" id="L2223">		{</span>
<span class="nc" id="L2224">			super(&quot;Close all filters&quot;);</span>
<span class="nc" id="L2225">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
<span class="nc" id="L2226">			putValue(Action.MNEMONIC_KEY, Integer.valueOf('a'));</span>
<span class="nc" id="L2227">		}</span>

		public void updateAction()
		{
<span class="nc" id="L2231">			int viewCount = 0;</span>
<span class="nc bnc" id="L2232" title="All 2 branches missed.">			if(viewContainer != null)</span>
			{
<span class="nc" id="L2234">				viewCount = viewContainer.getViewCount();</span>
			}
<span class="nc bnc" id="L2236" title="All 2 branches missed.">			if(viewCount &gt; 1)</span>
			{
<span class="nc" id="L2238">				setEnabled(true);</span>
			}
			else
			{
<span class="nc" id="L2242">				setEnabled(false);</span>
			}
<span class="nc" id="L2244">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2248">			closeAllFilters();</span>
<span class="nc" id="L2249">		}</span>
	}


	class ViewLoggingAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 6967472316665780683L;

		private EventSource&lt;LoggingEvent&gt; eventSource;

		public ViewLoggingAction(EventSource&lt;LoggingEvent&gt; eventSource)
<span class="nc" id="L2261">		{</span>
<span class="nc" id="L2262">			super(mainFrame.getLoggingSourceTitle(eventSource.getSourceIdentifier()));</span>
<span class="nc" id="L2263">			this.eventSource = eventSource;</span>
<span class="nc bnc" id="L2264" title="All 2 branches missed.">			if(eventSource.isGlobal())</span>
			{
<span class="nc" id="L2266">				KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; 1&quot;);</span>
<span class="nc bnc" id="L2267" title="All 2 branches missed.">				if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L2268">				putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L2269">			}</span>
			else
			{
<span class="nc" id="L2272">				SourceIdentifier si = eventSource.getSourceIdentifier();</span>
<span class="nc bnc" id="L2273" title="All 4 branches missed.">				if(si != null &amp;&amp; &quot;Lilith&quot;.equals(si.getIdentifier()))</span>
				{
					// internal Lilith log
<span class="nc" id="L2276">					KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; 0&quot;);</span>
<span class="nc bnc" id="L2277" title="All 2 branches missed.">					if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L2278">					putValue(Action.ACCELERATOR_KEY, accelerator);</span>
				}
			}
<span class="nc" id="L2281">		}</span>

		public void actionPerformed(ActionEvent evt)
		{
<span class="nc" id="L2285">			mainFrame.showLoggingView(eventSource);</span>
<span class="nc" id="L2286">		}</span>

	}

	class ViewAccessAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 8054851261518410946L;

		private EventSource&lt;AccessEvent&gt; eventSource;

		public ViewAccessAction(EventSource&lt;AccessEvent&gt; eventSource)
<span class="nc" id="L2298">		{</span>
<span class="nc" id="L2299">			super(mainFrame.getAccessSourceTitle(eventSource.getSourceIdentifier()));</span>
<span class="nc" id="L2300">			this.eventSource = eventSource;</span>
<span class="nc bnc" id="L2301" title="All 2 branches missed.">			if(eventSource.isGlobal())</span>
			{
<span class="nc" id="L2303">				KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; 2&quot;);</span>
<span class="nc bnc" id="L2304" title="All 2 branches missed.">				if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L2305">				putValue(Action.ACCELERATOR_KEY, accelerator);</span>
			}
<span class="nc" id="L2307">		}</span>

		public void actionPerformed(ActionEvent evt)
		{
<span class="nc" id="L2311">			mainFrame.showAccessView(eventSource);</span>
<span class="nc" id="L2312">		}</span>

	}

	class ViewStatisticsAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 4453230971326526165L;

		private SourceIdentifier sourceIentifier;

		public ViewStatisticsAction(String name, SourceIdentifier sourceIdentifier)
<span class="nc" id="L2324">		{</span>
<span class="nc" id="L2325">			super(name);</span>
<span class="nc" id="L2326">			this.sourceIentifier = sourceIdentifier;</span>
<span class="nc" id="L2327">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2331">			mainFrame.showStatistics(sourceIentifier);</span>
<span class="nc" id="L2332">		}</span>
	}

	static class StatisticsSubMenuAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -8180660223848656769L;

		public StatisticsSubMenuAction()
		{
<span class="nc" id="L2342">			super(&quot;Statistics&quot;);</span>
<span class="nc" id="L2343">			putValue(Action.SMALL_ICON, STATISTICS_MENU_ICON);</span>
<span class="nc" id="L2344">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2348">		}</span>
	}


	class UpdateWindowMenuRunnable
		implements Runnable
	{
		private JMenu windowMenu;

		public UpdateWindowMenuRunnable(JMenu windowMenu)
<span class="nc" id="L2358">		{</span>
<span class="nc" id="L2359">			this.windowMenu = windowMenu;</span>
<span class="nc" id="L2360">		}</span>

		public void run()
		{
			// remove loggingViews that were closed in the meantime...
<span class="nc" id="L2365">			mainFrame.removeInactiveViews(true, false);</span>
<span class="nc bnc" id="L2366" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;Updating Views-Menu.&quot;);</span>

<span class="nc" id="L2368">			windowMenu.removeAll();</span>
<span class="nc" id="L2369">			JMenu statisticsMenu = createStatisticsMenu();</span>
<span class="nc" id="L2370">			windowMenu.add(statisticsMenu);</span>
<span class="nc" id="L2371">			windowMenu.add(showTaskManagerItem);</span>
<span class="nc" id="L2372">			windowMenu.addSeparator();</span>
<span class="nc" id="L2373">			windowMenu.add(closeAllItem);</span>
<span class="nc" id="L2374">			windowMenu.add(closeAllOtherItem);</span>
<span class="nc" id="L2375">			windowMenu.add(minimizeAllItem);</span>
<span class="nc" id="L2376">			windowMenu.add(minimizeAllOtherItem);</span>
<span class="nc" id="L2377">			windowMenu.add(removeInactiveItem);</span>
//			windowMenu.add(clearAndRemoveInactiveItem);

<span class="nc" id="L2380">			int activeCounter = 0;</span>
<span class="nc" id="L2381">			int inactiveCounter = 0;</span>
<span class="nc" id="L2382">			int viewCounter = 0;</span>
<span class="nc" id="L2383">			Font inactiveFont = windowMenu.getFont();</span>
<span class="nc" id="L2384">			inactiveFont = inactiveFont.deriveFont(Font.PLAIN);</span>

			boolean first;

<span class="nc" id="L2388">			SortedMap&lt;EventSource&lt;LoggingEvent&gt;, ViewContainer&lt;LoggingEvent&gt;&gt; sortedLoggingViews = mainFrame</span>
<span class="nc" id="L2389">				.getSortedLoggingViews();</span>

<span class="nc" id="L2391">			SortedMap&lt;EventSource&lt;AccessEvent&gt;, ViewContainer&lt;AccessEvent&gt;&gt; sortedAccessViews = mainFrame</span>
<span class="nc" id="L2392">				.getSortedAccessViews();</span>

<span class="nc" id="L2394">			first = true;</span>
			// Lilith logging
<span class="nc bnc" id="L2396" title="All 2 branches missed.">			for(Map.Entry&lt;EventSource&lt;LoggingEvent&gt;, ViewContainer&lt;LoggingEvent&gt;&gt; entry : sortedLoggingViews.entrySet())</span>
			{
<span class="nc" id="L2398">				EventSource&lt;LoggingEvent&gt; key = entry.getKey();</span>
<span class="nc" id="L2399">				SourceIdentifier si = key.getSourceIdentifier();</span>
<span class="nc bnc" id="L2400" title="All 2 branches missed.">				if(&quot;Lilith&quot;.equals(si.getIdentifier()))</span>
				{
<span class="nc" id="L2402">					ViewContainer&lt;LoggingEvent&gt; value = entry.getValue();</span>
<span class="nc bnc" id="L2403" title="All 2 branches missed.">					if(value.resolveViewWindow() != null)</span>
					{
<span class="nc" id="L2405">						viewCounter++;</span>
					}
<span class="nc bnc" id="L2407" title="All 2 branches missed.">					if(first)</span>
					{
<span class="nc" id="L2409">						first = false;</span>
<span class="nc" id="L2410">						windowMenu.addSeparator();</span>
					}
<span class="nc" id="L2412">					JCheckBoxMenuItem menuItem = createLoggingMenuItem(key, value);</span>
<span class="nc" id="L2413">					windowMenu.add(menuItem);</span>
				}
<span class="nc" id="L2415">			}</span>
			// global (Logging)
<span class="nc bnc" id="L2417" title="All 2 branches missed.">			for(Map.Entry&lt;EventSource&lt;LoggingEvent&gt;, ViewContainer&lt;LoggingEvent&gt;&gt; entry : sortedLoggingViews.entrySet())</span>
			{
<span class="nc" id="L2419">				EventSource&lt;LoggingEvent&gt; key = entry.getKey();</span>
<span class="nc" id="L2420">				SourceIdentifier si = key.getSourceIdentifier();</span>
<span class="nc bnc" id="L2421" title="All 2 branches missed.">				if(!&quot;Lilith&quot;.equals(si.getIdentifier()))</span>
				{
<span class="nc" id="L2423">					ViewContainer&lt;LoggingEvent&gt; value = entry.getValue();</span>
<span class="nc bnc" id="L2424" title="All 2 branches missed.">					if(value.resolveViewWindow() != null)</span>
					{
<span class="nc" id="L2426">						viewCounter++;</span>
					}
<span class="nc bnc" id="L2428" title="All 2 branches missed.">					if(key.isGlobal())</span>
					{
<span class="nc bnc" id="L2430" title="All 2 branches missed.">						if(first)</span>
						{
<span class="nc" id="L2432">							first = false;</span>
<span class="nc" id="L2433">							windowMenu.addSeparator();</span>
						}
<span class="nc" id="L2435">						JCheckBoxMenuItem menuItem = createLoggingMenuItem(key, value);</span>
<span class="nc" id="L2436">						windowMenu.add(menuItem);</span>
					}
				}
<span class="nc" id="L2439">			}</span>
			// global (Access)
<span class="nc bnc" id="L2441" title="All 2 branches missed.">			for(Map.Entry&lt;EventSource&lt;AccessEvent&gt;, ViewContainer&lt;AccessEvent&gt;&gt; entry : sortedAccessViews.entrySet())</span>
			{
<span class="nc" id="L2443">				EventSource&lt;AccessEvent&gt; key = entry.getKey();</span>
<span class="nc" id="L2444">				ViewContainer&lt;AccessEvent&gt; value = entry.getValue();</span>
<span class="nc bnc" id="L2445" title="All 2 branches missed.">				if(value.resolveViewWindow() != null)</span>
				{
<span class="nc" id="L2447">					viewCounter++;</span>
				}
<span class="nc bnc" id="L2449" title="All 2 branches missed.">				if(key.isGlobal())</span>
				{
<span class="nc bnc" id="L2451" title="All 2 branches missed.">					if(first)</span>
					{
<span class="nc" id="L2453">						first = false;</span>
<span class="nc" id="L2454">						windowMenu.addSeparator();</span>
					}
<span class="nc" id="L2456">					JCheckBoxMenuItem menuItem = createAccessMenuItem(key, value);</span>
<span class="nc" id="L2457">					windowMenu.add(menuItem);</span>
				}
<span class="nc" id="L2459">			}</span>

<span class="nc" id="L2461">			first = true;</span>
			// Logging (active)
<span class="nc bnc" id="L2463" title="All 2 branches missed.">			for(Map.Entry&lt;EventSource&lt;LoggingEvent&gt;, ViewContainer&lt;LoggingEvent&gt;&gt; entry : sortedLoggingViews.entrySet())</span>
			{
<span class="nc" id="L2465">				EventSource&lt;LoggingEvent&gt; key = entry.getKey();</span>
<span class="nc" id="L2466">				SourceIdentifier si = key.getSourceIdentifier();</span>
<span class="nc bnc" id="L2467" title="All 2 branches missed.">				if(!&quot;Lilith&quot;.equals(si.getIdentifier()))</span>
				{
<span class="nc" id="L2469">					ViewContainer&lt;LoggingEvent&gt; value = entry.getValue();</span>
<span class="nc" id="L2470">					EventWrapperViewPanel&lt;LoggingEvent&gt; panel = value.getDefaultView();</span>
<span class="nc bnc" id="L2471" title="All 4 branches missed.">					if(!key.isGlobal() &amp;&amp; (LoggingViewState.ACTIVE == panel.getState()))</span>
					{
<span class="nc bnc" id="L2473" title="All 2 branches missed.">						if(first)</span>
						{
<span class="nc" id="L2475">							first = false;</span>
<span class="nc" id="L2476">							windowMenu.addSeparator();</span>
						}
<span class="nc" id="L2478">						JCheckBoxMenuItem menuItem = createLoggingMenuItem(key, value);</span>
<span class="nc" id="L2479">						windowMenu.add(menuItem);</span>
<span class="nc" id="L2480">						activeCounter++;</span>
					}
				}
<span class="nc" id="L2483">			}</span>
			// Logging (inactive)
<span class="nc bnc" id="L2485" title="All 2 branches missed.">			for(Map.Entry&lt;EventSource&lt;LoggingEvent&gt;, ViewContainer&lt;LoggingEvent&gt;&gt; entry : sortedLoggingViews.entrySet())</span>
			{
<span class="nc" id="L2487">				EventSource&lt;LoggingEvent&gt; key = entry.getKey();</span>
<span class="nc" id="L2488">				SourceIdentifier si = key.getSourceIdentifier();</span>
<span class="nc bnc" id="L2489" title="All 2 branches missed.">				if(!&quot;Lilith&quot;.equals(si.getIdentifier()))</span>
				{
<span class="nc" id="L2491">					ViewContainer&lt;LoggingEvent&gt; value = entry.getValue();</span>
<span class="nc" id="L2492">					EventWrapperViewPanel&lt;LoggingEvent&gt; panel = value.getDefaultView();</span>
<span class="nc bnc" id="L2493" title="All 4 branches missed.">					if(!key.isGlobal() &amp;&amp; (LoggingViewState.ACTIVE != panel.getState()))</span>
					{
<span class="nc bnc" id="L2495" title="All 2 branches missed.">						if(first)</span>
						{
<span class="nc" id="L2497">							first = false;</span>
<span class="nc" id="L2498">							windowMenu.addSeparator();</span>
						}
<span class="nc" id="L2500">						JCheckBoxMenuItem menuItem = createLoggingMenuItem(key, value);</span>
<span class="nc" id="L2501">						menuItem.setFont(inactiveFont);</span>
<span class="nc" id="L2502">						windowMenu.add(menuItem);</span>
<span class="nc" id="L2503">						inactiveCounter++;</span>
					}
				}
<span class="nc" id="L2506">			}</span>

			// Access (active)
<span class="nc" id="L2509">			first = true;</span>
<span class="nc bnc" id="L2510" title="All 2 branches missed.">			for(Map.Entry&lt;EventSource&lt;AccessEvent&gt;, ViewContainer&lt;AccessEvent&gt;&gt; entry : sortedAccessViews.entrySet())</span>
			{
<span class="nc" id="L2512">				EventSource&lt;AccessEvent&gt; key = entry.getKey();</span>
<span class="nc" id="L2513">				ViewContainer&lt;AccessEvent&gt; value = entry.getValue();</span>
<span class="nc" id="L2514">				EventWrapperViewPanel&lt;AccessEvent&gt; panel = value.getDefaultView();</span>
<span class="nc bnc" id="L2515" title="All 4 branches missed.">				if(!key.isGlobal() &amp;&amp; (LoggingViewState.ACTIVE == panel.getState()))</span>
				{
<span class="nc bnc" id="L2517" title="All 2 branches missed.">					if(first)</span>
					{
<span class="nc" id="L2519">						first = false;</span>
<span class="nc" id="L2520">						windowMenu.addSeparator();</span>
					}
<span class="nc" id="L2522">					JCheckBoxMenuItem menuItem = createAccessMenuItem(key, value);</span>
<span class="nc" id="L2523">					windowMenu.add(menuItem);</span>
<span class="nc" id="L2524">					activeCounter++;</span>
				}
<span class="nc" id="L2526">			}</span>
			// Access (inactive)
<span class="nc bnc" id="L2528" title="All 2 branches missed.">			for(Map.Entry&lt;EventSource&lt;AccessEvent&gt;, ViewContainer&lt;AccessEvent&gt;&gt; entry : sortedAccessViews.entrySet())</span>
			{
<span class="nc" id="L2530">				EventSource&lt;AccessEvent&gt; key = entry.getKey();</span>
<span class="nc" id="L2531">				ViewContainer&lt;AccessEvent&gt; value = entry.getValue();</span>
<span class="nc" id="L2532">				EventWrapperViewPanel&lt;AccessEvent&gt; panel = value.getDefaultView();</span>
<span class="nc bnc" id="L2533" title="All 4 branches missed.">				if(!key.isGlobal() &amp;&amp; (LoggingViewState.ACTIVE != panel.getState()))</span>
				{
<span class="nc bnc" id="L2535" title="All 2 branches missed.">					if(first)</span>
					{
<span class="nc" id="L2537">						first = false;</span>
<span class="nc" id="L2538">						windowMenu.addSeparator();</span>
					}
<span class="nc" id="L2540">					JCheckBoxMenuItem menuItem = createAccessMenuItem(key, value);</span>
<span class="nc" id="L2541">					menuItem.setFont(inactiveFont);</span>
<span class="nc" id="L2542">					windowMenu.add(menuItem);</span>
<span class="nc" id="L2543">					inactiveCounter++;</span>
				}
<span class="nc" id="L2545">			}</span>

			// update status text
<span class="nc bnc" id="L2548" title="All 2 branches missed.">			boolean hasInactive = (inactiveCounter != 0);</span>
			//clearAndRemoveInactiveAction.setEnabled(hasInactive);
<span class="nc" id="L2550">			removeInactiveAction.setEnabled(hasInactive);</span>
<span class="nc bnc" id="L2551" title="All 2 branches missed.">			boolean hasViews = viewCounter != 0;</span>
<span class="nc" id="L2552">			minimizeAllAction.setEnabled(hasViews);</span>
<span class="nc" id="L2553">			closeAllAction.setEnabled(hasViews);</span>
<span class="nc bnc" id="L2554" title="All 4 branches missed.">			if(viewContainer == null || viewCounter &lt;= 1)</span>
			{
<span class="nc" id="L2556">				minimizeAllOtherAction.setEnabled(false);</span>
<span class="nc" id="L2557">				closeAllOtherAction.setEnabled(false);</span>
			}
			else
			{
<span class="nc" id="L2561">				minimizeAllOtherAction.setEnabled(true);</span>
<span class="nc" id="L2562">				closeAllOtherAction.setEnabled(true);</span>
			}

<span class="nc" id="L2565">			mainFrame.setActiveConnectionsCounter(activeCounter);</span>

<span class="nc bnc" id="L2567" title="All 2 branches missed.">			if(windowMenu.isPopupMenuVisible())</span>
			{
				// I've not been able to find a more elegant solution to prevent
				// repaint artifacts if the menu contents change while the menu is still open...
<span class="nc" id="L2571">				windowMenu.setPopupMenuVisible(false);</span>
<span class="nc" id="L2572">				windowMenu.setPopupMenuVisible(true);</span>
			}
<span class="nc" id="L2574">		}</span>


		private JCheckBoxMenuItem createLoggingMenuItem(EventSource&lt;LoggingEvent&gt; key, ViewContainer&lt;LoggingEvent&gt; viewContainer)
		{
<span class="nc" id="L2579">			JCheckBoxMenuItem result = new JCheckBoxMenuItem(new ViewLoggingAction(key));</span>
<span class="nc" id="L2580">			Container compParent = viewContainer.getParent();</span>
<span class="nc bnc" id="L2581" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;\n\nParent for {}: {}\n&quot;, key.getSourceIdentifier(), compParent);</span>
<span class="nc bnc" id="L2582" title="All 2 branches missed.">			if(compParent == null)</span>
			{
<span class="nc" id="L2584">				result.setState(false);</span>
			}
			else
			{
<span class="nc" id="L2588">				result.setState(true);</span>
			}
<span class="nc" id="L2590">			return result;</span>
		}

		private JCheckBoxMenuItem createAccessMenuItem(EventSource&lt;AccessEvent&gt; key, ViewContainer&lt;AccessEvent&gt; viewContainer)
		{
<span class="nc" id="L2595">			JCheckBoxMenuItem result = new JCheckBoxMenuItem(new ViewAccessAction(key));</span>
<span class="nc" id="L2596">			Container compParent = viewContainer.getParent();</span>
<span class="nc bnc" id="L2597" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;\n\nParent for {}: {}\n&quot;, key.getSourceIdentifier(), compParent);</span>
<span class="nc bnc" id="L2598" title="All 2 branches missed.">			if(compParent == null)</span>
			{
<span class="nc" id="L2600">				result.setState(false);</span>
			}
			else
			{
<span class="nc" id="L2604">				result.setState(true);</span>
			}
<span class="nc" id="L2606">			return result;</span>
		}

		private JMenu createStatisticsMenu()
		{
<span class="nc" id="L2611">			JMenu result = new JMenu(new StatisticsMenuAction());</span>
<span class="nc" id="L2612">			SortedMap&lt;String, SourceIdentifier&gt; sources = mainFrame.getAvailableStatistics();</span>

			{
<span class="nc" id="L2615">				JMenuItem menuItem = new JMenuItem(new ViewStatisticsAction(&quot;Global&quot;, new SourceIdentifier(&quot;global&quot;)));</span>
<span class="nc" id="L2616">				result.add(menuItem);</span>
<span class="nc" id="L2617">				result.addSeparator();</span>
			}

<span class="nc bnc" id="L2620" title="All 2 branches missed.">			for(Map.Entry&lt;String, SourceIdentifier&gt; current : sources.entrySet())</span>
			{
<span class="nc" id="L2622">				String key = current.getKey();</span>
<span class="nc" id="L2623">				SourceIdentifier value = current.getValue();</span>

<span class="nc" id="L2625">				JMenuItem menuItem = new JMenuItem(new ViewStatisticsAction(key, value));</span>
<span class="nc" id="L2626">				result.add(menuItem);</span>
<span class="nc" id="L2627">			}</span>
<span class="nc" id="L2628">			return result;</span>
		}
	}


	class AboutAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -372250750198620913L;

		public AboutAction()
<span class="nc" id="L2639">		{</span>
<span class="nc" id="L2640">			super(&quot;About...&quot;);</span>
<span class="nc" id="L2641">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
<span class="nc" id="L2642">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2646">			mainFrame.showAboutDialog();</span>
<span class="nc" id="L2647">		}</span>
	}

	class SaveLayoutAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 6135867758474252484L;

		public SaveLayoutAction()
<span class="nc" id="L2656">		{</span>
<span class="nc" id="L2657">			super(&quot;Save layout&quot;);</span>
<span class="nc" id="L2658">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
<span class="nc" id="L2659">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc bnc" id="L2663" title="All 2 branches missed.">			if(viewContainer != null)</span>
			{
<span class="nc" id="L2665">				EventWrapperViewPanel&lt;?&gt; viewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L2666" title="All 2 branches missed.">				if(viewPanel != null)</span>
				{
<span class="nc" id="L2668">					EventWrapperViewTable&lt;?&gt; table = viewPanel.getTable();</span>
<span class="nc bnc" id="L2669" title="All 2 branches missed.">					if(table != null)</span>
					{
<span class="nc" id="L2671">						table.saveLayout();</span>
					}
				}
			}
<span class="nc" id="L2675">		}</span>
	}

	class ResetLayoutAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -8396518428359553649L;

		public ResetLayoutAction()
<span class="nc" id="L2684">		{</span>
<span class="nc" id="L2685">			super(&quot;Reset layout&quot;);</span>
<span class="nc" id="L2686">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
<span class="nc" id="L2687">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc bnc" id="L2691" title="All 2 branches missed.">			if(viewContainer != null)</span>
			{
<span class="nc" id="L2693">				EventWrapperViewPanel&lt;?&gt; viewPanel = viewContainer.getSelectedView();</span>
<span class="nc bnc" id="L2694" title="All 2 branches missed.">				if(viewPanel != null)</span>
				{
<span class="nc" id="L2696">					EventWrapperViewTable&lt;?&gt; table = viewPanel.getTable();</span>
<span class="nc bnc" id="L2697" title="All 2 branches missed.">					if(table != null)</span>
					{
<span class="nc" id="L2699">						table.resetLayout();</span>
					}
				}
			}
<span class="nc" id="L2703">		}</span>
	}

	class CheckForUpdateAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 529742851501771901L;

		public CheckForUpdateAction()
<span class="nc" id="L2712">		{</span>
<span class="nc" id="L2713">			super(&quot;Check for Update...&quot;);</span>
<span class="nc" id="L2714">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
<span class="nc" id="L2715">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2719">			mainFrame.checkForUpdate(true);</span>
<span class="nc" id="L2720">		}</span>
	}

	class KeyboardHelpAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 6942092383339768508L;

		public KeyboardHelpAction()
<span class="nc" id="L2729">		{</span>
<span class="nc" id="L2730">			super(&quot;Help Topics&quot;);</span>
<span class="nc" id="L2731">			putValue(Action.SMALL_ICON, HELP_MENU_ICON);</span>
<span class="nc" id="L2732">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2736">			mainFrame.showHelp();</span>
<span class="nc" id="L2737">		}</span>
	}

	class PreferencesMenuAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -196036112324455446L;

		public PreferencesMenuAction()
<span class="nc" id="L2746">		{</span>
<span class="nc" id="L2747">			super(&quot;Preferences...&quot;);</span>
<span class="nc" id="L2748">			putValue(Action.SMALL_ICON, PREFERENCES_MENU_ICON);</span>
<span class="nc" id="L2749">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; COMMA&quot;);</span>
<span class="nc bnc" id="L2750" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L2751">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L2752">			putValue(Action.MNEMONIC_KEY, Integer.valueOf('p'));</span>
<span class="nc" id="L2753">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2757">			mainFrame.showPreferencesDialog();</span>
<span class="nc" id="L2758">		}</span>
	}

	class PreferencesToolBarAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 8353604009441967874L;

		public PreferencesToolBarAction()
<span class="nc" id="L2767">		{</span>
<span class="nc" id="L2768">			super();</span>
<span class="nc" id="L2769">			putValue(Action.SMALL_ICON, PREFERENCES_TOOLBAR_ICON);</span>
<span class="nc" id="L2770">			putValue(Action.SHORT_DESCRIPTION, &quot;Preferences...&quot;);</span>
<span class="nc" id="L2771">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; COMMA&quot;);</span>
<span class="nc bnc" id="L2772" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L2773">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L2774">			putValue(Action.MNEMONIC_KEY, Integer.valueOf('p'));</span>
<span class="nc" id="L2775">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2779">			mainFrame.showPreferencesDialog();</span>
<span class="nc" id="L2780">		}</span>
	}

	class DebugAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -1837786931224404611L;

		public DebugAction()
<span class="nc" id="L2789">		{</span>
<span class="nc" id="L2790">			super(&quot;Debug&quot;);</span>
<span class="nc" id="L2791">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
<span class="nc" id="L2792">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2796">			mainFrame.showDebugDialog();</span>
<span class="nc" id="L2797">		}</span>
	}

	class ExitMenuAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 6693131597277483031L;

		public ExitMenuAction()
<span class="nc" id="L2806">		{</span>
<span class="nc" id="L2807">			super(&quot;Exit&quot;);</span>
<span class="nc" id="L2808">			putValue(Action.SMALL_ICON, EXIT_MENU_ICON);</span>
<span class="nc" id="L2809">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; Q&quot;);</span>
<span class="nc bnc" id="L2810" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L2811">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L2812">			putValue(Action.MNEMONIC_KEY, Integer.valueOf('x'));</span>
<span class="nc" id="L2813">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2817">			mainFrame.exit();</span>
<span class="nc" id="L2818">		}</span>
	}

	class OpenInactiveLogMenuAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 7500131416548647712L;

		public OpenInactiveLogMenuAction()
<span class="nc" id="L2827">		{</span>
<span class="nc" id="L2828">			super(&quot;Open inactive log...&quot;);</span>
<span class="nc" id="L2829">			putValue(Action.SMALL_ICON, OPEN_INACTIVE_MENU_ICON);</span>
<span class="nc" id="L2830">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; shift O&quot;);</span>
<span class="nc bnc" id="L2831" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L2832">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L2833">			putValue(Action.MNEMONIC_KEY, Integer.valueOf('o'));</span>
<span class="nc" id="L2834">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2838">			mainFrame.openInactiveLogs();</span>
<span class="nc" id="L2839">		}</span>
	}

	class OpenMenuAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 7500131416548647712L;

		public OpenMenuAction()
<span class="nc" id="L2848">		{</span>
<span class="nc" id="L2849">			super(&quot;Open...&quot;);</span>
<span class="nc" id="L2850">			putValue(Action.SMALL_ICON, OPEN_INACTIVE_MENU_ICON);</span>
<span class="nc" id="L2851">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; O&quot;);</span>
<span class="nc bnc" id="L2852" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L2853">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L2854">			putValue(Action.MNEMONIC_KEY, Integer.valueOf('o'));</span>
<span class="nc" id="L2855">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2859">			mainFrame.open();</span>
<span class="nc" id="L2860">		}</span>
	}

	class ImportMenuAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 7500131416548647712L;

		public ImportMenuAction()
<span class="nc" id="L2869">		{</span>
<span class="nc" id="L2870">			super(&quot;Import...&quot;);</span>
<span class="nc" id="L2871">			putValue(Action.SMALL_ICON, OPEN_INACTIVE_MENU_ICON);</span>
<span class="nc" id="L2872">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; shift I&quot;);</span>
<span class="nc bnc" id="L2873" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L2874">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L2875">			putValue(Action.MNEMONIC_KEY, Integer.valueOf('i'));</span>
<span class="nc" id="L2876">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2880">			mainFrame.importFile();</span>
<span class="nc" id="L2881">		}</span>
	}

	class CleanAllInactiveLogsMenuAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 626049491764655228L;

		public CleanAllInactiveLogsMenuAction()
<span class="nc" id="L2890">		{</span>
<span class="nc" id="L2891">			super(&quot;Clean all inactive logs&quot;);</span>
<span class="nc" id="L2892">			putValue(Action.SMALL_ICON, CLEAR_MENU_ICON);</span>
<span class="nc" id="L2893">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; shift X&quot;);</span>
<span class="nc bnc" id="L2894" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L2895">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L2896">			putValue(Action.MNEMONIC_KEY, Integer.valueOf('c'));</span>
<span class="nc" id="L2897">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc bnc" id="L2901" title="All 2 branches missed.">			if(logger.isInfoEnabled()) logger.info(&quot;Clean all inactive logs&quot;);</span>
<span class="nc" id="L2902">			mainFrame.cleanAllInactiveLogs();</span>
<span class="nc" id="L2903">		}</span>
	}

	private class PreviousTabAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 3841435361964210123L;

		public PreviousTabAction()
<span class="nc" id="L2912">		{</span>
<span class="nc" id="L2913">			super(&quot;Previous tab&quot;);</span>
<span class="nc" id="L2914">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; J&quot;);</span>
<span class="nc bnc" id="L2915" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L2916">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L2917">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
<span class="nc" id="L2918">		}</span>

		public void updateAction()
		{
<span class="nc bnc" id="L2922" title="All 2 branches missed.">			if(viewContainer != null)</span>
			{
<span class="nc" id="L2924">				int viewCount = viewContainer.getViewCount();</span>
<span class="nc bnc" id="L2925" title="All 2 branches missed.">				if(viewCount &gt; 1)</span>
				{
<span class="nc" id="L2927">					setEnabled(true);</span>
				}
				else
				{
<span class="nc" id="L2931">					setEnabled(false);</span>
				}
<span class="nc" id="L2933">			}</span>
			else
			{
<span class="nc" id="L2936">				setEnabled(false);</span>
			}
<span class="nc" id="L2938">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2942">			previousTab();</span>
<span class="nc" id="L2943">		}</span>
	}

	private class NextTabAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 6997026628818486446L;

		public NextTabAction()
<span class="nc" id="L2952">		{</span>
<span class="nc" id="L2953">			super(&quot;Next tab&quot;);</span>
<span class="nc" id="L2954">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; K&quot;);</span>
<span class="nc bnc" id="L2955" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L2956">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L2957">			putValue(Action.SMALL_ICON, EMPTY_16_ICON);</span>
<span class="nc" id="L2958">		}</span>

		public void updateAction()
		{
<span class="nc bnc" id="L2962" title="All 2 branches missed.">			if(viewContainer != null)</span>
			{
<span class="nc" id="L2964">				int viewCount = viewContainer.getViewCount();</span>
<span class="nc bnc" id="L2965" title="All 2 branches missed.">				if(viewCount &gt; 1)</span>
				{
<span class="nc" id="L2967">					setEnabled(true);</span>
				}
				else
				{
<span class="nc" id="L2971">					setEnabled(false);</span>
				}
<span class="nc" id="L2973">			}</span>
			else
			{
<span class="nc" id="L2976">				setEnabled(false);</span>
			}
<span class="nc" id="L2978">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L2982">			nextTab();</span>
<span class="nc" id="L2983">		}</span>
	}


	private class CopySelectionAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -551520865313383753L;

		private EventWrapperViewPanel view;

		public CopySelectionAction()
<span class="nc" id="L2995">		{</span>
<span class="nc" id="L2996">			super(&quot;Copy selection&quot;);</span>
<span class="nc" id="L2997">			putValue(Action.SHORT_DESCRIPTION, &quot;Copies the selection to the clipboard.&quot;);</span>
<span class="nc" id="L2998">			KeyStroke accelerator = KeyStrokes.resolveAcceleratorKeyStroke(KeyStrokes.COMMAND_ALIAS + &quot; C&quot;);</span>
<span class="nc bnc" id="L2999" title="All 2 branches missed.">			if(logger.isDebugEnabled()) logger.debug(&quot;accelerator: {}&quot;, accelerator);</span>
<span class="nc" id="L3000">			putValue(Action.ACCELERATOR_KEY, accelerator);</span>
<span class="nc" id="L3001">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc bnc" id="L3005" title="All 2 branches missed.">			if(view != null)</span>
			{
<span class="nc" id="L3007">				view.copySelection();</span>
			}
<span class="nc" id="L3009">		}</span>

		public void setView(EventWrapperViewPanel view)
		{
<span class="nc" id="L3013">			this.view = view;</span>
<span class="nc" id="L3014">		}</span>
	}

	private class CopyEventAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -551520865313383753L;

		private EventWrapper eventWrapper;

		public CopyEventAction()
<span class="nc" id="L3025">		{</span>
<span class="nc" id="L3026">			super(&quot;Copy event&quot;);</span>
<span class="nc" id="L3027">			putValue(Action.SHORT_DESCRIPTION, &quot;Copies the event to the clipboard.&quot;);</span>
<span class="nc" id="L3028">		}</span>

		public void setEventWrapper(EventWrapper wrapper)
		{
<span class="nc" id="L3032">			this.eventWrapper = wrapper;</span>
<span class="nc bnc" id="L3033" title="All 2 branches missed.">			if(wrapper == null)</span>
			{
<span class="nc" id="L3035">				setEnabled(false);</span>
			}
			else
			{
<span class="nc" id="L3039">				Serializable eventObj = wrapper.getEvent();</span>
<span class="nc bnc" id="L3040" title="All 4 branches missed.">				if(eventObj instanceof LoggingEvent || eventObj instanceof AccessEvent)</span>
				{
<span class="nc" id="L3042">					setEnabled(true);</span>
				}
				else
				{
<span class="nc" id="L3046">					setEnabled(false);</span>
				}
			}
<span class="nc" id="L3049">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L3053">			String message = mainFrame.createMessage(eventWrapper);</span>
<span class="nc" id="L3054">			mainFrame.copyHtml(message);</span>
<span class="nc" id="L3055">		}</span>
	}

	private class CopyLoggingMessageAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -1147972057354807369L;

		private String message;

		public CopyLoggingMessageAction()
<span class="nc" id="L3066">		{</span>
<span class="nc" id="L3067">			super(&quot;Copy message&quot;);</span>
<span class="nc" id="L3068">			putValue(Action.SHORT_DESCRIPTION, &quot;Copies the message of the logging event to the clipboard.&quot;);</span>
<span class="nc" id="L3069">		}</span>

		public void setEventWrapper(EventWrapper wrapper)
		{
<span class="nc" id="L3073">			String message = null;</span>
<span class="nc bnc" id="L3074" title="All 4 branches missed.">			if(wrapper != null &amp;&amp; wrapper.getEvent() != null)</span>
			{
<span class="nc" id="L3076">				Object eventObj = wrapper.getEvent();</span>
<span class="nc bnc" id="L3077" title="All 2 branches missed.">				if(eventObj instanceof LoggingEvent)</span>
				{
<span class="nc" id="L3079">					LoggingEvent loggingEvent = (LoggingEvent) eventObj;</span>
<span class="nc" id="L3080">					Message messageObj = loggingEvent.getMessage();</span>
<span class="nc bnc" id="L3081" title="All 2 branches missed.">					if(messageObj != null)</span>
					{
<span class="nc" id="L3083">						message = messageObj.getMessage();</span>
					}
				}
			}
<span class="nc" id="L3087">			setMessage(message);</span>
<span class="nc" id="L3088">		}</span>

		private void setMessage(String message)
		{
<span class="nc" id="L3092">			this.message = message;</span>
<span class="nc bnc" id="L3093" title="All 2 branches missed.">			setEnabled(message != null);</span>
<span class="nc" id="L3094">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L3098">			mainFrame.copyText(message);</span>
<span class="nc" id="L3099">		}</span>
	}

	private class CopyLoggerNameAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 6056521432357588113L;

		private String loggerName;

		public CopyLoggerNameAction()
<span class="nc" id="L3110">		{</span>
<span class="nc" id="L3111">			super(&quot;Copy logger name&quot;);</span>
<span class="nc" id="L3112">			putValue(Action.SHORT_DESCRIPTION, &quot;Copies the logger name of the logging event to the clipboard.&quot;);</span>
<span class="nc" id="L3113">		}</span>

		public void setEventWrapper(EventWrapper wrapper)
		{
<span class="nc" id="L3117">			String loggerName = null;</span>
<span class="nc bnc" id="L3118" title="All 4 branches missed.">			if(wrapper != null &amp;&amp; wrapper.getEvent() != null)</span>
			{
<span class="nc" id="L3120">				Object eventObj = wrapper.getEvent();</span>
<span class="nc bnc" id="L3121" title="All 2 branches missed.">				if(eventObj instanceof LoggingEvent)</span>
				{
<span class="nc" id="L3123">					LoggingEvent loggingEvent = (LoggingEvent) eventObj;</span>
<span class="nc" id="L3124">					loggerName = loggingEvent.getLogger();</span>
				}
			}
<span class="nc" id="L3127">			setLoggerName(loggerName);</span>
<span class="nc" id="L3128">		}</span>

		private void setLoggerName(String loggerName)
		{
<span class="nc" id="L3132">			this.loggerName = loggerName;</span>
<span class="nc bnc" id="L3133" title="All 2 branches missed.">			setEnabled(loggerName != null);</span>
<span class="nc" id="L3134">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L3138">			mainFrame.copyText(loggerName);</span>
<span class="nc" id="L3139">		}</span>
	}

	private class CopyLoggingThrowableAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -2869680200462202650L;

		private ThrowableInfo throwableInfo;

		public CopyLoggingThrowableAction()
<span class="nc" id="L3150">		{</span>
<span class="nc" id="L3151">			super(&quot;Copy Throwable&quot;);</span>
<span class="nc" id="L3152">			putValue(Action.SHORT_DESCRIPTION, &quot;Copies the Throwable of the logging event to the clipboard.&quot;);</span>
<span class="nc" id="L3153">		}</span>

		public void setEventWrapper(EventWrapper wrapper)
		{
<span class="nc" id="L3157">			ThrowableInfo info = null;</span>
<span class="nc bnc" id="L3158" title="All 4 branches missed.">			if(wrapper != null &amp;&amp; wrapper.getEvent() != null)</span>
			{
<span class="nc" id="L3160">				Object eventObj = wrapper.getEvent();</span>
<span class="nc bnc" id="L3161" title="All 2 branches missed.">				if(eventObj instanceof LoggingEvent)</span>
				{
<span class="nc" id="L3163">					LoggingEvent loggingEvent = (LoggingEvent) eventObj;</span>
<span class="nc" id="L3164">					info = loggingEvent.getThrowable();</span>
				}
			}
<span class="nc" id="L3167">			setThrowableInfo(info);</span>
<span class="nc" id="L3168">		}</span>

		private void setThrowableInfo(ThrowableInfo info)
		{
<span class="nc" id="L3172">			this.throwableInfo = info;</span>
<span class="nc bnc" id="L3173" title="All 2 branches missed.">			setEnabled(info != null);</span>
<span class="nc" id="L3174">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L3178">			StringBuilder throwableText = new StringBuilder();</span>
<span class="nc" id="L3179">			ThrowableInfo info = throwableInfo;</span>
			for(; ;)
			{
<span class="nc" id="L3182">				throwableText.append(&quot;Exception: &quot;).append(info.getName()).append(&quot;\n&quot;);</span>
<span class="nc" id="L3183">				String message = info.getMessage();</span>
<span class="nc bnc" id="L3184" title="All 4 branches missed.">				if(message != null &amp;&amp; !message.equals(info.getName()))</span>
				{
<span class="nc" id="L3186">					throwableText.append(&quot;Message: &quot;).append(message).append(&quot;\n&quot;);</span>
				}
<span class="nc" id="L3188">				ExtendedStackTraceElement[] st = info.getStackTrace();</span>
<span class="nc bnc" id="L3189" title="All 2 branches missed.">				if(st != null)</span>
				{
<span class="nc" id="L3191">					throwableText.append(&quot;StackTrace:\n&quot;);</span>
<span class="nc bnc" id="L3192" title="All 2 branches missed.">					for(ExtendedStackTraceElement current : st)</span>
					{
<span class="nc" id="L3194">						throwableText.append(&quot;\tat &quot;).append(current.toString(true)).append(&quot;\n&quot;);</span>
					}
				}
<span class="nc" id="L3197">				info = info.getCause();</span>
<span class="nc bnc" id="L3198" title="All 2 branches missed.">				if(info == null)</span>
				{
<span class="nc" id="L3200">					break;</span>
				}
<span class="nc" id="L3202">				throwableText.append(&quot;\nCaused by:\n&quot;);</span>
<span class="nc" id="L3203">			}</span>
<span class="nc" id="L3204">			mainFrame.copyText(throwableText.toString());</span>
<span class="nc" id="L3205">		}</span>
	}

	private class CopyLoggingCallStackAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -7271955597619779579L;

		private ExtendedStackTraceElement[] callStack;

		public CopyLoggingCallStackAction()
<span class="nc" id="L3216">		{</span>
<span class="nc" id="L3217">			super(&quot;Copy call stack&quot;);</span>
<span class="nc" id="L3218">			putValue(Action.SHORT_DESCRIPTION, &quot;Copies the call stack of the logging event to the clipboard.&quot;);</span>
<span class="nc" id="L3219">		}</span>

		public void setEventWrapper(EventWrapper wrapper)
		{
<span class="nc" id="L3223">			ExtendedStackTraceElement[] callStack = null;</span>
<span class="nc bnc" id="L3224" title="All 4 branches missed.">			if(wrapper != null &amp;&amp; wrapper.getEvent() != null)</span>
			{
<span class="nc" id="L3226">				Object eventObj = wrapper.getEvent();</span>
<span class="nc bnc" id="L3227" title="All 2 branches missed.">				if(eventObj instanceof LoggingEvent)</span>
				{
<span class="nc" id="L3229">					LoggingEvent loggingEvent = (LoggingEvent) eventObj;</span>
<span class="nc" id="L3230">					callStack = loggingEvent.getCallStack();</span>
				}
			}
<span class="nc" id="L3233">			setCallStack(callStack);</span>
<span class="nc" id="L3234">		}</span>

		private void setCallStack(ExtendedStackTraceElement[] callStack)
		{
<span class="nc" id="L3238">			this.callStack = callStack;</span>
<span class="nc bnc" id="L3239" title="All 4 branches missed.">			setEnabled(callStack != null &amp;&amp; callStack.length &gt; 0);</span>
<span class="nc" id="L3240">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L3244">			StringBuilder text = new StringBuilder();</span>
<span class="nc" id="L3245">			ExtendedStackTraceElement[] cs = callStack;</span>
<span class="nc bnc" id="L3246" title="All 2 branches missed.">			if(cs != null)</span>
			{
<span class="nc" id="L3248">				boolean first = true;</span>
<span class="nc bnc" id="L3249" title="All 2 branches missed.">				for(ExtendedStackTraceElement current : cs)</span>
				{
<span class="nc bnc" id="L3251" title="All 2 branches missed.">					if(first)</span>
					{
<span class="nc" id="L3253">						first = false;</span>
					}
					else
					{
<span class="nc" id="L3257">						text.append(&quot;\n&quot;);</span>
					}
<span class="nc" id="L3259">					text.append(&quot;\tat &quot;).append(current);</span>
				}
			}
<span class="nc" id="L3262">			mainFrame.copyText(text.toString());</span>
<span class="nc" id="L3263">		}</span>
	}

	private class CopyLoggingMarkerAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -3523674814363899315L;

		private Marker marker;

		public CopyLoggingMarkerAction()
<span class="nc" id="L3274">		{</span>
<span class="nc" id="L3275">			super(&quot;Copy Marker&quot;);</span>
<span class="nc" id="L3276">			putValue(Action.SHORT_DESCRIPTION, &quot;Copies the Marker of the logging event to the clipboard.&quot;);</span>
<span class="nc" id="L3277">		}</span>

		public void setEventWrapper(EventWrapper wrapper)
		{
<span class="nc" id="L3281">			Marker marker = null;</span>
<span class="nc bnc" id="L3282" title="All 4 branches missed.">			if(wrapper != null &amp;&amp; wrapper.getEvent() != null)</span>
			{
<span class="nc" id="L3284">				Object eventObj = wrapper.getEvent();</span>
<span class="nc bnc" id="L3285" title="All 2 branches missed.">				if(eventObj instanceof LoggingEvent)</span>
				{
<span class="nc" id="L3287">					LoggingEvent loggingEvent = (LoggingEvent) eventObj;</span>
<span class="nc" id="L3288">					marker = loggingEvent.getMarker();</span>
				}
			}
<span class="nc" id="L3291">			setMarker(marker);</span>
<span class="nc" id="L3292">		}</span>

		private void setMarker(Marker marker)
		{
<span class="nc" id="L3296">			this.marker = marker;</span>
<span class="nc bnc" id="L3297" title="All 2 branches missed.">			setEnabled(marker != null);</span>
<span class="nc" id="L3298">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L3302">			StringBuilder text = new StringBuilder();</span>
<span class="nc" id="L3303">			buildMarker(text, 0, marker, new ArrayList&lt;String&gt;());</span>
<span class="nc" id="L3304">			mainFrame.copyText(text.toString());</span>
<span class="nc" id="L3305">		}</span>

		private void buildMarker(StringBuilder text, int indent, Marker marker, ArrayList&lt;String&gt; handledMarkers)
		{
<span class="nc bnc" id="L3309" title="All 2 branches missed.">			if(logger.isInfoEnabled()) logger.info(&quot;Implement!&quot;);</span>
<span class="nc bnc" id="L3310" title="All 2 branches missed.">			if(marker != null)</span>
			{
<span class="nc bnc" id="L3312" title="All 2 branches missed.">				for(int i = 0; i &lt; indent; i++)</span>
				{
<span class="nc" id="L3314">					text.append(&quot;  &quot;);</span>
				}
<span class="nc" id="L3316">				String markerName = marker.getName();</span>
<span class="nc" id="L3317">				text.append(&quot;- &quot;).append(markerName);</span>
<span class="nc bnc" id="L3318" title="All 2 branches missed.">				if(handledMarkers.contains(markerName))</span>
				{
<span class="nc" id="L3320">					text.append(&quot; [..]\n&quot;);</span>
				}
				else
				{
<span class="nc" id="L3324">					text.append(&quot;\n&quot;);</span>
<span class="nc" id="L3325">					handledMarkers.add(markerName);</span>
<span class="nc" id="L3326">					Map&lt;String, Marker&gt; references = marker.getReferences();</span>
<span class="nc bnc" id="L3327" title="All 2 branches missed.">					if(references != null)</span>
					{
<span class="nc bnc" id="L3329" title="All 2 branches missed.">						for(Map.Entry&lt;String, Marker&gt; current : references.entrySet())</span>
						{
<span class="nc" id="L3331">							buildMarker(text, indent + 1, current.getValue(), handledMarkers);</span>
<span class="nc" id="L3332">						}</span>
					}
				}
			}
<span class="nc" id="L3336">		}</span>
	}

	private class CopyLoggingMdcAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 2453432319268833157L;

		private Map&lt;String, String&gt; mdc;

		public CopyLoggingMdcAction()
<span class="nc" id="L3347">		{</span>
<span class="nc" id="L3348">			super(&quot;Copy MDC&quot;);</span>
<span class="nc" id="L3349">			putValue(Action.SHORT_DESCRIPTION, &quot;Copies the Mapped Diagnostic Context of the logging event to the clipboard.&quot;);</span>
<span class="nc" id="L3350">		}</span>

		public void setEventWrapper(EventWrapper wrapper)
		{
<span class="nc" id="L3354">			Map&lt;String, String&gt; mdc = null;</span>
<span class="nc bnc" id="L3355" title="All 4 branches missed.">			if(wrapper != null &amp;&amp; wrapper.getEvent() != null)</span>
			{
<span class="nc" id="L3357">				Object eventObj = wrapper.getEvent();</span>
<span class="nc bnc" id="L3358" title="All 2 branches missed.">				if(eventObj instanceof LoggingEvent)</span>
				{
<span class="nc" id="L3360">					LoggingEvent loggingEvent = (LoggingEvent) eventObj;</span>
<span class="nc" id="L3361">					mdc = loggingEvent.getMdc();</span>
				}
			}
<span class="nc" id="L3364">			setMdc(mdc);</span>
<span class="nc" id="L3365">		}</span>

		private void setMdc(Map&lt;String, String&gt; mdc)
		{
<span class="nc" id="L3369">			this.mdc = mdc;</span>
<span class="nc bnc" id="L3370" title="All 2 branches missed.">			setEnabled(mdc != null);</span>
<span class="nc" id="L3371">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L3375">			StringBuilder text = new StringBuilder();</span>
<span class="nc bnc" id="L3376" title="All 2 branches missed.">			if(mdc != null)</span>
			{
<span class="nc" id="L3378">				SortedMap&lt;String, String&gt; sorted = new TreeMap&lt;String, String&gt;(mdc);</span>
<span class="nc bnc" id="L3379" title="All 2 branches missed.">				for(Map.Entry&lt;String, String&gt; current : sorted.entrySet())</span>
				{
<span class="nc" id="L3381">					text.append(current.getKey()).append(&quot;\t&quot;).append(current.getValue()).append(&quot;\n&quot;);</span>
<span class="nc" id="L3382">				}</span>
			}
<span class="nc" id="L3384">			mainFrame.copyText(text.toString());</span>
<span class="nc" id="L3385">		}</span>
	}

	private class CopyLoggingNdcAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -1530866703421390638L;
		private Message[] ndc;

		public CopyLoggingNdcAction()
<span class="nc" id="L3395">		{</span>
<span class="nc" id="L3396">			super(&quot;Copy NDC&quot;);</span>
<span class="nc" id="L3397">			putValue(Action.SHORT_DESCRIPTION, &quot;Copies the Nested Diagnostic Context of the logging event to the clipboard.&quot;);</span>
<span class="nc" id="L3398">		}</span>

		public void setEventWrapper(EventWrapper wrapper)
		{
<span class="nc" id="L3402">			Message[] ndc = null;</span>
<span class="nc bnc" id="L3403" title="All 4 branches missed.">			if(wrapper != null &amp;&amp; wrapper.getEvent() != null)</span>
			{
<span class="nc" id="L3405">				Object eventObj = wrapper.getEvent();</span>
<span class="nc bnc" id="L3406" title="All 2 branches missed.">				if(eventObj instanceof LoggingEvent)</span>
				{
<span class="nc" id="L3408">					LoggingEvent loggingEvent = (LoggingEvent) eventObj;</span>
<span class="nc" id="L3409">					ndc = loggingEvent.getNdc();</span>
				}
			}
<span class="nc" id="L3412">			setNdc(ndc);</span>
<span class="nc" id="L3413">		}</span>

		private void setNdc(Message[] ndc)
		{
<span class="nc" id="L3417">			this.ndc = ndc;</span>
<span class="nc bnc" id="L3418" title="All 2 branches missed.">			setEnabled(ndc != null);</span>
<span class="nc" id="L3419">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L3423">			StringBuilder text = new StringBuilder();</span>
<span class="nc bnc" id="L3424" title="All 2 branches missed.">			if(ndc != null)</span>
			{
<span class="nc bnc" id="L3426" title="All 2 branches missed.">				for(Message current : ndc)</span>
				{
<span class="nc" id="L3428">					text.append(current.getMessage()).append(&quot;\n&quot;);</span>
				}
			}
<span class="nc" id="L3431">			mainFrame.copyText(text.toString());</span>
<span class="nc" id="L3432">		}</span>
	}

	private class CopyAccessUriAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -3535746663619981434L;
		private String requestUri;

		public CopyAccessUriAction()
<span class="nc" id="L3442">		{</span>
<span class="nc" id="L3443">			super(&quot;Copy request URI&quot;);</span>
<span class="nc" id="L3444">			putValue(Action.SHORT_DESCRIPTION, &quot;Copies the request URI of the access event to the clipboard.&quot;);</span>
<span class="nc" id="L3445">		}</span>

		public void setEventWrapper(EventWrapper wrapper)
		{
<span class="nc" id="L3449">			String requestUrl = null;</span>
<span class="nc bnc" id="L3450" title="All 4 branches missed.">			if(wrapper != null &amp;&amp; wrapper.getEvent() != null)</span>
			{
<span class="nc" id="L3452">				Object eventObj = wrapper.getEvent();</span>
<span class="nc bnc" id="L3453" title="All 2 branches missed.">				if(eventObj instanceof AccessEvent)</span>
				{
<span class="nc" id="L3455">					AccessEvent accessEvent = (AccessEvent) eventObj;</span>
<span class="nc" id="L3456">					requestUrl = accessEvent.getRequestURI();</span>
				}
			}
<span class="nc" id="L3459">			setRequestUri(requestUrl);</span>
<span class="nc" id="L3460">		}</span>

		private void setRequestUri(String requestUri)
		{
<span class="nc" id="L3464">			this.requestUri = requestUri;</span>
<span class="nc bnc" id="L3465" title="All 2 branches missed.">			setEnabled(requestUri != null);</span>
<span class="nc" id="L3466">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L3470">			mainFrame.copyText(requestUri);</span>
<span class="nc" id="L3471">		}</span>
	}

	private class ShowUnfilteredEventAction
		extends AbstractAction
	{
		private static final long serialVersionUID = -3282222163767568550L;

		public ShowUnfilteredEventAction()
<span class="nc" id="L3480">		{</span>
<span class="nc" id="L3481">			super(&quot;Show unfiltered&quot;);</span>
<span class="nc" id="L3482">			putValue(Action.SHORT_DESCRIPTION, &quot;Show unfiltered event.&quot;);</span>
<span class="nc" id="L3483">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L3487">			showUnfilteredEvent();</span>
<span class="nc" id="L3488">		}</span>

	}

	private class GotoSourceAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 4284532761807647658L;
		private ExtendedStackTraceElement stackTraceElement;

		public GotoSourceAction()
<span class="nc" id="L3499">		{</span>
<span class="nc" id="L3500">			super(&quot;Go to source&quot;);</span>
<span class="nc" id="L3501">			putValue(Action.SHORT_DESCRIPTION, &quot;Show source in IDEA if everything is ok ;)&quot;);</span>
<span class="nc" id="L3502">		}</span>

		public void setEventWrapper(EventWrapper wrapper)
		{
<span class="nc bnc" id="L3506" title="All 2 branches missed.">			if(wrapper == null)</span>
			{
<span class="nc" id="L3508">				setStackTraceElement(null);</span>
<span class="nc" id="L3509">				return;</span>
			}
<span class="nc" id="L3511">			Serializable event = wrapper.getEvent();</span>
<span class="nc bnc" id="L3512" title="All 2 branches missed.">			if(event instanceof LoggingEvent)</span>
			{
<span class="nc" id="L3514">				LoggingEvent loggingEvent = (LoggingEvent) event;</span>
<span class="nc" id="L3515">				ExtendedStackTraceElement[] callStack = loggingEvent.getCallStack();</span>
<span class="nc bnc" id="L3516" title="All 4 branches missed.">				if(callStack != null &amp;&amp; callStack.length &gt; 0)</span>
				{
<span class="nc" id="L3518">					setStackTraceElement(callStack[0]);</span>
<span class="nc" id="L3519">					return;</span>
				}
			}
<span class="nc" id="L3522">			setStackTraceElement(null);</span>
<span class="nc" id="L3523">		}</span>

		public void setStackTraceElement(ExtendedStackTraceElement stackTraceElement)
		{
<span class="nc" id="L3527">			this.stackTraceElement = stackTraceElement;</span>
<span class="nc bnc" id="L3528" title="All 2 branches missed.">			setEnabled(this.stackTraceElement != null);</span>
<span class="nc" id="L3529">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L3533">			mainFrame.goToSource(stackTraceElement.getStackTraceElement());</span>
<span class="nc" id="L3534">		}</span>
	}

	protected class SendAction&lt;T extends Serializable&gt;
		extends AbstractAction
	{
		private static final long serialVersionUID = 6612401555757959404L;
		private EventSender&lt;T&gt; sender;
		private T event;

		public SendAction(String name, EventSender&lt;T&gt; sender, EventWrapper&lt;T&gt; wrapper)
<span class="nc" id="L3545">		{</span>
<span class="nc" id="L3546">			super(name);</span>
<span class="nc" id="L3547">			this.sender = sender;</span>
<span class="nc" id="L3548">			this.event = wrapper.getEvent();</span>
<span class="nc bnc" id="L3549" title="All 2 branches missed.">			setEnabled(event != null);</span>
<span class="nc" id="L3550">		}</span>

		/**
		 * Invoked when an action occurs.
		 */
		public void actionPerformed(ActionEvent e)
		{
<span class="nc" id="L3557">			sender.send(event);</span>
<span class="nc" id="L3558">		}</span>
	}

	private class ShowHideAction
		extends AbstractAction
	{
		private static final long serialVersionUID = 7775753128032553866L;
		private boolean visible;
		private String columnName;
		private PersistentTableColumnModel tableColumnModel;

		public ShowHideAction(PersistentTableColumnModel tableColumnModel, String columnName, boolean visible)
<span class="nc" id="L3570">		{</span>
<span class="nc" id="L3571">			super(columnName);</span>
<span class="nc" id="L3572">			this.columnName = columnName;</span>
<span class="nc" id="L3573">			this.visible = visible;</span>
<span class="nc" id="L3574">			this.tableColumnModel = tableColumnModel;</span>
			//putValue(ViewActions.SELECTED_KEY, visible);
			// selection must be set manually
<span class="nc" id="L3577">		}</span>

		public void actionPerformed(ActionEvent e)
		{
<span class="nc bnc" id="L3581" title="All 2 branches missed.">			visible = !visible;</span>
<span class="nc" id="L3582">			Iterator&lt;TableColumn&gt; iter = tableColumnModel.getColumns(false);</span>
<span class="nc" id="L3583">			TableColumn found = null;</span>
<span class="nc bnc" id="L3584" title="All 2 branches missed.">			while(iter.hasNext())</span>
			{
<span class="nc" id="L3586">				TableColumn current = iter.next();</span>
<span class="nc bnc" id="L3587" title="All 2 branches missed.">				if(columnName.equals(current.getIdentifier()))</span>
				{
<span class="nc" id="L3589">					found = current;</span>
<span class="nc" id="L3590">					break;</span>
				}
<span class="nc" id="L3592">			}</span>
<span class="nc bnc" id="L3593" title="All 2 branches missed.">			if(found != null)</span>
			{
<span class="nc" id="L3595">				tableColumnModel.setColumnVisible(found, visible);</span>
			}
<span class="nc" id="L3597">		}</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>