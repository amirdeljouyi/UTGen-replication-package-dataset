<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ObjectModelBuilder.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">63_objectexplorer</a> &gt; <a href="index.source.html" class="el_package">de.paragon.explorer.model</a> &gt; <span class="el_source">ObjectModelBuilder.java</span></div><h1>ObjectModelBuilder.java</h1><pre class="source lang-java linenums">/**
 * [ObjectExplorer4J - Tool zur grafischen Darstellung von Objekten und ihren
 * Referenzen]
 * 
 * Copyright (C) [2009] [PARAGON Systemhaus GmbH]
 * 
 * This program is free software; you can redistribute it and/or modify it under
 * the terms of the GNU General Public License as published by the Free Software
 * Foundation; either version 3 of the License, or (at your option) any later
 * version.
 * 
 * This program is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE. See the GNU General Public License for more
 * details.
 * 
 * You should have received a copy of the GNU General Public License along with
 * this program; if not, see &lt;http://www.gnu.org/licenses/&gt;.
 **/
package de.paragon.explorer.model;

import java.util.Vector;

import de.paragon.explorer.figure.ListBoxFigureBuilder;
import de.paragon.explorer.figure.TextBoxFigure;
import de.paragon.explorer.util.ObjectViewManager;
import de.paragon.explorer.util.PropertyManager;
import de.paragon.explorer.util.StandardEnumeration;
import de.paragon.explorer.util.StandardEnumerator;

public final class ObjectModelBuilder {
	private static ObjectModelBuilder	singleton;

	public static ObjectModelBuilder getInstance() {
<span class="nc" id="L35">		return ObjectModelBuilder.getSingleton();</span>
	}

	private static ObjectModelBuilder getSingleton() {
<span class="nc bnc" id="L39" title="All 2 branches missed.">		if (ObjectModelBuilder.singleton == null) {</span>
<span class="nc" id="L40">			ObjectModelBuilder.setSingleton(new ObjectModelBuilder());</span>
		}
<span class="nc" id="L42">		return ObjectModelBuilder.singleton;</span>
	}

	private static void setSingleton(ObjectModelBuilder builder) {
<span class="nc" id="L46">		ObjectModelBuilder.singleton = builder;</span>
<span class="nc" id="L47">	}</span>

	private ObjectModelBuilder() {
		super();
	}

	protected StandardEnumeration asEnumeration(Object[] anArray) {
<span class="nc" id="L54">		Vector&lt;Object&gt; aVector = new Vector&lt;Object&gt;();</span>
<span class="nc bnc" id="L55" title="All 2 branches missed.">		for (int i = 0; i &lt; anArray.length; i++) {</span>
<span class="nc" id="L56">			aVector.addElement(anArray[i]);</span>
		}
<span class="nc" id="L58">		return new StandardEnumerator(aVector);</span>
	}

	/**
	 * Kommentar: Diese Methode geht davon aus, dass das ExplorerModel, das
	 * ObjectModel, die ExplorerFigure und die ListBoxFigure schon miteinander
	 * verknuepft sind. Zunaechst wird das HeaderModel erzeugt und mit dem
	 * ObjectModel verknuepft. Analog wird fuer jedes Feld des Objekts ein
	 * AttributeModel erzeugt und mit dem ObjectModel verknuepft. Dann wird
	 * allen AttributeModels ihr jeweiliger Wert, also das Objekt, auf das das
	 * jeweilige Feld zeigt, zugewiesen. Fuer alle Teile des ObjectModels (also
	 * die Vereinigung von ObjectHeaderModel und AttributeModels) wird je eine
	 * TextBox- Figure erzeugt und mit dem jeweiligen Model verknuepft. Jede der
	 * soeben erzeugten TextBoxFigures erhaelt den ent- sprechenden
	 * darzustellenden Text. Danach wird der mit dem HeaderModel verknuepften
	 * TextBox- Figure der darzustellende Text zugewiesen, anhand dessen die
	 * Groesse bestimmt wird, und anschliessend wird sie mit derselben
	 * ListBoxFigure verknuepft, die mit der Explorer-Figure verknuepft ist, die
	 * die Graphics kennt, anhand derer die Groesse bestimmt wurde. Dann wird
	 * eine FilledRectangleFigure mit der ListBoxFigure verknuepft. Schliesslich
	 * wird mit allen mit einem AttributeModel verknuepften TextBoxFigures
	 * analog zum HeaderModel verfahren. Zum Schluss wird noch die Groesse der
	 * ListBoxFigure korrigiert.
	 */
	public void buildObjectModel(ObjectModel objModl, Object object) {
<span class="nc" id="L83">		this.setObject(objModl, object);</span>
<span class="nc" id="L84">		this.createModelParts(objModl);</span>
<span class="nc" id="L85">		this.setAttributes(objModl);</span>
<span class="nc" id="L86">		this.getListBoxFigureBuilder().buildListBoxFigure(objModl);</span>
<span class="nc" id="L87">		this.initializeObjectViewManager(objModl);</span>
<span class="nc" id="L88">	}</span>

	/**
	 * Kommentar: Diese Methode geht davon aus, dass ExplorerModel,
	 * ExplorerFigure, ObjectModel und ListBoxFigure miteinander verknuepft
	 * sind. Diese Methode erzeugt ein HeaderModel und verknuepft dies mit dem
	 * objectModel. Dasselbe geschieht anschliessend fuer alle Felder des
	 * Objects. Fuer jedes Feld wird ein AttributeModel erzeugt und verknuepft.
	 */
	private void createModelParts(ObjectModel objModl) {
<span class="nc" id="L98">		this.createNewHeaderModel(objModl);</span>
<span class="nc bnc" id="L99" title="All 2 branches missed.">		for (int i = 0; i &lt; objModl.getNumberOfAttributes(); i++) {</span>
<span class="nc bnc" id="L100" title="All 2 branches missed.">			if (objModl.isArrayObject()) {</span>
<span class="nc" id="L101">				this.getAttributeModelBuilder().createArrayAttributeModel(objModl);</span>
			}
			else {
<span class="nc" id="L104">				this.getAttributeModelBuilder().createStandardAttributeModel(objModl);</span>
			}
		}
<span class="nc" id="L107">	}</span>

	/**
	 * Kommentar: Diese Methode geht davon aus, dass das ObjectModel bereits mit
	 * einem Object versehen ist. Erzeugt ein neues HeaderModel und verknuepft
	 * es mit dem ObjectModel.
	 */
	private void createNewHeaderModel(ObjectModel objModl) {
<span class="nc" id="L115">		objModl.setHeaderModel(new ObjectHeaderModel());</span>
<span class="nc" id="L116">		objModl.getHeaderModel().setObjectModel(objModl);</span>
<span class="nc" id="L117">	}</span>

	private void createNewListBoxFigure(ObjectModel objModl) {
<span class="nc" id="L120">		this.getListBoxFigureBuilder().createNewListBoxFigure(objModl);</span>
<span class="nc" id="L121">	}</span>

	private void createNewListBoxFigure(ObjectModel objModl, TextBoxFigure tbf) {
<span class="nc" id="L124">		this.getListBoxFigureBuilder().createNewListBoxFigure(objModl, tbf);</span>
<span class="nc" id="L125">	}</span>

	/**
	 * Kommentar: Diese Methode geht davon aus, dass bereits das ExplorerModel
	 * mit einer ExplorerFigur verknuepft wurde. Sie erzeugt ein neues
	 * ObjectModel und laesst es mit dem ExplorerModel verknuepfen.
	 * Anschliessend veranlasst sie, dies auch mit einer neu zu erzeugenden
	 * ListBoxFigure zu tun.
	 * 
	 * @param explModl
	 *            ExplorerModel
	 * 
	 * @return ObjectModel
	 */
	protected ObjectModel createNewObjectModel(ExplorerModel explModl) {
<span class="nc" id="L140">		ObjectModel objModl = new ObjectModel();</span>
<span class="nc" id="L141">		explModl.addObjectModel(objModl);</span>
<span class="nc" id="L142">		objModl.setExplorerModel(explModl);</span>
<span class="nc" id="L143">		this.createNewListBoxFigure(objModl);</span>
<span class="nc" id="L144">		return objModl;</span>
	}

	/**
	 * 
	 * @param tbf
	 *            TextBoxFigure
	 * 
	 * @return ObjectModel
	 */
	protected ObjectModel createNewObjectModel(TextBoxFigure tbf) {
<span class="nc" id="L155">		ExplorerModel explModel = ((AttributeModel) tbf.getModel()).getObjectModel().getExplorerModel();</span>
<span class="nc" id="L156">		ObjectModel objModl = new ObjectModel();</span>
<span class="nc" id="L157">		explModel.addObjectModel(objModl);</span>
<span class="nc" id="L158">		objModl.setExplorerModel(explModel);</span>
<span class="nc" id="L159">		this.createNewListBoxFigure(objModl, tbf);</span>
<span class="nc" id="L160">		return objModl;</span>
	}

	private AttributeModelBuilder getAttributeModelBuilder() {
<span class="nc" id="L164">		return AttributeModelBuilder.getInstance();</span>
	}

	private ListBoxFigureBuilder getListBoxFigureBuilder() {
<span class="nc" id="L168">		return ListBoxFigureBuilder.getInstance();</span>
	}

	private void initializeObjectViewManager(ObjectModel objModl) {
<span class="nc" id="L172">		ObjectViewManager objView = objModl.getObjectViewManager();</span>
<span class="nc" id="L173">		objView.setAllAttributesVisible(false);</span>
<span class="nc" id="L174">		objView.setNullAttributesVisible(PropertyManager.getInstance().getHideNullAttribut());</span>
<span class="nc" id="L175">		objView.setStaticAttributesVisible(PropertyManager.getInstance().getHideStaticAttribut());</span>
<span class="nc" id="L176">		objView.setUnexploredAttributesVisible(PropertyManager.getInstance().getHideUnexploredAttribut());</span>
<span class="nc bnc" id="L177" title="All 2 branches missed.">		objView.setAttributesToDisplay(!(objModl.isNullObject()));</span>
<span class="nc" id="L178">	}</span>

	public void setAttributes(ObjectModel objModl) {
<span class="nc bnc" id="L181" title="All 2 branches missed.">		if (objModl.isArrayObject()) {</span>
<span class="nc" id="L182">			this.getAttributeModelBuilder().setArrayAttributeData(objModl);</span>
		}
		else {
<span class="nc" id="L185">			this.getAttributeModelBuilder().setStandardAttributeData(objModl);</span>
		}
<span class="nc" id="L187">	}</span>

	public void setObject(ObjectModel objModl, Object object) {
<span class="nc" id="L190">		objModl.setObject(object);</span>
<span class="nc" id="L191">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>