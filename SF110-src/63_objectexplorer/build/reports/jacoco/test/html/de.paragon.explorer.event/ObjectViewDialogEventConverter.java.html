<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ObjectViewDialogEventConverter.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">63_objectexplorer</a> &gt; <a href="index.source.html" class="el_package">de.paragon.explorer.event</a> &gt; <span class="el_source">ObjectViewDialogEventConverter.java</span></div><h1>ObjectViewDialogEventConverter.java</h1><pre class="source lang-java linenums">/**
 * [ObjectExplorer4J - Tool zur grafischen Darstellung von Objekten und ihren
 * Referenzen]
 * 
 * Copyright (C) [2009] [PARAGON Systemhaus GmbH]
 * 
 * This program is free software; you can redistribute it and/or modify it under
 * the terms of the GNU General Public License as published by the Free Software
 * Foundation; either version 3 of the License, or (at your option) any later
 * version.
 * 
 * This program is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE. See the GNU General Public License for more
 * details.
 * 
 * You should have received a copy of the GNU General Public License along with
 * this program; if not, see &lt;http://www.gnu.org/licenses/&gt;.
 **/
package de.paragon.explorer.event;

import java.awt.Point;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.ItemEvent;
import java.awt.event.ItemListener;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.util.Collections;
import java.util.Enumeration;
import java.util.Vector;

import javax.swing.event.ListSelectionEvent;
import javax.swing.event.ListSelectionListener;

import org.apache.log4j.Logger;

import de.paragon.explorer.ProjectConstants4ObjectExplorer;
import de.paragon.explorer.figure.ExplorerFigure;
import de.paragon.explorer.figure.ExplorerFigureBuilder;
import de.paragon.explorer.figure.ListBoxFigure;
import de.paragon.explorer.figure.ListBoxFigureBuilder;
import de.paragon.explorer.figure.TextBoxFigure;
import de.paragon.explorer.gui.ObjectViewDialog;
import de.paragon.explorer.model.AttributeModel;
import de.paragon.explorer.model.AttributeModelComparator;
import de.paragon.explorer.model.ExplorerModel;
import de.paragon.explorer.model.ObjectModel;
import de.paragon.explorer.model.StandardAttributeModel;
import de.paragon.explorer.util.LoggerFactory;
import de.paragon.explorer.util.ObjectViewManager;

/**
 * Diese Klasse erzeugt den Object View Dialog und verarbeitet die zugehoerigen
 * Events
 */
public class ObjectViewDialogEventConverter extends WindowAdapter implements ActionListener, ItemListener, ListSelectionListener, KeyListener {
<span class="fc" id="L60">	private static final Logger		logger		= LoggerFactory.make();</span>
	private static final int		NUMBER_100	= 100;
	private static final int		NUMBER_400	= 400;
	private ExplorerFigure			explorerFigure;
	private ObjectViewDialog		objectViewDialog;
	private ListBoxFigure			objectToView;
	private Object					selectedObject;
	private Vector&lt;AttributeModel&gt;	visibleAttributes;
	private Vector&lt;AttributeModel&gt;	invisibleAttributes;

	/**
	 * AboutDialogEventConverter constructor comment.
	 */
	public ObjectViewDialogEventConverter(ExplorerFigure expl) {
<span class="nc" id="L74">		super();</span>
<span class="nc" id="L75">		this.setExplorerFigure(expl);</span>
<span class="nc" id="L76">	}</span>

	public void actionPerformed(ActionEvent event) {
<span class="nc" id="L79">		String actionCommand = event.getActionCommand();</span>
<span class="nc bnc" id="L80" title="All 2 branches missed.">		if (actionCommand.equals(ProjectConstants4ObjectExplorer.getOBJECT_VIEW_DIALOG_GO_TO())) {</span>
<span class="nc" id="L81">			this.gotoObject();</span>
		}
<span class="nc bnc" id="L83" title="All 2 branches missed.">		else if (actionCommand.equals(ProjectConstants4ObjectExplorer.getOBJECT_VIEW_DIALOG_CLOSE())) {</span>
<span class="nc" id="L84">			this.close();</span>
		}
<span class="nc bnc" id="L86" title="All 2 branches missed.">		else if (actionCommand.equals(ProjectConstants4ObjectExplorer.getOBJECT_VIEW_DIALOG_EXPLORE())) {</span>
<span class="nc" id="L87">			this.explore();</span>
		}
<span class="nc bnc" id="L89" title="All 2 branches missed.">		else if (actionCommand.equals(ProjectConstants4ObjectExplorer.getOBJECT_VIEW_DIALOG_ADD())) {</span>
<span class="nc" id="L90">			this.add();</span>
		}
<span class="nc bnc" id="L92" title="All 2 branches missed.">		else if (actionCommand.equals(ProjectConstants4ObjectExplorer.getOBJECT_VIEW_DIALOG_REMOVE())) {</span>
<span class="nc" id="L93">			this.remove();</span>
		}
<span class="nc" id="L95">	}</span>

	private void add() {
<span class="nc" id="L98">		this.getInvisibleAttributes().remove(this.getSelectedObject());</span>
<span class="nc" id="L99">		this.getVisibleAttributes().addElement((AttributeModel) this.getSelectedObject());</span>
<span class="nc" id="L100">		Collections.sort(this.getVisibleAttributes(), new AttributeModelComparator());</span>
<span class="nc" id="L101">		this.getObjectViewDialog().getVisibleList().setListData(this.getVisibleAttributesNames());</span>
<span class="nc" id="L102">		this.getObjectViewDialog().getInvisibleList().setListData(this.getInvisibleAttributesNames());</span>
<span class="nc" id="L103">		this.selectionChangedVisibleList();</span>
<span class="nc" id="L104">		this.setAttributeVisible();</span>
<span class="nc" id="L105">	}</span>

	private void close() {
<span class="nc" id="L108">		this.getObjectViewDialog().setVisible(false);</span>
<span class="nc" id="L109">		this.getExplorerFigure().getFrame().getWindowMenu().getItem(0).setEnabled(true);</span>
<span class="nc" id="L110">		((ExplorerModel) this.getExplorerFigure().getModel()).getDrawingFrameEventConverter().getHeaderPopupMenu().enable(&quot;object view&quot;, true);</span>
<span class="nc" id="L111">		this.reset();</span>
<span class="nc" id="L112">	}</span>

	private final void displayDialog() {
		// this.getExplorerFigure().getFrame().getGlassPane().setVisible(true);
		// javax.swing.SwingUtilities.convertPointToScreen(point,((ExplorerFigure)this.getObjectToView().getParent()).getFrame());
<span class="nc" id="L117">		this.getObjectViewDialog().setLocation(new Point(ObjectViewDialogEventConverter.NUMBER_400, ObjectViewDialogEventConverter.NUMBER_100));</span>
<span class="nc" id="L118">		this.getObjectViewDialog().setVisible(true);</span>
<span class="nc" id="L119">	}</span>

	private void explore() {
<span class="nc" id="L122">		AttributeModel attrModl = (AttributeModel) this.getSelectedObject();</span>
<span class="nc" id="L123">		TextBoxFigure teBoFi = (TextBoxFigure) attrModl.getFigure();</span>
<span class="nc" id="L124">		this.getExplorerActionConverter().showInForeground(teBoFi);</span>
<span class="nc" id="L125">		this.setExploreButtonEnabled(false);</span>
<span class="nc" id="L126">		this.getObjectViewDialog().setGoToButtonEnabled(true);</span>
<span class="nc" id="L127">	}</span>

	private int findIndex(Vector&lt;String&gt; aVector) {
<span class="nc" id="L130">		int selectedIndex = -1;</span>
<span class="nc bnc" id="L131" title="All 4 branches missed.">		if ((aVector != null) &amp;&amp; (this.getSelectedObject() != null)) {</span>
<span class="nc bnc" id="L132" title="All 2 branches missed.">			for (int i = 0; i &lt; aVector.size(); i++) {</span>
<span class="nc bnc" id="L133" title="All 2 branches missed.">				if (aVector.elementAt(i).equals(((AttributeModel) this.getSelectedObject()).getName())) {</span>
<span class="nc" id="L134">					selectedIndex = i;</span>
				}
			}
		}
<span class="nc" id="L138">		return selectedIndex;</span>
	}

	private ExplorerActionConverter getExplorerActionConverter() {
<span class="nc" id="L142">		return ExplorerActionConverter.getInstance();</span>
	}

	private ExplorerFigure getExplorerFigure() {
<span class="nc" id="L146">		return this.explorerFigure;</span>
	}

	private ExplorerFigureBuilder getExplorerFigureBuilder() {
<span class="nc" id="L150">		return ExplorerFigureBuilder.getInstance();</span>
	}

	private Vector&lt;AttributeModel&gt; getInvisibleAttributes() {
<span class="nc bnc" id="L154" title="All 2 branches missed.">		if (this.invisibleAttributes == null) {</span>
<span class="nc" id="L155">			this.setInvisibleAttributes((Vector&lt;AttributeModel&gt;) this.getObjectViewManager().getInvisibleAttributes());</span>
		}
<span class="nc" id="L157">		return this.invisibleAttributes;</span>
	}

	private Vector&lt;String&gt; getInvisibleAttributesNames() {
<span class="nc" id="L161">		Vector&lt;String&gt; names = new Vector&lt;String&gt;();</span>
<span class="nc bnc" id="L162" title="All 2 branches missed.">		for (int i = 0; i &lt; this.getInvisibleAttributes().size(); i++) {</span>
<span class="nc" id="L163">			names.add((this.getInvisibleAttributes().elementAt(i)).getName());</span>
		}
		// Collections.sort(names);
<span class="nc" id="L166">		return names;</span>
	}

	private ListBoxFigureBuilder getListBoxFigureBuilder() {
<span class="nc" id="L170">		return ListBoxFigureBuilder.getInstance();</span>
	}

	private ListBoxFigure getObjectToView() {
<span class="nc" id="L174">		return this.objectToView;</span>
	}

	private ObjectViewDialog getObjectViewDialog() {
<span class="nc bnc" id="L178" title="All 2 branches missed.">		if (this.objectViewDialog == null) {</span>
<span class="nc" id="L179">			this.setObjectViewDialog(new ObjectViewDialog(this.getExplorerFigure().getFrame(), false));</span>
<span class="nc" id="L180">			this.initialize();</span>
		}
<span class="nc" id="L182">		return this.objectViewDialog;</span>
	}

	private ObjectViewManager getObjectViewManager() {
<span class="nc" id="L186">		return ((ObjectModel) this.getObjectToView().getModel()).getObjectViewManager();</span>
	}

	private Object getSelectedObject() {
<span class="nc" id="L190">		return this.selectedObject;</span>
	}

	private Vector&lt;AttributeModel&gt; getVisibleAttributes() {
<span class="nc bnc" id="L194" title="All 2 branches missed.">		if (this.visibleAttributes == null) {</span>
<span class="nc" id="L195">			this.setVisibleAttributes((Vector&lt;AttributeModel&gt;) this.getObjectViewManager().getVisibleAttributes());</span>
		}
<span class="nc" id="L197">		return this.visibleAttributes;</span>
	}

	private Vector&lt;String&gt; getVisibleAttributesNames() {
<span class="nc" id="L201">		Vector&lt;String&gt; names = new Vector&lt;String&gt;();</span>
<span class="nc bnc" id="L202" title="All 2 branches missed.">		for (int i = 0; i &lt; this.getVisibleAttributes().size(); i++) {</span>
<span class="nc" id="L203">			names.add((this.getVisibleAttributes().elementAt(i)).getName());</span>
		}
		// Collections.sort(names);
<span class="nc" id="L206">		return names;</span>
	}

	private void gotoObject() {
<span class="nc" id="L210">		AttributeModel attrModl = (AttributeModel) this.getSelectedObject();</span>
<span class="nc bnc" id="L211" title="All 2 branches missed.">		if (attrModl != null) {</span>
<span class="nc" id="L212">			de.paragon.explorer.figure.TextBoxFigure teBoFi = (TextBoxFigure) attrModl.getConnectionModel().getHeaderModel().getFigure();</span>
<span class="nc" id="L213">			this.getExplorerActionConverter().setInForeground((ListBoxFigure) teBoFi.getParent());</span>
<span class="nc" id="L214">			this.getExplorerFigure().getFocusManager().handleFocus(teBoFi, false);</span>
<span class="nc" id="L215">			this.updateObjectFocus((ListBoxFigure) teBoFi.getParent());</span>
		}
<span class="nc" id="L217">	}</span>

	private void handleAttribute() {
		AttributeModel attrModl;
<span class="nc" id="L221">		attrModl = (AttributeModel) this.getSelectedObject();</span>
<span class="nc bnc" id="L222" title="All 2 branches missed.">		if (attrModl != null) {</span>
<span class="nc" id="L223">			this.getObjectViewDialog().getInfoText().setText(attrModl.getCompleteTitle());</span>
<span class="nc" id="L224">			this.getObjectViewDialog().getInfoText().setCaretPosition(0);</span>
<span class="nc bnc" id="L225" title="All 4 branches missed.">			if ((!attrModl.isAttributePrimitive() &amp;&amp; (attrModl.getConnectionModel() == null))) {</span>
<span class="nc" id="L226">				this.setExploreButtonEnabled(true);</span>
<span class="nc" id="L227">				this.getObjectViewDialog().setGoToButtonEnabled(false);</span>
			}
			else {
<span class="nc" id="L230">				this.setExploreButtonEnabled(false);</span>
<span class="nc bnc" id="L231" title="All 2 branches missed.">				if (attrModl.isAttributePrimitive()) {</span>
<span class="nc" id="L232">					this.getObjectViewDialog().setGoToButtonEnabled(false);</span>
				}
				else {
<span class="nc" id="L235">					this.getObjectViewDialog().setGoToButtonEnabled(true);</span>
				}
			}
		}
<span class="nc" id="L239">	}</span>

	private void handleFocus(boolean mousePressed) {
		int selectedIndex;
<span class="nc" id="L243">		selectedIndex = this.findIndex(this.getVisibleAttributesNames());</span>
<span class="nc bnc" id="L244" title="All 2 branches missed.">		if (selectedIndex &gt;= 0) {</span>
<span class="nc" id="L245">			this.setSelectedObject(this.getVisibleAttributes().elementAt(selectedIndex));</span>
<span class="nc" id="L246">			this.selectionChangedVisibleList();</span>
		}
		else {
<span class="nc" id="L249">			selectedIndex = this.findIndex(this.getInvisibleAttributesNames());</span>
<span class="nc bnc" id="L250" title="All 2 branches missed.">			if ((selectedIndex &gt;= 0)) {</span>
<span class="nc" id="L251">				this.setSelectedObject(this.getInvisibleAttributes().elementAt(selectedIndex));</span>
<span class="nc" id="L252">				this.selectionChangedInvisibleList();</span>
			}
			else {
<span class="nc" id="L255">				this.getObjectViewDialog().getInvisibleList().clearSelection();</span>
				// this.getObjectViewDialog().getInvisibleList().ensureIndexIsVisible(0);
				// this.getObjectViewDialog().getVisibleList().clearSelection();
				// this.getObjectViewDialog().getVisibleList().ensureIndexIsVisible(0);
<span class="nc" id="L259">				this.setSelectedObject(null);</span>
<span class="nc" id="L260">				this.getExplorerFigure().getFocusManager()</span>
<span class="nc" id="L261">						.handleFocus((TextBoxFigure) ((ObjectModel) this.getObjectToView().getModel()).getHeaderModel().getFigure(), mousePressed);</span>
			}
		}
<span class="nc" id="L264">	}</span>

	private void initialize() {
<span class="nc" id="L267">		final ObjectViewDialog objectViewDialog4Init = this.getObjectViewDialog();</span>
<span class="nc" id="L268">		objectViewDialog4Init.addListSelectionListener(this);</span>
<span class="nc" id="L269">		objectViewDialog4Init.addKeyListener(this);</span>
<span class="nc" id="L270">		objectViewDialog4Init.addButtonActionListener(this);</span>
<span class="nc" id="L271">		objectViewDialog4Init.addWindowListener(this);</span>
<span class="nc" id="L272">		objectViewDialog4Init.addItemListener(this);</span>
<span class="nc" id="L273">		objectViewDialog4Init.setTitle(((ExplorerModel) this.getExplorerFigure().getModel()).getName() + &quot; Object View&quot;);</span>
<span class="nc" id="L274">	}</span>

	public final void initializeDialog(ListBoxFigure param, boolean mousePressed) {
<span class="nc" id="L277">		this.setObjectToView(param);</span>
<span class="nc" id="L278">		final ObjectViewDialog objectViewDialog4Init = this.getObjectViewDialog();</span>
<span class="nc" id="L279">		objectViewDialog4Init.setRemoveButtonEnabled(false);</span>
<span class="nc" id="L280">		objectViewDialog4Init.setAddButtonEnabled(false);</span>
<span class="nc" id="L281">		objectViewDialog4Init.setExploreButtonEnabled(false);</span>
<span class="nc" id="L282">		objectViewDialog4Init.setGoToButtonEnabled(false);</span>
<span class="nc" id="L283">		objectViewDialog4Init.getVisibleList().setListData(this.getVisibleAttributesNames());</span>
<span class="nc" id="L284">		objectViewDialog4Init.getInvisibleList().setListData(this.getInvisibleAttributesNames());</span>
<span class="nc" id="L285">		this.handleFocus(mousePressed);</span>
<span class="nc" id="L286">	}</span>

	public final void itemStateChanged(ItemEvent event) {
		// if (event.getStateChange() == ItemEvent.SELECTED) {
		// nicht implementiert
		// this.getObjectTitleManager().getValuesToShow().add(this.getObjectToView().getModel().getObject().getClass());
		// }
<span class="nc" id="L293">	}</span>

	public void keyPressed(KeyEvent e) {
<span class="nc bnc" id="L296" title="All 2 branches missed.">		if (e.getSource() == this.getObjectViewDialog().getInvisibleList()) {</span>
<span class="nc" id="L297">			this.keyPressedInvisibleList(e);</span>
		}
<span class="nc bnc" id="L299" title="All 2 branches missed.">		if (e.getSource() == this.getObjectViewDialog().getVisibleList()) {</span>
<span class="nc" id="L300">			this.keyPressedVisibleList(e);</span>
		}
<span class="nc" id="L302">	}</span>

	public void keyPressedInvisibleList(KeyEvent e) {
<span class="nc" id="L305">		Character charKey = Character.valueOf(e.getKeyChar());</span>
<span class="nc" id="L306">		String key = charKey.toString();</span>
<span class="nc" id="L307">		int selectedIndex = this.getObjectViewDialog().getInvisibleList().getSelectedIndex();</span>
		int j;
<span class="nc" id="L309">		Vector&lt;String&gt; invisibleAttributesNames = this.getInvisibleAttributesNames();</span>
<span class="nc" id="L310">		String elementAtAsString = null;</span>
<span class="nc bnc" id="L311" title="All 2 branches missed.">		for (int i = 0; i &lt; invisibleAttributesNames.size(); i++) {</span>
<span class="nc" id="L312">			elementAtAsString = invisibleAttributesNames.elementAt(i);</span>
<span class="nc bnc" id="L313" title="All 4 branches missed.">			if (elementAtAsString.startsWith(key) || elementAtAsString.startsWith(key.toUpperCase())) {</span>
<span class="nc" id="L314">				selectedIndex = i;</span>
<span class="nc bnc" id="L315" title="All 2 branches missed.">				if (this.getSelectedObject() != null) {</span>
<span class="nc bnc" id="L316" title="All 2 branches missed.">					if (((AttributeModel) this.getSelectedObject()).getName().startsWith(key)</span>
<span class="nc bnc" id="L317" title="All 2 branches missed.">							|| ((AttributeModel) this.getSelectedObject()).getName().startsWith(key.toUpperCase())) {</span>
<span class="nc" id="L318">						j = this.getObjectViewDialog().getInvisibleList().getSelectedIndex();</span>
<span class="nc bnc" id="L319" title="All 2 branches missed.">						if (invisibleAttributesNames.size() &gt; (j + 1)) {</span>
<span class="nc bnc" id="L320" title="All 4 branches missed.">							if ((invisibleAttributesNames.elementAt(j + 1)).startsWith(key) || (invisibleAttributesNames.elementAt(j + 1)).startsWith(key.toUpperCase())) {</span>
<span class="nc" id="L321">								selectedIndex = j + 1;</span>
							}
						}
					}
				}
<span class="nc" id="L326">				this.setSelectedObject(this.getInvisibleAttributes().elementAt(selectedIndex));</span>
<span class="nc" id="L327">				this.selectionChangedInvisibleList();</span>
<span class="nc" id="L328">				break;</span>
			}
		}
<span class="nc" id="L331">	}</span>

	public void keyPressedVisibleList(KeyEvent e) {
<span class="nc" id="L334">		Character charKey = Character.valueOf(e.getKeyChar());</span>
<span class="nc" id="L335">		String key = charKey.toString();</span>
<span class="nc" id="L336">		int selectedIndex = this.getObjectViewDialog().getVisibleList().getSelectedIndex();</span>
		int j;
<span class="nc bnc" id="L338" title="All 2 branches missed.">		for (int i = 0; i &lt; this.getVisibleAttributesNames().size(); i++) {</span>
<span class="nc bnc" id="L339" title="All 4 branches missed.">			if ((this.getVisibleAttributesNames().elementAt(i)).startsWith(key) || (this.getVisibleAttributesNames().elementAt(i)).startsWith(key.toUpperCase())) {</span>
<span class="nc" id="L340">				selectedIndex = i;</span>
<span class="nc bnc" id="L341" title="All 2 branches missed.">				if (this.getSelectedObject() != null) {</span>
<span class="nc bnc" id="L342" title="All 2 branches missed.">					if (((AttributeModel) this.getSelectedObject()).getName().startsWith(key)</span>
<span class="nc bnc" id="L343" title="All 2 branches missed.">							|| ((AttributeModel) this.getSelectedObject()).getName().startsWith(key.toUpperCase())) {</span>
<span class="nc" id="L344">						j = this.getObjectViewDialog().getVisibleList().getSelectedIndex();</span>
<span class="nc bnc" id="L345" title="All 2 branches missed.">						if ((this.getVisibleAttributesNames().size() &gt; (j + 1))) {</span>
<span class="nc bnc" id="L346" title="All 2 branches missed.">							if ((this.getVisibleAttributesNames().elementAt(j + 1)).startsWith(key)</span>
<span class="nc bnc" id="L347" title="All 2 branches missed.">									|| (this.getVisibleAttributesNames().elementAt(j + 1)).startsWith(key.toUpperCase())) {</span>
<span class="nc" id="L348">								selectedIndex = j + 1;</span>
							}
						}
					}
					else {
<span class="nc bnc" id="L353" title="All 2 branches missed.">						if (ObjectViewDialogEventConverter.logger.isDebugEnabled()) {</span>
<span class="nc" id="L354">							ObjectViewDialogEventConverter.logger.debug(&quot;kein Object mit diesem Buchstaben selektiert: &quot; + key.toString() + &quot; &quot;</span>
<span class="nc" id="L355">									+ ((AttributeModel) this.getSelectedObject()).getName());</span>
						}
					}
				}
				else {
<span class="nc bnc" id="L360" title="All 2 branches missed.">					if (ObjectViewDialogEventConverter.logger.isDebugEnabled()) {</span>
<span class="nc" id="L361">						ObjectViewDialogEventConverter.logger.debug(&quot;selectedObject == null&quot;);</span>
					}
				}
<span class="nc" id="L364">				this.setSelectedObject(this.getVisibleAttributes().elementAt(selectedIndex));</span>
<span class="nc" id="L365">				this.selectionChangedVisibleList();</span>
<span class="nc" id="L366">				break;</span>
			}
		}
		// System.out.println(key.toString()+ &quot; &quot; +((AttributeModel)
		// this.getSelectedObject()).getName() + &quot; &quot;+ selectedIndex);
<span class="nc" id="L371">	}</span>

	public void keyRealsed(KeyEvent e) {
<span class="nc" id="L374">	}</span>

	public void keyReleased(KeyEvent e) {
<span class="nc" id="L377">	}</span>

	public void keyTyped(KeyEvent e) {
<span class="nc" id="L380">	}</span>

	private void remove() {
<span class="nc" id="L383">		this.getVisibleAttributes().remove(this.getSelectedObject());</span>
<span class="nc bnc" id="L384" title="All 2 branches missed.">		if (this.getSelectedObject() != null) {</span>
<span class="nc" id="L385">			this.getInvisibleAttributes().addElement((AttributeModel) this.getSelectedObject());</span>
		}
		// sortieren der liste
<span class="nc" id="L388">		Collections.sort(this.getInvisibleAttributes(), new AttributeModelComparator());</span>
		// update der listen
<span class="nc" id="L390">		this.getObjectViewDialog().getVisibleList().setListData(this.getVisibleAttributesNames());</span>
<span class="nc" id="L391">		this.getObjectViewDialog().getInvisibleList().setListData(this.getInvisibleAttributesNames());</span>
		// aktualisieren der oberflaeche
<span class="nc" id="L393">		this.selectionChangedInvisibleList();</span>
<span class="nc" id="L394">		this.setAttributeInvisible();</span>
<span class="nc" id="L395">	}</span>

	private void reset() {
<span class="nc" id="L398">		this.setVisibleAttributes(null);</span>
<span class="nc" id="L399">		this.setInvisibleAttributes(null);</span>
<span class="nc" id="L400">		this.getObjectViewDialog().getInfoText().setText(&quot;&quot;);</span>
		// this.setSelectedObject(null);
		// this.getExplorerFigure().getFrame().getGlassPane().setVisible(false);
<span class="nc" id="L403">	}</span>

	private void selectionChangedInvisibleList() {
<span class="nc" id="L406">		final ObjectViewDialog objectViewDialog2 = this.getObjectViewDialog();</span>
<span class="nc" id="L407">		objectViewDialog2.setRemoveButtonEnabled(false);</span>
<span class="nc" id="L408">		objectViewDialog2.setAddButtonEnabled(true);</span>
<span class="nc" id="L409">		objectViewDialog2.getVisibleList().clearSelection();</span>
<span class="nc" id="L410">		objectViewDialog2.getInvisibleList().setSelectedIndex(this.getInvisibleAttributes().indexOf(this.getSelectedObject()));</span>
<span class="nc" id="L411">		objectViewDialog2.getInvisibleList().ensureIndexIsVisible(this.getInvisibleAttributes().indexOf(this.getSelectedObject()));</span>
<span class="nc" id="L412">		this.handleAttribute();</span>
<span class="nc" id="L413">		de.paragon.explorer.figure.ListBoxFigure liBoFi = this.getObjectToView();</span>
<span class="nc" id="L414">		this.getExplorerFigure().getFocusManager().handleFocus((TextBoxFigure) ((ObjectModel) liBoFi.getModel()).getHeaderModel().getFigure(), false);</span>
<span class="nc" id="L415">	}</span>

	private void selectionChangedVisibleList() {
<span class="nc" id="L418">		final ObjectViewDialog objectViewDialog2 = this.getObjectViewDialog();</span>
<span class="nc" id="L419">		objectViewDialog2.setRemoveButtonEnabled(true);</span>
<span class="nc" id="L420">		objectViewDialog2.setAddButtonEnabled(false);</span>
<span class="nc" id="L421">		objectViewDialog2.getInvisibleList().clearSelection();</span>
<span class="nc" id="L422">		objectViewDialog2.getVisibleList().setSelectedIndex(this.getVisibleAttributes().indexOf(this.getSelectedObject()));</span>
<span class="nc" id="L423">		objectViewDialog2.getVisibleList().ensureIndexIsVisible(this.getVisibleAttributes().indexOf(this.getSelectedObject()));</span>
<span class="nc" id="L424">		this.handleAttribute();</span>
<span class="nc bnc" id="L425" title="All 2 branches missed.">		if (this.getSelectedObject() != null) {</span>
<span class="nc" id="L426">			TextBoxFigure teBoFi = (TextBoxFigure) ((AttributeModel) this.getSelectedObject()).getFigure();</span>
<span class="nc" id="L427">			this.getExplorerFigure().getFocusManager().handleFocus(teBoFi, false);</span>
		}
<span class="nc" id="L429">	}</span>

	private void setAttributeInvisible() {
<span class="nc" id="L432">		AttributeModel attrModl = (AttributeModel) this.getSelectedObject();</span>
<span class="nc" id="L433">		this.getListBoxFigureBuilder().setSingleAttributeUnvisible((TextBoxFigure) attrModl.getFigure());</span>
<span class="nc" id="L434">		ListBoxFigure liBoFi = (ListBoxFigure) ((TextBoxFigure) attrModl.getFigure()).getParent();</span>
<span class="nc" id="L435">		this.getListBoxFigureBuilder().initializeListBoxFigure(liBoFi);</span>
<span class="nc" id="L436">		this.getExplorerFigureBuilder().update((ExplorerFigure) liBoFi.getParent());</span>
<span class="nc" id="L437">	}</span>

	private void setAttributeVisible() {
<span class="nc" id="L440">		AttributeModel attrModl = (AttributeModel) this.getSelectedObject();</span>
<span class="nc" id="L441">		this.getListBoxFigureBuilder().setSingleAttributeVisible((TextBoxFigure) attrModl.getFigure());</span>
<span class="nc" id="L442">		ListBoxFigure liBoFi = (ListBoxFigure) ((TextBoxFigure) attrModl.getFigure()).getParent();</span>
<span class="nc" id="L443">		this.getListBoxFigureBuilder().initializeListBoxFigure(liBoFi);</span>
<span class="nc" id="L444">		this.getExplorerFigureBuilder().update((ExplorerFigure) liBoFi.getParent());</span>
<span class="nc" id="L445">	}</span>

	public void setExploreButtonEnabled(boolean value) {
<span class="nc" id="L448">		this.getObjectViewDialog().setExploreButtonEnabled(value);</span>
<span class="nc" id="L449">	}</span>

	private void setExplorerFigure(ExplorerFigure newExplorerFigure) {
<span class="nc" id="L452">		this.explorerFigure = newExplorerFigure;</span>
<span class="nc" id="L453">	}</span>

	private void setInvisibleAttributes(Vector&lt;AttributeModel&gt; newInvisibleAttributes) {
<span class="nc" id="L456">		this.invisibleAttributes = newInvisibleAttributes;</span>
<span class="nc" id="L457">	}</span>

	private void setObjectToView(ListBoxFigure newObjectToView) {
<span class="nc" id="L460">		this.objectToView = newObjectToView;</span>
<span class="nc" id="L461">	}</span>

	private void setObjectViewDialog(ObjectViewDialog newObjectViewDialog) {
<span class="nc" id="L464">		this.objectViewDialog = newObjectViewDialog;</span>
<span class="nc" id="L465">	}</span>

	private void setSelectedObject(Object newSelectedObject) {
<span class="nc" id="L468">		this.selectedObject = newSelectedObject;</span>
<span class="nc bnc" id="L469" title="All 2 branches missed.">		this.getObjectViewDialog().getGoToButton().setEnabled(newSelectedObject != null);</span>
<span class="nc bnc" id="L470" title="All 2 branches missed.">		this.getObjectViewDialog().getAddButton().setEnabled(newSelectedObject != null);</span>
<span class="nc bnc" id="L471" title="All 2 branches missed.">		this.getObjectViewDialog().getRemoveButton().setEnabled(newSelectedObject != null);</span>
<span class="nc" id="L472">	}</span>

	private void setVisibleAttributes(Vector&lt;AttributeModel&gt; newVisibleAttributes) {
<span class="nc" id="L475">		this.visibleAttributes = newVisibleAttributes;</span>
<span class="nc" id="L476">	}</span>

	public final void showDialog() {
<span class="nc bnc" id="L479" title="All 2 branches missed.">		if (!(this.getObjectViewDialog().isShowing())) {</span>
<span class="nc" id="L480">			this.displayDialog();</span>
<span class="nc" id="L481">			this.getExplorerFigure().getFrame().getWindowMenu().getItem(0).setEnabled(false);</span>
<span class="nc" id="L482">			((ExplorerModel) this.getExplorerFigure().getModel()).getDrawingFrameEventConverter().getHeaderPopupMenu().enable(&quot;object view&quot;, false);</span>
		}
<span class="nc" id="L484">	}</span>

	public final void updateAttributeFocus(TextBoxFigure param) {
<span class="nc" id="L487">		this.setSelectedObject(param.getModel());</span>
<span class="nc" id="L488">		this.selectionChangedVisibleList();</span>
<span class="nc" id="L489">	}</span>

	public final void updateObjectFocus(ListBoxFigure param) {
<span class="nc bnc" id="L492" title="All 2 branches missed.">		if (this.getObjectViewDialog().isVisible()) {</span>
<span class="nc" id="L493">			this.reset();</span>
<span class="nc" id="L494">			this.initializeDialog(param, false);</span>
		}
<span class="nc" id="L496">	}</span>

	public final void updateObjectFocusMousePressed(ListBoxFigure param) {
<span class="nc" id="L499">		boolean found = false;</span>
<span class="nc" id="L500">		Object foundElement = null;</span>
<span class="nc" id="L501">		Object oldSelection = this.getSelectedObject();</span>
<span class="nc" id="L502">		Enumeration&lt;?&gt; enumeration = ((ObjectModel) param.getModel()).getAttributeModels().getVector().elements();</span>
<span class="nc bnc" id="L503" title="All 4 branches missed.">		while (enumeration.hasMoreElements() &amp;&amp; !found) {</span>
<span class="nc" id="L504">			foundElement = enumeration.nextElement();</span>
<span class="nc bnc" id="L505" title="All 4 branches missed.">			if ((foundElement instanceof StandardAttributeModel) &amp;&amp; (oldSelection instanceof StandardAttributeModel)) {</span>
<span class="nc bnc" id="L506" title="All 2 branches missed.">				if (((StandardAttributeModel) foundElement).getName().equals(((StandardAttributeModel) oldSelection).getName())) {</span>
<span class="nc" id="L507">					found = true;</span>
				}
			}
		}
<span class="nc bnc" id="L511" title="All 2 branches missed.">		if (found) {</span>
<span class="nc" id="L512">			this.setSelectedObject(foundElement);</span>
		}
		else {
<span class="nc" id="L515">			this.setSelectedObject(null);</span>
		}
<span class="nc" id="L517">		this.reset();</span>
<span class="nc" id="L518">		this.initializeDialog(param, true);</span>
<span class="nc" id="L519">	}</span>

	public final void valueChanged(ListSelectionEvent event) {
		// if (event.getValueIsAdjusting()) {
<span class="nc bnc" id="L523" title="All 2 branches missed.">		if (event.getSource() == this.getObjectViewDialog().getVisibleList().getSelectionModel()) {</span>
			// System.out.println(&quot;valueChanged &quot;);
<span class="nc bnc" id="L525" title="All 2 branches missed.">			for (int i = 0; i &lt; this.getVisibleAttributes().size(); i++) {</span>
<span class="nc bnc" id="L526" title="All 2 branches missed.">				if (this.getObjectViewDialog().getVisibleList().getSelectionModel().isSelectedIndex(i)) {</span>
<span class="nc" id="L527">					this.setSelectedObject((this.getVisibleAttributes()).elementAt(i));</span>
				}
			}
<span class="nc" id="L530">			this.selectionChangedVisibleList();</span>
		}
<span class="nc bnc" id="L532" title="All 2 branches missed.">		if (event.getSource() == this.getObjectViewDialog().getInvisibleList().getSelectionModel()) {</span>
<span class="nc bnc" id="L533" title="All 2 branches missed.">			for (int i = 0; i &lt; this.getInvisibleAttributes().size(); i++) {</span>
<span class="nc bnc" id="L534" title="All 2 branches missed.">				if (this.getObjectViewDialog().getInvisibleList().getSelectionModel().isSelectedIndex(i)) {</span>
<span class="nc" id="L535">					this.setSelectedObject((this.getInvisibleAttributes()).elementAt(i));</span>
				}
			}
<span class="nc" id="L538">			this.selectionChangedInvisibleList();</span>
		}
		// }
<span class="nc" id="L541">	}</span>

	@Override
	public void windowClosing(WindowEvent e) {
<span class="nc" id="L545">		this.reset();</span>
<span class="nc" id="L546">		this.getExplorerFigure().getFrame().getWindowMenu().getItem(0).setEnabled(true);</span>
<span class="nc" id="L547">		((ExplorerModel) this.getExplorerFigure().getModel()).getDrawingFrameEventConverter().getHeaderPopupMenu().enable(&quot;object view&quot;, true);</span>
<span class="nc" id="L548">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>