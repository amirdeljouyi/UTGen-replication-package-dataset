<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ClosableTabbedPaneUI.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">73_fim1</a> &gt; <a href="index.source.html" class="el_package">osa.ora.server.client.ui.utils</a> &gt; <span class="el_source">ClosableTabbedPaneUI.java</span></div><h1>ClosableTabbedPaneUI.java</h1><pre class="source lang-java linenums">/*
 * ClosableTabbedPaneUI.java
 *
 * Created on October 29, 2009, 5:19 PM
 *
 * To change this template, choose Tools | Template Manager
 * and open the template in the editor.
 */

package osa.ora.server.client.ui.utils;
import javax.swing.*;
import javax.swing.plaf.basic.*;
import java.awt.*;
import java.awt.event.*;
import osa.ora.server.client.*;
/**
 *
 * @author ooransa
 */
public  class ClosableTabbedPaneUI extends BasicTabbedPaneUI{
    //override to return our layoutmanager
    ChatClientApp chatApp;
<span class="nc" id="L23">    public ClosableTabbedPaneUI(ChatClientApp chatApp){</span>
<span class="nc" id="L24">        this.chatApp=chatApp;</span>
<span class="nc" id="L25">    }</span>
    protected LayoutManager createLayoutManager(){        
<span class="nc" id="L27">        return new TestPlafLayout();</span>
    }
    //add 40 to the tab size to allow room for the close button and 8 to the height
    protected Insets getTabInsets(int tabPlacement,int tabIndex){
        //note that the insets that are returned to us are not copies.
<span class="nc" id="L32">        Insets defaultInsets = (Insets)super.getTabInsets(tabPlacement,tabIndex).clone();</span>
<span class="nc" id="L33">        defaultInsets.right += 40;</span>
<span class="nc" id="L34">        defaultInsets.top += 4;</span>
<span class="nc" id="L35">        defaultInsets.bottom += 4;</span>
<span class="nc" id="L36">        return defaultInsets;</span>
    }
<span class="nc" id="L38">    class TestPlafLayout extends TabbedPaneLayout {</span>
        //a list of our close buttons
<span class="nc" id="L40">        java.util.ArrayList closeButtons = new java.util.ArrayList();</span>
        public void layoutContainer(Container parent){
<span class="nc" id="L42">            super.layoutContainer(parent);</span>
            //ensure that there are at least as many close buttons as tabs
<span class="nc bnc" id="L44" title="All 2 branches missed.">            while(tabPane.getTabCount() &gt; closeButtons.size()){</span>
<span class="nc" id="L45">                closeButtons.add(new CloseButton(closeButtons.size()));</span>
            }
<span class="nc" id="L47">            Rectangle rect = new Rectangle();</span>
            int i;
            //start loop from 1 to exclude 1st tab from having this close button
<span class="nc bnc" id="L50" title="All 2 branches missed.">            for(i = 1; i &lt; tabPane.getTabCount();i++){</span>
<span class="nc" id="L51">                rect = getTabBounds(i,rect);</span>
<span class="nc" id="L52">                JButton closeButton = (JButton)closeButtons.get(i);</span>
                //shift the close button 3 down from the top of the pane and 20 to the left
<span class="nc" id="L54">                closeButton.setLocation(rect.x+rect.width-20,rect.y+5);</span>
<span class="nc" id="L55">                closeButton.setSize(15,15);</span>
<span class="nc" id="L56">                tabPane.add(closeButton);</span>
            }
<span class="nc bnc" id="L58" title="All 2 branches missed.">            for(;i &lt; closeButtons.size();i++){</span>
                //remove any extra close buttons
<span class="nc" id="L60">                tabPane.remove((JButton)closeButtons.get(i));</span>
            }
<span class="nc" id="L62">        }</span>
        // implement UIResource so that when we add this button to the
        // tabbedpane, it doesn't try to make a tab for it!
        class CloseButton extends JButton implements javax.swing.plaf.UIResource{
<span class="nc" id="L66">            public CloseButton(int index){</span>
<span class="nc" id="L67">                super(new CloseButtonAction(index));</span>
<span class="nc" id="L68">                setToolTipText(&quot;Close This Tab&quot;);</span>
                //remove the typical padding for the button
<span class="nc" id="L70">                setMargin(new Insets(0,0,0,0));</span>
                //no need as use icon instead of x text
                /*addMouseListener(new MouseAdapter(){
                    public void mouseEntered(MouseEvent e){
                        setForeground(new Color(255,0,0));
                    }
                    public void mouseExited(MouseEvent e){
                        setForeground(new Color(0,0,0));
                    }
                });*/
<span class="nc" id="L80">            }</span>
        }
        class CloseButtonAction extends AbstractAction{
            int index;
<span class="nc" id="L84">            public CloseButtonAction(int index){</span>
<span class="nc" id="L85">                super();//&quot;x&quot;);</span>
<span class="nc" id="L86">                putValue(AbstractAction.SMALL_ICON,new ImageIcon(java.awt.Toolkit.getDefaultToolkit().getImage(getClass().getResource(&quot;/images/close.jpg&quot;))));</span>
<span class="nc" id="L87">                this.index = index;</span>
<span class="nc" id="L88">            }</span>
            public void actionPerformed(ActionEvent e){
<span class="nc bnc" id="L90" title="All 2 branches missed.">                if(index&gt;0) //tabPane.remove(index);</span>
<span class="nc bnc" id="L91" title="All 2 branches missed.">                if(index&gt;0) ClosableTabbedPaneUI.this.chatApp.closeChatAtIndex(index);</span>
                        //getOpenChatPanelsByIndex().remove(index);
<span class="nc" id="L93">            }</span>
        }	// End of CloseButtonAction
    }	// End of TestPlafLayout
}	// End of static class ClosableTabbedPaneUI
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>