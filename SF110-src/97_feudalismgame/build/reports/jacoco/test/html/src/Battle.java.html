<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Battle.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">97_feudalismgame</a> &gt; <a href="index.source.html" class="el_package">src</a> &gt; <span class="el_source">Battle.java</span></div><h1>Battle.java</h1><pre class="source lang-java linenums">package src;

import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.util.ArrayList;
import java.util.Collection;
import java.util.Iterator;
import java.util.Random;

<span class="fc" id="L10">public class Battle extends Actions{</span>
	public void perform(Collection args){
/*Arguments for battle follows the following order:
 * 1- Method name (attack target)
 * 		- vassal
 * 		- peasant
 * 		- knight's name
 * 		- viking
 * 		- magyar
 * 		- muslim
 * 2- Attacker's Name
 *
*/
		try {
<span class="fc" id="L24">			Iterator argsIter = args.iterator();</span>
/*The following will call a method dinamically according 
 * to the item the player wants to buy
*/
<span class="nc" id="L28">			Class aMethod = this.getClass().forName(&quot;feudalism.Battle&quot;);</span>
<span class="nc" id="L29">			Class[] argType = {String.class};</span>
<span class="nc" id="L30">			Method methodObj = aMethod.getMethod((String)argsIter.next(), new Class[]{Collection.class});</span>
<span class="nc" id="L31">			methodObj.invoke(this, args);</span>
<span class="nc" id="L32">			GameAutoActions.saveAll();</span>
<span class="nc" id="L33">		} catch (SecurityException e) {</span>
<span class="nc" id="L34">			e.printStackTrace();</span>
<span class="nc" id="L35">		} catch (NoSuchMethodException e) {</span>
<span class="nc" id="L36">			e.printStackTrace();</span>
<span class="nc" id="L37">		} catch (IllegalArgumentException e) {</span>
<span class="nc" id="L38">			e.printStackTrace();</span>
<span class="nc" id="L39">		} catch (IllegalAccessException e) {</span>
<span class="nc" id="L40">			e.printStackTrace();</span>
<span class="nc" id="L41">		} catch (InvocationTargetException e) {</span>
<span class="nc" id="L42">			e.printStackTrace();</span>
<span class="fc" id="L43">		} catch (ClassNotFoundException e) {</span>
<span class="fc" id="L44">			e.printStackTrace();</span>
<span class="nc" id="L45">		}</span>
<span class="fc" id="L46">	}</span>
	
	public int[] rollDice(int diceQty){
<span class="fc" id="L49">		int[] results = new int[6];</span>
<span class="fc" id="L50">		Random rand = new Random();</span>
<span class="fc" id="L51">		int die = 0;</span>

<span class="fc bfc" id="L53" title="All 2 branches covered.">		for(int i = 0; i &lt; diceQty; i++){</span>
<span class="fc" id="L54">			die = rand.nextInt(6);</span>
<span class="fc" id="L55">			results[die]++;</span>
		}
<span class="fc" id="L57">		return results;</span>
	}


	public void vassal(Collection args){
<span class="nc" id="L62">		int attackersDice = 0;</span>
<span class="nc" id="L63">		int defendersDice = 0;</span>
<span class="nc" id="L64">		ArrayList&lt;Player&gt; allies = new ArrayList&lt;Player&gt;();</span>
<span class="nc" id="L65">		Iterator argsIter = args.iterator();</span>
<span class="nc" id="L66">		argsIter.next(); //Method name</span>
<span class="nc" id="L67">		Knight attackingKnight = CurrentPlayers.currentPlayers.get(argsIter.next());</span>
<span class="nc" id="L68">		Fiefdoms fief = Map.map.get(attackingKnight.getLocation());</span>
<span class="nc bnc" id="L69" title="All 2 branches missed.">		if(fief.getRebelliousVassals().size() &gt; 0){</span>
<span class="nc bnc" id="L70" title="All 2 branches missed.">			if(attackingKnight.getLocation().equalsIgnoreCase(fief.getName())){</span>
<span class="nc" id="L71">				ArrayList&lt;Vassals&gt; rebelliousVassals = fief.getRebelliousVassals();</span>
<span class="nc" id="L72">				allies = attackingKnight.getAllies();</span>
<span class="nc" id="L73">				attackingKnight.allyTo(attackingKnight.getName()); // The knight himself, retainers, and mercenaries (if any) will be added to the allied army</span>

<span class="nc bnc" id="L75" title="All 2 branches missed.">				if(allies.size() &gt; 0){</span>
<span class="nc bnc" id="L76" title="All 2 branches missed.">					for(Player soldier : allies){</span>
<span class="nc bnc" id="L77" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;knight&quot;))</span>
<span class="nc" id="L78">							attackersDice += 3;</span>
<span class="nc bnc" id="L79" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;count&quot;))</span>
<span class="nc" id="L80">							attackersDice += 4;</span>
<span class="nc bnc" id="L81" title="All 4 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;duke&quot;) || soldier.getRank().equalsIgnoreCase(&quot;king&quot;))</span>
<span class="nc" id="L82">							attackersDice += 6;</span>
<span class="nc bnc" id="L83" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;vassal&quot;))</span>
<span class="nc" id="L84">							attackersDice += 1;</span>
<span class="nc" id="L85">					}</span>
				}
<span class="nc" id="L87">				attackersDice += fief.getLoyalVassals().size();</span>
<span class="nc" id="L88">				defendersDice = fief.getRebelliousVassals().size();</span>
<span class="nc" id="L89">				System.out.println(&quot;Attacker's dice: &quot; + attackersDice);</span>
<span class="nc" id="L90">				System.out.println(&quot;Defender's dice: &quot; + defendersDice);</span>
<span class="nc bnc" id="L91" title="All 4 branches missed.">				while(allies.size() &gt; 0 &amp;&amp; rebelliousVassals.size() &gt; 0){</span>
<span class="nc" id="L92">					int attackers[] = this.rollDice(attackersDice);</span>
<span class="nc" id="L93">					int defenders[] = this.rollDice(defendersDice);</span>
<span class="nc bnc" id="L94" title="All 2 branches missed.">					for(int i = 1; i &lt; 6; i++){</span>
<span class="nc bnc" id="L95" title="All 4 branches missed.">						if(allies.size() &gt; 0 &amp;&amp; rebelliousVassals.size() &gt; 0){</span>
<span class="nc" id="L96">							System.out.println(i + &quot; Rebellious: &quot; + rebelliousVassals.size());</span>
<span class="nc" id="L97">							System.out.println(i + &quot; Allied Forces: &quot; + allies.size());</span>
<span class="nc" id="L98">							System.out.println(&quot;Allies has thrown &quot; + attackers[i] + &quot; &quot; + i + &quot;'s&quot;);</span>
<span class="nc" id="L99">							System.out.println(&quot;Rebellious Vassals has thrown &quot; + defenders[i] + &quot; &quot; + i + &quot;'s&quot;);</span>
<span class="nc bnc" id="L100" title="All 2 branches missed.">							attackers[i] = (attackers[i] &lt; rebelliousVassals.size()) ? attackers[i] : rebelliousVassals.size();</span>
<span class="nc bnc" id="L101" title="All 2 branches missed.">							defenders[i] = (defenders[i] &lt; allies.size()) ? defenders[i] : allies.size();</span>
<span class="nc bnc" id="L102" title="All 6 branches missed.">							switch(i){</span>
								case 3: //autokill
<span class="nc bnc" id="L104" title="All 2 branches missed.">									for(int b = 0; b &lt; attackers[i]; b++){</span>
<span class="nc" id="L105">										rebelliousVassals.remove(0);</span>
									}
<span class="nc bnc" id="L107" title="All 2 branches missed.">									for(int c = 0; c &lt; defenders[i]; c++){</span>
<span class="nc" id="L108">										int rand = new Random().nextInt(allies.size());</span>
<span class="nc" id="L109">										Player soldier = allies.get(rand);</span>
<span class="nc bnc" id="L110" title="All 2 branches missed.">										if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L111" title="All 2 branches missed.">											if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L112">												soldier.kill();</span>
<span class="nc" id="L113">												System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
											}
											else{
<span class="nc" id="L116">												allies.remove(rand);</span>
<span class="nc" id="L117">												System.out.println(&quot;Killed a Knight&quot;);</span>
											}
										}
<span class="nc bnc" id="L120" title="All 6 branches missed.">										else if(soldier instanceof Vassals || </span>
												soldier instanceof Retainers || 
												soldier instanceof Mercenaries){
<span class="nc" id="L123">											soldier.kill();</span>
<span class="nc" id="L124">											allies.remove(rand);</span>
										}
									}
<span class="nc" id="L127">									break;</span>
								case 4: //conditional kill
<span class="nc bnc" id="L129" title="All 6 branches missed.">									if(attackers[i] &gt; defenders[i] || (attackers[i] == defenders[i] &amp;&amp; (fief.getFiefdomCastles() + fief.getPersonalCastles() &gt; 0))){</span>
<span class="nc bnc" id="L130" title="All 2 branches missed.">										for(int c = 0; c &lt; attackers[i]; c++){</span>
<span class="nc" id="L131">											rebelliousVassals.remove(0);</span>
										}
									}
<span class="nc bnc" id="L134" title="All 2 branches missed.">									else if(attackers[i] &lt; defenders[i]){</span>
<span class="nc bnc" id="L135" title="All 2 branches missed.">										for(int c = 0; c &lt; attackers[i]; c++){</span>
<span class="nc bnc" id="L136" title="All 2 branches missed.">											int rand = (allies.size() &gt; 0) ? new Random().nextInt(allies.size()) : 0;</span>
<span class="nc" id="L137">											Player soldier = allies.get(rand);</span>
<span class="nc bnc" id="L138" title="All 2 branches missed.">											if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L139" title="All 2 branches missed.">												if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L140">													soldier.kill();</span>
<span class="nc" id="L141">													System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
												}
												else{
<span class="nc" id="L144">													allies.remove(rand);</span>
<span class="nc" id="L145">													System.out.println(&quot;Killed a Knight&quot;);</span>
												}
											}
										}
									}
									break;
								case 1: //autowound
<span class="nc bnc" id="L152" title="All 2 branches missed.">									for(int b = 0; b &lt; attackers[i]; b++){</span>
<span class="nc" id="L153">										rebelliousVassals.get(0).wound();</span>
<span class="nc" id="L154">										rebelliousVassals.remove(0);</span>
									}
<span class="nc bnc" id="L156" title="All 2 branches missed.">									for(int c = 0; c &lt; defenders[i]; c++){</span>
<span class="nc bnc" id="L157" title="All 2 branches missed.">										int rand = (allies.size() &gt; 0) ? new Random().nextInt(allies.size()) : 0;</span>
<span class="nc" id="L158">										Player soldier = allies.get(rand);</span>
<span class="nc" id="L159">										System.out.println(c);</span>
<span class="nc bnc" id="L160" title="All 2 branches missed.">										if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L161" title="All 2 branches missed.">											if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L162">												soldier.wound();</span>
<span class="nc" id="L163">												System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
											}
											else{
<span class="nc" id="L166">												allies.remove(rand);</span>
<span class="nc" id="L167">												System.out.println(&quot;Killed a Knight&quot;);</span>
											}
										}
<span class="nc bnc" id="L170" title="All 6 branches missed.">										else if(soldier instanceof Vassals || </span>
												soldier instanceof Retainers || 
												soldier instanceof Mercenaries){
<span class="nc" id="L173">											soldier.wound();</span>
<span class="nc" id="L174">											allies.remove(rand);</span>
										}
									}
<span class="nc" id="L177">									break;</span>
			
								case 2: //conditional wound
<span class="nc bnc" id="L180" title="All 4 branches missed.">									if(attackers[i] &gt; defenders[i] || </span>
											(attackers[i] == defenders[i] &amp;&amp; 
<span class="nc bnc" id="L182" title="All 2 branches missed.">											(fief.getFiefdomCastles() + fief.getPersonalCastles() &gt; 0))){</span>
<span class="nc bnc" id="L183" title="All 2 branches missed.">										for(int c = 0; c &lt; attackers[i]; c++){</span>
<span class="nc" id="L184">											rebelliousVassals.get(0).wound();</span>
<span class="nc" id="L185">											rebelliousVassals.remove(0);</span>
										}
									}
<span class="nc bnc" id="L188" title="All 2 branches missed.">									else if(attackers[i] &lt; defenders[i]){</span>
<span class="nc bnc" id="L189" title="All 2 branches missed.">										for(int d = 0; d &lt; defenders[i]; d++){</span>
<span class="nc bnc" id="L190" title="All 2 branches missed.">											int rand = (allies.size() &gt; 0) ? new Random().nextInt(allies.size()) : 0; //There is an error here!</span>
<span class="nc" id="L191">											System.out.println(&quot;n: &quot; + rand);</span>
<span class="nc" id="L192">											Player soldier = allies.get(rand);</span>
<span class="nc" id="L193">											System.out.println(&quot;got a &quot; + soldier.getRank());</span>
<span class="nc bnc" id="L194" title="All 2 branches missed.">											if(soldier instanceof Knight){</span>
<span class="nc bnc" id="L195" title="All 2 branches missed.">												if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L196">													soldier.wound();</span>
<span class="nc" id="L197">													System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
												}
												else{
<span class="nc" id="L200">													allies.remove(rand);</span>
<span class="nc" id="L201">													System.out.println(&quot;Killed a Knight&quot;);</span>
												}
											}
<span class="nc bnc" id="L204" title="All 6 branches missed.">											else if(soldier instanceof Vassals || </span>
													soldier instanceof Retainers || 
													soldier instanceof Mercenaries){
<span class="nc" id="L207">												soldier.wound();</span>
<span class="nc" id="L208">												allies.remove(rand);</span>
											}
										}
									}
									break;
									
								case 5:
<span class="nc" id="L215">									break;</span>
									
								case 6:
									break;
								}
							}
						}
<span class="nc" id="L222">					}</span>
<span class="nc bnc" id="L223" title="All 2 branches missed.">				if(allies.size() &gt; rebelliousVassals.size()){</span>
<span class="nc" id="L224">					System.out.println(&quot;Allied forces won the battle &quot; + rebelliousVassals.size());</span>
<span class="nc bnc" id="L225" title="All 2 branches missed.">					for(Player vassal : allies){</span>
<span class="nc bnc" id="L226" title="All 2 branches missed.">						if(vassal instanceof Vassals){</span>
<span class="nc" id="L227">							vassal.wound(); //The wound method will cause the vassal to go back to the fiefdom he belongs to</span>
						}
<span class="nc" id="L229">					}</span>
					
				}	
<span class="nc bnc" id="L232" title="All 2 branches missed.">				else if(allies.size() &lt; rebelliousVassals.size()){</span>
<span class="nc bnc" id="L233" title="All 2 branches missed.">					if(CurrentPlayers.currentPlayers.get(fief.getOwner()).getDead()){</span>
<span class="nc" id="L234">						fief.setName(CurrentPlayers.getKing().getName());</span>
					}
					
				}
				
<span class="nc" id="L239">			}</span>
		}
		else{
<span class="nc" id="L242">			System.out.println(&quot;There is no vassal rebellion in your fiefdom&quot;);</span>
		}
		
<span class="nc" id="L245">	}</span>

	public void peasant(Collection args){
<span class="nc" id="L248">		int attackersDice = 0;</span>
<span class="nc" id="L249">		int defendersDice = 0;</span>
<span class="nc" id="L250">		Iterator argsIter = args.iterator();</span>
<span class="nc" id="L251">		argsIter.next(); //Method name</span>
<span class="nc" id="L252">		Knight attackingKnight = CurrentPlayers.currentPlayers.get(argsIter.next());</span>
<span class="nc" id="L253">		Fiefdoms fief = Map.map.get(attackingKnight.getLocation());</span>
<span class="nc" id="L254">		ArrayList&lt;Player&gt; allies = new ArrayList&lt;Player&gt;();</span>
<span class="nc bnc" id="L255" title="All 2 branches missed.">		if(fief.getPeasants() &gt; 0){</span>
<span class="nc bnc" id="L256" title="All 2 branches missed.">			if(attackingKnight.getLocation().equalsIgnoreCase(fief.getName())){</span>
<span class="nc" id="L257">				int peasantArmy = fief.getPeasants();</span>
<span class="nc" id="L258">				allies = attackingKnight.getAllies();</span>
<span class="nc" id="L259">				attackingKnight.allyTo(attackingKnight.getName());</span>
	
<span class="nc" id="L261">				System.out.println(&quot;Attacker's dice: &quot; + attackersDice);</span>
<span class="nc bnc" id="L262" title="All 2 branches missed.">				if(allies.size() &gt; 0){</span>
<span class="nc bnc" id="L263" title="All 2 branches missed.">					for(Player soldier : allies){</span>
<span class="nc bnc" id="L264" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;knight&quot;))</span>
<span class="nc" id="L265">							attackersDice += 3;</span>
<span class="nc bnc" id="L266" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;count&quot;))</span>
<span class="nc" id="L267">							attackersDice += 4;</span>
<span class="nc bnc" id="L268" title="All 4 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;duke&quot;) || soldier.getRank().equalsIgnoreCase(&quot;king&quot;))</span>
<span class="nc" id="L269">							attackersDice += 6;</span>
<span class="nc bnc" id="L270" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;vassal&quot;))</span>
<span class="nc" id="L271">							attackersDice += 1;</span>
<span class="nc" id="L272">					}</span>
				}
<span class="nc" id="L274">				attackersDice += fief.getLoyalVassals().size();</span>
<span class="nc" id="L275">				defendersDice = 1;</span>
				
<span class="nc bnc" id="L277" title="All 4 branches missed.">				while(allies.size() &gt; 0 &amp;&amp; peasantArmy &gt; 0){</span>
<span class="nc" id="L278">					int attackers[] = this.rollDice(attackersDice);</span>
<span class="nc" id="L279">					int defenders[] = this.rollDice(defendersDice);</span>
<span class="nc bnc" id="L280" title="All 2 branches missed.">					for(int i = 1; i &lt; 6; i++){</span>
<span class="nc bnc" id="L281" title="All 4 branches missed.">						if(allies.size() &gt; 0 &amp;&amp; peasantArmy &gt; 0){</span>
<span class="nc" id="L282">							System.out.println(i + &quot; Peasants: &quot; + peasantArmy);</span>
<span class="nc" id="L283">							System.out.println(i + &quot; Allied Forces: &quot; + allies.size());</span>
<span class="nc" id="L284">							System.out.println(&quot;Allies has thrown &quot; + attackers[i] + &quot; &quot; + i + &quot;'s&quot;);</span>
<span class="nc" id="L285">							System.out.println(&quot;Rebellious Vassals has thrown &quot; + defenders[i] + &quot; &quot; + i + &quot;'s&quot;);</span>
<span class="nc bnc" id="L286" title="All 2 branches missed.">							attackers[i] = (attackers[i] &lt; peasantArmy) ? attackers[i] : peasantArmy;</span>
<span class="nc bnc" id="L287" title="All 2 branches missed.">							defenders[i] = (defenders[i] &lt; allies.size()) ? defenders[i] : allies.size();</span>
<span class="nc bnc" id="L288" title="All 6 branches missed.">							switch(i){ //auto kill</span>
								case 1:
<span class="nc bnc" id="L290" title="All 2 branches missed.">									for(int b = 0; b &lt; attackers[i]; b++){</span>
<span class="nc" id="L291">										peasantArmy --;</span>
									}
<span class="nc bnc" id="L293" title="All 2 branches missed.">									for(int c = 0; c &lt; defenders[i]; c++){</span>
<span class="nc bnc" id="L294" title="All 2 branches missed.">										int rand = (allies.size() &gt; 0) ? new Random().nextInt(allies.size()) : 0;</span>
<span class="nc" id="L295">										Player soldier = allies.get(rand);</span>
<span class="nc bnc" id="L296" title="All 2 branches missed.">										if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L297" title="All 2 branches missed.">											if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() &lt; 3){</span>
<span class="nc" id="L298">												soldier.kill();</span>
<span class="nc" id="L299">												System.out.println(&quot;Got a knight&quot;);</span>
											}
											else{
<span class="nc" id="L302">												allies.remove(rand);</span>
<span class="nc" id="L303">												System.out.println(&quot;Killed a Knight&quot;);</span>
											}
										}
<span class="nc bnc" id="L306" title="All 6 branches missed.">										else if(soldier instanceof Vassals || </span>
												soldier instanceof Retainers || 
												soldier instanceof Mercenaries){
<span class="nc" id="L309">											soldier.kill();</span>
<span class="nc" id="L310">											allies.remove(rand);</span>
										}
									}
<span class="nc" id="L313">									break;</span>
								case 2: //conditional kill
<span class="nc bnc" id="L315" title="All 4 branches missed.">									if(attackers[i] &gt; defenders[i] || </span>
											(attackers[i] == defenders[i] &amp;&amp; 
<span class="nc bnc" id="L317" title="All 2 branches missed.">											(fief.getFiefdomCastles() + fief.getPersonalCastles() &gt; 0))){</span>
<span class="nc bnc" id="L318" title="All 2 branches missed.">										for(int c = 0; c &lt; attackers[i]; c++){</span>
<span class="nc" id="L319">											peasantArmy--;</span>
										}
									}
<span class="nc bnc" id="L322" title="All 2 branches missed.">									else if(attackers[i] &lt; defenders[i]){</span>
<span class="nc bnc" id="L323" title="All 2 branches missed.">										int rand = (allies.size() &gt; 0) ? new Random().nextInt(allies.size()) : 0;</span>
<span class="nc" id="L324">										Player soldier = allies.get(rand);</span>
<span class="nc bnc" id="L325" title="All 2 branches missed.">										if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L326" title="All 2 branches missed.">											if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() &lt; 3){</span>
<span class="nc" id="L327">												soldier.kill();</span>
<span class="nc" id="L328">												System.out.println(&quot;Got a knight&quot;);</span>
											}
											else{
<span class="nc" id="L331">												allies.remove(rand);</span>
<span class="nc" id="L332">												System.out.println(&quot;Killed a Knight&quot;);</span>
											}
										}
<span class="nc" id="L335">									}</span>
									break;
								case 3:
<span class="nc bnc" id="L338" title="All 2 branches missed.">									for(int b = 0; b &lt; attackers[i]; b++){</span>
<span class="nc" id="L339">										peasantArmy--;</span>
									}
<span class="nc bnc" id="L341" title="All 2 branches missed.">									for(int c = 0; c &lt; defenders[i]; c++){</span>
<span class="nc bnc" id="L342" title="All 2 branches missed.">										int rand = (allies.size() &gt; 0) ? new Random().nextInt(allies.size()) : 0;</span>
<span class="nc" id="L343">										Player soldier = allies.get(rand);</span>
<span class="nc bnc" id="L344" title="All 2 branches missed.">										if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L345" title="All 2 branches missed.">											if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() &lt; 3){</span>
<span class="nc" id="L346">												soldier.wound();</span>
<span class="nc" id="L347">												System.out.println(&quot;Got a Knight&quot;);</span>
											}
											else{
<span class="nc" id="L350">												allies.remove(rand);</span>
<span class="nc" id="L351">												System.out.println(&quot;Killed a Knight&quot;);</span>
											}
										}
<span class="nc bnc" id="L354" title="All 6 branches missed.">										else if(soldier instanceof Vassals || </span>
												soldier instanceof Retainers || 
												soldier instanceof Mercenaries){
<span class="nc" id="L357">											soldier.wound();</span>
<span class="nc" id="L358">											allies.remove(rand);</span>
										}
									}
<span class="nc" id="L361">									break;</span>
			
								case 4: //conditional wound
<span class="nc bnc" id="L364" title="All 4 branches missed.">									if(attackers[i] &gt; defenders[i] || </span>
											(attackers[i] == defenders[i] &amp;&amp; 
<span class="nc bnc" id="L366" title="All 2 branches missed.">											(fief.getFiefdomCastles() + fief.getPersonalCastles() &gt; 0))){</span>
<span class="nc bnc" id="L367" title="All 2 branches missed.">										for(int c = 0; c &lt; attackers[i]; c++){</span>
<span class="nc" id="L368">											peasantArmy--;</span>
										}
									}
<span class="nc bnc" id="L371" title="All 2 branches missed.">									else if(attackers[i] &lt; defenders[i]){</span>
<span class="nc bnc" id="L372" title="All 2 branches missed.">										int rand = (allies.size() &gt; 0) ? new Random().nextInt(allies.size()) : 0;</span>
<span class="nc" id="L373">										Player soldier = allies.get(rand);</span>
<span class="nc bnc" id="L374" title="All 2 branches missed.">										if(soldier instanceof Knight){</span>
<span class="nc bnc" id="L375" title="All 2 branches missed.">											if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() &lt; 3){</span>
<span class="nc" id="L376">												soldier.kill();</span>
<span class="nc" id="L377">												System.out.println(&quot;Got a Knight&quot;);</span>
											}
											else{
<span class="nc" id="L380">												allies.remove(rand);</span>
<span class="nc" id="L381">												System.out.println(&quot;Killed a Knight&quot;);</span>
											}
										}
<span class="nc" id="L384">									}</span>
									break;
									
								case 5:
<span class="nc" id="L388">									break;</span>
									
								case 6:
									break;
								}
							}
						}
<span class="nc" id="L395">					}</span>
<span class="nc bnc" id="L396" title="All 2 branches missed.">				if(allies.size() &gt; peasantArmy){</span>
<span class="nc" id="L397">					System.out.println(&quot;Allied forces won the battle &quot; + peasantArmy);</span>
<span class="nc bnc" id="L398" title="All 2 branches missed.">					for(Player vassal : allies){</span>
<span class="nc bnc" id="L399" title="All 2 branches missed.">						if(vassal instanceof Vassals){</span>
<span class="nc" id="L400">							vassal.wound(); //The wound method will cause the vassal to go back to the fiefdom he belongs to</span>
						}
<span class="nc" id="L402">					}</span>
				}
				else
<span class="nc" id="L405">					System.out.println(&quot;Peasants won the battle &quot; + allies.size());</span>
<span class="nc" id="L406">			}</span>
		}
		else{
<span class="nc" id="L409">			System.out.println(&quot;There is no peasant uprising in this fiefdom&quot;);</span>
		}
<span class="nc" id="L411">	}</span>


	public void viking(Collection args){
<span class="nc" id="L415">		int attackersDice = 0;</span>
<span class="nc" id="L416">		int defendersDice = 0;</span>
<span class="nc" id="L417">		Iterator argsIter = args.iterator();</span>
<span class="nc" id="L418">		argsIter.next(); //Method name</span>
<span class="nc" id="L419">		Knight attackingKnight = CurrentPlayers.currentPlayers.get(argsIter.next());</span>
<span class="nc" id="L420">		Fiefdoms fief = Map.map.get(attackingKnight.getLocation());</span>
<span class="nc" id="L421">		System.out.println(fief.getLoyalVassals().size());</span>
<span class="nc" id="L422">		ArrayList&lt;Player&gt; allies = new ArrayList&lt;Player&gt;();</span>
<span class="nc bnc" id="L423" title="All 2 branches missed.">		if(fief.getViking().size() &gt; 0){</span>
<span class="nc bnc" id="L424" title="All 2 branches missed.">			if(attackingKnight.getLocation().equalsIgnoreCase(fief.getName())){</span>
<span class="nc" id="L425">				ArrayList&lt;Intruders&gt; viking = fief.getViking();</span>
<span class="nc" id="L426">				attackingKnight.allyTo(attackingKnight.getName()); // The knight himself, retainers, and mercenaries (if any) will be added to the allied army</span>
<span class="nc" id="L427">				allies = attackingKnight.getAllies();</span>
				
<span class="nc bnc" id="L429" title="All 2 branches missed.">				if(allies.size() &gt; 0){</span>
<span class="nc bnc" id="L430" title="All 2 branches missed.">					for(Player soldier : allies){</span>
<span class="nc bnc" id="L431" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;knight&quot;))</span>
<span class="nc" id="L432">							attackersDice += 3;</span>
<span class="nc bnc" id="L433" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;count&quot;))</span>
<span class="nc" id="L434">							attackersDice += 4;</span>
<span class="nc bnc" id="L435" title="All 4 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;duke&quot;) || soldier.getRank().equalsIgnoreCase(&quot;king&quot;))</span>
<span class="nc" id="L436">							attackersDice += 6;</span>
<span class="nc bnc" id="L437" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;vassal&quot;))</span>
<span class="nc" id="L438">							attackersDice += 1;</span>
<span class="nc" id="L439">					}</span>
				}
<span class="nc" id="L441">				defendersDice = viking.size();</span>
<span class="nc" id="L442">				System.out.println(&quot;\nAttacker's dice: &quot; + attackersDice);</span>
<span class="nc" id="L443">				System.out.println(&quot;Defender's dice: &quot; + defendersDice);</span>
<span class="nc bnc" id="L444" title="All 4 branches missed.">				while(allies.size() &gt; 0 &amp;&amp; viking.size() &gt; 0){</span>
<span class="nc" id="L445">					int attackers[] = this.rollDice(attackersDice);</span>
<span class="nc" id="L446">					int defenders[] = this.rollDice(defendersDice);</span>
<span class="nc bnc" id="L447" title="All 2 branches missed.">					for(int i = 1; i &lt; 6; i++){</span>
<span class="nc bnc" id="L448" title="All 4 branches missed.">						if(allies.size() &gt; 0 &amp;&amp; viking.size() &gt; 0){</span>
<span class="nc" id="L449">							System.out.println(i + &quot; Rebellious: &quot; + viking.size());</span>
<span class="nc" id="L450">							System.out.println(i + &quot; Allied Forces: &quot; + allies.size());</span>
<span class="nc" id="L451">							System.out.println(&quot;Allies has thrown &quot; + attackers[i] + &quot; &quot; + i + &quot;'s&quot;);</span>
<span class="nc" id="L452">							System.out.println(&quot;Rebellious Vassals has thrown &quot; + defenders[i] + &quot; &quot; + i + &quot;'s&quot;);</span>
<span class="nc bnc" id="L453" title="All 2 branches missed.">							attackers[i] = (attackers[i] &lt; viking.size()) ? attackers[i] : viking.size();</span>
<span class="nc bnc" id="L454" title="All 2 branches missed.">							defenders[i] = (defenders[i] &lt; allies.size()) ? defenders[i] : allies.size();</span>
<span class="nc bnc" id="L455" title="All 6 branches missed.">							switch(i){</span>
								case 1: //autokill
<span class="nc bnc" id="L457" title="All 2 branches missed.">									for(int b = 0; b &lt; attackers[i]; b++){</span>
<span class="nc" id="L458">										viking.remove(0);</span>
									}
<span class="nc bnc" id="L460" title="All 2 branches missed.">									for(int c = 0; c &lt; defenders[i]; c++){</span>
<span class="nc" id="L461">										int rand = new Random().nextInt(allies.size());</span>
<span class="nc" id="L462">										Player soldier = allies.get(rand);</span>
<span class="nc bnc" id="L463" title="All 2 branches missed.">										if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L464" title="All 2 branches missed.">											if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L465">												soldier.kill();</span>
<span class="nc" id="L466">												System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
											}
											else{
<span class="nc" id="L469">												allies.remove(rand);</span>
<span class="nc" id="L470">												System.out.println(&quot;Killed a Knight&quot;);</span>
											}
										}
<span class="nc bnc" id="L473" title="All 6 branches missed.">										else if(soldier instanceof Vassals || </span>
												soldier instanceof Retainers || 
												soldier instanceof Mercenaries){
<span class="nc" id="L476">											soldier.kill();</span>
<span class="nc" id="L477">											allies.remove(rand);</span>
										}
									}
<span class="nc" id="L480">									break;</span>
								case 2: //conditional kill
<span class="nc bnc" id="L482" title="All 4 branches missed.">									if(attackers[i] &gt; defenders[i] || </span>
											(attackers[i] == defenders[i] &amp;&amp; 
<span class="nc bnc" id="L484" title="All 2 branches missed.">											(fief.getFiefdomCastles() + fief.getPersonalCastles() &gt; 0))){</span>
<span class="nc bnc" id="L485" title="All 2 branches missed.">										for(int c = 0; c &lt; attackers[i]; c++){</span>
<span class="nc" id="L486">											viking.remove(0);</span>
										}
									}
<span class="nc bnc" id="L489" title="All 2 branches missed.">									else if(attackers[i] &lt; defenders[i]){</span>
<span class="nc bnc" id="L490" title="All 2 branches missed.">										for(int c = 0; c &lt; attackers[i]; i++){</span>
<span class="nc bnc" id="L491" title="All 2 branches missed.">											int rand = (allies.size() &gt; 0) ? new Random().nextInt(allies.size()) : 0;</span>
<span class="nc" id="L492">											Player soldier = allies.get(rand);</span>
<span class="nc bnc" id="L493" title="All 2 branches missed.">											if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L494" title="All 2 branches missed.">												if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L495">													soldier.kill();</span>
<span class="nc" id="L496">													System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
												}
												else{
<span class="nc" id="L499">													allies.remove(rand);</span>
<span class="nc" id="L500">													System.out.println(&quot;Killed a Knight&quot;);</span>
												}
											}
										}
									}
									break;
								case 3: //autowound
<span class="nc bnc" id="L507" title="All 2 branches missed.">									for(int b = 0; b &lt; attackers[i]; b++){</span>
<span class="nc" id="L508">										viking.get(0).wound();</span>
<span class="nc" id="L509">										viking.remove(0);</span>
									}
<span class="nc bnc" id="L511" title="All 2 branches missed.">									for(int c = 0; c &lt; defenders[i]; c++){</span>
<span class="nc bnc" id="L512" title="All 2 branches missed.">										int rand = (allies.size() &gt; 0) ? new Random().nextInt(allies.size()) : 0;</span>
<span class="nc" id="L513">										Player soldier = allies.get(rand);</span>
<span class="nc" id="L514">										System.out.println(c);</span>
<span class="nc bnc" id="L515" title="All 2 branches missed.">										if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L516" title="All 2 branches missed.">											if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L517">												soldier.wound();</span>
<span class="nc" id="L518">												System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
											}
											else{
<span class="nc" id="L521">												allies.remove(rand);</span>
<span class="nc" id="L522">												System.out.println(&quot;Killed a Knight&quot;);</span>
											}
										}
<span class="nc bnc" id="L525" title="All 6 branches missed.">										else if(soldier instanceof Vassals || </span>
												soldier instanceof Retainers || 
												soldier instanceof Mercenaries){
<span class="nc" id="L528">											soldier.wound();</span>
<span class="nc" id="L529">											allies.remove(rand);</span>
										}
									}
<span class="nc" id="L532">									break;</span>
			
								case 4: //conditional wound
<span class="nc bnc" id="L535" title="All 4 branches missed.">									if(attackers[i] &gt; defenders[i] || </span>
											(attackers[i] == defenders[i] &amp;&amp; 
<span class="nc bnc" id="L537" title="All 2 branches missed.">											(fief.getFiefdomCastles() + fief.getPersonalCastles() &gt; 0))){</span>
<span class="nc bnc" id="L538" title="All 2 branches missed.">										for(int c = 0; c &lt; attackers[i]; c++){</span>
<span class="nc" id="L539">											viking.get(0).wound();</span>
<span class="nc" id="L540">											viking.remove(0);</span>
										}
									}
<span class="nc bnc" id="L543" title="All 2 branches missed.">									else if(attackers[i] &lt; defenders[i]){</span>
<span class="nc bnc" id="L544" title="All 2 branches missed.">										for(int d = 0; d &lt; defenders[i]; d++){</span>
<span class="nc bnc" id="L545" title="All 2 branches missed.">											int rand = (allies.size() &gt; 0) ? new Random().nextInt(allies.size()) : 0; //There is an error here!</span>
<span class="nc" id="L546">											System.out.println(&quot;n: &quot; + rand);</span>
<span class="nc" id="L547">											Player soldier = allies.get(rand);</span>
<span class="nc" id="L548">											System.out.println(&quot;got a &quot; + soldier.getRank());</span>
<span class="nc bnc" id="L549" title="All 2 branches missed.">											if(soldier instanceof Knight){</span>
<span class="nc bnc" id="L550" title="All 2 branches missed.">												if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L551">													soldier.wound();</span>
<span class="nc" id="L552">													System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
												}
												else{
<span class="nc" id="L555">													allies.remove(rand);</span>
<span class="nc" id="L556">													System.out.println(&quot;Killed a Knight&quot;);</span>
												}
											}
<span class="nc bnc" id="L559" title="All 6 branches missed.">											else if(soldier instanceof Vassals || </span>
													soldier instanceof Retainers || 
													soldier instanceof Mercenaries){
<span class="nc" id="L562">												soldier.wound();</span>
<span class="nc" id="L563">												allies.remove(rand);</span>
											}
										}
									}
									break;
									
								case 5:
<span class="nc" id="L570">									break;</span>
									
								case 6:
									break;
								}
							}
						}
<span class="nc" id="L577">					}</span>
<span class="nc bnc" id="L578" title="All 2 branches missed.">				if(allies.size() &gt; viking.size()){</span>
<span class="nc" id="L579">					System.out.println(&quot;Allied forces won the battle &quot; + viking.size());</span>
<span class="nc bnc" id="L580" title="All 2 branches missed.">					for(Player vassal : allies){</span>
<span class="nc bnc" id="L581" title="All 2 branches missed.">						if(vassal instanceof Vassals){</span>
<span class="nc" id="L582">							vassal.wound(); //The wound method will cause the vassal to go back to the fiefdom he belongs to</span>
						}
<span class="nc" id="L584">					}</span>
					
				}
				else
<span class="nc" id="L588">					System.out.println(&quot;Rebellious Vassals won the battle &quot; + allies.size());</span>
<span class="nc" id="L589">			}</span>
		}else{
<span class="nc" id="L591">			System.out.println(&quot;There is no Viking invasion in this fiefdom&quot;);</span>
		}
		
<span class="nc" id="L594">	}</span>


	public void magyar(Collection args){
<span class="fc" id="L598">		int attackersDice = 0;</span>
<span class="fc" id="L599">		int defendersDice = 0;</span>
<span class="fc" id="L600">		Iterator argsIter = args.iterator();</span>
<span class="fc" id="L601">		argsIter.next(); //Method name</span>
<span class="nc" id="L602">		Knight attackingKnight = CurrentPlayers.currentPlayers.get(argsIter.next());</span>
<span class="nc" id="L603">		Fiefdoms fief = Map.map.get(attackingKnight.getLocation());</span>
<span class="nc bnc" id="L604" title="All 2 branches missed.">		if(fief.getMagyar().size() &gt; 0){</span>
<span class="nc bnc" id="L605" title="All 2 branches missed.">			if(attackingKnight.getLocation().equalsIgnoreCase(fief.getName())){</span>
<span class="nc" id="L606">				ArrayList&lt;Intruders&gt; magyar = fief.getMagyar();</span>
<span class="nc" id="L607">				attackingKnight.allyTo(attackingKnight.getName()); // The knight himself, retainers, and mercenaries (if any) will be added to the allied army</span>
<span class="nc" id="L608">				ArrayList&lt;Player&gt; allies = attackingKnight.getAllies();</span>
				
<span class="nc bnc" id="L610" title="All 2 branches missed.">				if(allies.size() &gt; 0){</span>
<span class="nc bnc" id="L611" title="All 2 branches missed.">					for(Player soldier : allies){</span>
<span class="nc bnc" id="L612" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;knight&quot;))</span>
<span class="nc" id="L613">							attackersDice += 3;</span>
<span class="nc bnc" id="L614" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;count&quot;))</span>
<span class="nc" id="L615">							attackersDice += 4;</span>
<span class="nc bnc" id="L616" title="All 4 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;duke&quot;) || soldier.getRank().equalsIgnoreCase(&quot;king&quot;))</span>
<span class="nc" id="L617">							attackersDice += 6;</span>
<span class="nc bnc" id="L618" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;vassal&quot;))</span>
<span class="nc" id="L619">							attackersDice += 1;</span>
<span class="nc" id="L620">					}</span>
				}
<span class="nc" id="L622">				defendersDice = magyar.size();</span>
<span class="nc" id="L623">				System.out.println(&quot;Attacker's dice: &quot; + attackersDice);</span>
<span class="nc" id="L624">				System.out.println(&quot;Defender's dice: &quot; + defendersDice);</span>
<span class="nc bnc" id="L625" title="All 4 branches missed.">				while(allies.size() &gt; 0 &amp;&amp; magyar.size() &gt; 0){</span>
<span class="nc" id="L626">					int attackers[] = this.rollDice(attackersDice);</span>
<span class="nc" id="L627">					int defenders[] = this.rollDice(defendersDice);</span>
<span class="nc bnc" id="L628" title="All 2 branches missed.">					for(int i = 1; i &lt; 6; i++){</span>
<span class="nc bnc" id="L629" title="All 4 branches missed.">						if(allies.size() &gt; 0 &amp;&amp; magyar.size() &gt; 0){</span>
<span class="nc" id="L630">							System.out.println(i + &quot; Rebellious: &quot; + magyar.size());</span>
<span class="nc" id="L631">							System.out.println(i + &quot; Allied Forces: &quot; + allies.size());</span>
<span class="nc" id="L632">							System.out.println(&quot;Allies has thrown &quot; + attackers[i] + &quot; &quot; + i + &quot;'s&quot;);</span>
<span class="nc" id="L633">							System.out.println(&quot;Rebellious Vassals has thrown &quot; + defenders[i] + &quot; &quot; + i + &quot;'s&quot;);</span>
<span class="nc bnc" id="L634" title="All 2 branches missed.">							attackers[i] = (attackers[i] &lt; magyar.size()) ? attackers[i] : magyar.size();</span>
<span class="nc bnc" id="L635" title="All 2 branches missed.">							defenders[i] = (defenders[i] &lt; allies.size()) ? defenders[i] : allies.size();</span>
<span class="nc bnc" id="L636" title="All 6 branches missed.">							switch(i){</span>
								case 1: //autokill
<span class="nc bnc" id="L638" title="All 2 branches missed.">									for(int b = 0; b &lt; attackers[i]; b++){</span>
<span class="nc" id="L639">										magyar.remove(0);</span>
									}
<span class="nc bnc" id="L641" title="All 2 branches missed.">									for(int c = 0; c &lt; defenders[i]; c++){</span>
<span class="nc" id="L642">										int rand = new Random().nextInt(allies.size());</span>
<span class="nc" id="L643">										Player soldier = allies.get(rand);</span>
<span class="nc bnc" id="L644" title="All 2 branches missed.">										if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L645" title="All 2 branches missed.">											if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L646">												soldier.kill();</span>
<span class="nc" id="L647">												System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
											}
											else{
<span class="nc" id="L650">												allies.remove(rand);</span>
<span class="nc" id="L651">												System.out.println(&quot;Killed a Knight&quot;);</span>
											}
										}
<span class="nc bnc" id="L654" title="All 6 branches missed.">										else if(soldier instanceof Vassals || </span>
												soldier instanceof Retainers || 
												soldier instanceof Mercenaries){
<span class="nc" id="L657">											soldier.kill();</span>
<span class="nc" id="L658">											allies.remove(rand);</span>
										}
									}
<span class="nc" id="L661">									break;</span>
								case 2: //conditional kill
<span class="nc bnc" id="L663" title="All 4 branches missed.">									if(attackers[i] &gt; defenders[i] || </span>
											(attackers[i] == defenders[i] &amp;&amp; 
<span class="nc bnc" id="L665" title="All 2 branches missed.">											(fief.getFiefdomCastles() + fief.getPersonalCastles() &gt; 0))){</span>
<span class="nc bnc" id="L666" title="All 2 branches missed.">										for(int c = 0; c &lt; attackers[i]; c++){</span>
<span class="nc" id="L667">											magyar.remove(0);</span>
										}
									}
<span class="nc bnc" id="L670" title="All 2 branches missed.">									else if(attackers[i] &lt; defenders[i]){</span>
<span class="nc bnc" id="L671" title="All 2 branches missed.">										for(int c = 0; c &lt; attackers[i]; c++){</span>
<span class="nc bnc" id="L672" title="All 2 branches missed.">											int rand = (allies.size() &gt; 0) ? new Random().nextInt(allies.size()) : 0;</span>
<span class="nc" id="L673">											Player soldier = allies.get(rand);</span>
<span class="nc bnc" id="L674" title="All 2 branches missed.">											if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L675" title="All 2 branches missed.">												if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L676">													soldier.kill();</span>
<span class="nc" id="L677">													System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
												}
												else{
<span class="nc" id="L680">													allies.remove(rand);</span>
<span class="nc" id="L681">													System.out.println(&quot;Killed a Knight&quot;);</span>
												}
											}
										}
									}
									break;
								case 3: //autowound
<span class="nc bnc" id="L688" title="All 2 branches missed.">									for(int b = 0; b &lt; attackers[i]; b++){</span>
<span class="nc" id="L689">										magyar.get(0).wound();</span>
<span class="nc" id="L690">										magyar.remove(0);</span>
									}
<span class="nc bnc" id="L692" title="All 2 branches missed.">									for(int c = 0; c &lt; defenders[i]; c++){</span>
<span class="nc bnc" id="L693" title="All 2 branches missed.">										int rand = (allies.size() &gt; 0) ? new Random().nextInt(allies.size()) : 0;</span>
<span class="nc" id="L694">										Player soldier = allies.get(rand);</span>
<span class="nc" id="L695">										System.out.println(c);</span>
<span class="nc bnc" id="L696" title="All 2 branches missed.">										if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L697" title="All 2 branches missed.">											if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L698">												soldier.wound();</span>
<span class="nc" id="L699">												System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
											}
											else{
<span class="nc" id="L702">												allies.remove(rand);</span>
<span class="nc" id="L703">												System.out.println(&quot;Killed a Knight&quot;);</span>
											}
										}
<span class="nc bnc" id="L706" title="All 6 branches missed.">										else if(soldier instanceof Vassals || </span>
												soldier instanceof Retainers || 
												soldier instanceof Mercenaries){
<span class="nc" id="L709">											soldier.wound();</span>
<span class="nc" id="L710">											allies.remove(rand);</span>
										}
									}
<span class="nc" id="L713">									break;</span>
			
								case 4: //conditional wound
<span class="nc bnc" id="L716" title="All 4 branches missed.">									if(attackers[i] &gt; defenders[i] || </span>
											(attackers[i] == defenders[i] &amp;&amp; 
<span class="nc bnc" id="L718" title="All 2 branches missed.">											(fief.getFiefdomCastles() + fief.getPersonalCastles() &gt; 0))){</span>
<span class="nc bnc" id="L719" title="All 2 branches missed.">										for(int c = 0; c &lt; attackers[i]; c++){</span>
<span class="nc" id="L720">											magyar.get(0).wound();</span>
<span class="nc" id="L721">											magyar.remove(0);</span>
										}
									}
<span class="nc bnc" id="L724" title="All 2 branches missed.">									else if(attackers[i] &lt; defenders[i]){</span>
<span class="nc bnc" id="L725" title="All 2 branches missed.">										for(int d = 0; d &lt; defenders[i]; d++){</span>
<span class="nc bnc" id="L726" title="All 2 branches missed.">											int rand = (allies.size() &gt; 0) ? new Random().nextInt(allies.size()) : 0; //There is an error here!</span>
<span class="nc" id="L727">											System.out.println(&quot;n: &quot; + rand);</span>
<span class="nc" id="L728">											Player soldier = allies.get(rand);</span>
<span class="nc" id="L729">											System.out.println(&quot;got a &quot; + soldier.getRank());</span>
<span class="nc bnc" id="L730" title="All 2 branches missed.">											if(soldier instanceof Knight){</span>
<span class="nc bnc" id="L731" title="All 2 branches missed.">												if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L732">													soldier.wound();</span>
<span class="nc" id="L733">													System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
												}
												else{
<span class="nc" id="L736">													allies.remove(rand);</span>
<span class="nc" id="L737">													System.out.println(&quot;Killed a Knight&quot;);</span>
												}
											}
<span class="nc bnc" id="L740" title="All 6 branches missed.">											else if(soldier instanceof Vassals || </span>
													soldier instanceof Retainers || 
													soldier instanceof Mercenaries){
<span class="nc" id="L743">												soldier.wound();</span>
<span class="nc" id="L744">												allies.remove(rand);</span>
											}
										}
									}
									break;
									
								case 5:
<span class="nc" id="L751">									break;</span>
									
								case 6:
									break;
								}
							}
						}
<span class="nc" id="L758">					}</span>
<span class="nc bnc" id="L759" title="All 2 branches missed.">				if(allies.size() &gt; magyar.size())</span>
<span class="nc" id="L760">					System.out.println(&quot;Allied forces won the battle &quot; + magyar.size());</span>
				else
<span class="nc" id="L762">					System.out.println(&quot;Rebellious Vassals won the battle &quot; + allies.size());</span>
<span class="nc" id="L763">			}</span>
		}else{
<span class="nc" id="L765">			System.out.println(&quot;There is no invasion by Magyars in this fiefdom&quot;);</span>
		}
<span class="nc" id="L767">	}</span>


	public void muslim(Collection args){
<span class="nc" id="L771">		int attackersDice = 0;</span>
<span class="nc" id="L772">		int defendersDice = 0;</span>
<span class="nc" id="L773">		Iterator argsIter = args.iterator();</span>
<span class="nc" id="L774">		argsIter.next(); //Method name</span>
<span class="nc" id="L775">		Knight attackingKnight = CurrentPlayers.currentPlayers.get(argsIter.next());</span>
<span class="nc" id="L776">		Fiefdoms fief = Map.map.get(attackingKnight.getLocation());</span>
<span class="nc bnc" id="L777" title="All 2 branches missed.">		if(fief.getMuslim().size() &gt; 0){</span>
<span class="nc bnc" id="L778" title="All 2 branches missed.">			if(attackingKnight.getLocation().equalsIgnoreCase(fief.getName())){</span>
<span class="nc" id="L779">				ArrayList&lt;Intruders&gt; muslim = fief.getMuslim();</span>
<span class="nc" id="L780">				ArrayList&lt;Player&gt; allies = attackingKnight.getAllies();</span>
<span class="nc" id="L781">				attackingKnight.allyTo(attackingKnight.getName()); // The knight himself, retainers, and mercenaries (if any) will be added to the allied army</span>
				
<span class="nc bnc" id="L783" title="All 2 branches missed.">				if(allies.size() &gt; 0){</span>
<span class="nc bnc" id="L784" title="All 2 branches missed.">					for(Player soldier : allies){</span>
<span class="nc bnc" id="L785" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;knight&quot;))</span>
<span class="nc" id="L786">							attackersDice += 3;</span>
<span class="nc bnc" id="L787" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;count&quot;))</span>
<span class="nc" id="L788">							attackersDice += 4;</span>
<span class="nc bnc" id="L789" title="All 4 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;duke&quot;) || soldier.getRank().equalsIgnoreCase(&quot;king&quot;))</span>
<span class="nc" id="L790">							attackersDice += 6;</span>
<span class="nc bnc" id="L791" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;vassal&quot;))</span>
<span class="nc" id="L792">							attackersDice += 1;</span>
<span class="nc" id="L793">					}</span>
				}
	
<span class="nc" id="L796">				defendersDice = muslim.size();</span>
<span class="nc" id="L797">				System.out.println(&quot;Attacker's dice: &quot; + attackersDice);</span>
<span class="nc" id="L798">				System.out.println(&quot;Defender's dice: &quot; + defendersDice);</span>
<span class="nc bnc" id="L799" title="All 4 branches missed.">				while(allies.size() &gt; 0 &amp;&amp; muslim.size() &gt; 0){</span>
<span class="nc" id="L800">					int attackers[] = this.rollDice(attackersDice);</span>
<span class="nc" id="L801">					int defenders[] = this.rollDice(defendersDice);</span>
<span class="nc bnc" id="L802" title="All 2 branches missed.">					for(int i = 1; i &lt; 6; i++){</span>
<span class="nc bnc" id="L803" title="All 4 branches missed.">						if(allies.size() &gt; 0 &amp;&amp; muslim.size() &gt; 0){</span>
<span class="nc" id="L804">							System.out.println(i + &quot; Rebellious: &quot; + muslim.size());</span>
<span class="nc" id="L805">							System.out.println(i + &quot; Allied Forces: &quot; + allies.size());</span>
<span class="nc" id="L806">							System.out.println(&quot;Allies has thrown &quot; + attackers[i] + &quot; &quot; + i + &quot;'s&quot;);</span>
<span class="nc" id="L807">							System.out.println(&quot;Rebellious Vassals has thrown &quot; + defenders[i] + &quot; &quot; + i + &quot;'s&quot;);</span>
<span class="nc bnc" id="L808" title="All 2 branches missed.">							attackers[i] = (attackers[i] &lt; muslim.size()) ? attackers[i] : muslim.size();</span>
<span class="nc bnc" id="L809" title="All 2 branches missed.">							defenders[i] = (defenders[i] &lt; allies.size()) ? defenders[i] : allies.size();</span>
<span class="nc bnc" id="L810" title="All 6 branches missed.">							switch(i){</span>
								case 1: //autokill
<span class="nc bnc" id="L812" title="All 2 branches missed.">									for(int b = 0; b &lt; attackers[i]; b++){</span>
<span class="nc" id="L813">										muslim.remove(0);</span>
									}
<span class="nc bnc" id="L815" title="All 2 branches missed.">									for(int c = 0; c &lt; defenders[i]; c++){</span>
<span class="nc" id="L816">										int rand = new Random().nextInt(allies.size());</span>
<span class="nc" id="L817">										Player soldier = allies.get(rand);</span>
<span class="nc bnc" id="L818" title="All 2 branches missed.">										if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L819" title="All 2 branches missed.">											if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L820">												soldier.kill();</span>
<span class="nc" id="L821">												System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
											}
											else{
<span class="nc" id="L824">												allies.remove(rand);</span>
<span class="nc" id="L825">												System.out.println(&quot;Killed a Knight&quot;);</span>
											}
										}
<span class="nc bnc" id="L828" title="All 6 branches missed.">										else if(soldier instanceof Vassals || </span>
												soldier instanceof Retainers || 
												soldier instanceof Mercenaries){
<span class="nc" id="L831">											soldier.kill();</span>
<span class="nc" id="L832">											allies.remove(rand);</span>
										}
									}
<span class="nc" id="L835">									break;</span>
								case 2: //conditional kill
<span class="nc bnc" id="L837" title="All 4 branches missed.">									if(attackers[i] &gt; defenders[i] || </span>
											(attackers[i] == defenders[i] &amp;&amp; 
<span class="nc bnc" id="L839" title="All 2 branches missed.">											(fief.getFiefdomCastles() + fief.getPersonalCastles() &gt; 0))){</span>
<span class="nc bnc" id="L840" title="All 2 branches missed.">										for(int c = 0; c &lt; attackers[i]; c++){</span>
<span class="nc" id="L841">											muslim.remove(0);</span>
										}
									}
<span class="nc bnc" id="L844" title="All 2 branches missed.">									else if(attackers[i] &lt; defenders[i]){</span>
<span class="nc bnc" id="L845" title="All 2 branches missed.">										for(int c = 0; c &lt; attackers[i]; c++){</span>
<span class="nc bnc" id="L846" title="All 2 branches missed.">											int rand = (allies.size() &gt; 0) ? new Random().nextInt(allies.size()) : 0;</span>
<span class="nc" id="L847">											Player soldier = allies.get(rand);</span>
<span class="nc bnc" id="L848" title="All 2 branches missed.">											if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L849" title="All 2 branches missed.">												if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L850">													soldier.kill();</span>
<span class="nc" id="L851">													System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
												}
												else{
<span class="nc" id="L854">													allies.remove(rand);</span>
<span class="nc" id="L855">													System.out.println(&quot;Killed a Knight&quot;);</span>
												}
											}
										}
									}
									break;
								case 3: //autowound
<span class="nc bnc" id="L862" title="All 2 branches missed.">									for(int b = 0; b &lt; attackers[i]; b++){</span>
<span class="nc" id="L863">										muslim.get(0).wound();</span>
<span class="nc" id="L864">										muslim.remove(0);</span>
									}
<span class="nc bnc" id="L866" title="All 2 branches missed.">									for(int c = 0; c &lt; defenders[i]; c++){</span>
<span class="nc bnc" id="L867" title="All 2 branches missed.">										int rand = (allies.size() &gt; 0) ? new Random().nextInt(allies.size()) : 0;</span>
<span class="nc" id="L868">										Player soldier = allies.get(rand);</span>
<span class="nc" id="L869">										System.out.println(c);</span>
<span class="nc bnc" id="L870" title="All 2 branches missed.">										if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L871" title="All 2 branches missed.">											if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L872">												soldier.wound();</span>
<span class="nc" id="L873">												System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
											}
											else{
<span class="nc" id="L876">												allies.remove(rand);</span>
<span class="nc" id="L877">												System.out.println(&quot;Killed a Knight&quot;);</span>
											}
										}
<span class="nc bnc" id="L880" title="All 6 branches missed.">										else if(soldier instanceof Vassals || </span>
												soldier instanceof Retainers || 
												soldier instanceof Mercenaries){
<span class="nc" id="L883">											soldier.wound();</span>
<span class="nc" id="L884">											allies.remove(rand);</span>
										}
									}
<span class="nc" id="L887">									break;</span>
			
								case 4: //conditional wound
<span class="nc bnc" id="L890" title="All 4 branches missed.">									if(attackers[i] &gt; defenders[i] || </span>
											(attackers[i] == defenders[i] &amp;&amp; 
<span class="nc bnc" id="L892" title="All 2 branches missed.">											(fief.getFiefdomCastles() + fief.getPersonalCastles() &gt; 0))){</span>
<span class="nc bnc" id="L893" title="All 2 branches missed.">										for(int c = 0; c &lt; attackers[i]; c++){</span>
<span class="nc" id="L894">											muslim.get(0).wound();</span>
<span class="nc" id="L895">											muslim.remove(0);</span>
										}
									}
<span class="nc bnc" id="L898" title="All 2 branches missed.">									else if(attackers[i] &lt; defenders[i]){</span>
<span class="nc bnc" id="L899" title="All 2 branches missed.">										for(int d = 0; d &lt; defenders[i]; d++){</span>
<span class="nc bnc" id="L900" title="All 2 branches missed.">											int rand = (allies.size() &gt; 0) ? new Random().nextInt(allies.size()) : 0; //There is an error here!</span>
<span class="nc" id="L901">											System.out.println(&quot;n: &quot; + rand);</span>
<span class="nc" id="L902">											Player soldier = allies.get(rand);</span>
<span class="nc" id="L903">											System.out.println(&quot;got a &quot; + soldier.getRank());</span>
<span class="nc bnc" id="L904" title="All 2 branches missed.">											if(soldier instanceof Knight){</span>
<span class="nc bnc" id="L905" title="All 2 branches missed.">												if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L906">													soldier.wound();</span>
<span class="nc" id="L907">													System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
												}
												else{
<span class="nc" id="L910">													allies.remove(rand);</span>
<span class="nc" id="L911">													System.out.println(&quot;Killed a Knight&quot;);</span>
												}
											}
<span class="nc bnc" id="L914" title="All 6 branches missed.">											else if(soldier instanceof Vassals || </span>
													soldier instanceof Retainers || 
													soldier instanceof Mercenaries){
<span class="nc" id="L917">												soldier.wound();</span>
<span class="nc" id="L918">												allies.remove(rand);</span>
											}
										}
									}
									break;
									
								case 5:
<span class="nc" id="L925">									break;</span>
									
								case 6:
									break;
								}
							}
						}
<span class="nc" id="L932">					}</span>
<span class="nc bnc" id="L933" title="All 2 branches missed.">				if(allies.size() &gt; muslim.size())</span>
<span class="nc" id="L934">					System.out.println(&quot;Allied forces won the battle &quot; + muslim.size());</span>
				else
<span class="nc" id="L936">					System.out.println(&quot;Rebellious Vassals won the battle &quot; + allies.size());</span>
			}
		}
<span class="nc" id="L939">	}</span>

	
	public void knight(Collection args){
<span class="nc" id="L943">		int attackersDice = 0;</span>
<span class="nc" id="L944">		int defendersDice = 0;</span>
<span class="nc" id="L945">		Iterator argsIter = args.iterator();</span>
<span class="nc" id="L946">		argsIter.next(); //Method name</span>

<span class="nc" id="L948">		Knight attackingKnight = CurrentPlayers.currentPlayers.get(argsIter.next());</span>
<span class="nc" id="L949">		Fiefdoms fief = Map.map.get(attackingKnight.getLocation());</span>
<span class="nc" id="L950">		Knight defendingKnight = CurrentPlayers.currentPlayers.get(fief.getOwner());</span>

<span class="nc bnc" id="L952" title="All 2 branches missed.">		if(attackingKnight != defendingKnight){</span>
<span class="nc bnc" id="L953" title="All 2 branches missed.">			if(attackingKnight.getLocation().equalsIgnoreCase(fief.getName())){</span>
<span class="nc" id="L954">				attackingKnight.allyTo(attackingKnight.getName()); // The knight himself, retainers, and mercenaries (if any) will be added to the allied army</span>
<span class="nc" id="L955">				ArrayList&lt;Player&gt; attackingArmy = attackingKnight.getAllies();</span>
<span class="nc" id="L956">				System.out.println(&quot;Attacking Army allies: &quot; + attackingArmy.size());</span>
<span class="nc" id="L957">				ArrayList&lt;Player&gt; defendingArmy = new ArrayList&lt;Player&gt;();</span>
<span class="nc bnc" id="L958" title="All 2 branches missed.">				if(defendingKnight.getLocation().equalsIgnoreCase(fief.getName())){</span>
<span class="nc" id="L959">					defendingKnight.allyTo(defendingKnight.getName()); // The knight himself, retainers, and mercenaries (if any) will be added to the allied army</span>
<span class="nc" id="L960">					defendingArmy = defendingKnight.getAllies();</span>
				}
				else{
<span class="nc" id="L963">					defendingArmy.addAll(fief.getLoyalVassals());</span>
				}
<span class="nc bnc" id="L965" title="All 2 branches missed.">				if(defendingArmy.size() &gt; 0){</span>
<span class="nc bnc" id="L966" title="All 2 branches missed.">					for(Player soldier : defendingArmy){</span>
<span class="nc bnc" id="L967" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;knight&quot;))</span>
<span class="nc" id="L968">							defendersDice += 3;</span>
<span class="nc bnc" id="L969" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;count&quot;))</span>
<span class="nc" id="L970">							defendersDice += 4;</span>
<span class="nc bnc" id="L971" title="All 4 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;duke&quot;) || soldier.getRank().equalsIgnoreCase(&quot;king&quot;))</span>
<span class="nc" id="L972">							defendersDice += 6;</span>
<span class="nc bnc" id="L973" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;vassal&quot;))</span>
<span class="nc" id="L974">							defendersDice += 1;</span>
<span class="nc" id="L975">					}</span>
				}
				
<span class="nc bnc" id="L978" title="All 2 branches missed.">				if(attackingArmy.size() &gt; 0){</span>
<span class="nc bnc" id="L979" title="All 2 branches missed.">					for(Player soldier : attackingArmy){</span>
<span class="nc bnc" id="L980" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;knight&quot;))</span>
<span class="nc" id="L981">							attackersDice += 3;</span>
<span class="nc bnc" id="L982" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;count&quot;))</span>
<span class="nc" id="L983">							attackersDice += 4;</span>
<span class="nc bnc" id="L984" title="All 4 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;duke&quot;) || soldier.getRank().equalsIgnoreCase(&quot;king&quot;))</span>
<span class="nc" id="L985">							attackersDice += 6;</span>
<span class="nc bnc" id="L986" title="All 2 branches missed.">						if(soldier.getRank().equalsIgnoreCase(&quot;vassal&quot;))</span>
<span class="nc" id="L987">							attackersDice += 1;</span>
<span class="nc" id="L988">					}</span>
				}
	
<span class="nc" id="L991">				System.out.println(&quot;Attacker's dice: &quot; + attackersDice);</span>
<span class="nc" id="L992">				System.out.println(&quot;Defender's dice: &quot; + defendersDice);</span>
<span class="nc bnc" id="L993" title="All 4 branches missed.">				while(attackingArmy.size() &gt; 0 &amp;&amp; defendingArmy.size() &gt; 0){</span>
<span class="nc" id="L994">					int attackers[] = this.rollDice(attackersDice);</span>
<span class="nc" id="L995">					int defenders[] = this.rollDice(defendersDice);</span>
<span class="nc bnc" id="L996" title="All 2 branches missed.">					for(int i = 1; i &lt; 6; i++){</span>
<span class="nc bnc" id="L997" title="All 4 branches missed.">						if(attackingArmy.size() &gt; 0 &amp;&amp; defendingArmy.size() &gt; 0){</span>
<span class="nc" id="L998">							System.out.println(i + &quot; Rebellious: &quot; + defendingArmy.size());</span>
<span class="nc" id="L999">							System.out.println(i + &quot; Allied Forces: &quot; + attackingArmy.size());</span>
<span class="nc" id="L1000">							System.out.println(&quot;Allies has thrown &quot; + attackers[i] + &quot; &quot; + i + &quot;'s&quot;);</span>
<span class="nc" id="L1001">							System.out.println(&quot;Rebellious Vassals has thrown &quot; + defenders[i] + &quot; &quot; + i + &quot;'s&quot;);</span>
<span class="nc bnc" id="L1002" title="All 2 branches missed.">							attackers[i] = (attackers[i] &lt; defendingArmy.size()) ? attackers[i] : defendingArmy.size();</span>
<span class="nc bnc" id="L1003" title="All 2 branches missed.">							defenders[i] = (defenders[i] &lt; attackingArmy.size()) ? defenders[i] : attackingArmy.size();</span>
<span class="nc bnc" id="L1004" title="All 6 branches missed.">							switch(i){</span>
								case 1: //autokill
<span class="nc bnc" id="L1006" title="All 2 branches missed.">									for(int c = 0; c &lt; attackers[i]; c++){</span>
<span class="nc" id="L1007">										int rand = new Random().nextInt(defendingArmy.size());</span>
<span class="nc" id="L1008">										Player soldier = defendingArmy.get(rand);</span>
<span class="nc bnc" id="L1009" title="All 2 branches missed.">										if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L1010" title="All 2 branches missed.">											if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L1011">												soldier.kill();</span>
<span class="nc" id="L1012">												System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
											}
											else{
<span class="nc" id="L1015">												defendingArmy.remove(rand);</span>
<span class="nc" id="L1016">												System.out.println(&quot;Killed a Knight&quot;);</span>
											}
										}
<span class="nc bnc" id="L1019" title="All 6 branches missed.">										else if(soldier instanceof Vassals || </span>
												soldier instanceof Retainers || 
												soldier instanceof Mercenaries){
<span class="nc" id="L1022">											soldier.kill();</span>
<span class="nc" id="L1023">											defendingArmy.remove(rand);</span>
										}
									}
<span class="nc bnc" id="L1026" title="All 2 branches missed.">									for(int c = 0; c &lt; defenders[i]; c++){</span>
<span class="nc bnc" id="L1027" title="All 2 branches missed.">										int rand = (attackingArmy.size() &gt; 0) ? new Random().nextInt(attackingArmy.size()) : 0;</span>
										
<span class="nc" id="L1029">										Player soldier = attackingArmy.get(rand);</span>
<span class="nc bnc" id="L1030" title="All 2 branches missed.">										if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L1031" title="All 2 branches missed.">											if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L1032">												soldier.kill();</span>
<span class="nc" id="L1033">												System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
											}
											else{
<span class="nc" id="L1036">												attackingArmy.remove(rand);</span>
<span class="nc" id="L1037">												System.out.println(&quot;Killed a Knight&quot;);</span>
											}
										}
<span class="nc bnc" id="L1040" title="All 6 branches missed.">										else if(soldier instanceof Vassals || </span>
												soldier instanceof Retainers || 
												soldier instanceof Mercenaries){
<span class="nc" id="L1043">											soldier.kill();</span>
<span class="nc" id="L1044">											attackingArmy.remove(rand);</span>
										}
									}
<span class="nc" id="L1047">									break;</span>
								case 2: //conditional kill
	//if Attacking army throws more 2's than the defending army
<span class="nc bnc" id="L1050" title="All 2 branches missed.">									if(attackers[i] &gt; defenders[i]){</span>
<span class="nc bnc" id="L1051" title="All 2 branches missed.">										for(int c = 0; c &lt; attackers[i]; c++){</span>
<span class="nc bnc" id="L1052" title="All 2 branches missed.">											int rand = (defendingArmy.size() &gt; 0) ? new Random().nextInt(defendingArmy.size()) : 0;</span>
<span class="nc" id="L1053">											Player soldier = defendingArmy.get(rand);</span>
<span class="nc bnc" id="L1054" title="All 2 branches missed.">											if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L1055" title="All 2 branches missed.">												if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L1056">													soldier.kill();</span>
<span class="nc" id="L1057">													System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
												}
												else{
<span class="nc" id="L1060">													defendingArmy.remove(rand);</span>
<span class="nc" id="L1061">													System.out.println(&quot;Killed a Knight&quot;);</span>
												}
											}
										}
									}
	// if defending army throws more 2's than the attacking army
<span class="nc bnc" id="L1067" title="All 4 branches missed.">									else if(attackers[i] &lt; defenders[i] || </span>
											(attackers[i] == defenders[i] &amp;&amp; 
<span class="nc bnc" id="L1069" title="All 2 branches missed.">											(fief.getFiefdomCastles() + fief.getPersonalCastles() &gt; 0))){</span>
<span class="nc bnc" id="L1070" title="All 2 branches missed.">										for(int c = 0; c &lt; defenders[i]; c++){</span>
<span class="nc bnc" id="L1071" title="All 2 branches missed.">											int rand = (attackingArmy.size() &gt; 0) ? new Random().nextInt(attackingArmy.size()) : 0;</span>
<span class="nc" id="L1072">											Player soldier = attackingArmy.get(rand);</span>
<span class="nc bnc" id="L1073" title="All 2 branches missed.">											if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L1074" title="All 2 branches missed.">												if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L1075">													soldier.kill();</span>
<span class="nc" id="L1076">													System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
												}
												else{
<span class="nc" id="L1079">													attackingArmy.remove(rand);</span>
<span class="nc" id="L1080">													System.out.println(&quot;Killed a Knight&quot;);</span>
												}
											}
										}
									}
									break;
								case 3: //autowound
<span class="nc bnc" id="L1087" title="All 2 branches missed.">									for(int c = 0; c &lt; attackers[i]; c++){</span>
<span class="nc bnc" id="L1088" title="All 2 branches missed.">										int rand = (defendingArmy.size() &gt; 0) ? new Random().nextInt(defendingArmy.size()) : 0;</span>
<span class="nc" id="L1089">										Player soldier = defendingArmy.get(rand);</span>
<span class="nc" id="L1090">										System.out.println(c);</span>
<span class="nc bnc" id="L1091" title="All 2 branches missed.">										if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L1092" title="All 2 branches missed.">											if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L1093">												soldier.wound();</span>
<span class="nc" id="L1094">												System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
											}
											else{
<span class="nc" id="L1097">												defendingArmy.remove(rand);</span>
<span class="nc" id="L1098">												System.out.println(&quot;Killed a Knight&quot;);</span>
											}
										}
<span class="nc bnc" id="L1101" title="All 6 branches missed.">										else if(soldier instanceof Vassals || </span>
												soldier instanceof Retainers || 
												soldier instanceof Mercenaries){
<span class="nc" id="L1104">											soldier.wound();</span>
<span class="nc" id="L1105">											defendingArmy.remove(rand);</span>
										}
									}
<span class="nc bnc" id="L1108" title="All 2 branches missed.">									for(int c = 0; c &lt; defenders[i]; c++){</span>
<span class="nc bnc" id="L1109" title="All 2 branches missed.">										int rand = (attackingArmy.size() &gt; 0) ? new Random().nextInt(attackingArmy.size()) : 0;</span>
<span class="nc bnc" id="L1110" title="All 2 branches missed.">										if(rand &gt; 0){</span>
<span class="nc" id="L1111">											Player soldier = attackingArmy.get(rand);</span>
<span class="nc" id="L1112">											System.out.println(c);</span>
<span class="nc bnc" id="L1113" title="All 2 branches missed.">											if(soldier instanceof Knight){</span>
<span class="nc bnc" id="L1114" title="All 2 branches missed.">												if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L1115">													soldier.wound();</span>
<span class="nc" id="L1116">													System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
												}
												else{
<span class="nc" id="L1119">													attackingArmy.remove(rand);</span>
<span class="nc" id="L1120">													System.out.println(&quot;Killed a Knight&quot;);</span>
												}
											}
<span class="nc bnc" id="L1123" title="All 6 branches missed.">											else if(soldier instanceof Vassals ||</span>
													soldier instanceof Retainers ||
													soldier instanceof Mercenaries){
<span class="nc" id="L1126">												soldier.wound();</span>
<span class="nc" id="L1127">												attackingArmy.remove(rand);</span>
											}
										}
									}
<span class="nc" id="L1131">									break;</span>
			
								case 4: //conditional wound
	// if Attacking army throws more 2's than the defending army
<span class="nc bnc" id="L1135" title="All 2 branches missed.">									if(attackers[i] &gt; defenders[i]){</span>
<span class="nc bnc" id="L1136" title="All 2 branches missed.">										for(int c = 0; c &lt; attackers[i]; c++){</span>
<span class="nc bnc" id="L1137" title="All 2 branches missed.">											int rand = (defendingArmy.size() &gt; 0) ? new Random().nextInt(defendingArmy.size()) : 0;</span>
<span class="nc" id="L1138">											Player soldier = defendingArmy.get(rand);</span>
<span class="nc bnc" id="L1139" title="All 2 branches missed.">											if(soldier instanceof Knight){							</span>
<span class="nc bnc" id="L1140" title="All 2 branches missed.">												if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L1141">													soldier.wound();</span>
<span class="nc" id="L1142">													System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
												}
												else{
<span class="nc" id="L1145">													defendingArmy.remove(rand);</span>
<span class="nc" id="L1146">													System.out.println(&quot;Killed a Knight&quot;);</span>
												}
											}
										}
									}
<span class="nc bnc" id="L1151" title="All 4 branches missed.">									else if(attackers[i] &lt; defenders[i] || </span>
											(attackers[i] == defenders[i] &amp;&amp; 
<span class="nc bnc" id="L1153" title="All 2 branches missed.">											(fief.getFiefdomCastles() + fief.getPersonalCastles() &gt; 0))){</span>
<span class="nc bnc" id="L1154" title="All 2 branches missed.">										for(int d = 0; d &lt; defenders[i]; d++){</span>
<span class="nc bnc" id="L1155" title="All 2 branches missed.">											int rand = (attackingArmy.size() &gt; 0) ? new Random().nextInt(attackingArmy.size()) : 0; //There is an error here!</span>
<span class="nc" id="L1156">											Player soldier = attackingArmy.get(rand);</span>
<span class="nc bnc" id="L1157" title="All 2 branches missed.">											if(soldier instanceof Knight){</span>
<span class="nc bnc" id="L1158" title="All 2 branches missed.">												if(((Knight)soldier).getWounds() + ((Knight)soldier).getKills() + 1 &lt; 3){</span>
<span class="nc" id="L1159">													soldier.wound();</span>
<span class="nc" id="L1160">													System.out.println(&quot;Got a knight. &quot; + (int)(((Knight)soldier).getWounds() + ((Knight)soldier).getKills()) + &quot; slots have been filled&quot;);</span>
												}
												else{
<span class="nc" id="L1163">													attackingArmy.remove(rand);</span>
<span class="nc" id="L1164">													System.out.println(&quot;Killed a Knight&quot;);</span>
												}
											}
<span class="nc bnc" id="L1167" title="All 6 branches missed.">											else if(soldier instanceof Vassals || </span>
													soldier instanceof Retainers || 
													soldier instanceof Mercenaries){
<span class="nc" id="L1170">												soldier.wound();</span>
<span class="nc" id="L1171">												attackingArmy.remove(rand);</span>
											}
										}
									}
									break;
									
								case 5:
<span class="nc" id="L1178">									break;</span>
									
								case 6:
									break;
								}
							}
						}
<span class="nc" id="L1185">					}</span>
				
<span class="nc bnc" id="L1187" title="All 2 branches missed.">				if(attackingArmy.size() &gt; defendingArmy.size())</span>
<span class="nc" id="L1188">					System.out.println(&quot;Attacking army won the battle &quot; + defendingArmy.size());</span>
				else
<span class="nc" id="L1190">					System.out.println(&quot;Defending army won the battle &quot; + attackingArmy.size());</span>
			
<span class="nc bnc" id="L1192" title="All 2 branches missed.">				if(attackingArmy.size() &gt; 0){</span>
					
				}
<span class="nc" id="L1195">			}</span>
		}
		else{
<span class="nc" id="L1198">			System.out.println(&quot;You can only go to war against a fiefdom that doesn't belong to you.&quot;);</span>
		}
<span class="nc" id="L1200">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>