<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>XMLParser.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">97_feudalismgame</a> &gt; <a href="index.source.html" class="el_package">src</a> &gt; <span class="el_source">XMLParser.java</span></div><h1>XMLParser.java</h1><pre class="source lang-java linenums">package src;

import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;

import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.NodeList;
import org.xml.sax.SAXException;

<span class="nc" id="L16">public class XMLParser {</span>

	public static HashMap&lt;String,Fiefdoms&gt; fiefdoms(){

<span class="fc" id="L20">		HashMap&lt;String,Fiefdoms&gt; map = new HashMap&lt;String,Fiefdoms&gt;();</span>
<span class="fc" id="L21">		ArrayList&lt;Fiefdoms&gt; fiefdoms = new ArrayList&lt;Fiefdoms&gt;();</span>
		Document doc;
<span class="fc" id="L23">		String FILENAME = &quot;fiefdoms.xml&quot;;</span>
<span class="fc" id="L24">		DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();</span>
		try { //Load document as DOM
<span class="fc" id="L26">			DocumentBuilder db = dbf.newDocumentBuilder();</span>
<span class="nc" id="L27">			doc = db.parse(FILENAME);</span>
<span class="nc" id="L28">			Element e = doc.getDocumentElement();</span>
<span class="nc" id="L29">			NodeList nl = e.getElementsByTagName(&quot;Fiefdom&quot;);</span>

<span class="nc bnc" id="L31" title="All 2 branches missed.">			for(int i = 0 ; i &lt; nl.getLength() ; i++){</span>
<span class="nc" id="L32">				Element el = (Element)nl.item(i); //Look for &lt;Fiefdom&gt; elements</span>
				//get the Fiefdom object
<span class="nc" id="L34">				Fiefdoms fiefdom = getFiefdom(el);</span>
<span class="nc" id="L35">				fiefdoms.add(fiefdom);</span>
				//Populating map with fiefdoms
<span class="nc" id="L37">				map.put(fiefdom.getName(), fiefdom);</span>
			}

<span class="nc" id="L40">		} catch (ParserConfigurationException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L42">			e.printStackTrace();</span>
<span class="nc" id="L43">		} catch (SAXException e) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L45">			e.printStackTrace();</span>
<span class="fc" id="L46">		} catch (IOException e) {</span>
			// TODO Auto-generated catch block
<span class="fc" id="L48">			e.printStackTrace();</span>
<span class="nc" id="L49">		}</span>
		
<span class="fc" id="L51">		SAXEncoder.fiefdoms(map);</span>
<span class="fc" id="L52">		return map;</span>
	}

	private static Fiefdoms getFiefdom(Element fiefEle){

<span class="nc" id="L57">		ArrayList&lt;String&gt; neighbors = getListValue(fiefEle, &quot;Neighbor&quot;);</span>
<span class="nc" id="L58">		String name = fiefEle.getAttribute(&quot;Name&quot;);</span>
//		int vassals = Integer.parseInt(fiefEle.getAttribute(&quot;Vassals&quot;));
<span class="nc" id="L60">		String owner = fiefEle.getAttribute(&quot;Owner&quot;);</span>
<span class="nc" id="L61">		int value = Integer.parseInt(fiefEle.getAttribute(&quot;Value&quot;));</span>
<span class="nc" id="L62">		int fCastles = Integer.parseInt(fiefEle.getAttribute(&quot;FiefdomCastles&quot;));</span>
<span class="nc" id="L63">		int pCastles = Integer.parseInt(fiefEle.getAttribute(&quot;PersonalCastles&quot;));</span>
<span class="nc" id="L64">		int intruders = Integer.parseInt(fiefEle.getAttribute(&quot;Intruders&quot;));</span>
<span class="nc" id="L65">		int peasants = Integer.parseInt(fiefEle.getAttribute(&quot;Peasants&quot;));</span>
<span class="nc" id="L66">		int loyalVassals = Integer.parseInt(fiefEle.getAttribute(&quot;LoyalVassals&quot;));</span>
<span class="nc" id="L67">		int rebelliousVassals = Integer.parseInt(fiefEle.getAttribute(&quot;RebelliousVassals&quot;));</span>
<span class="nc" id="L68">		boolean isKingdom = Boolean.parseBoolean(fiefEle.getAttribute(&quot;Kingdom&quot;));</span>
<span class="nc" id="L69">		ArrayList&lt;String&gt; invaderType = getListValue(fiefEle, &quot;invaderType&quot;);</span>
<span class="nc" id="L70">		Fiefdoms fiefdom = new Fiefdoms(neighbors, name, owner, value, isKingdom, invaderType);</span>

<span class="nc" id="L72">		return fiefdom;</span>
	}

	private static ArrayList&lt;String&gt; getListValue(Element e, String tagName){
<span class="nc" id="L76">		ArrayList&lt;String&gt; valuesList = new ArrayList&lt;String&gt;();</span>
<span class="nc" id="L77">		String textVal = null;</span>
<span class="nc" id="L78">		NodeList nl = e.getElementsByTagName(tagName);</span>
<span class="nc bnc" id="L79" title="All 4 branches missed.">		if((nl != null) &amp;&amp; (nl.getLength() &gt; 0)){</span>
<span class="nc bnc" id="L80" title="All 2 branches missed.">			for(int i = 0; i &lt; nl.getLength(); i++){</span>
<span class="nc" id="L81">				Element el = (Element) nl.item(i);</span>
<span class="nc" id="L82">				textVal = el.getFirstChild().getNodeValue();</span>
//				System.out.println(textVal);
<span class="nc" id="L84">				valuesList.add(textVal);</span>
			}
		}
<span class="nc" id="L87">		return valuesList;</span>
	}

//	public static HashMap&lt;String,Knight&gt; knights(){
//
//		HashMap&lt;String,Knight&gt; knights = new HashMap&lt;String,Knight&gt;();
//		Document doc;
//		String FILENAME = &quot;knights.xml&quot;;
//		DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
//		try { //Load document as DOM
//			DocumentBuilder db = dbf.newDocumentBuilder();
//			doc = db.parse(FILENAME);
//			Element e = doc.getDocumentElement();
//			NodeList nl = e.getElementsByTagName(&quot;Knight&quot;);
//			for(int i = 0 ; i &lt; nl.getLength() ; i++){
//				Element el = (Element)nl.item(i); //Look for &lt;Knight&gt; elements
//				//get the Fiefdom object
//				Knight knight = getKnight(el);
//				//Populating map with fiefdoms
//				knights.put(knight.getName(), knight);
//			}
//
//		} catch (ParserConfigurationException e) {
//			// TODO Auto-generated catch block
//			e.printStackTrace();
//		} catch (SAXException e) {
//			// TODO Auto-generated catch block
//			e.printStackTrace();
//		} catch (IOException e) {
//			// TODO Auto-generated catch block
//			e.printStackTrace();
//		}
//		return knights;
//	}

//	private static Knight getKnight(Element knightEle){
//		HashMap fiefdoms = XMLParser.fiefdoms(); //Get  hashmap of all fiefdoms
//		ArrayList&lt;String&gt; fiefdomNames = getListValue(knightEle, &quot;Fiefdom&quot;); //Get the list of fiefdoms owned by this knight
//		ArrayList&lt;String&gt; fiefdomList = new ArrayList&lt;String&gt;();
//		String fiefdomName = null;
//		Iterator fiefdomNamesIter = fiefdomNames.iterator();
//		while(fiefdomNamesIter.hasNext() &amp;&amp; (fiefdomName = (String)fiefdomNamesIter.next()) != null){
//			Fiefdoms fiefdom = (Fiefdoms)fiefdoms.get(fiefdomName);
////			System.out.println(fiefdom.getName());
//			fiefdomList.add(fiefdom.getName());
////			System.out.println(fiefdom.getName());
////			System.out.println(fiefdom.getOwner().getName());
//		}
//
//		String name = knightEle.getAttribute(&quot;Name&quot;);
//		String rank = knightEle.getAttribute(&quot;Rank&quot;);
//		int money = Integer.parseInt(knightEle.getAttribute(&quot;Money&quot;));
//		int diceNumber = Integer.parseInt(knightEle.getAttribute(&quot;Dice&quot;));
//		Knight knight = new Knight(name, money, fiefdomList, rank);

//		return knight;
//	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>