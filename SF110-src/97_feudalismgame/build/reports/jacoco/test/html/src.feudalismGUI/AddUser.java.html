<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AddUser.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">97_feudalismgame</a> &gt; <a href="index.source.html" class="el_package">src.feudalismGUI</a> &gt; <span class="el_source">AddUser.java</span></div><h1>AddUser.java</h1><pre class="source lang-java linenums">package src.feudalismGUI;
import java.awt.Container;
import java.awt.FlowLayout;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.ArrayList;
import java.util.HashMap;

import javax.swing.JApplet;
import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JLabel;
import javax.swing.JList;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextField;
import javax.swing.event.ListDataEvent;
import javax.swing.event.ListDataListener;

import src.CurrentPlayers;
import src.GameAutoActions;
import src.Knight;


public class AddUser extends JApplet {
<span class="nc" id="L28">	private JPanel panel = new JPanel(new GridLayout(0,1));</span>
<span class="nc" id="L29">	private JPanel panelBtn = new JPanel(new FlowLayout());</span>
<span class="nc" id="L30">	private static ArrayList&lt;Object&gt; users = new ArrayList&lt;Object&gt;();</span>
<span class="nc" id="L31">	private JButton submitBtn = new JButton(&quot;Add Player&quot;);</span>
<span class="nc" id="L32">	private JPanel knightPanel = new JPanel(new GridLayout(0,2));</span>
<span class="nc" id="L33">	private JPanel leftPanel = new JPanel();</span>
<span class="nc" id="L34">	private JLabel userLabel = new JLabel(&quot;Username: &quot;,0);</span>
<span class="nc" id="L35">	private JTextField userTxt = new JTextField(9);</span>
<span class="nc" id="L36">	private JTextField passwdTxt = new JTextField(9);</span>
<span class="nc" id="L37">	private JLabel passwdLabel = new JLabel(&quot;Password: &quot;,0);</span>
<span class="nc" id="L38">	private HashMap&lt;String, Knight&gt; allPlayers = CurrentPlayers.getAll();</span>
<span class="nc" id="L39">	private Object[] players = (Object[]) allPlayers.keySet().toArray();</span>
<span class="nc" id="L40">	private JList playersList = new JList(TabbedInterface.listModel);</span>
<span class="nc" id="L41">	private JScrollPane scrollPlayerPane = new JScrollPane(playersList);</span>
<span class="nc" id="L42">	private JLabel rankLbl = new JLabel(&quot;Rank: &quot;, 0);</span>
<span class="nc" id="L43">	private JComboBox ranksComboBox = new JComboBox(TabbedInterface.comboBoxModel);</span>


<span class="nc" id="L46">	public AddUser(){</span>
<span class="nc" id="L47">		Container content = this.getContentPane();</span>
<span class="nc" id="L48">		content.setLayout(new FlowLayout());</span>
<span class="nc" id="L49">		fieldsGenerator();</span>
<span class="nc" id="L50">		leftPanel.add(scrollPlayerPane);</span>
<span class="nc" id="L51">		TabbedInterface.listModel.addListDataListener(new ListData());</span>
<span class="nc bnc" id="L52" title="All 2 branches missed.">		for(Object name : players){ TabbedInterface.listModel.addElement(name); }</span>
<span class="nc" id="L53">		playersList.setEnabled(false);</span>
<span class="nc" id="L54">		content.add(leftPanel);</span>
<span class="nc" id="L55">		content.add(panel);</span>
<span class="nc" id="L56">		submitBtn.addActionListener(new addPlayers(this));</span>
<span class="nc" id="L57">		userTxt.addActionListener(new addPlayers(this));</span>
<span class="nc" id="L58">		passwdTxt.addActionListener(new addPlayers(this));</span>
<span class="nc" id="L59">		panelBtn.add(submitBtn);</span>
<span class="nc" id="L60">		panel.add(panelBtn);</span>
<span class="nc" id="L61">		setSize(400,200);</span>
<span class="nc" id="L62">		setVisible(true);</span>
<span class="nc" id="L63">	}</span>
	
	public boolean isThereKing(){
<span class="nc bnc" id="L66" title="All 2 branches missed.">		if(CurrentPlayers.getKing() == null){</span>
<span class="nc" id="L67">			return false;</span>
		}
		else{
<span class="nc" id="L70">			return true;</span>
		}
	}

	public boolean validator(Knight knight){
<span class="nc" id="L75">		String user = knight.getName();</span>
<span class="nc" id="L76">		String passwd = knight.getPassword();</span>
<span class="nc bnc" id="L77" title="All 2 branches missed.">		if(allPlayers.containsKey(user)){</span>
<span class="nc" id="L78">			JOptionPane.showMessageDialog(this, &quot;The username you have provided already exists&quot;, &quot;Invalid Name&quot;, JOptionPane.ERROR_MESSAGE);</span>
<span class="nc" id="L79">			userTxt.requestFocus();</span>
<span class="nc" id="L80">			userTxt.selectAll();</span>
<span class="nc" id="L81">			return false;</span>
		}
<span class="nc bnc" id="L83" title="All 4 branches missed.">		else if(user.equals(&quot;&quot;) || user == null){</span>
<span class="nc" id="L84">			JOptionPane.showMessageDialog(this, &quot;You must provide a username&quot;, &quot;Error&quot;, JOptionPane.ERROR_MESSAGE);</span>
<span class="nc" id="L85">			userTxt.requestFocus();</span>
<span class="nc" id="L86">			return false;</span>
		}

<span class="nc bnc" id="L89" title="All 4 branches missed.">		else if(passwd.equals(&quot;&quot;) || passwd == null){</span>
<span class="nc" id="L90">			JOptionPane.showMessageDialog(this, &quot;You must provide a password&quot;, &quot;Error&quot;, JOptionPane.ERROR_MESSAGE);</span>
<span class="nc" id="L91">			passwdTxt.requestFocus();</span>
<span class="nc" id="L92">			return false;</span>
		}
<span class="nc" id="L94">		return true;		</span>
	}

	public void fieldsGenerator(){
<span class="nc" id="L98">			knightPanel.add(userLabel);</span>
<span class="nc" id="L99">			knightPanel.add(userTxt);</span>
<span class="nc" id="L100">			knightPanel.add(passwdLabel);</span>
<span class="nc" id="L101">			knightPanel.add(passwdTxt);</span>
<span class="nc" id="L102">			knightPanel.add(rankLbl);</span>
<span class="nc" id="L103">			knightPanel.add(ranksComboBox);</span>
//			knightPanel.add(new JLabel());
<span class="nc" id="L105">			panel.add(knightPanel);</span>
<span class="nc" id="L106">		}</span>

	private class addPlayers implements ActionListener{
		private JApplet obj;
		
<span class="nc" id="L111">		public addPlayers(JApplet obj){</span>
<span class="nc" id="L112">			this.obj = obj;</span>
<span class="nc" id="L113">		}</span>
		
		public void actionPerformed(ActionEvent arg0) {
<span class="nc" id="L116">			String username = userTxt.getText();</span>
<span class="nc" id="L117">			String password = passwdTxt.getText();</span>
<span class="nc" id="L118">			String rank = TabbedInterface.ranks.getSelectedItem().toString();</span>
<span class="nc" id="L119">			Knight player = new Knight(username, rank, password);</span>
<span class="nc bnc" id="L120" title="All 2 branches missed.">			if(validator(player)){</span>
<span class="nc bnc" id="L121" title="All 4 branches missed.">				if(isThereKing() &amp;&amp; ranksComboBox.getSelectedItem().equals(&quot;king&quot;)){</span>
<span class="nc" id="L122">					ranksComboBox.setSelectedItem(&quot;knight&quot;);</span>
<span class="nc" id="L123">					ranksComboBox.requestFocus();</span>
<span class="nc" id="L124">					JOptionPane.showMessageDialog(obj, &quot;You cannot create another king while another is existent&quot;, &quot;Error!&quot;, JOptionPane.ERROR_MESSAGE);</span>
<span class="nc" id="L125">					return;</span>
				}
<span class="nc" id="L127">				TabbedInterface.listModel.addElement(player.getName());</span>
<span class="nc" id="L128">				allPlayers.put(player.getName(), player);</span>
<span class="nc" id="L129">				GameAutoActions.saveAll();</span>
<span class="nc" id="L130">				userTxt.setText(&quot;&quot;);</span>
<span class="nc" id="L131">				passwdTxt.setText(&quot;&quot;);</span>
<span class="nc" id="L132">				ranksComboBox.setSelectedItem(&quot;knight&quot;);</span>
<span class="nc" id="L133">				userTxt.requestFocus();</span>
			}
<span class="nc" id="L135">		}</span>
	}
	
<span class="nc" id="L138">	private class ListData implements ListDataListener{</span>

		public void contentsChanged(ListDataEvent arg0) {
			// TODO Auto-generated method stub
			
<span class="nc" id="L143">		}</span>

		public void intervalAdded(ListDataEvent arg0) {
			// TODO Auto-generated method stub
			
<span class="nc" id="L148">		}</span>

		public void intervalRemoved(ListDataEvent arg0) {
			// TODO Auto-generated method stub
			
<span class="nc" id="L153">		}</span>
		
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>