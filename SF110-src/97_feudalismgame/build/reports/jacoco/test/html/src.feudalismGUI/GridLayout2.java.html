<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>GridLayout2.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">97_feudalismgame</a> &gt; <a href="index.source.html" class="el_package">src.feudalismGUI</a> &gt; <span class="el_source">GridLayout2.java</span></div><h1>GridLayout2.java</h1><pre class="source lang-java linenums">package src.feudalismGUI;

import java.awt.Component;
import java.awt.Container;
import java.awt.Dimension;
import java.awt.GridLayout;
import java.awt.Insets;

// Grid Layout which allows components of differrent sizes
public class GridLayout2 extends GridLayout 
{
  public GridLayout2() {
<span class="nc" id="L13">    this(1, 0, 0, 0);</span>
<span class="nc" id="L14">  }</span>

  public GridLayout2(int rows, int cols) {
<span class="nc" id="L17">    this(rows, cols, 0, 0);</span>
<span class="nc" id="L18">  }</span>

  public GridLayout2(int rows, int cols, int hgap, int vgap) {
<span class="nc" id="L21">    super(rows, cols, hgap, vgap);</span>
<span class="nc" id="L22">  }</span>

  public Dimension preferredLayoutSize(Container parent) {
	//System.err.println(&quot;preferredLayoutSize&quot;);
<span class="nc" id="L26">    synchronized (parent.getTreeLock()) {</span>
<span class="nc" id="L27">      Insets insets = parent.getInsets();</span>
<span class="nc" id="L28">      int ncomponents = parent.getComponentCount();</span>
<span class="nc" id="L29">      int nrows = getRows();</span>
<span class="nc" id="L30">      int ncols = getColumns();</span>
<span class="nc bnc" id="L31" title="All 2 branches missed.">      if (nrows &gt; 0) {</span>
<span class="nc" id="L32">        ncols = (ncomponents + nrows - 1) / nrows;</span>
      } 
      else {
<span class="nc" id="L35">        nrows = (ncomponents + ncols - 1) / ncols;</span>
      }
<span class="nc" id="L37">      int[] w = new int[ncols];</span>
<span class="nc" id="L38">      int[] h = new int[nrows];</span>
<span class="nc bnc" id="L39" title="All 2 branches missed.">      for (int i = 0; i &lt; ncomponents; i ++) {</span>
<span class="nc" id="L40">        int r = i / ncols;</span>
<span class="nc" id="L41">        int c = i % ncols;</span>
<span class="nc" id="L42">        Component comp = parent.getComponent(i);</span>
<span class="nc" id="L43">        Dimension d = comp.getPreferredSize();</span>
<span class="nc bnc" id="L44" title="All 2 branches missed.">        if (w[c] &lt; d.width) {</span>
<span class="nc" id="L45">          w[c] = d.width;</span>
        }
<span class="nc bnc" id="L47" title="All 2 branches missed.">        if (h[r] &lt; d.height) {</span>
<span class="nc" id="L48">          h[r] = d.height;</span>
        }
      }
<span class="nc" id="L51">      int nw = 0;</span>
<span class="nc bnc" id="L52" title="All 2 branches missed.">      for (int j = 0; j &lt; ncols; j ++) {</span>
<span class="nc" id="L53">        nw += w[j];</span>
      }
<span class="nc" id="L55">      int nh = 0;</span>
<span class="nc bnc" id="L56" title="All 2 branches missed.">      for (int i = 0; i &lt; nrows; i ++) {</span>
<span class="nc" id="L57">        nh += h[i];</span>
      }
<span class="nc" id="L59">      return new Dimension(insets.left + insets.right + nw + (ncols-1)*getHgap(), </span>
<span class="nc" id="L60">          insets.top + insets.bottom + nh + (nrows-1)*getVgap());</span>
    }
  }

  public Dimension minimumLayoutSize(Container parent) {
<span class="nc" id="L65">	System.err.println(&quot;minimumLayoutSize&quot;);</span>
<span class="nc" id="L66">    synchronized (parent.getTreeLock()) {</span>
<span class="nc" id="L67">      Insets insets = parent.getInsets();</span>
<span class="nc" id="L68">      int ncomponents = parent.getComponentCount();</span>
<span class="nc" id="L69">      int nrows = getRows();</span>
<span class="nc" id="L70">      int ncols = getColumns();</span>
<span class="nc bnc" id="L71" title="All 2 branches missed.">      if (nrows &gt; 0) {</span>
<span class="nc" id="L72">        ncols = (ncomponents + nrows - 1) / nrows;</span>
      } 
      else {
<span class="nc" id="L75">        nrows = (ncomponents + ncols - 1) / ncols;</span>
      }
<span class="nc" id="L77">      int[] w = new int[ncols];</span>
<span class="nc" id="L78">      int[] h = new int[nrows];</span>
<span class="nc bnc" id="L79" title="All 2 branches missed.">      for (int i = 0; i &lt; ncomponents; i ++) {</span>
<span class="nc" id="L80">        int r = i / ncols;</span>
<span class="nc" id="L81">        int c = i % ncols;</span>
<span class="nc" id="L82">        Component comp = parent.getComponent(i);</span>
<span class="nc" id="L83">        Dimension d = comp.getMinimumSize();</span>
<span class="nc bnc" id="L84" title="All 2 branches missed.">        if (w[c] &lt; d.width) {</span>
<span class="nc" id="L85">          w[c] = d.width;</span>
        }
<span class="nc bnc" id="L87" title="All 2 branches missed.">        if (h[r] &lt; d.height) {</span>
<span class="nc" id="L88">          h[r] = d.height;</span>
        }
      }
<span class="nc" id="L91">      int nw = 0;</span>
<span class="nc bnc" id="L92" title="All 2 branches missed.">      for (int j = 0; j &lt; ncols; j ++) {</span>
<span class="nc" id="L93">        nw += w[j];</span>
      }
<span class="nc" id="L95">      int nh = 0;</span>
<span class="nc bnc" id="L96" title="All 2 branches missed.">      for (int i = 0; i &lt; nrows; i ++) {</span>
<span class="nc" id="L97">        nh += h[i];</span>
      }
<span class="nc" id="L99">      return new Dimension(insets.left + insets.right + nw + (ncols-1)*getHgap(), </span>
<span class="nc" id="L100">          insets.top + insets.bottom + nh + (nrows-1)*getVgap());</span>
    }
  }

  public void layoutContainer(Container parent) {
    //System.err.println(&quot;layoutContainer&quot;);
<span class="nc" id="L106">    synchronized (parent.getTreeLock()) {</span>
<span class="nc" id="L107">      Insets insets = parent.getInsets();</span>
<span class="nc" id="L108">      int ncomponents = parent.getComponentCount();</span>
<span class="nc" id="L109">      int nrows = getRows();</span>
<span class="nc" id="L110">      int ncols = getColumns();</span>
<span class="nc bnc" id="L111" title="All 2 branches missed.">      if (ncomponents == 0) {</span>
<span class="nc" id="L112">        return;</span>
      }
<span class="nc bnc" id="L114" title="All 2 branches missed.">      if (nrows &gt; 0) {</span>
<span class="nc" id="L115">        ncols = (ncomponents + nrows - 1) / nrows;</span>
      } 
      else {
<span class="nc" id="L118">        nrows = (ncomponents + ncols - 1) / ncols;</span>
      }
<span class="nc" id="L120">      int hgap = getHgap();</span>
<span class="nc" id="L121">      int vgap = getVgap();</span>
	  // scaling factors      
<span class="nc" id="L123">      Dimension pd = preferredLayoutSize(parent);</span>
<span class="nc" id="L124">      double sw = (1.0 * parent.getWidth()) / pd.width;</span>
<span class="nc" id="L125">      double sh = (1.0 * parent.getHeight()) / pd.height;</span>
      // scale
<span class="nc" id="L127">      int[] w = new int[ncols];</span>
<span class="nc" id="L128">      int[] h = new int[nrows];</span>
<span class="nc bnc" id="L129" title="All 2 branches missed.">      for (int i = 0; i &lt; ncomponents; i ++) {</span>
<span class="nc" id="L130">        int r = i / ncols;</span>
<span class="nc" id="L131">        int c = i % ncols;</span>
<span class="nc" id="L132">        Component comp = parent.getComponent(i);</span>
<span class="nc" id="L133">        Dimension d = comp.getPreferredSize();</span>
<span class="nc" id="L134">        d.width = (int) (sw * d.width);</span>
<span class="nc" id="L135">        d.height = (int) (sh * d.height);</span>
<span class="nc bnc" id="L136" title="All 2 branches missed.">        if (w[c] &lt; d.width) {</span>
<span class="nc" id="L137">          w[c] = d.width;</span>
        }
<span class="nc bnc" id="L139" title="All 2 branches missed.">        if (h[r] &lt; d.height) {</span>
<span class="nc" id="L140">          h[r] = d.height;</span>
        }
      }
<span class="nc bnc" id="L143" title="All 2 branches missed.">      for (int c = 0, x = insets.left; c &lt; ncols; c ++) {</span>
<span class="nc bnc" id="L144" title="All 2 branches missed.">        for (int r = 0, y = insets.top; r &lt; nrows; r ++) {</span>
<span class="nc" id="L145">          int i = r * ncols + c;</span>
<span class="nc bnc" id="L146" title="All 2 branches missed.">          if (i &lt; ncomponents) {</span>
<span class="nc" id="L147">            parent.getComponent(i).setBounds(x, y, w[c], h[r]);</span>
          }
<span class="nc" id="L149">          y += h[r] + vgap;</span>
        }
<span class="nc" id="L151">        x += w[c] + hgap;</span>
      }
<span class="nc" id="L153">    }</span>
<span class="nc" id="L154">  }  </span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>