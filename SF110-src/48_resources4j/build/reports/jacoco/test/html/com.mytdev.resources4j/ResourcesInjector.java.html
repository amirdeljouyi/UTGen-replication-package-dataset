<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ResourcesInjector.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">48_resources4j</a> &gt; <a href="index.source.html" class="el_package">com.mytdev.resources4j</a> &gt; <span class="el_source">ResourcesInjector.java</span></div><h1>ResourcesInjector.java</h1><pre class="source lang-java linenums">/*
 * ResourcesInjector.java
 *
 *  Copyright 2010 Yann D'Isanto.
 *
 *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *       http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 *  under the License.
 */
package com.mytdev.resources4j;

import com.mytdev.resources4j.interfaces.ResourcesBundle;
import com.mytdev.resources4j.interfaces.Resources;
import com.mytdev.resources4j.annotations.Resource;
import com.mytdev.resources4j.annotations.TimeResource;
import com.mytdev.resources4j.annotations.DateTimeResource;
import com.mytdev.resources4j.annotations.DateResource;
import java.awt.Color;
import java.awt.Image;
import java.io.IOException;
import java.lang.reflect.Field;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Locale;
import javax.swing.Icon;
import javax.swing.ImageIcon;

/**
 * The ResourcesInjector class allows to inject resources on an object using a
 * specific ResourceBundle and a specific Locale.
 * The reources are injected in the processed object's fields marked with
 * the resources annotations.
 * @author Yann D'Isanto
 */
public final class ResourcesInjector {

<span class="nc" id="L49">    private Locale locale = Locale.getDefault();</span>
    private ResourcesBundle resourcesBundle;

    /**
     * Creates a new instance of &lt;code&gt;ResourcesInjector&lt;/code&gt; with the
     * specified ResourcesBundle and the default Locale.
     * @param resourcesBundle the ResourcesBundle.
     */
    public ResourcesInjector(ResourcesBundle resourcesBundle) {
<span class="nc" id="L58">        this(resourcesBundle, Locale.getDefault());</span>
<span class="nc" id="L59">    }</span>

    /**
     * Creates a new instance of &lt;code&gt;ResourcesInjector&lt;/code&gt; with the
     * specified ResourcesBundle and Locale.
     * @param resourcesBundle the ResourcesBundle.
     * @param locale the locale.
     */
<span class="nc" id="L67">    public ResourcesInjector(ResourcesBundle resourcesBundle, Locale locale) {</span>
<span class="nc" id="L68">        setResourcesBundle(resourcesBundle);</span>
<span class="nc" id="L69">        setLocale(locale);</span>
<span class="nc" id="L70">    }</span>

    /**
     * Injects resources in the specified object's fields marked with the
     * resources annotations.
     * @param object the object to process.
     * @throws ResourcesException if an error occurs during resources injection.
     */
    public void process(Object object) throws ResourcesException {
        try {
<span class="nc" id="L80">            Class&lt;?&gt; c = object.getClass();</span>
<span class="nc" id="L81">            process(object, c.getDeclaredFields());</span>
<span class="nc" id="L82">            process(object, c.getFields());</span>
<span class="nc" id="L83">        } catch (IllegalArgumentException ex) {</span>
<span class="nc" id="L84">            throw new ResourcesException(ex);</span>
<span class="nc" id="L85">        } catch (IllegalAccessException ex) {</span>
<span class="nc" id="L86">            throw new ResourcesException(ex);</span>
<span class="nc" id="L87">        } catch (InvocationTargetException ex) {</span>
<span class="nc" id="L88">            throw new ResourcesException(ex);</span>
<span class="nc" id="L89">        } catch (NoSuchMethodException ex) {</span>
<span class="nc" id="L90">            throw new ResourcesException(ex);</span>
<span class="nc" id="L91">        } catch (IOException ex) {</span>
<span class="nc" id="L92">            throw new ResourcesException(ex);</span>
<span class="nc" id="L93">        }</span>
<span class="nc" id="L94">    }</span>

    private void process(Object object, Field[] fields)
            throws IllegalArgumentException, IllegalAccessException, IOException,
            NoSuchMethodException, InvocationTargetException {
<span class="nc" id="L99">        Resources resources = resourcesBundle.getResources(locale);</span>
<span class="nc bnc" id="L100" title="All 2 branches missed.">        for (Field field : fields) {</span>
<span class="nc" id="L101">            field.setAccessible(true);</span>
<span class="nc" id="L102">            Class&lt;?&gt; fieldClass = field.getType();</span>

<span class="nc" id="L104">            Resource resource = field.getAnnotation(Resource.class);</span>
<span class="nc bnc" id="L105" title="All 2 branches missed.">            if (resource != null) {</span>
<span class="nc" id="L106">                String property = resource.property();</span>
<span class="nc bnc" id="L107" title="All 2 branches missed.">                String resourceName = &quot;&quot;.equals(resource.name()) ? field.getName() : resource.name();</span>
<span class="nc bnc" id="L108" title="All 2 branches missed.">                if (&quot;&quot;.equals(property)) {</span>
<span class="nc" id="L109">                    Object value = getResourceValue(field.getName(), resource, fieldClass);</span>
<span class="nc" id="L110">                    field.set(object, value);</span>
<span class="nc" id="L111">                } else {</span>
<span class="nc" id="L112">                    injectResourceToProperty(field.get(object), property, resourceName, resource, null);</span>
                }
            }

<span class="nc" id="L116">            DateResource dateResource = field.getAnnotation(DateResource.class);</span>
<span class="nc bnc" id="L117" title="All 2 branches missed.">            if (dateResource != null) {</span>
<span class="nc bnc" id="L118" title="All 2 branches missed.">                String resourceName = &quot;&quot;.equals(dateResource.name())</span>
<span class="nc" id="L119">                        ? field.getName() : dateResource.name();</span>
<span class="nc" id="L120">                String pattern = dateResource.pattern();</span>
<span class="nc" id="L121">                DateFormat dateFormat = null;</span>
<span class="nc bnc" id="L122" title="All 2 branches missed.">                if (&quot;&quot;.equals(pattern)) {</span>
<span class="nc" id="L123">                    dateFormat = DateFormat.getDateInstance(dateResource.style(), locale);</span>
                } else {
<span class="nc bnc" id="L125" title="All 2 branches missed.">                    if (dateResource.loadPatternAsResource()) {</span>
<span class="nc" id="L126">                        pattern = resources.getString(pattern);</span>
                    }
<span class="nc" id="L128">                    dateFormat = new SimpleDateFormat(pattern);</span>
                }
<span class="nc" id="L130">                String value = dateFormat.format(resources.getDate(resourceName));</span>
<span class="nc" id="L131">                String property = dateResource.property();</span>
<span class="nc bnc" id="L132" title="All 2 branches missed.">                if (&quot;&quot;.equals(dateResource.property())) {</span>
<span class="nc" id="L133">                    field.set(object, value);</span>
                } else {
<span class="nc" id="L135">                    injectResourceToProperty(field.get(object), property, resourceName, resource, value);</span>
                }
            }

<span class="nc" id="L139">            TimeResource timeResource = field.getAnnotation(TimeResource.class);</span>
<span class="nc bnc" id="L140" title="All 2 branches missed.">            if (timeResource != null) {</span>
<span class="nc bnc" id="L141" title="All 2 branches missed.">                String resourceName = &quot;&quot;.equals(timeResource.name())</span>
<span class="nc" id="L142">                        ? field.getName() : timeResource.name();</span>
<span class="nc" id="L143">                String pattern = timeResource.pattern();</span>
<span class="nc" id="L144">                DateFormat dateFormat = null;</span>
<span class="nc bnc" id="L145" title="All 2 branches missed.">                if (&quot;&quot;.equals(pattern)) {</span>
<span class="nc" id="L146">                    dateFormat = DateFormat.getTimeInstance(timeResource.style(), locale);</span>
                } else {
<span class="nc bnc" id="L148" title="All 2 branches missed.">                    if (timeResource.loadPatternAsResource()) {</span>
<span class="nc" id="L149">                        pattern = resources.getString(pattern);</span>
                    }
<span class="nc" id="L151">                    dateFormat = new SimpleDateFormat(pattern);</span>
                }
<span class="nc" id="L153">                String value = dateFormat.format(resources.getDate(resourceName));</span>
<span class="nc" id="L154">                String property = timeResource.property();</span>
<span class="nc bnc" id="L155" title="All 2 branches missed.">                if (&quot;&quot;.equals(timeResource.property())) {</span>
<span class="nc" id="L156">                    field.set(object, value);</span>
                } else {
<span class="nc" id="L158">                    injectResourceToProperty(field.get(object), property, resourceName, resource, value);</span>
                }
            }

<span class="nc" id="L162">            DateTimeResource dateTimeResource = field.getAnnotation(DateTimeResource.class);</span>
<span class="nc bnc" id="L163" title="All 2 branches missed.">            if (dateTimeResource != null) {</span>
<span class="nc bnc" id="L164" title="All 2 branches missed.">                String resourceName = &quot;&quot;.equals(dateTimeResource.name())</span>
<span class="nc" id="L165">                        ? field.getName() : dateTimeResource.name();</span>
<span class="nc" id="L166">                String pattern = dateTimeResource.pattern();</span>
<span class="nc" id="L167">                DateFormat dateFormat = null;</span>
<span class="nc bnc" id="L168" title="All 2 branches missed.">                if (&quot;&quot;.equals(pattern)) {</span>
<span class="nc" id="L169">                    dateFormat = DateFormat.getDateTimeInstance(</span>
<span class="nc" id="L170">                            dateTimeResource.dateStyle(),</span>
<span class="nc" id="L171">                            dateTimeResource.timeStyle(),</span>
                            locale);
                } else {
<span class="nc bnc" id="L174" title="All 2 branches missed.">                    if (dateTimeResource.loadPatternAsResource()) {</span>
<span class="nc" id="L175">                        pattern = resources.getString(pattern);</span>
                    }
<span class="nc" id="L177">                    dateFormat = new SimpleDateFormat(pattern);</span>
                }
<span class="nc" id="L179">                String value = dateFormat.format(resources.getDate(resourceName));</span>
<span class="nc" id="L180">                String property = dateTimeResource.property();</span>
<span class="nc bnc" id="L181" title="All 2 branches missed.">                if (&quot;&quot;.equals(dateTimeResource.property())) {</span>
<span class="nc" id="L182">                    field.set(object, value);</span>
                } else {
<span class="nc" id="L184">                    injectResourceToProperty(field.get(object), property, resourceName, resource, value);</span>
                }
            }
<span class="nc" id="L187">            field.setAccessible(false);</span>
        }
<span class="nc" id="L189">    }</span>

    private Object getResourceValue(String resourceName, Resource resource, Class&lt;?&gt; type)
            throws IllegalArgumentException, IOException {
<span class="nc" id="L193">        Object value = null;</span>
<span class="nc" id="L194">        Resources resources = resourcesBundle.getResources(locale);</span>
<span class="nc bnc" id="L195" title="All 2 branches missed.">        String resourceKey = &quot;&quot;.equals(resource.name()) ? resourceName : resource.name();</span>
<span class="nc bnc" id="L196" title="All 4 branches missed.">        if (type.equals(Integer.TYPE) || type.equals(Integer.class)) {</span>
<span class="nc" id="L197">            value = resources.getInt(</span>
<span class="nc" id="L198">                    resourceKey, resource.intDefaultValue(), resource.radix());</span>
<span class="nc bnc" id="L199" title="All 4 branches missed.">        } else if (type.equals(Double.TYPE) || type.equals(Double.class)) {</span>
<span class="nc" id="L200">            value = resources.getDouble(</span>
<span class="nc" id="L201">                    resourceKey, resource.doubleDefaultValue());</span>
<span class="nc bnc" id="L202" title="All 4 branches missed.">        } else if (type.equals(Boolean.TYPE) || type.equals(Boolean.class)) {</span>
<span class="nc" id="L203">            value = resources.getBoolean(</span>
<span class="nc" id="L204">                    resourceKey, resource.booleanDefaultValue());</span>
<span class="nc bnc" id="L205" title="All 4 branches missed.">        } else if (type.equals(Long.TYPE) || type.equals(Long.class)) {</span>
<span class="nc" id="L206">            value = resources.getLong(</span>
<span class="nc" id="L207">                    resourceKey, resource.longDefaultValue(), resource.radix());</span>
<span class="nc bnc" id="L208" title="All 4 branches missed.">        } else if (type.equals(Float.TYPE) || type.equals(Float.class)) {</span>
<span class="nc" id="L209">            value = resources.getFloat(</span>
<span class="nc" id="L210">                    resourceKey, resource.floatDefaultValue());</span>
<span class="nc bnc" id="L211" title="All 4 branches missed.">        } else if (type.equals(Character.TYPE) || type.equals(Character.class)) {</span>
<span class="nc" id="L212">            value = resources.getChar(</span>
<span class="nc" id="L213">                    resourceKey, resource.charDefaultValue());</span>
<span class="nc bnc" id="L214" title="All 4 branches missed.">        } else if (type.equals(Byte.TYPE) || type.equals(Byte.class)) {</span>
<span class="nc" id="L215">            value = resources.getByte(</span>
<span class="nc" id="L216">                    resourceKey, resource.byteDefaultValue(), resource.radix());</span>
<span class="nc bnc" id="L217" title="All 4 branches missed.">        } else if (type.equals(Short.TYPE) || type.equals(Short.class)) {</span>
<span class="nc" id="L218">            value = resources.getShort(</span>
<span class="nc" id="L219">                    resourceKey, resource.shortDefaultValue(), resource.radix());</span>
<span class="nc bnc" id="L220" title="All 2 branches missed.">        } else if (type.isArray()) {</span>
<span class="nc" id="L221">            Class&lt;?&gt; arrayClass = type.getComponentType();</span>
<span class="nc bnc" id="L222" title="All 2 branches missed.">            if (arrayClass.equals(Integer.TYPE)) {</span>
<span class="nc" id="L223">                value = resources.getIntArray(resourceKey, resource.radix());</span>
<span class="nc bnc" id="L224" title="All 2 branches missed.">            } else if (arrayClass.equals(Double.TYPE)) {</span>
<span class="nc" id="L225">                value = resources.getDoubleArray(resourceKey);</span>
<span class="nc bnc" id="L226" title="All 2 branches missed.">            } else if (arrayClass.equals(Boolean.TYPE)) {</span>
<span class="nc" id="L227">                value = resources.getBooleanArray(resourceKey);</span>
<span class="nc bnc" id="L228" title="All 2 branches missed.">            } else if (arrayClass.equals(Long.TYPE)) {</span>
<span class="nc" id="L229">                value = resources.getLongArray(resourceKey, resource.radix());</span>
<span class="nc bnc" id="L230" title="All 2 branches missed.">            } else if (arrayClass.equals(Float.TYPE)) {</span>
<span class="nc" id="L231">                value = resources.getFloatArray(resourceKey);</span>
<span class="nc bnc" id="L232" title="All 2 branches missed.">            } else if (arrayClass.equals(Character.TYPE)) {</span>
<span class="nc" id="L233">                value = resources.getCharArray(resourceKey);</span>
<span class="nc bnc" id="L234" title="All 2 branches missed.">            } else if (arrayClass.equals(Byte.TYPE)) {</span>
<span class="nc" id="L235">                value = resources.getByteArray(resourceKey, resource.radix());</span>
<span class="nc bnc" id="L236" title="All 2 branches missed.">            } else if (arrayClass.equals(Short.TYPE)) {</span>
<span class="nc" id="L237">                value = resources.getShortArray(resourceKey, resource.radix());</span>
<span class="nc bnc" id="L238" title="All 2 branches missed.">            } else if (arrayClass.equals(Integer.class)) {</span>
<span class="nc" id="L239">                value = resources.getIntegerArray(resourceKey, resource.radix());</span>
<span class="nc bnc" id="L240" title="All 2 branches missed.">            } else if (arrayClass.equals(Double.class)) {</span>
<span class="nc" id="L241">                value = resources.getDoubleObjectArray(resourceKey);</span>
<span class="nc bnc" id="L242" title="All 2 branches missed.">            } else if (arrayClass.equals(Boolean.class)) {</span>
<span class="nc" id="L243">                value = resources.getBooleanObjectArray(resourceKey);</span>
<span class="nc bnc" id="L244" title="All 2 branches missed.">            } else if (arrayClass.equals(Long.class)) {</span>
<span class="nc" id="L245">                value = resources.getLongObjectArray(resourceKey, resource.radix());</span>
<span class="nc bnc" id="L246" title="All 2 branches missed.">            } else if (arrayClass.equals(Float.class)) {</span>
<span class="nc" id="L247">                value = resources.getFloatObjectArray(resourceKey);</span>
<span class="nc bnc" id="L248" title="All 2 branches missed.">            } else if (arrayClass.equals(Character.class)) {</span>
<span class="nc" id="L249">                value = resources.getCharacterArray(resourceKey);</span>
<span class="nc bnc" id="L250" title="All 2 branches missed.">            } else if (arrayClass.equals(Byte.class)) {</span>
<span class="nc" id="L251">                value = resources.getByteObjectArray(resourceKey, resource.radix());</span>
<span class="nc bnc" id="L252" title="All 2 branches missed.">            } else if (arrayClass.equals(Short.class)) {</span>
<span class="nc" id="L253">                value = resources.getShortObjectArray(resourceKey, resource.radix());</span>
            }
<span class="nc bnc" id="L255" title="All 2 branches missed.">        } else if (type.isAssignableFrom(String.class)) {</span>
<span class="nc" id="L256">            value = resources.getString(resourceKey, resource.stringDefaultValue());</span>
<span class="nc bnc" id="L257" title="All 2 branches missed.">        } else if (type.isAssignableFrom(Color.class)) {</span>
<span class="nc" id="L258">            value = resources.getColor(resourceKey);</span>
<span class="nc bnc" id="L259" title="All 2 branches missed.">        } else if (type.isAssignableFrom(Date.class)) {</span>
<span class="nc" id="L260">            value = resources.getDate(resourceKey);</span>
<span class="nc bnc" id="L261" title="All 2 branches missed.">        } else if (type.isAssignableFrom(Image.class)) {</span>
<span class="nc" id="L262">            value = resources.getImage(resourceKey);</span>
<span class="nc bnc" id="L263" title="All 2 branches missed.">        } else if (type.isAssignableFrom(Icon.class)) {</span>
<span class="nc" id="L264">            value = new ImageIcon(resources.getImage(resourceKey));</span>
        } else {
<span class="nc" id="L266">            throw new IllegalArgumentException(&quot;unupported resource type:&quot; + type);</span>
        }
<span class="nc" id="L268">        return value;</span>
    }

    private void injectResourceToProperty(Object object, String propertyPath, String resourceName, Resource resource, Object value)
            throws NoSuchMethodException, IllegalAccessException, InvocationTargetException, IOException {
<span class="nc" id="L273">        int index = propertyPath.lastIndexOf(&quot;.&quot;);</span>
<span class="nc bnc" id="L274" title="All 2 branches missed.">        if (index &gt; -1) {</span>
<span class="nc" id="L275">            object = getProperty(object, propertyPath.substring(0, index));</span>
        }
<span class="nc bnc" id="L277" title="All 2 branches missed.">        String property = index == -1 ? propertyPath : propertyPath.substring(index + 1, propertyPath.length());</span>
<span class="nc" id="L278">        String methodName = &quot;set&quot; + property.substring(0, 1).toUpperCase() + property.substring(1);</span>
<span class="nc" id="L279">        Class&lt;?&gt; objectClass = object.getClass();</span>
<span class="nc bnc" id="L280" title="All 2 branches missed.">        for (Method method : objectClass.getMethods()) {</span>
<span class="nc bnc" id="L281" title="All 2 branches missed.">            if (method.getName().equals(methodName)) {</span>
<span class="nc bnc" id="L282" title="All 2 branches missed.">                if (value == null) {</span>
<span class="nc" id="L283">                    value = getResourceValue(resourceName, resource, method.getParameterTypes()[0]);</span>
                }
<span class="nc" id="L285">                method.invoke(object, value);</span>
<span class="nc" id="L286">                return;</span>
            }
        }
        try {
<span class="nc" id="L290">            Field field = objectClass.getDeclaredField(property);</span>
<span class="nc bnc" id="L291" title="All 2 branches missed.">            if (value == null) {</span>
<span class="nc" id="L292">                value = getResourceValue(resourceName, resource, field.getType());</span>
            }
<span class="nc" id="L294">            field.set(object, value);</span>
<span class="nc" id="L295">        } catch (NoSuchFieldException ex3) {</span>
<span class="nc bnc" id="L296" title="All 2 branches missed.">            for (Method method : objectClass.getDeclaredMethods()) {</span>
<span class="nc bnc" id="L297" title="All 2 branches missed.">                if (method.getName().equals(methodName)) {</span>
<span class="nc bnc" id="L298" title="All 2 branches missed.">                    if (value == null) {</span>
<span class="nc" id="L299">                        value = getResourceValue(resourceName, resource, method.getParameterTypes()[0]);</span>
                    }
<span class="nc" id="L301">                    method.invoke(object, value);</span>
                }
            }
            try {
<span class="nc" id="L305">                Field field = objectClass.getField(propertyPath);</span>
<span class="nc bnc" id="L306" title="All 2 branches missed.">                if (value == null) {</span>
<span class="nc" id="L307">                    value = getResourceValue(resourceName, resource, field.getType());</span>
                }
<span class="nc" id="L309">                field.set(object, value);</span>
<span class="nc" id="L310">            } catch (NoSuchFieldException ex6) {</span>
<span class="nc" id="L311">                throw new IllegalArgumentException(&quot;property not found: &quot; + propertyPath);</span>
<span class="nc" id="L312">            }</span>
<span class="nc" id="L313">        }</span>
<span class="nc" id="L314">    }</span>

    private Object getProperty(Object object, String path) throws IllegalAccessException, InvocationTargetException {
<span class="nc" id="L317">        Object value = null;</span>
<span class="nc" id="L318">        int index = path.indexOf(&quot;.&quot;);</span>
<span class="nc bnc" id="L319" title="All 2 branches missed.">        String property = index == -1 ? path : path.substring(0, index);</span>
<span class="nc" id="L320">        String methodBasename = property.substring(0, 1).toUpperCase() + property.substring(1);</span>
<span class="nc" id="L321">        Method method = null;</span>
<span class="nc" id="L322">        Field field = null;</span>
<span class="nc" id="L323">        Class&lt;?&gt; objectClass = object.getClass();</span>
        try {
<span class="nc" id="L325">            method = objectClass.getMethod(&quot;get&quot; + methodBasename);</span>
<span class="nc" id="L326">        } catch (NoSuchMethodException ex1) {</span>
            try {
<span class="nc" id="L328">                method = objectClass.getMethod(&quot;is&quot; + methodBasename);</span>
<span class="nc" id="L329">            } catch (NoSuchMethodException ex2) {</span>
                try {
<span class="nc" id="L331">                    field = objectClass.getDeclaredField(path);</span>
<span class="nc" id="L332">                } catch (NoSuchFieldException ex3) {</span>
                    try {
<span class="nc" id="L334">                        method = objectClass.getDeclaredMethod(&quot;get&quot; + methodBasename);</span>
<span class="nc" id="L335">                    } catch (NoSuchMethodException ex4) {</span>
                        try {
<span class="nc" id="L337">                            method = objectClass.getDeclaredMethod(&quot;is&quot; + methodBasename);</span>
<span class="nc" id="L338">                        } catch (NoSuchMethodException ex5) {</span>
                            try {
<span class="nc" id="L340">                                field = objectClass.getField(path);</span>
<span class="nc" id="L341">                            } catch (NoSuchFieldException ex6) {</span>
<span class="nc" id="L342">                                throw new IllegalArgumentException(&quot;property not found: &quot; + path);</span>
<span class="nc" id="L343">                            }</span>
<span class="nc" id="L344">                        }</span>
<span class="nc" id="L345">                    }</span>
<span class="nc" id="L346">                }</span>
<span class="nc" id="L347">            }</span>
<span class="nc" id="L348">        }</span>
<span class="nc bnc" id="L349" title="All 2 branches missed.">        if (method != null) {</span>
<span class="nc" id="L350">            value = method.invoke(object);</span>
<span class="nc bnc" id="L351" title="All 2 branches missed.">        } else if (field != null) {</span>
<span class="nc" id="L352">            value = field.get(object);</span>
        }
<span class="nc bnc" id="L354" title="All 2 branches missed.">        if (index &gt; -1) {</span>
<span class="nc" id="L355">            value = getProperty(value, path.substring(index + 1, path.length()));</span>
        }
<span class="nc" id="L357">        return value;</span>
    }

    /**
     * @return the locale
     */
    public Locale getLocale() {
<span class="nc" id="L364">        return locale;</span>
    }

    /**
     * @param locale the locale to set
     */
    public ResourcesInjector setLocale(Locale locale) {
<span class="nc bnc" id="L371" title="All 2 branches missed.">        this.locale = locale == null ? Locale.getDefault() : locale;</span>
<span class="nc" id="L372">        return this;</span>
    }

    /**
     * @return the resourcesBundle
     */
    public ResourcesBundle getResourcesBundle() {
<span class="nc" id="L379">        return resourcesBundle;</span>
    }

    /**
     * @param resourcesBundle the resourcesBundle to set
     */
    public ResourcesInjector setResourcesBundle(ResourcesBundle resourcesBundle) {
<span class="nc bnc" id="L386" title="All 2 branches missed.">        if (resourcesBundle == null) {</span>
<span class="nc" id="L387">            throw new NullPointerException(&quot;resources bundle is null&quot;);</span>
        }
<span class="nc" id="L389">        this.resourcesBundle = resourcesBundle;</span>
<span class="nc" id="L390">        return this;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>