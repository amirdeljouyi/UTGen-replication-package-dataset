<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DemandCurveParameterFrame.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">10_water-simulator</a> &gt; <a href="index.source.html" class="el_package">simulator.SA.gui</a> &gt; <span class="el_source">DemandCurveParameterFrame.java</span></div><h1>DemandCurveParameterFrame.java</h1><pre class="source lang-java linenums">package simulator.SA.gui;

import jade.gui.GuiEvent;

import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.FlowLayout;
import java.awt.GridLayout;
import java.awt.SystemColor;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.Hashtable;
import java.util.Iterator;
import java.util.Vector;

import javax.swing.BorderFactory;
import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JInternalFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.SwingConstants;

import org.apache.log4j.Logger;

import simulator.SA.SimulationAgent;
import simulator.util.ConsumerType;
import simulator.util.Function;
import simulator.util.ParameterAttributes;

/**
 * @author Vartalas Panagiotis
 * @author Ioannis N. Athanasiadis
 * @version 1.9
 * @since 2003-2006
 */

public class DemandCurveParameterFrame extends JInternalFrame {

	private static final long serialVersionUID = 1208279781892420981L;

<span class="nc" id="L44">	private Logger log = Logger.getLogger(DemandCurveParameterFrame.class);</span>
<span class="nc" id="L45">	private boolean flagFunctionSelected = false;</span>

<span class="nc" id="L47">	private boolean flagSocialSelected = false;</span>

	private String consumerTypeName;

	private String[] availableFunctionsNames;

	private Function[] availableFunctions;

	private ParameterAttributes parameter;

	private SimulationAgent myAgent;

<span class="nc" id="L59">	private int maxConstants = 0;</span>

	//auxiliary
<span class="nc" id="L62">	private Hashtable functionNameToComboIndex = new Hashtable();</span>

<span class="nc" id="L64">	private Hashtable socialNameToComboIndex = new Hashtable();</span>

	// Constructor
	@SuppressWarnings(&quot;unchecked&quot;)
	public DemandCurveParameterFrame(SimulationAgent agent,
			Function[] availableFunctions, ConsumerType consumerType,
<span class="nc" id="L70">			ParameterAttributes parameter) {</span>

<span class="nc" id="L72">		this.myAgent = agent;</span>
<span class="nc" id="L73">		this.consumerTypeName = consumerType.getName();</span>
<span class="nc" id="L74">		this.parameter = parameter;</span>
<span class="nc" id="L75">		this.availableFunctions = availableFunctions;</span>
<span class="nc" id="L76">		this.availableFunctionsNames = new String[availableFunctions.length];</span>

		//Add available functions names to Combos (functionCombo &amp; socialCombo)

<span class="nc" id="L80">		int countItems = 0; // auxiliary</span>
		String hashKey;
<span class="nc bnc" id="L82" title="All 2 branches missed.">		for (int i = 0; i &lt; availableFunctions.length; i++) {</span>
<span class="nc" id="L83">			availableFunctionsNames[i] = availableFunctions[i]</span>
<span class="nc" id="L84">					.getFunctionName();</span>
<span class="nc" id="L85">			this.functionCombo.addItem(availableFunctionsNames[i]);</span>
<span class="nc" id="L86">			hashKey = availableFunctionsNames[i];</span>
<span class="nc" id="L87">			functionNameToComboIndex.put(hashKey, new Integer(i));</span>
<span class="nc bnc" id="L88" title="All 2 branches missed.">			if (!(availableFunctionsNames[i].equals(&quot;MetDATA&quot;) || availableFunctionsNames[i]</span>
<span class="nc bnc" id="L89" title="All 2 branches missed.">					.equals(&quot;PRICE&quot;))) {</span>
<span class="nc" id="L90">				this.socialCombo.addItem(availableFunctionsNames[i]);</span>
<span class="nc" id="L91">				socialNameToComboIndex.put(availableFunctionsNames[i]</span>
<span class="nc" id="L92">						.toString(), new Integer(countItems));</span>
<span class="nc" id="L93">				countItems++;</span>
			}//END if
		}

<span class="nc" id="L97">		this.maxConstants = findMaxConstants();</span>
<span class="nc" id="L98">		this.simpleLabels = new JLabel[2][maxConstants];</span>
<span class="nc" id="L99">		defineSimpleLabels();</span>
<span class="nc" id="L100">		this.simpleTextFields = new JTextField[2][maxConstants];</span>
<span class="nc" id="L101">		defineSimpleTextFields();</span>
<span class="nc" id="L102">		this.functionCombo.addActionListener(new functionComboListener());</span>
<span class="nc" id="L103">		this.socialCombo.addActionListener(new socialComboListener());</span>

		// Fill in labels
<span class="nc" id="L106">		this.setTitle(&quot;Editing &quot; + parameter.getName() + &quot; of &quot;</span>
<span class="nc" id="L107">				+ consumerType.getName() + &quot; consumer Type&quot;);</span>
<span class="nc" id="L108">		this.titleLabel1.setText(this.consumerTypeName + &quot; Consumer Type&quot;);</span>
<span class="nc" id="L109">		this.titleLabel2.setText(&quot;Demand Curve Parameter : &quot;</span>
<span class="nc" id="L110">				+ parameter.getName());</span>

		// fill in elasticity and functions' constants
<span class="nc" id="L113">		fillSimpleTextFields();</span>

<span class="nc" id="L115">		contentPane.add(titlePanel, BorderLayout.NORTH);</span>
<span class="nc" id="L116">		contentPane.add(centerPanel, BorderLayout.CENTER);</span>
<span class="nc" id="L117">		centerPanel.add(inputPanel);</span>
<span class="nc" id="L118">		centerPanel.add(functionPanel);</span>
<span class="nc" id="L119">		centerPanel.add(socialPanel);</span>
<span class="nc" id="L120">		contentPane.add(endPanel, BorderLayout.SOUTH);</span>

<span class="nc bnc" id="L122" title="All 2 branches missed.">		if (parameter.getName().equals(&quot;TEMPERATURE&quot;)</span>
<span class="nc bnc" id="L123" title="All 2 branches missed.">				|| parameter.getName().equals(&quot;RAINFALL&quot;)) {</span>
<span class="nc" id="L124">			functionCombo.setEnabled(false);</span>
<span class="nc" id="L125">			flagFunctionSelected = true;</span>
<span class="nc" id="L126">			functionCombo.setSelectedItem(&quot;MetDATA&quot;);</span>

		} // if
<span class="nc bnc" id="L129" title="All 2 branches missed.">		else if (parameter.isSocial())</span>
<span class="nc" id="L130">			socialCombo.setEnabled(true);</span>

<span class="nc" id="L132">	}// END of constructor</span>

	// GUI setup
<span class="nc" id="L135">	private JPanel contentPane = (JPanel) this.getContentPane();</span>
	{
<span class="nc" id="L137">		contentPane.setLayout(new BorderLayout());</span>
<span class="nc" id="L138">		this.setClosable(true);</span>
<span class="nc" id="L139">		this.setDefaultCloseOperation(JInternalFrame.HIDE_ON_CLOSE);</span>
<span class="nc" id="L140">		this.setResizable(false);</span>
<span class="nc" id="L141">		this.setSize(new Dimension(650, 400));</span>

	}

	//*******************************************************
	// TITLE PANEL
<span class="nc" id="L147">	private JPanel titlePanel = new JPanel(new GridLayout(2, 1, 5, 5));</span>
	{
<span class="nc" id="L149">		titlePanel.setBorder(BorderFactory.createEtchedBorder());</span>
<span class="nc" id="L150">		titlePanel.setPreferredSize(new Dimension(0, 150));</span>
	}

	//*******************************************************
<span class="nc" id="L154">	private JPanel subTitlePanel = new JPanel(new FlowLayout(FlowLayout.CENTER,</span>
			5, 5));
	{
<span class="nc" id="L157">		titlePanel.add(subTitlePanel, null);</span>
	}

<span class="nc" id="L160">	private JLabel titleLabel1 = new JLabel();</span>
	{
<span class="nc" id="L162">		titleLabel1.setFont(new java.awt.Font(&quot;Dialog&quot;, 1, 12));</span>
<span class="nc" id="L163">		titleLabel1.setBorder(BorderFactory.createRaisedBevelBorder());</span>
<span class="nc" id="L164">		titleLabel1.setHorizontalAlignment(SwingConstants.CENTER);</span>
<span class="nc" id="L165">		titleLabel1.setHorizontalTextPosition(SwingConstants.CENTER);</span>
<span class="nc" id="L166">		subTitlePanel.add(titleLabel1, null);</span>
	}

<span class="nc" id="L169">	private JLabel titleLabel2 = new JLabel();</span>
	{
<span class="nc" id="L171">		titleLabel2.setFont(new java.awt.Font(&quot;Dialog&quot;, 1, 12));</span>
<span class="nc" id="L172">		titleLabel2.setHorizontalAlignment(SwingConstants.CENTER);</span>
<span class="nc" id="L173">		titleLabel2.setHorizontalTextPosition(SwingConstants.CENTER);</span>
<span class="nc" id="L174">		titleLabel2.setForeground(SystemColor.textText);</span>
<span class="nc" id="L175">		titlePanel.add(titleLabel2, null);</span>
	}

	//***************************END of title panel***************************

	//*******************************************************
	// Center PANEL
<span class="nc" id="L182">	private JPanel centerPanel = new JPanel(new GridLayout(3, 1, 0, 0));</span>
	{
<span class="nc" id="L184">		centerPanel.setBorder(BorderFactory.createEtchedBorder());</span>
	}

	//*******************************************************
	// INPUT PANEL

<span class="nc" id="L190">	private JPanel inputPanel = new JPanel(new FlowLayout(FlowLayout.CENTER,</span>
			15, 20));
	{
<span class="nc" id="L193">		inputPanel.setBorder(BorderFactory.createEtchedBorder());</span>
	}

	//*******************************************************

<span class="nc" id="L198">	private JLabel inputLabelElasticity = new JLabel(&quot;Elasticity  :&quot;);</span>
	{
<span class="nc" id="L200">		inputLabelElasticity.setFont(new java.awt.Font(&quot;Dialog&quot;, 1, 12));</span>
<span class="nc" id="L201">		inputLabelElasticity.setBorder(BorderFactory.createEtchedBorder());</span>
<span class="nc" id="L202">		inputLabelElasticity.setHorizontalAlignment(SwingConstants.CENTER);</span>
<span class="nc" id="L203">		inputLabelElasticity.setHorizontalTextPosition(SwingConstants.CENTER);</span>
<span class="nc" id="L204">		inputPanel.add(inputLabelElasticity, null);</span>
	}

<span class="nc" id="L207">	private JTextField textFieldElasticity = new JTextField(7);</span>
	{
<span class="nc" id="L209">		textFieldElasticity.setBorder(BorderFactory.createLoweredBevelBorder());</span>
<span class="nc" id="L210">		inputPanel.add(textFieldElasticity, null);</span>
	}

<span class="nc" id="L213">	private JLabel inputLabelFunction = new JLabel(&quot;Function&quot;);</span>
	{
<span class="nc" id="L215">		inputLabelFunction.setFont(new java.awt.Font(&quot;Dialog&quot;, 1, 12));</span>
<span class="nc" id="L216">		inputLabelFunction.setHorizontalAlignment(SwingConstants.CENTER);</span>
<span class="nc" id="L217">		inputLabelFunction.setHorizontalTextPosition(SwingConstants.CENTER);</span>
<span class="nc" id="L218">		inputPanel.add(inputLabelFunction, null);</span>
	}

<span class="nc" id="L221">	private JComboBox functionCombo = new JComboBox();</span>
	{
<span class="nc" id="L223">		inputPanel.add(functionCombo, null);</span>
	}

<span class="nc" id="L226">	private JLabel inputLabelSocial = new JLabel(&quot;Social Function&quot;);</span>
	{
<span class="nc" id="L228">		inputLabelSocial.setFont(new java.awt.Font(&quot;Dialog&quot;, 1, 12));</span>
<span class="nc" id="L229">		inputLabelSocial.setHorizontalAlignment(SwingConstants.CENTER);</span>
<span class="nc" id="L230">		inputLabelSocial.setHorizontalTextPosition(SwingConstants.CENTER);</span>
<span class="nc" id="L231">		inputPanel.add(inputLabelSocial, null);</span>
	}

<span class="nc" id="L234">	private JComboBox socialCombo = new JComboBox();</span>
	{
<span class="nc" id="L236">		socialCombo.setEnabled(false);</span>
<span class="nc" id="L237">		inputPanel.add(socialCombo, null);</span>
	}

	//***************************END of Input Panel**********************

	private JLabel[][] simpleLabels;

	private JTextField[][] simpleTextFields;

	//*******************************************************
	// Function PANEL

<span class="nc" id="L249">	private JPanel functionPanel = new JPanel(new FlowLayout(FlowLayout.CENTER,</span>
			5, 5));
	{
<span class="nc" id="L252">		functionPanel.setName(&quot;FUNCTION&quot;);</span>
	}

	//*******************************************************
	// Social PANEL

<span class="nc" id="L258">	private JPanel socialPanel = new JPanel(new FlowLayout(FlowLayout.CENTER,</span>
			5, 5));
	{
<span class="nc" id="L261">		socialPanel.setName(&quot;SOCIAL&quot;);</span>
	}

	//*******************************************************
	// End PANEL

<span class="nc" id="L267">	private JPanel endPanel = new JPanel(new FlowLayout(FlowLayout.CENTER, 10,</span>
			10));
	{
<span class="nc" id="L270">		endPanel.setBorder(BorderFactory.createEtchedBorder());</span>
<span class="nc" id="L271">		titlePanel.setPreferredSize(new Dimension(0, 60));</span>
	}

	//*******************************************************

<span class="nc" id="L276">	private JButton cancelButton = new JButton(&quot;    Cancel    &quot;);</span>
	{

<span class="nc" id="L279">		cancelButton.setBorder(BorderFactory.createRaisedBevelBorder());</span>
<span class="nc" id="L280">		endPanel.add(cancelButton, null);</span>
<span class="nc" id="L281">		cancelButton.addActionListener(new ActionListener() {</span>
			public void actionPerformed(ActionEvent ev) {
				try {
<span class="nc" id="L284">					DemandCurveParameterFrame.this.setClosed(true);</span>
<span class="nc" id="L285">				} catch (java.beans.PropertyVetoException ex) {</span>
<span class="nc" id="L286">				}</span>
<span class="nc" id="L287">			}</span>
		});
	}

<span class="nc" id="L291">	private JButton okButton = new JButton(&quot;   OK   &quot;);</span>
	{
<span class="nc" id="L293">		okButton.setBorder(BorderFactory.createRaisedBevelBorder());</span>
<span class="nc" id="L294">		endPanel.add(okButton, null);</span>
<span class="nc" id="L295">		okButton.addActionListener(new ActionListener() {</span>
			@SuppressWarnings(&quot;unchecked&quot;)
			public void actionPerformed(ActionEvent ev) {
<span class="nc bnc" id="L298" title="All 2 branches missed.">				if (flagFunctionSelected</span>
<span class="nc bnc" id="L299" title="All 4 branches missed.">						&amp;&amp; (parameter.isSocial() ? flagSocialSelected : true)) {</span>
					try {

<span class="nc" id="L302">						int i = 0;</span>
<span class="nc" id="L303">						boolean ok = true;</span>

						// Saving this consumer type parameters
<span class="nc" id="L306">						ParameterAttributes pa = DemandCurveParameterFrame.this.parameter;</span>
<span class="nc" id="L307">						pa.setElasticity(new Float(textFieldElasticity</span>
<span class="nc" id="L308">								.getText()).floatValue());</span>
<span class="nc" id="L309">						pa</span>
<span class="nc" id="L310">								.setDemandCurveFunction((Function) availableFunctions[functionCombo</span>
<span class="nc" id="L311">										.getSelectedIndex()].getClass()</span>
<span class="nc" id="L312">										.newInstance());</span>

						//***************************
<span class="nc bnc" id="L315" title="All 2 branches missed.">						if (functionCombo.getSelectedItem().equals(&quot;PRICE&quot;))</span>
<span class="nc" id="L316">							pa.getDemandCurveFunction()</span>
<span class="nc" id="L317">									.setFunctionName(&quot;PRICE&quot;);</span>
<span class="nc" id="L318">						if (functionCombo.getSelectedItem()</span>
<span class="nc bnc" id="L319" title="All 2 branches missed.">								.equals(&quot;RANDOM-INT&quot;))</span>
<span class="nc" id="L320">							pa.getDemandCurveFunction().setFunctionName(</span>
									&quot;RANDOM-INT&quot;);
<span class="nc bnc" id="L322" title="All 2 branches missed.">						if (functionCombo.getSelectedItem().equals(&quot;RANDOM-FL&quot;))</span>
<span class="nc" id="L323">							pa.getDemandCurveFunction().setFunctionName(</span>
									&quot;RANDOM-FL&quot;);
						//****************************

<span class="nc" id="L327">						Vector v = new Vector(0);</span>
<span class="nc" id="L328">						Iterator it = pa.getDemandCurveFunction()</span>
<span class="nc" id="L329">								.getFunctionConstants();</span>

<span class="nc bnc" id="L331" title="All 2 branches missed.">						while (it.hasNext()) {</span>
<span class="nc" id="L332">							Function.FunctionConstant fc = (Function.FunctionConstant) it</span>
<span class="nc" id="L333">									.next();</span>

<span class="nc bnc" id="L335" title="All 2 branches missed.">							if (fc.asFloat())</span>
<span class="nc" id="L336">								fc.setConstantValue(new Float(</span>
<span class="nc" id="L337">										simpleTextFields[0][i].getText())</span>
<span class="nc" id="L338">										.floatValue());</span>
							else
<span class="nc" id="L340">								ok = fc.setConstantValue(simpleTextFields[0][i]</span>
<span class="nc" id="L341">										.getText());</span>

<span class="nc bnc" id="L343" title="All 2 branches missed.">							if (!ok)</span>
<span class="nc" id="L344">								new Float(&quot;zong!!&quot;);</span>

<span class="nc" id="L346">							v.addElement(fc);</span>

<span class="nc" id="L348">							i++;</span>

<span class="nc" id="L350">						}// while</span>

<span class="nc" id="L352">						pa.getDemandCurveFunction().setFunctionConstants(v);</span>

						// if it is social PARAMETER
<span class="nc" id="L355">						if (pa.getDemandCurveFunction().getFunctionName()</span>
<span class="nc bnc" id="L356" title="All 2 branches missed.">								.equals(&quot;MetDATA&quot;)</span>
<span class="nc" id="L357">								|| pa.getDemandCurveFunction()</span>
<span class="nc bnc" id="L358" title="All 2 branches missed.">										.getFunctionName().equals(&quot;PRICE&quot;))</span>
<span class="nc" id="L359">							parameter.setSocial(false);</span>

<span class="nc bnc" id="L361" title="All 2 branches missed.">						else if (parameter.isSocial()) {</span>
<span class="nc" id="L362">							pa.setSocial(true);</span>
<span class="nc" id="L363">							pa</span>
<span class="nc" id="L364">									.setSocialFunction((Function) availableFunctions[socialCombo</span>
<span class="nc" id="L365">											.getSelectedIndex()].getClass()</span>
<span class="nc" id="L366">											.newInstance());</span>

							//********************************
<span class="nc bnc" id="L369" title="All 2 branches missed.">							if (socialCombo.getSelectedItem().equals(</span>
									&quot;RANDOM-INT&quot;))
<span class="nc" id="L371">								pa.getSocialFunction().setFunctionName(</span>
										&quot;RANDOM-INT&quot;);
<span class="nc bnc" id="L373" title="All 2 branches missed.">							if (socialCombo.getSelectedItem().equals(</span>
									&quot;RANDOM-FL&quot;))
<span class="nc" id="L375">								pa.getSocialFunction().setFunctionName(</span>
										&quot;RANDOM-FL&quot;);
							//********************************

<span class="nc" id="L379">							i = 0;</span>
<span class="nc" id="L380">							Vector v2 = new Vector(0);</span>
<span class="nc" id="L381">							it = pa.getSocialFunction().getFunctionConstants();</span>

<span class="nc bnc" id="L383" title="All 2 branches missed.">							while (it.hasNext()) {</span>
<span class="nc" id="L384">								Function.FunctionConstant fc = (Function.FunctionConstant) it</span>
<span class="nc" id="L385">										.next();</span>
<span class="nc bnc" id="L386" title="All 2 branches missed.">								if (fc.asFloat())</span>
<span class="nc" id="L387">									fc.setConstantValue(new Float(</span>
<span class="nc" id="L388">											simpleTextFields[1][i].getText())</span>
<span class="nc" id="L389">											.floatValue());</span>
								else
<span class="nc" id="L391">									ok = fc</span>
<span class="nc" id="L392">											.setConstantValue(simpleTextFields[1][i]</span>
<span class="nc" id="L393">													.getText());</span>

<span class="nc bnc" id="L395" title="All 2 branches missed.">								if (!ok)</span>
<span class="nc" id="L396">									new Float(&quot;zong!!&quot;);</span>

<span class="nc" id="L398">								v2.addElement(fc);</span>

<span class="nc" id="L400">								i++;</span>
<span class="nc" id="L401">							}</span>

<span class="nc" id="L403">							pa.getSocialFunction().setFunctionConstants(v2);</span>

						}

						// Inform Simulation Agent
<span class="nc" id="L408">						GuiEvent ge = new GuiEvent(</span>
								(Object) this,
								SimulationAgent.PARAMETER_INPUT);
<span class="nc" id="L411">						ge.addParameter(pa);</span>
<span class="nc" id="L412">						DemandCurveParameterFrame.this.myAgent.postGuiEvent(ge);</span>

<span class="nc" id="L414">						DemandCurveParameterFrame.this.setVisible(false);</span>

						/*if(index &gt;= demandCurveParameters.length-1){
						 Step3_1Frame.this.setVisible(false);
						 step3.setVisible(true);
						 }
						 else if (JOptionPane.showConfirmDialog(Step3_1Frame.this,&quot;Continue to next Parameter&quot;,&quot;Confirm&quot;,
						 JOptionPane.YES_NO_OPTION,JOptionPane.QUESTION_MESSAGE)== JOptionPane.YES_OPTION){

						 // Reset flag and fields
						 flagFunctionSelected = false;
						 flagSocialSelected = false;
						 textFieldElasticity.setText(&quot;&quot;);
						 //Next parameter
						 index++;

						 Step3_1Frame.this.setTitle(&quot;Scenario Design Wizard - Step 3 - &quot; + (index+1) + &quot;/&quot; + demandCurveParameters.length);
						 titleLabel2.setText(&quot;Demand Curve Parameter : &quot; + demandCurveParameters[index].getName());

						 functionPanel.removeAll();
						 functionPanel.validate();
						 functionPanel.setBorder(BorderFactory.createEmptyBorder());

						 socialPanel.removeAll();
						 socialPanel.validate();
						 socialPanel.setBorder(BorderFactory.createEmptyBorder());

						 socialCombo.setEnabled(
						 demandCurveParameters[index].getSocial().booleanValue()?true:false);


						 if(demandCurveParameters[index].getName().equals(&quot;TEMPERATURE&quot;) ||
						 demandCurveParameters[index].getName().equals(&quot;RAINFALL&quot;)){
						 functionCombo.setEnabled(false);
						 flagFunctionSelected=true;
						 functionCombo.setSelectedItem(&quot;MetDATA&quot;);

						 } // if-temperature
						 else
						 functionCombo.setEnabled(true);

						 } // ELSE-if*/
<span class="nc" id="L456">					} catch (NumberFormatException nfe) {</span>
<span class="nc" id="L457">						JOptionPane.showMessageDialog(</span>
								DemandCurveParameterFrame.this,
								&quot;Invalid INPUTS !!!&quot;, &quot;Error&quot;,
								JOptionPane.ERROR_MESSAGE);
<span class="nc" id="L461">					} catch (IllegalAccessException iae) {</span>
<span class="nc" id="L462">						log.error(iae.getStackTrace());</span>
<span class="nc" id="L463">					} catch (InstantiationException ie) {</span>
<span class="nc" id="L464">						log.error(ie.getStackTrace());</span>
<span class="nc" id="L465">					}</span>

				}// IF  for Flags
				else { // functions are not selected
<span class="nc" id="L469">					JOptionPane.showMessageDialog(</span>
							DemandCurveParameterFrame.this,
							&quot;Select Functions !!!&quot;, &quot;Error&quot;,
							JOptionPane.ERROR_MESSAGE);
				}
<span class="nc" id="L474">			}// Action performed</span>
		});
	} // END okButton

	//***************************END of End Panel**********************

	private int findMaxConstants() {
<span class="nc bnc" id="L481" title="All 2 branches missed.">		for (int i = 0; i &lt; availableFunctions.length; i++)</span>
<span class="nc bnc" id="L482" title="All 2 branches missed.">			if (availableFunctions[i].constantsNumber() &gt; maxConstants)</span>
<span class="nc" id="L483">				maxConstants = availableFunctions[i].constantsNumber();</span>
<span class="nc" id="L484">		return maxConstants;</span>
	}

	private void defineSimpleLabels() {
<span class="nc bnc" id="L488" title="All 2 branches missed.">		for (int j = 0; j &lt; 2; j++)</span>
<span class="nc bnc" id="L489" title="All 2 branches missed.">			for (int i = 0; i &lt; maxConstants; i++) {</span>
<span class="nc" id="L490">				simpleLabels[j][i] = new JLabel();</span>
<span class="nc" id="L491">				simpleLabels[j][i].setFont(new java.awt.Font(&quot;Dialog&quot;, 1, 12));</span>
<span class="nc" id="L492">				simpleLabels[j][i]</span>
<span class="nc" id="L493">						.setHorizontalTextPosition(SwingConstants.CENTER);</span>
<span class="nc" id="L494">				simpleLabels[j][i].setSize(new Dimension(20, 15));</span>
			}

<span class="nc" id="L497">	}</span>

	private void defineSimpleTextFields() {
<span class="nc bnc" id="L500" title="All 2 branches missed.">		for (int j = 0; j &lt; 2; j++)</span>
<span class="nc bnc" id="L501" title="All 2 branches missed.">			for (int i = 0; i &lt; maxConstants; i++) {</span>
<span class="nc" id="L502">				simpleTextFields[j][i] = new JTextField(4);</span>
<span class="nc" id="L503">				simpleTextFields[j][i].setBorder(BorderFactory</span>
<span class="nc" id="L504">						.createLoweredBevelBorder());</span>
			}

<span class="nc" id="L507">	}</span>

	private void createParametersPanel(JPanel panel, Function function) {
<span class="nc bnc" id="L510" title="All 2 branches missed.">		int j = ((panel.getName() == &quot;FUNCTION&quot;) ? 0 : 1);</span>
<span class="nc bnc" id="L511" title="All 2 branches missed.">		String title = ((panel.getName() == &quot;FUNCTION&quot;) ? &quot;Function  :&quot;</span>
				: &quot;Social Function  :&quot;);

<span class="nc" id="L514">		panel.setBorder(BorderFactory.createCompoundBorder(BorderFactory</span>
<span class="nc" id="L515">				.createTitledBorder(BorderFactory</span>
<span class="nc" id="L516">						.createLineBorder(SystemColor.BLACK), title + &quot;   &quot;</span>
<span class="nc" id="L517">						+ function.getFunctionName().toLowerCase() + &quot;    &quot;</span>
<span class="nc" id="L518">						+ function.getFunctionRepresentation()), BorderFactory</span>
<span class="nc" id="L519">				.createEmptyBorder(5, 5, 5, 5)));</span>

<span class="nc" id="L521">		int i = 0;</span>
<span class="nc" id="L522">		Iterator it = function.getFunctionConstants();</span>
<span class="nc bnc" id="L523" title="All 2 branches missed.">		while (it.hasNext()) {</span>
<span class="nc" id="L524">			Function.FunctionConstant fc = (Function.FunctionConstant) it</span>
<span class="nc" id="L525">					.next();</span>
<span class="nc" id="L526">			simpleLabels[j][i].setText(fc.getConstantName() + &quot; : &quot;);</span>
<span class="nc" id="L527">			panel.add(simpleLabels[j][i], null);</span>
<span class="nc bnc" id="L528" title="All 2 branches missed.">			simpleTextFields[j][i].setText(function.getFunctionName().equals(</span>
					&quot;MetDATA&quot;) ? &quot;1&quot; : &quot;&quot;);
<span class="nc" id="L530">			panel.add(simpleTextFields[j][i], null);</span>
<span class="nc" id="L531">			i++;</span>
<span class="nc" id="L532">		}</span>
<span class="nc" id="L533">		panel.validate();</span>

<span class="nc" id="L535">	} // End createParametersPanel</span>

	private void fillSimpleTextFields() {

<span class="nc" id="L539">		this.flagFunctionSelected = true;</span>
<span class="nc" id="L540">		this.flagSocialSelected = true;</span>

<span class="nc" id="L542">		this.textFieldElasticity.setText(Float.toString(parameter</span>
<span class="nc" id="L543">				.getElasticity()));</span>

<span class="nc" id="L545">		String name = parameter.getDemandCurveFunction().getFunctionName();</span>

<span class="nc" id="L547">		this.functionCombo.setSelectedIndex(((Integer) functionNameToComboIndex</span>
<span class="nc" id="L548">				.get(name)).intValue());</span>

<span class="nc bnc" id="L550" title="All 2 branches missed.">		if (parameter.isSocial()) {</span>
<span class="nc" id="L551">			name = parameter.getSocialFunction().getFunctionName();</span>
<span class="nc" id="L552">			this.socialCombo.setSelectedIndex(((Integer) socialNameToComboIndex</span>
<span class="nc" id="L553">					.get(name)).intValue());</span>
		}

<span class="nc" id="L556">		Iterator it = parameter.getDemandCurveFunction().getFunctionConstants();</span>
<span class="nc" id="L557">		int i = 0;</span>
<span class="nc bnc" id="L558" title="All 2 branches missed.">		while (it.hasNext()) {</span>
<span class="nc" id="L559">			Function.FunctionConstant fc = (Function.FunctionConstant) it</span>
<span class="nc" id="L560">					.next();</span>
<span class="nc" id="L561">			this.simpleTextFields[0][i].setText(Float.toString(fc</span>
<span class="nc" id="L562">					.getConstantFValue()));</span>
<span class="nc" id="L563">			i++;</span>
<span class="nc" id="L564">		}</span>
<span class="nc bnc" id="L565" title="All 2 branches missed.">		if (parameter.isSocial()) {</span>
<span class="nc" id="L566">			it = parameter.getSocialFunction().getFunctionConstants();</span>
<span class="nc" id="L567">			i = 0;</span>
<span class="nc bnc" id="L568" title="All 2 branches missed.">			while (it.hasNext()) {</span>
<span class="nc" id="L569">				Function.FunctionConstant fc = (Function.FunctionConstant) it</span>
<span class="nc" id="L570">						.next();</span>
<span class="nc" id="L571">				this.simpleTextFields[1][i].setText(Float.toString(fc</span>
<span class="nc" id="L572">						.getConstantFValue()));</span>
<span class="nc" id="L573">				i++;</span>
<span class="nc" id="L574">			}</span>
		}

<span class="nc" id="L577">	}</span>

	//***************************************************************************
	// Listeners
<span class="nc" id="L581">	private class functionComboListener implements ActionListener {</span>
		public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L583" title="All 2 branches missed.">			if (&quot;comboBoxChanged&quot;.equals(e.getActionCommand())) {</span>
<span class="nc" id="L584">				functionPanel.removeAll();</span>
<span class="nc" id="L585">				functionPanel.validate();</span>
<span class="nc" id="L586">				flagFunctionSelected = true;</span>
<span class="nc" id="L587">				if (functionCombo.getSelectedItem().toString()</span>
<span class="nc bnc" id="L588" title="All 2 branches missed.">						.equals(&quot;MetDATA&quot;)</span>
<span class="nc bnc" id="L589" title="All 2 branches missed.">						|| functionCombo.getSelectedItem().toString().equals(</span>
								&quot;PRICE&quot;)) {
					// to pass the ok test and will be changed
<span class="nc" id="L592">					flagSocialSelected = true;</span>
<span class="nc" id="L593">					socialCombo.setEnabled(false);</span>
<span class="nc" id="L594">					socialPanel.removeAll();</span>
<span class="nc" id="L595">					socialPanel.setBorder(BorderFactory.createEmptyBorder());</span>
<span class="nc" id="L596">					socialPanel.validate();</span>
<span class="nc bnc" id="L597" title="All 2 branches missed.">				} else if (parameter.isSocial()) {</span>
<span class="nc" id="L598">					socialCombo.setEnabled(true);</span>
				}
<span class="nc" id="L600">				createParametersPanel(functionPanel,</span>
<span class="nc" id="L601">						availableFunctions[functionCombo.getSelectedIndex()]);</span>
			}//END if
<span class="nc" id="L603">		}//END actionPerformed</span>
	}// END of social Combo Listener

<span class="nc" id="L606">	private class socialComboListener implements ActionListener {</span>
		public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L608" title="All 2 branches missed.">			if (&quot;comboBoxChanged&quot;.equals(e.getActionCommand())) {</span>
<span class="nc" id="L609">				socialPanel.removeAll();</span>
<span class="nc" id="L610">				socialPanel.validate();</span>
<span class="nc" id="L611">				flagSocialSelected = true;</span>
<span class="nc" id="L612">				createParametersPanel(socialPanel,</span>
<span class="nc" id="L613">						availableFunctions[socialCombo.getSelectedIndex()]);</span>
			}
<span class="nc" id="L615">		}</span>
	}

}// END of DemandCurveParameterFrame
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>