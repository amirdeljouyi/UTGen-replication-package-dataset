<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Configure.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">41_follow</a> &gt; <a href="index.source.html" class="el_package">ghm.follow.config</a> &gt; <span class="el_source">Configure.java</span></div><h1>Configure.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2000-2003 Greg Merrill (greghmerrill@yahoo.com)
 * 
 * This file is part of Follow (http://follow.sf.net).
 * 
 * Follow is free software; you can redistribute it and/or modify it under the
 * terms of version 2 of the GNU General Public License as published by the Free
 * Software Foundation.
 * 
 * Follow is distributed in the hope that it will be useful, but WITHOUT ANY
 * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
 * A PARTICULAR PURPOSE. See the GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License along with
 * Follow; if not, write to the Free Software Foundation, Inc., 59 Temple Place,
 * Suite 330, Boston, MA 02111-1307 USA
 */

package ghm.follow.config;

import ghm.follow.font.FontSelectionPanel;
import ghm.follow.font.InvalidFontException;
import ghm.follow.gui.FileFollowingPane;
import ghm.follow.FollowApp;
import ghm.follow.gui.FollowAppAction;
import ghm.follow.gui.WhatIsThis;

import java.awt.BorderLayout;
import java.awt.Cursor;
import java.awt.FlowLayout;
import java.awt.Font;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyEvent;
import java.io.IOException;
import javax.swing.BorderFactory;
import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JComponent;
import javax.swing.JDialog;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JRootPane;
import javax.swing.JTabbedPane;
import javax.swing.JTextField;
import javax.swing.KeyStroke;

/**
 * Action which brings up a dialog allowing one to configure the Follow application.
 * 
 * @author &lt;a href=&quot;mailto:greghmerrill@yahoo.com&quot;&gt;Greg Merrill&lt;/a&gt;
 */
public class Configure extends FollowAppAction
{
	public static final String NAME = &quot;configure&quot;;

	public Configure(FollowApp app)
	{
<span class="nc" id="L62">		super(app, FollowApp.getResourceString(&quot;action.Configure.name&quot;),</span>
<span class="nc" id="L63">				FollowApp.getResourceString(&quot;action.Configure.mnemonic&quot;),</span>
<span class="nc" id="L64">				FollowApp.getResourceString(&quot;action.Configure.accelerator&quot;),</span>
<span class="nc" id="L65">				FollowApp.getIcon(Configure.class, &quot;action.Configure.icon&quot;),</span>
				ActionContext.APP);
<span class="nc" id="L67">	}</span>

	public void actionPerformed(ActionEvent e)
	{
<span class="nc" id="L71">		getApp().setCursor(Cursor.WAIT_CURSOR);</span>
<span class="nc bnc" id="L72" title="All 2 branches missed.">		if (dialog == null)</span>
		{
<span class="nc" id="L74">			dialog = new CfgDialog();</span>
		}
<span class="nc" id="L76">		dialog.bufferSize.setText(String.valueOf(getApp().getAttributes().getBufferSize()));</span>
<span class="nc" id="L77">		dialog.latency.setText(String.valueOf(getApp().getAttributes().getLatency()));</span>
<span class="nc" id="L78">		dialog.tabPlacement.setSelectedItem(new TabPlacementValue(getApp().getAttributes()</span>
<span class="nc" id="L79">				.getTabPlacement()));</span>
<span class="nc" id="L80">		dialog.confirmDelete.setValue(getApp().getAttributes().confirmDelete());</span>
<span class="nc" id="L81">		dialog.confirmDeleteAll.setValue(getApp().getAttributes().confirmDeleteAll());</span>
<span class="nc" id="L82">		dialog.autoScroll.setValue(getApp().getAttributes().autoScroll());</span>
<span class="nc" id="L83">		dialog.editor.setText(String.valueOf(getApp().getAttributes().getEditor()));</span>
<span class="nc" id="L84">		dialog.tabSize.setText(String.valueOf(getApp().getAttributes().getTabSize()));</span>
<span class="nc" id="L85">		dialog.fontSelectionPanel.setSelectedFont(getApp().getAttributes().getFont());</span>
<span class="nc" id="L86">		dialog.recentFilesMax.setText(String</span>
<span class="nc" id="L87">				.valueOf(getApp().getAttributes().getRecentFilesMax()));</span>
		// Quasi-kludge to get around font repainting issue
<span class="nc" id="L89">		dialog.setLocationRelativeTo(getApp().getFrame());</span>
<span class="nc" id="L90">		dialog.setLocation(30, 30);</span>
		// No need to set font; this is taken care of during CfgDialog
		// construction
<span class="nc" id="L93">		dialog.pack();</span>
<span class="nc" id="L94">		dialog.setVisible(true);</span>
<span class="nc" id="L95">		getApp().setCursor(Cursor.DEFAULT_CURSOR);</span>
<span class="nc" id="L96">	}</span>

	private CfgDialog dialog;

	class CfgDialog extends JDialog
	{
		protected JRootPane createRootPane()
		{
<span class="nc" id="L104">			KeyStroke stroke = KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0);</span>
<span class="nc" id="L105">			JRootPane rootPane = new JRootPane();</span>
<span class="nc" id="L106">			rootPane.registerKeyboardAction(new ActionListener()</span>
<span class="nc" id="L107">			{</span>
				public void actionPerformed(ActionEvent actionEvent)
				{
<span class="nc" id="L110">					dialog.close.doClick();</span>
<span class="nc" id="L111">				}</span>
			}, stroke, JComponent.WHEN_IN_FOCUSED_WINDOW);
<span class="nc" id="L113">			return rootPane;</span>
		}

		CfgDialog()
<span class="nc" id="L117">		{</span>
<span class="nc" id="L118">			super(Configure.this.getApp().getFrame(), FollowApp.getResourceString(&quot;dialog.Configure.title&quot;),</span>
					true);
<span class="nc" id="L120">			JComponent contentPane = (JComponent) getContentPane();</span>
<span class="nc" id="L121">			contentPane.setBorder(BorderFactory.createEmptyBorder(12, 12, 11, 11));</span>

<span class="nc" id="L123">			JPanel configPanel = new JPanel(new GridBagLayout());</span>
<span class="nc" id="L124">			GridBagConstraints gbc = new GridBagConstraints();</span>
<span class="nc" id="L125">			gbc.anchor = GridBagConstraints.WEST;</span>
<span class="nc" id="L126">			gbc.ipadx = 4;</span>

			// buffer size
<span class="nc" id="L129">			gbc.gridy = 0;</span>
<span class="nc" id="L130">			configPanel</span>
<span class="nc" id="L131">					.add(new JLabel(FollowApp.getResourceString(&quot;dialog.Configure.bufferSize.label&quot;)), gbc);</span>
<span class="nc" id="L132">			bufferSize = new JTextField();</span>
<span class="nc" id="L133">			bufferSize.setHorizontalAlignment(JTextField.RIGHT);</span>
<span class="nc" id="L134">			gbc.gridx = 1;</span>
<span class="nc" id="L135">			gbc.weightx = 1;</span>
<span class="nc" id="L136">			gbc.ipadx = 0;</span>
<span class="nc" id="L137">			gbc.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L138">			configPanel.add(bufferSize, gbc);</span>
<span class="nc" id="L139">			JButton bufferSizeInfo = new WhatIsThis(getApp(),</span>
<span class="nc" id="L140">					FollowApp.getResourceString(&quot;WhatIsThis.bufferSize.title&quot;),</span>
<span class="nc" id="L141">					FollowApp.getResourceString(&quot;WhatIsThis.bufferSize.text&quot;));</span>
<span class="nc" id="L142">			gbc.gridx = 2;</span>
<span class="nc" id="L143">			gbc.weightx = 0;</span>
<span class="nc" id="L144">			gbc.fill = GridBagConstraints.NONE;</span>
<span class="nc" id="L145">			configPanel.add(bufferSizeInfo, gbc);</span>

			// latency
<span class="nc" id="L148">			gbc.gridx = 0;</span>
<span class="nc" id="L149">			gbc.gridy++;</span>
<span class="nc" id="L150">			gbc.ipadx = 4;</span>
<span class="nc" id="L151">			configPanel.add(new JLabel(FollowApp.getResourceString(&quot;dialog.Configure.latency.label&quot;)), gbc);</span>
<span class="nc" id="L152">			latency = new JTextField();</span>
<span class="nc" id="L153">			latency.setHorizontalAlignment(JTextField.RIGHT);</span>
<span class="nc" id="L154">			gbc.gridx = 1;</span>
<span class="nc" id="L155">			gbc.weightx = 1;</span>
<span class="nc" id="L156">			gbc.ipadx = 0;</span>
<span class="nc" id="L157">			gbc.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L158">			configPanel.add(latency, gbc);</span>
<span class="nc" id="L159">			JButton latencyInfo = new WhatIsThis(getApp(),</span>
<span class="nc" id="L160">					FollowApp.getResourceString(&quot;WhatIsThis.latency.title&quot;),</span>
<span class="nc" id="L161">					FollowApp.getResourceString(&quot;WhatIsThis.latency.text&quot;));</span>
<span class="nc" id="L162">			gbc.gridx = 2;</span>
<span class="nc" id="L163">			gbc.weightx = 0;</span>
<span class="nc" id="L164">			gbc.fill = GridBagConstraints.NONE;</span>
<span class="nc" id="L165">			configPanel.add(latencyInfo, gbc);</span>

			// tab placement
<span class="nc" id="L168">			gbc.gridx = 0;</span>
<span class="nc" id="L169">			gbc.gridy++;</span>
<span class="nc" id="L170">			gbc.ipadx = 4;</span>
<span class="nc" id="L171">			configPanel.add(new JLabel(FollowApp.getResourceString(&quot;dialog.Configure.tabPlacement.label&quot;)),</span>
					gbc);
<span class="nc" id="L173">			tabPlacement = new JComboBox(ALL_TAB_PLACEMENT_VALUES);</span>
<span class="nc" id="L174">			gbc.gridx = 1;</span>
<span class="nc" id="L175">			gbc.weightx = 1;</span>
<span class="nc" id="L176">			gbc.ipadx = 0;</span>
<span class="nc" id="L177">			gbc.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L178">			configPanel.add(tabPlacement, gbc);</span>
<span class="nc" id="L179">			JButton tabPlacementInfo = new WhatIsThis(getApp(),</span>
<span class="nc" id="L180">					FollowApp.getResourceString(&quot;WhatIsThis.tabPlacement.title&quot;),</span>
<span class="nc" id="L181">					FollowApp.getResourceString(&quot;WhatIsThis.tabPlacement.text&quot;));</span>
<span class="nc" id="L182">			gbc.gridx = 2;</span>
<span class="nc" id="L183">			gbc.weightx = 0;</span>
<span class="nc" id="L184">			gbc.fill = GridBagConstraints.NONE;</span>
<span class="nc" id="L185">			configPanel.add(tabPlacementInfo, gbc);</span>

			// confirm delete
<span class="nc" id="L188">			gbc.gridx = 0;</span>
<span class="nc" id="L189">			gbc.gridy++;</span>
<span class="nc" id="L190">			gbc.ipadx = 4;</span>
<span class="nc" id="L191">			configPanel.add(new JLabel(FollowApp.getResourceString(&quot;dialog.Configure.confirmDelete.label&quot;)),</span>
					gbc);
<span class="nc" id="L193">			confirmDelete = new BooleanComboBox(</span>
<span class="nc" id="L194">					FollowApp.getResourceString(&quot;dialog.Configure.confirmDelete.yes.displayValue&quot;),</span>
<span class="nc" id="L195">					FollowApp.getResourceString(&quot;dialog.Configure.confirmDelete.no.displayValue&quot;));</span>
<span class="nc" id="L196">			gbc.gridx = 1;</span>
<span class="nc" id="L197">			gbc.weightx = 1;</span>
<span class="nc" id="L198">			gbc.ipadx = 0;</span>
<span class="nc" id="L199">			gbc.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L200">			configPanel.add(confirmDelete, gbc);</span>
<span class="nc" id="L201">			JButton confirmDeleteInfo = new WhatIsThis(getApp(),</span>
<span class="nc" id="L202">					FollowApp.getResourceString(&quot;WhatIsThis.confirmDelete.title&quot;),</span>
<span class="nc" id="L203">					FollowApp.getResourceString(&quot;WhatIsThis.confirmDelete.text&quot;));</span>
<span class="nc" id="L204">			gbc.gridx = 2;</span>
<span class="nc" id="L205">			gbc.weightx = 0;</span>
<span class="nc" id="L206">			gbc.fill = GridBagConstraints.NONE;</span>
<span class="nc" id="L207">			configPanel.add(confirmDeleteInfo, gbc);</span>

			// confirm delete all
<span class="nc" id="L210">			gbc.gridx = 0;</span>
<span class="nc" id="L211">			gbc.gridy++;</span>
<span class="nc" id="L212">			gbc.ipadx = 4;</span>
<span class="nc" id="L213">			configPanel.add(</span>
<span class="nc" id="L214">					new JLabel(FollowApp.getResourceString(&quot;dialog.Configure.confirmDeleteAll.label&quot;)), gbc);</span>
<span class="nc" id="L215">			confirmDeleteAll = new BooleanComboBox(</span>
<span class="nc" id="L216">					FollowApp.getResourceString(&quot;dialog.Configure.confirmDeleteAll.yes.displayValue&quot;),</span>
<span class="nc" id="L217">					FollowApp.getResourceString(&quot;dialog.Configure.confirmDeleteAll.no.displayValue&quot;));</span>
<span class="nc" id="L218">			gbc.gridx = 1;</span>
<span class="nc" id="L219">			gbc.weightx = 1;</span>
<span class="nc" id="L220">			gbc.ipadx = 0;</span>
<span class="nc" id="L221">			gbc.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L222">			configPanel.add(confirmDeleteAll, gbc);</span>
<span class="nc" id="L223">			JButton confirmDeleteAllInfo = new WhatIsThis(getApp(),</span>
<span class="nc" id="L224">					FollowApp.getResourceString(&quot;WhatIsThis.confirmDeleteAll.title&quot;),</span>
<span class="nc" id="L225">					FollowApp.getResourceString(&quot;WhatIsThis.confirmDeleteAll.text&quot;));</span>
<span class="nc" id="L226">			gbc.gridx = 2;</span>
<span class="nc" id="L227">			gbc.weightx = 0;</span>
<span class="nc" id="L228">			gbc.fill = GridBagConstraints.NONE;</span>
<span class="nc" id="L229">			configPanel.add(confirmDeleteAllInfo, gbc);</span>

			// autoscroll
<span class="nc" id="L232">			gbc.gridx = 0;</span>
<span class="nc" id="L233">			gbc.gridy++;</span>
<span class="nc" id="L234">			gbc.ipadx = 4;</span>
<span class="nc" id="L235">			configPanel</span>
<span class="nc" id="L236">					.add(new JLabel(FollowApp.getResourceString(&quot;dialog.Configure.autoScroll.label&quot;)), gbc);</span>
<span class="nc" id="L237">			autoScroll = new BooleanComboBox(</span>
<span class="nc" id="L238">					FollowApp.getResourceString(&quot;dialog.Configure.autoScroll.yes.displayValue&quot;),</span>
<span class="nc" id="L239">					FollowApp.getResourceString(&quot;dialog.Configure.autoScroll.no.displayValue&quot;));</span>
<span class="nc" id="L240">			gbc.gridx = 1;</span>
<span class="nc" id="L241">			gbc.weightx = 1;</span>
<span class="nc" id="L242">			gbc.ipadx = 0;</span>
<span class="nc" id="L243">			gbc.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L244">			configPanel.add(autoScroll, gbc);</span>
<span class="nc" id="L245">			JButton autoScrollInfo = new WhatIsThis(getApp(),</span>
<span class="nc" id="L246">					FollowApp.getResourceString(&quot;WhatIsThis.autoScroll.title&quot;),</span>
<span class="nc" id="L247">					FollowApp.getResourceString(&quot;WhatIsThis.autoScroll.text&quot;));</span>
<span class="nc" id="L248">			gbc.gridx = 2;</span>
<span class="nc" id="L249">			gbc.weightx = 0;</span>
<span class="nc" id="L250">			gbc.fill = GridBagConstraints.NONE;</span>
<span class="nc" id="L251">			configPanel.add(autoScrollInfo, gbc);</span>

			// external editor
<span class="nc" id="L254">			gbc.gridx = 0;</span>
<span class="nc" id="L255">			gbc.gridy++;</span>
<span class="nc" id="L256">			gbc.ipadx = 4;</span>
<span class="nc" id="L257">			configPanel.add(new JLabel(FollowApp.getResourceString(&quot;dialog.Configure.editor.label&quot;)), gbc);</span>
<span class="nc" id="L258">			editor = new JTextField();</span>
<span class="nc" id="L259">			editor.setHorizontalAlignment(JTextField.LEFT);</span>
<span class="nc" id="L260">			gbc.gridx = 1;</span>
<span class="nc" id="L261">			gbc.weightx = 1;</span>
<span class="nc" id="L262">			gbc.ipadx = 0;</span>
<span class="nc" id="L263">			gbc.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L264">			configPanel.add(editor, gbc);</span>
<span class="nc" id="L265">			JButton editorInfo = new WhatIsThis(getApp(),</span>
<span class="nc" id="L266">					FollowApp.getResourceString(&quot;WhatIsThis.editor.title&quot;),</span>
<span class="nc" id="L267">					FollowApp.getResourceString(&quot;WhatIsThis.editor.text&quot;));</span>
<span class="nc" id="L268">			gbc.gridx = 2;</span>
<span class="nc" id="L269">			gbc.weightx = 0;</span>
<span class="nc" id="L270">			gbc.fill = GridBagConstraints.NONE;</span>
<span class="nc" id="L271">			configPanel.add(editorInfo, gbc);</span>

			// tabSize
<span class="nc" id="L274">			gbc.gridx = 0;</span>
<span class="nc" id="L275">			gbc.gridy++;</span>
<span class="nc" id="L276">			gbc.ipadx = 4;</span>
<span class="nc" id="L277">			configPanel.add(new JLabel(FollowApp.getResourceString(&quot;dialog.Configure.tabSize.label&quot;)), gbc);</span>
<span class="nc" id="L278">			tabSize = new JTextField();</span>
<span class="nc" id="L279">			tabSize.setHorizontalAlignment(JTextField.RIGHT);</span>
<span class="nc" id="L280">			gbc.gridx = 1;</span>
<span class="nc" id="L281">			gbc.weightx = 1;</span>
<span class="nc" id="L282">			gbc.ipadx = 0;</span>
<span class="nc" id="L283">			gbc.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L284">			configPanel.add(tabSize, gbc);</span>
<span class="nc" id="L285">			JButton tabSizeInfo = new WhatIsThis(getApp(),</span>
<span class="nc" id="L286">					FollowApp.getResourceString(&quot;WhatIsThis.tabSize.title&quot;),</span>
<span class="nc" id="L287">					FollowApp.getResourceString(&quot;WhatIsThis.tabSize.text&quot;));</span>
<span class="nc" id="L288">			gbc.gridx = 2;</span>
<span class="nc" id="L289">			gbc.weightx = 0;</span>
<span class="nc" id="L290">			gbc.fill = GridBagConstraints.NONE;</span>
<span class="nc" id="L291">			configPanel.add(tabSizeInfo, gbc);</span>

			// recentFilesMax
<span class="nc" id="L294">			gbc.gridx = 0;</span>
<span class="nc" id="L295">			gbc.gridy++;</span>
<span class="nc" id="L296">			gbc.ipadx = 4;</span>
<span class="nc" id="L297">			configPanel.add(new JLabel(FollowApp.getResourceString(&quot;dialog.Configure.recentFilesMax.label&quot;)),</span>
					gbc);
<span class="nc" id="L299">			recentFilesMax = new JTextField();</span>
<span class="nc" id="L300">			recentFilesMax.setHorizontalAlignment(JTextField.RIGHT);</span>
<span class="nc" id="L301">			gbc.gridx = 1;</span>
<span class="nc" id="L302">			gbc.weightx = 1;</span>
<span class="nc" id="L303">			gbc.ipadx = 0;</span>
<span class="nc" id="L304">			gbc.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L305">			configPanel.add(recentFilesMax, gbc);</span>
<span class="nc" id="L306">			JButton recentFilesMaxInfo = new WhatIsThis(getApp(),</span>
<span class="nc" id="L307">					FollowApp.getResourceString(&quot;WhatIsThis.recentFilesMax.title&quot;),</span>
<span class="nc" id="L308">					FollowApp.getResourceString(&quot;WhatIsThis.recentFilesMax.text&quot;));</span>
<span class="nc" id="L309">			gbc.gridx = 2;</span>
<span class="nc" id="L310">			gbc.weightx = 0;</span>
<span class="nc" id="L311">			gbc.fill = GridBagConstraints.NONE;</span>
<span class="nc" id="L312">			configPanel.add(recentFilesMaxInfo, gbc);</span>

			// font selection
<span class="nc" id="L315">			fontSelectionPanel = new CfgFontSelectionPanel();</span>
			// Must change border to top=0 because of default top in titled
			// border
<span class="nc" id="L318">			fontSelectionPanel.setBorder(BorderFactory.createEmptyBorder(0, 12, 11, 11));</span>
<span class="nc" id="L319">			JPanel fontPanelHolder = new JPanel(new BorderLayout());</span>
<span class="nc" id="L320">			fontPanelHolder.add(fontSelectionPanel, BorderLayout.CENTER);</span>
<span class="nc" id="L321">			fontPanelHolder.setBorder(BorderFactory</span>
<span class="nc" id="L322">					.createTitledBorder(FollowApp.getResourceString(&quot;dialog.Configure.font.label&quot;)));</span>
<span class="nc" id="L323">			gbc.gridx = 0;</span>
<span class="nc" id="L324">			gbc.gridy++;</span>
<span class="nc" id="L325">			gbc.gridwidth = 3;</span>
<span class="nc" id="L326">			gbc.fill = GridBagConstraints.BOTH;</span>
<span class="nc" id="L327">			configPanel.add(fontPanelHolder, gbc);</span>

<span class="nc" id="L329">			contentPane.add(configPanel, BorderLayout.CENTER);</span>

			// Save button
<span class="nc" id="L332">			save = new JButton(FollowApp.getResourceString(&quot;dialog.Configure.save.label&quot;));</span>
<span class="nc" id="L333">			save.setMnemonic(FollowApp.getResourceString(&quot;dialog.Configure.save.mnemonic&quot;).charAt(0));</span>
<span class="nc" id="L334">			save.addActionListener(new ActionListener()</span>
<span class="nc" id="L335">			{</span>
				public void actionPerformed(ActionEvent e)
				{
					// Validate fields
<span class="nc" id="L339">					StringBuffer invalidFieldsMessage = new StringBuffer();</span>
<span class="nc bnc" id="L340" title="All 2 branches missed.">					if (!isPositiveInteger(bufferSize.getText()))</span>
					{
<span class="nc" id="L342">						invalidFieldsMessage</span>
<span class="nc" id="L343">								.append(FollowApp.getResourceString(&quot;dialog.Configure.bufferSizeInvalid.text&quot;));</span>
<span class="nc" id="L344">						invalidFieldsMessage.append(FollowApp.MESSAGE_LINE_SEPARATOR);</span>
<span class="nc" id="L345">						invalidFieldsMessage.append(FollowApp.MESSAGE_LINE_SEPARATOR);</span>
					}
<span class="nc bnc" id="L347" title="All 2 branches missed.">					if (!isPositiveInteger(latency.getText()))</span>
					{
<span class="nc" id="L349">						invalidFieldsMessage</span>
<span class="nc" id="L350">								.append(FollowApp.getResourceString(&quot;dialog.Configure.latencyInvalid.text&quot;));</span>
<span class="nc" id="L351">						invalidFieldsMessage.append(FollowApp.MESSAGE_LINE_SEPARATOR);</span>
<span class="nc" id="L352">						invalidFieldsMessage.append(FollowApp.MESSAGE_LINE_SEPARATOR);</span>
					}
<span class="nc bnc" id="L354" title="All 2 branches missed.">					if (!isPositiveInteger(recentFilesMax.getText()))</span>
					{
<span class="nc" id="L356">						invalidFieldsMessage</span>
<span class="nc" id="L357">								.append(FollowApp.getResourceString(&quot;dialog.Configure.recentFilesMaxInvalid.text&quot;));</span>
<span class="nc" id="L358">						invalidFieldsMessage.append(FollowApp.MESSAGE_LINE_SEPARATOR);</span>
<span class="nc" id="L359">						invalidFieldsMessage.append(FollowApp.MESSAGE_LINE_SEPARATOR);</span>
					}
					try
					{
<span class="nc" id="L363">						fontSelectionPanel.getSelectedFont();</span>
					}
<span class="nc" id="L365">					catch (InvalidFontException ife)</span>
					{
<span class="nc" id="L367">						invalidFieldsMessage</span>
<span class="nc" id="L368">								.append(FollowApp.getResourceString(&quot;dialog.Configure.fontInvalid.text&quot;));</span>
<span class="nc" id="L369">						invalidFieldsMessage.append(FollowApp.MESSAGE_LINE_SEPARATOR);</span>
<span class="nc" id="L370">						invalidFieldsMessage.append(FollowApp.MESSAGE_LINE_SEPARATOR);</span>
<span class="nc" id="L371">					}</span>

<span class="nc bnc" id="L373" title="All 2 branches missed.">					if (invalidFieldsMessage.length() &gt; 0)</span>
					{
<span class="nc" id="L375">						JOptionPane.showMessageDialog(getApp().getFrame(), invalidFieldsMessage</span>
<span class="nc" id="L376">								.toString(),</span>
<span class="nc" id="L377">								FollowApp.getResourceString(&quot;dialog.Configure.invalidFieldsDialog.title&quot;),</span>
								JOptionPane.ERROR_MESSAGE);
					}
					else
					{
<span class="nc" id="L382">						getApp().getAttributes().setBufferSize(bufferSize.getText());</span>
<span class="nc" id="L383">						getApp().getAttributes().setLatency(latency.getText());</span>
<span class="nc" id="L384">						getApp().getAttributes().setTabPlacement(</span>
<span class="nc" id="L385">								((TabPlacementValue) tabPlacement.getSelectedItem()).value);</span>
<span class="nc" id="L386">						getApp().getAttributes().setConfirmDelete(confirmDelete.getValue());</span>
<span class="nc" id="L387">						getApp().getAttributes().setConfirmDeleteAll(confirmDeleteAll.getValue());</span>
<span class="nc" id="L388">						getApp().getAttributes().setAutoScroll(autoScroll.getValue());</span>
<span class="nc" id="L389">						getApp().getAttributes().setEditor(editor.getText());</span>
<span class="nc" id="L390">						getApp().getAttributes().setTabSize(tabSize.getText());</span>
<span class="nc" id="L391">						getApp().getAttributes().setRecentFilesMax(recentFilesMax.getText());</span>
//						getApp().refreshRecentFilesMenu();
						Font selectedFont;
						try
						{
<span class="nc" id="L396">							selectedFont = fontSelectionPanel.getSelectedFont();</span>
						}
<span class="nc" id="L398">						catch (InvalidFontException ife)</span>
						{
							// This shouldn't happen if the error catching at
							// the beginning
							// of actionPerformed() worked correctly
<span class="nc" id="L403">							throw new RuntimeException(</span>
									&quot;Programmatic error; supposedly impossible scenario has occurred.&quot;);
<span class="nc" id="L405">						}</span>
<span class="nc" id="L406">						getApp().getAttributes().setFont(selectedFont);</span>
<span class="nc bnc" id="L407" title="All 2 branches missed.">						for (FileFollowingPane pane : getApp().getFileToFollowingPaneMap().values())</span>
						{
<span class="nc" id="L409">							pane.getFileFollower().setBufferSize(</span>
<span class="nc" id="L410">									getApp().getAttributes().getBufferSize());</span>
<span class="nc" id="L411">							pane.getFileFollower()</span>
<span class="nc" id="L412">									.setLatency(getApp().getAttributes().getLatency());</span>
<span class="nc" id="L413">							pane.getTextPane().setFont(selectedFont);</span>
<span class="nc" id="L414">							pane.setAutoPositionCaret(getApp().getAttributes().autoScroll());</span>
<span class="nc" id="L415">							pane.getTextPane().setTabSize(getApp().getAttributes().getTabSize());</span>
<span class="nc" id="L416">							getApp().getTabbedPane().invalidate();</span>
<span class="nc" id="L417">							getApp().getTabbedPane().repaint();</span>
<span class="nc" id="L418">						}</span>
<span class="nc" id="L419">						getApp().getTabbedPane().setTabPlacement(</span>
<span class="nc" id="L420">								getApp().getAttributes().getTabPlacement());</span>
<span class="nc" id="L421">						getApp().getTabbedPane().invalidate();</span>
					}
<span class="nc" id="L423">				}</span>
			});

			// Restore Defaults button
<span class="nc" id="L427">			restoreDefaults = new JButton(</span>
<span class="nc" id="L428">					FollowApp.getResourceString(&quot;dialog.Configure.restoreDefaults.label&quot;));</span>
<span class="nc" id="L429">			restoreDefaults.setMnemonic(FollowApp.getResourceString(</span>
<span class="nc" id="L430">					&quot;dialog.Configure.restoreDefaults.mnemonic&quot;).charAt(0));</span>
<span class="nc" id="L431">			restoreDefaults.addActionListener(new ActionListener()</span>
<span class="nc" id="L432">			{</span>
				public void actionPerformed(ActionEvent e)
				{
					try
					{
<span class="nc" id="L437">						bufferSize.setText(String.valueOf(getApp().getAttributes()</span>
<span class="nc" id="L438">								.getDefaultAttributes().getBufferSize()));</span>
<span class="nc" id="L439">						latency.setText(String.valueOf(getApp().getAttributes()</span>
<span class="nc" id="L440">								.getDefaultAttributes().getLatency()));</span>
<span class="nc" id="L441">						tabPlacement.setSelectedItem(new TabPlacementValue(getApp()</span>
<span class="nc" id="L442">								.getAttributes().getDefaultAttributes().getTabPlacement()));</span>
<span class="nc" id="L443">						confirmDelete.setValue(getApp().getAttributes().getDefaultAttributes()</span>
<span class="nc" id="L444">								.confirmDelete());</span>
<span class="nc" id="L445">						confirmDeleteAll.setValue(getApp().getAttributes().getDefaultAttributes()</span>
<span class="nc" id="L446">								.confirmDeleteAll());</span>
<span class="nc" id="L447">						autoScroll.setValue(getApp().getAttributes().getDefaultAttributes()</span>
<span class="nc" id="L448">								.autoScroll());</span>
<span class="nc" id="L449">						editor.setText(String.valueOf(getApp().getAttributes()</span>
<span class="nc" id="L450">								.getDefaultAttributes().getEditor()));</span>
<span class="nc" id="L451">						fontSelectionPanel.setSelectedFont(getApp().getAttributes()</span>
<span class="nc" id="L452">								.getDefaultAttributes().getFont());</span>
<span class="nc" id="L453">						recentFilesMax.setText(String.valueOf(getApp().getAttributes()</span>
<span class="nc" id="L454">								.getDefaultAttributes().getRecentFilesMax()));</span>
					}
<span class="nc" id="L456">					catch (IOException ioe)</span>
					{
<span class="nc" id="L458">						JOptionPane.showMessageDialog(getApp().getFrame(),</span>
<span class="nc" id="L459">								FollowApp.getResourceString(&quot;dialog.Configure.cantRestoreDefaults.text&quot;),</span>
<span class="nc" id="L460">								FollowApp.getResourceString(&quot;dialog.Configure.cantRestoreDefaults.title&quot;),</span>
								JOptionPane.ERROR_MESSAGE);
<span class="nc" id="L462">					}</span>
<span class="nc" id="L463">				}</span>
			});

			// Close button
<span class="nc" id="L467">			close = new JButton(FollowApp.getResourceString(&quot;dialog.Configure.close.label&quot;));</span>
<span class="nc" id="L468">			close.setMnemonic(FollowApp.getResourceString(&quot;dialog.Configure.close.mnemonic&quot;).charAt(0));</span>
<span class="nc" id="L469">			close.addActionListener(new ActionListener()</span>
<span class="nc" id="L470">			{</span>
				public void actionPerformed(ActionEvent e)
				{
<span class="nc" id="L473">					dispose();</span>
<span class="nc" id="L474">				}</span>
			});

<span class="nc" id="L477">			JPanel buttonPanel = new JPanel(new FlowLayout(FlowLayout.RIGHT));</span>
<span class="nc" id="L478">			buttonPanel.add(save);</span>
<span class="nc" id="L479">			buttonPanel.add(restoreDefaults);</span>
<span class="nc" id="L480">			buttonPanel.add(close);</span>
<span class="nc" id="L481">			contentPane.add(buttonPanel, BorderLayout.SOUTH);</span>
<span class="nc" id="L482">		}</span>

		private boolean isPositiveInteger(String value)
		{
			try
			{
<span class="nc" id="L488">				int intValue = Integer.parseInt(value);</span>
<span class="nc bnc" id="L489" title="All 2 branches missed.">				if (intValue &lt; 1)</span>
				{
<span class="nc" id="L491">					return false;</span>
				}
<span class="nc" id="L493">				return true;</span>
			}
<span class="nc" id="L495">			catch (NumberFormatException nfe)</span>
			{
<span class="nc" id="L497">				return false;</span>
			}
		}

		JTextField bufferSize;
		JTextField latency;
		JComboBox tabPlacement;
		BooleanComboBox confirmDelete;
		BooleanComboBox confirmDeleteAll;
		BooleanComboBox autoScroll;
		JTextField editor;
		JTextField tabSize;
		JTextField recentFilesMax;
		CfgFontSelectionPanel fontSelectionPanel;
		JButton save;
		JButton restoreDefaults;
		JButton close;
	}

	private class TabPlacementValue
	{
		public TabPlacementValue(int value)
<span class="nc" id="L519">		{</span>
<span class="nc" id="L520">			this.value = value;</span>
<span class="nc bnc" id="L521" title="All 5 branches missed.">			switch (value)</span>
			{
				case JTabbedPane.TOP:
<span class="nc" id="L524">					displayValue = FollowApp.getResourceString(&quot;dialog.Configure.tabPlacement.Top.displayValue&quot;);</span>
<span class="nc" id="L525">					break;</span>
				case JTabbedPane.BOTTOM:
<span class="nc" id="L527">					displayValue = FollowApp.getResourceString(&quot;dialog.Configure.tabPlacement.Bottom.displayValue&quot;);</span>
<span class="nc" id="L528">					break;</span>
				case JTabbedPane.LEFT:
<span class="nc" id="L530">					displayValue = FollowApp.getResourceString(&quot;dialog.Configure.tabPlacement.Left.displayValue&quot;);</span>
<span class="nc" id="L531">					break;</span>
				case JTabbedPane.RIGHT:
<span class="nc" id="L533">					displayValue = FollowApp.getResourceString(&quot;dialog.Configure.tabPlacement.Right.displayValue&quot;);</span>
<span class="nc" id="L534">					break;</span>
				default:
<span class="nc" id="L536">					throw new IllegalArgumentException(</span>
							&quot;int value must be one of the tab placement values from JTabbedPane&quot;);
			}
<span class="nc" id="L539">		}</span>

		public int value;

		public String displayValue;

		public String toString()
		{
<span class="nc" id="L547">			return displayValue;</span>
		}

		public boolean equals(Object o)
		{
<span class="nc bnc" id="L552" title="All 4 branches missed.">			if (o != null &amp;&amp; o.getClass() == getClass())</span>
			{
<span class="nc bnc" id="L554" title="All 2 branches missed.">				return value == ((TabPlacementValue) o).value;</span>
			}
<span class="nc" id="L556">			return false;</span>
		}
	}

	private class CfgFontSelectionPanel extends FontSelectionPanel
	{
		CfgFontSelectionPanel()
<span class="nc" id="L563">		{</span>
<span class="nc" id="L564">			super(Configure.this.getApp().getAttributes().getFont(),</span>
<span class="nc" id="L565">					getStyleDisplayValues(), new int[] { 8, 9, 10, 12,</span>
							14 });
<span class="nc" id="L567">			this.fontFamilyList.setVisibleRowCount(5);</span>
<span class="nc" id="L568">		}</span>
	}

	private static String[] getStyleDisplayValues()
	{
<span class="nc" id="L573">		return new String[] { FollowApp.getResourceString(&quot;dialog.Configure.font.plain.displayValue&quot;),</span>
<span class="nc" id="L574">				FollowApp.getResourceString(&quot;dialog.Configure.font.bold.displayValue&quot;),</span>
<span class="nc" id="L575">				FollowApp.getResourceString(&quot;dialog.Configure.font.italic.displayValue&quot;),</span>
<span class="nc" id="L576">				FollowApp.getResourceString(&quot;dialog.Configure.font.boldItalic.displayValue&quot;) };</span>
	}

<span class="nc" id="L579">	private TabPlacementValue TOP = new TabPlacementValue(JTabbedPane.TOP);</span>

<span class="nc" id="L581">	private TabPlacementValue BOTTOM = new TabPlacementValue(JTabbedPane.BOTTOM);</span>

<span class="nc" id="L583">	private TabPlacementValue LEFT = new TabPlacementValue(JTabbedPane.LEFT);</span>

<span class="nc" id="L585">	private TabPlacementValue RIGHT = new TabPlacementValue(JTabbedPane.RIGHT);</span>

<span class="nc" id="L587">	private TabPlacementValue[] ALL_TAB_PLACEMENT_VALUES = new TabPlacementValue[] { TOP, BOTTOM,</span>
			LEFT, RIGHT };

	static class BooleanComboBox extends JComboBox
	{
		BooleanComboBox(String trueDisplayValue, String falseDisplayValue)
		{
<span class="nc" id="L594">			super(new String[] { trueDisplayValue, falseDisplayValue });</span>
<span class="nc" id="L595">		}</span>

		public void setValue(boolean value)
		{
<span class="nc bnc" id="L599" title="All 2 branches missed.">			if (value == true)</span>
			{
<span class="nc" id="L601">				this.setSelectedIndex(0);</span>
			}
			else
			{
<span class="nc" id="L605">				this.setSelectedIndex(1);</span>
			}
<span class="nc" id="L607">		}</span>

		public boolean getValue()
		{
<span class="nc bnc" id="L611" title="All 2 branches missed.">			return (this.getSelectedIndex() == 0);</span>
		}
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>