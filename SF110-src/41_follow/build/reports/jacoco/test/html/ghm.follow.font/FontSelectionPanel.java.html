<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>FontSelectionPanel.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">41_follow</a> &gt; <a href="index.source.html" class="el_package">ghm.follow.font</a> &gt; <span class="el_source">FontSelectionPanel.java</span></div><h1>FontSelectionPanel.java</h1><pre class="source lang-java linenums">/* 
 Copyright (C) 2000-2003 Greg Merrill (greghmerrill@yahoo.com)

 This file is part of Follow (http://follow.sf.net).

 Follow is free software; you can redistribute it and/or modify
 it under the terms of version 2 of the GNU General Public
 License as published by the Free Software Foundation.

 Follow is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with Follow; if not, write to the Free Software
 Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
 */

package ghm.follow.font;

import java.awt.Canvas;
import java.awt.Color;
import java.awt.Component;
import java.awt.Font;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.GraphicsEnvironment;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.Insets;
import java.awt.font.FontRenderContext;
import java.awt.font.GlyphVector;
import java.awt.geom.Rectangle2D;
import java.util.Observable;
import java.util.Observer;
import javax.swing.DefaultListCellRenderer;
import javax.swing.JLabel;
import javax.swing.JList;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextField;
import javax.swing.ListModel;
import javax.swing.ListSelectionModel;
import javax.swing.border.EmptyBorder;
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;
import javax.swing.event.ListSelectionEvent;
import javax.swing.event.ListSelectionListener;

/**
 * FontSelectionPanel v1.1, copied without functional modification from &lt;a
 * href=&quot;http://gregmerrill.imagineis.com/fontSelectionPanel&quot;
 * &gt;http://gregmerrill.imagineis.com/fontSelectionPanel&lt;/a&gt;.
 */
public class FontSelectionPanel extends JPanel
{

	/**
	 * Like {@link #FontSelectionPanel(java.awt.Font)}, except an initialFont of &lt;code&gt;null&lt;/code&gt;
	 * will be used.
	 */
	public FontSelectionPanel()
	{
<span class="nc" id="L65">		this(null);</span>
<span class="nc" id="L66">	}</span>

	/**
	 * Like {@link #FontSelectionPanel(java.awt.Font, String[], int[])}, except that a default list
	 * of styles (&lt;code&gt;{&quot;Plain&quot;, &quot;Bold&quot;, &quot;Italic&quot;, &quot;Bold Italic&quot;}&lt;/code&gt;) and font sizes (&lt;code&gt;{8, 9, 10, 12, 14}&lt;/code&gt;)
	 * will be used.
	 * 
	 * @param initialFont
	 *            see {@link #FontSelectionPanel(java.awt.Font, String[], int[])}
	 */
	public FontSelectionPanel(Font initialFont)
	{
<span class="nc" id="L78">		this(initialFont,</span>
		// Don't change the following two values without changing the javadocs
				new String[] { &quot;Plain&quot;, &quot;Bold&quot;, &quot;Italic&quot;, &quot;Bold Italic&quot; }, new int[] { 8, 9, 10,
						12, 14 });
<span class="nc" id="L82">	}</span>

	/**
	 * Construct a new FontSelectionPanel whose family, style &amp; size widget selections are set
	 * according to the supplied initial Font. Additionally, the style &amp; size values available will
	 * be dictated by the values in styleDisplayNames and predefinedSizes, respectively.
	 * 
	 * @param initialFont
	 *            the newly constructed FontSelectionPanel's family, style, and size widgets will be
	 *            set according to this value. This value may be null, in which case an initial font
	 *            will be automatically created. This auto-created font will have a family, style,
	 *            and size corresponding to the first avaiable value in the widget form family,
	 *            style, and size respectively.
	 * @param styleDisplayNames
	 *            must contain exactly four members. The members of this array represent the
	 *            following styles, in order: Font.PLAIN, Font.BOLD, Font.ITALIC, and
	 *            Font.BOLD+Font.ITALIC
	 * @param predefinedSizes
	 *            must contain one or more predefined font sizes which will be available to the user
	 *            as a convenience for populating the font size text field; all values must be
	 *            greater than 0.
	 */
	public FontSelectionPanel(Font initialFont, String[] styleDisplayNames, int[] predefinedSizes)
	{
<span class="nc" id="L106">		super(new GridBagLayout());</span>
<span class="nc" id="L107">		this.setBorder(new EmptyBorder(12, 12, 11, 11));</span>
<span class="nc" id="L108">		GridBagConstraints gbc = new GridBagConstraints();</span>

<span class="nc" id="L110">		String[] availableFontFamilyNames = GraphicsEnvironment.getLocalGraphicsEnvironment()</span>
<span class="nc" id="L111">				.getAvailableFontFamilyNames();</span>

<span class="nc bnc" id="L113" title="All 2 branches missed.">		if (initialFont == null)</span>
		{
<span class="nc" id="L115">			initialFont = new Font(availableFontFamilyNames[0], Font.PLAIN, predefinedSizes[0]);</span>
		}

		// Font family
<span class="nc" id="L119">		fontFamilyList = new JList(availableFontFamilyNames);</span>
<span class="nc" id="L120">		fontFamilyList.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);</span>
<span class="nc" id="L121">		fontFamilyList.setVisibleRowCount(8);</span>
<span class="nc" id="L122">		ListSelectionListener phraseCanvasUpdater = new ListSelectionListener()</span>
<span class="nc" id="L123">		{</span>
			public void valueChanged(ListSelectionEvent e)
			{
<span class="nc bnc" id="L126" title="All 2 branches missed.">				if (!e.getValueIsAdjusting())</span>
				{
<span class="nc" id="L128">					observable.setChanged();</span>
<span class="nc" id="L129">					observable.notifyObservers();</span>
				}
<span class="nc" id="L131">			}</span>
		};
<span class="nc" id="L133">		fontFamilyList.addListSelectionListener(phraseCanvasUpdater);</span>
<span class="nc" id="L134">		gbc.fill = GridBagConstraints.BOTH;</span>
<span class="nc" id="L135">		gbc.gridheight = 2;</span>
<span class="nc" id="L136">		this.add(new JScrollPane(fontFamilyList), gbc);</span>

		// Font style
<span class="nc" id="L139">		fontStyleList = new FontStyleList(styleDisplayNames);</span>
<span class="nc" id="L140">		fontStyleList.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);</span>
<span class="nc" id="L141">		fontStyleList.setVisibleRowCount(4);</span>
<span class="nc" id="L142">		fontStyleList.addListSelectionListener(phraseCanvasUpdater);</span>
<span class="nc" id="L143">		gbc.gridx = 1;</span>
<span class="nc" id="L144">		gbc.insets = new Insets(0, 10, 0, 0);</span>
		// fontStyleList_ is put into a JScrollPane only because it puts a nice
		// border around it which is consistent with the border around
		// fontFamilyList_
<span class="nc" id="L148">		this.add(new JScrollPane(fontStyleList), gbc);</span>

		// Font size
<span class="nc" id="L151">		fontSize = new JTextField();</span>
<span class="nc" id="L152">		fontSize.setHorizontalAlignment(JTextField.RIGHT);</span>
<span class="nc" id="L153">		fontSize.setColumns(4);</span>
<span class="nc" id="L154">		gbc.gridx = 2;</span>
<span class="nc" id="L155">		gbc.gridheight = 1;</span>
<span class="nc" id="L156">		gbc.fill = GridBagConstraints.HORIZONTAL;</span>
<span class="nc" id="L157">		this.add(fontSize, gbc);</span>
<span class="nc" id="L158">		fontSizeList = new JList(validateAndConvertPredefinedSizes(predefinedSizes));</span>
<span class="nc" id="L159">		fontSizeList.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);</span>
		// Will be able to see more than 1 row because gbc.fill set to BOTH
<span class="nc" id="L161">		fontSizeList.setVisibleRowCount(1);</span>
<span class="nc" id="L162">		fontSizeList.setCellRenderer(new ListCellRenderer());</span>
<span class="nc" id="L163">		gbc.gridy = 1;</span>
<span class="nc" id="L164">		gbc.insets = new Insets(10, 10, 0, 0);</span>
<span class="nc" id="L165">		gbc.fill = GridBagConstraints.BOTH;</span>
<span class="nc" id="L166">		this.add(new JScrollPane(fontSizeList), gbc);</span>

		// Phrase Canvas (displays current font selection)
<span class="nc" id="L169">		phraseCanvas = new PhraseCanvas(initialFont.getFamily(), initialFont, Color.black);</span>
<span class="nc" id="L170">		addObserver(new Observer()</span>
<span class="nc" id="L171">		{</span>
			public void update(Observable o, Object arg)
			{
				try
				{
<span class="nc" id="L176">					phraseCanvas.setPhrase((String) fontFamilyList.getSelectedValue());</span>
<span class="nc" id="L177">					phraseCanvas.setFont(FontSelectionPanel.this.getSelectedFont());</span>
				}
<span class="nc" id="L179">				catch (InvalidFontException e)</span>
				{
<span class="nc" id="L181">					phraseCanvas.setPhrase(&quot;&quot;);</span>
<span class="nc" id="L182">				}</span>
<span class="nc" id="L183">				phraseCanvas.invalidate();</span>
<span class="nc" id="L184">				phraseCanvas.repaint();</span>
<span class="nc" id="L185">			}</span>
		});
<span class="nc" id="L187">		phraseCanvas.setSize((int) this.getPreferredSize().getWidth(), 100);</span>
<span class="nc" id="L188">		gbc.gridy = 2;</span>
<span class="nc" id="L189">		gbc.gridx = 0;</span>
<span class="nc" id="L190">		gbc.gridwidth = 3;</span>
<span class="nc" id="L191">		gbc.insets = new Insets(10, 0, 0, 0);</span>
<span class="nc" id="L192">		gbc.fill = GridBagConstraints.HORIZONTAL;</span>
		// put into JScrollPane for formatting purposes (no scrolling ever
		// occurs)
<span class="nc" id="L195">		this.add(new JScrollPane(phraseCanvas), gbc);</span>

		// Use FontSizeSynchronizer to ensure consistency between text field &amp;
		// list for font size
<span class="nc" id="L199">		FontSizeSynchronizer fontSizeSynchronizer = new FontSizeSynchronizer(fontSizeList,</span>
				fontSize);
<span class="nc" id="L201">		fontSizeList.addListSelectionListener(fontSizeSynchronizer);</span>
<span class="nc" id="L202">		fontSize.getDocument().addDocumentListener(fontSizeSynchronizer);</span>

		// Set initial widget values here at the end of the constructor to
		// ensure that all listeners have been added beforehand
<span class="nc" id="L206">		fontFamilyList.setSelectedValue(initialFont.getFamily(), true);</span>
<span class="nc" id="L207">		fontStyleList.setSelectedStyle(initialFont.getStyle());</span>
<span class="nc" id="L208">		fontSize.setText(String.valueOf(initialFont.getSize()));</span>
<span class="nc" id="L209">	}</span>

	/** JList for font family */
	protected JList fontFamilyList;
	/** FontStlyeList (subclass of JList) for font style */
	protected FontStyleList fontStyleList;
	/** JTextField for font size */
	protected JTextField fontSize;
	/** JList for font size */
	protected JList fontSizeList;
	/** PhraseCanvas in which font samples are displayed */
	protected PhraseCanvas phraseCanvas;

	/**
	 * @exception IllegalArgumentException
	 *                thrown if
	 *                &lt;ul&gt;
	 *                &lt;li&gt;predefinedSizes does not contain one or more integer values
	 *                &lt;li&gt;predefinedSizes contains any integers with a value of less than 1
	 *                &lt;/ul&gt;
	 */
	private Integer[] validateAndConvertPredefinedSizes(int[] predefinedSizes)
	{
<span class="nc bnc" id="L232" title="All 2 branches missed.">		if (predefinedSizes == null)</span>
		{
<span class="nc" id="L234">			throw new IllegalArgumentException(&quot;int[] predefinedSizes may not be null&quot;);</span>
		}
<span class="nc bnc" id="L236" title="All 2 branches missed.">		if (predefinedSizes.length &lt; 1)</span>
		{
<span class="nc" id="L238">			throw new IllegalArgumentException(</span>
					&quot;int[] predefinedSizes must contain one or more values&quot;);
		}
<span class="nc" id="L241">		Integer[] predefinedSizeIntegers = new Integer[predefinedSizes.length];</span>
<span class="nc bnc" id="L242" title="All 2 branches missed.">		for (int i = 0; i &lt; predefinedSizes.length; i++)</span>
		{
<span class="nc bnc" id="L244" title="All 2 branches missed.">			if (predefinedSizes[i] &lt; 1)</span>
			{
<span class="nc" id="L246">				throw new IllegalArgumentException(</span>
						&quot;int[] predefinedSizes may not contain integers with value less than 1&quot;);
			}
<span class="nc" id="L249">			predefinedSizeIntegers[i] = new Integer(predefinedSizes[i]);</span>
		}
<span class="nc" id="L251">		return predefinedSizeIntegers;</span>
	}

	/**
	 * Adds an Observer to this FontSelectionPanel; the supplied Observer will have its update()
	 * method called any time the Font currently specified in the FontSelectionPanel changes. (The
	 * &lt;tt&gt;arg&lt;/tt&gt; supplied to the Observer will be &lt;tt&gt;null&lt;/tt&gt;.)
	 * 
	 * @param o
	 *            observer to be added
	 * @see java.util.Observer
	 */
	public void addObserver(Observer o)
	{
<span class="nc" id="L265">		observable.addObserver(o);</span>
<span class="nc" id="L266">	}</span>

	/**
	 * Removes an Observer from this FontSelectionPanel.
	 * 
	 * @param o
	 *            Observer to be removed
	 * @see java.util.Observer
	 */
	public void deleteObserver(Observer o)
	{
<span class="nc" id="L277">		observable.deleteObserver(o);</span>
<span class="nc" id="L278">	}</span>

	/** Observable used for registering/notifying Observers */
<span class="nc" id="L281">	protected PublicChangeObservable observable = new PublicChangeObservable();</span>

	/**
	 * Returns the currently selected font family
	 * 
	 * @return currently selected font family
	 * @exception NoFontFamilySelectedException
	 *                thrown if no font family is currently selected
	 */
	public String getSelectedFontFamily() throws NoFontFamilySelectedException
	{
<span class="nc" id="L292">		String fontFamily = (String) fontFamilyList.getSelectedValue();</span>
<span class="nc bnc" id="L293" title="All 2 branches missed.">		if (fontFamily == null)</span>
		{
<span class="nc" id="L295">			throw new NoFontFamilySelectedException(&quot;No font family is currently selected&quot;);</span>
		}
<span class="nc" id="L297">		return fontFamily;</span>
	}

	/**
	 * Returns the currently selected font style.
	 * 
	 * @return currently selected font style. This value will correspond to one of the font styles
	 *         specified in {@link java.awt.Font}
	 * @exception NoFontStyleSelectedException
	 *                thrown if no font style is currently selected
	 */
	public int getSelectedFontStyle() throws NoFontStyleSelectedException
	{
<span class="nc" id="L310">		return fontStyleList.getSelectedStyle();</span>
	}

	/**
	 * Returns the currently selected font size.
	 * 
	 * @return currently selected font size.
	 * @exception NoFontSizeSpecifiedException
	 *                thrown if no font size is currently specified
	 * @exception InvalidFontSizeException
	 *                thrown if the font size currently specified is invalid
	 */
	public int getSelectedFontSize() throws NoFontSizeSpecifiedException, InvalidFontSizeException
	{
<span class="nc" id="L324">		String fontSizeText = fontSize.getText();</span>
<span class="nc bnc" id="L325" title="All 4 branches missed.">		if ((fontSize == null) || (fontSize.equals(&quot;&quot;)))</span>
		{
<span class="nc" id="L327">			throw new NoFontSizeSpecifiedException(&quot;No font size specified&quot;);</span>
		}
<span class="nc bnc" id="L329" title="All 2 branches missed.">		if (fontSizeText.length() &gt; maxNumCharsInFontSize_)</span>
		{
<span class="nc" id="L331">			throw new InvalidFontSizeException(&quot;Too many characters in font size&quot;);</span>
		}
		try
		{
<span class="nc" id="L335">			return Integer.parseInt(fontSizeText);</span>
		}
<span class="nc" id="L337">		catch (NumberFormatException e)</span>
		{
<span class="nc" id="L339">			throw new InvalidFontSizeException(&quot;The number specified in the font size text field (&quot;</span>
<span class="nc" id="L340">					+ fontSize.getText() + &quot;) is not a valid integer.&quot;);</span>
		}
	}

	/**
	 * Returns the currently selected font.
	 * 
	 * @return currently selected font.
	 * @exception InvalidFontException
	 *                thrown if no valid font is currently specified; the actual class of the
	 *                exception thrown may be {@link InvalidFontException},
	 *                {@link NoFontFamilySelectedException}, {@link NoFontStyleSelectedException},
	 *                {@link NoFontSizeSpecifiedException}, or {@link InvalidFontSizeException}
	 */
	public Font getSelectedFont() throws InvalidFontException
	{
<span class="nc" id="L356">		return new Font(getSelectedFontFamily(), getSelectedFontStyle(), getSelectedFontSize());</span>
	}

	/**
	 * Changes the currently selected font by assigning all widget values to match the
	 * family/style/size values of the supplied font
	 * 
	 * @param font
	 *            font whose values should be used to set widgets
	 * @exception IllegalArgumentException
	 *                thrown if the family or style of the font supplied are not available or
	 *                invalid
	 */
	public void setSelectedFont(Font font)
	{
<span class="nc" id="L371">		setSelectedFontFamily(font.getFamily());</span>
<span class="nc" id="L372">		setSelectedFontStyle(font.getStyle());</span>
<span class="nc" id="L373">		setSelectedFontSize(font.getSize());</span>
<span class="nc" id="L374">	}</span>

	/**
	 * Sets the currently selected font family.
	 * 
	 * @param family
	 *            family to which selection should change
	 * @exception IllegalArgumentException
	 *                thrown if the supplied font family is not among the list of available font
	 *                families
	 */
	public void setSelectedFontFamily(String family)
	{
<span class="nc" id="L387">		ListModel familyListModel = fontFamilyList.getModel();</span>
<span class="nc bnc" id="L388" title="All 2 branches missed.">		for (int i = 0; i &lt; familyListModel.getSize(); i++)</span>
		{
<span class="nc" id="L390">			String listEntry = String.valueOf(familyListModel.getElementAt(i));</span>
<span class="nc bnc" id="L391" title="All 2 branches missed.">			if (listEntry.equalsIgnoreCase(family))</span>
			{
<span class="nc" id="L393">				fontFamilyList.setSelectedValue(listEntry, true);</span>
<span class="nc" id="L394">				return;</span>
			}
		}
<span class="nc" id="L397">		throw new IllegalArgumentException(&quot;The font family supplied, '&quot; + family</span>
				+ &quot;', is not in the list of availalbe &quot; + &quot;font families.&quot;);
	}

	/**
	 * Sets the currently selected font style.
	 * 
	 * @param style
	 *            style to which selection should change
	 * @exception IllegalArgumentException
	 *                thrown if the supplied font style is not one of Font.PLAIN, Font.BOLD,
	 *                Font.ITALIC, or Font.BOLD+Font.ITALIC
	 */
	public void setSelectedFontStyle(int style)
	{
<span class="nc" id="L412">		fontStyleList.setSelectedStyle(style);</span>
<span class="nc" id="L413">	}</span>

	/**
	 * Sets the currently selected font size.
	 * 
	 * @param size
	 *            size to which selection should change
	 */
	public void setSelectedFontSize(int size)
	{
<span class="nc" id="L423">		fontSize.setText(String.valueOf(size));</span>
<span class="nc" id="L424">	}</span>

	/** Maximum number of characters permissibile in a valid font size */
<span class="nc" id="L427">	protected int maxNumCharsInFontSize_ = 3;</span>

	/**
	 * This class synchronizes font size value between the list containing available font sizes &amp;
	 * the text field in which font size is ultimately specified.
	 */
	protected class FontSizeSynchronizer implements DocumentListener, ListSelectionListener
	{
		/**
		 * @param list
		 *            list containing predefined font sizes
		 * @param textField
		 *            text field in which font size is specified
		 */
		public FontSizeSynchronizer(JList list, JTextField textField)
<span class="nc" id="L442">		{</span>
<span class="nc" id="L443">			list_ = list;</span>
<span class="nc" id="L444">			textField_ = textField;</span>
<span class="nc" id="L445">		}</span>

		/** @see javax.swing.event.ListSelectionListener */
		public void valueChanged(ListSelectionEvent e)
		{
<span class="nc bnc" id="L450" title="All 2 branches missed.">			if (updating_)</span>
			{
<span class="nc" id="L452">				return;</span>
			}
<span class="nc" id="L454">			updating_ = true;</span>
<span class="nc bnc" id="L455" title="All 2 branches missed.">			if (!e.getValueIsAdjusting())</span>
			{
<span class="nc" id="L457">				Object selectedValue = ((JList) e.getSource()).getSelectedValue();</span>
<span class="nc bnc" id="L458" title="All 2 branches missed.">				if (selectedValue != null)</span>
				{
<span class="nc" id="L460">					textField_.setText(selectedValue.toString());</span>
				}
<span class="nc" id="L462">				observable.setChanged();</span>
<span class="nc" id="L463">				observable.notifyObservers();</span>
			}
<span class="nc" id="L465">			updating_ = false;</span>
<span class="nc" id="L466">		}</span>

		/** @see javax.swing.event.DocumentListener */
		public void changedUpdate(DocumentEvent e)
		{
<span class="nc" id="L471">			handle(e);</span>
<span class="nc" id="L472">		}</span>

		/** @see javax.swing.event.DocumentListener */
		public void insertUpdate(DocumentEvent e)
		{
<span class="nc" id="L477">			handle(e);</span>
<span class="nc" id="L478">		}</span>

		/** @see javax.swing.event.DocumentListener */
		public void removeUpdate(DocumentEvent e)
		{
<span class="nc" id="L483">			handle(e);</span>
<span class="nc" id="L484">		}</span>

		/** Handles all DocumentEvents */
		protected void handle(DocumentEvent e)
		{
<span class="nc bnc" id="L489" title="All 2 branches missed.">			if (updating_)</span>
			{
<span class="nc" id="L491">				return;</span>
			}
<span class="nc" id="L493">			updating_ = true;</span>
			try
			{
<span class="nc" id="L496">				Integer currentFontSizeInteger = Integer.valueOf(textField_.getText());</span>
<span class="nc" id="L497">				boolean currentSizeWasInList = false;</span>
				Object listMember;
<span class="nc bnc" id="L499" title="All 2 branches missed.">				for (int i = 0; i &lt; list_.getModel().getSize(); i++)</span>
				{
<span class="nc" id="L501">					listMember = list_.getModel().getElementAt(i);</span>
<span class="nc bnc" id="L502" title="All 2 branches missed.">					if (listMember.equals(currentFontSizeInteger))</span>
					{
<span class="nc" id="L504">						list_.setSelectedValue(currentFontSizeInteger, true);</span>
<span class="nc" id="L505">						currentSizeWasInList = true;</span>
<span class="nc" id="L506">						break;</span>
					}
				}
<span class="nc bnc" id="L509" title="All 2 branches missed.">				if (!currentSizeWasInList)</span>
				{
<span class="nc" id="L511">					list_.clearSelection();</span>
				}
			}
<span class="nc" id="L514">			catch (NumberFormatException nfe)</span>
			{
<span class="nc" id="L516">				list_.clearSelection();</span>
<span class="nc" id="L517">			}</span>
<span class="nc" id="L518">			observable.setChanged();</span>
<span class="nc" id="L519">			observable.notifyObservers();</span>
<span class="nc" id="L520">			updating_ = false;</span>
<span class="nc" id="L521">		}</span>

		protected JList list_;
		protected JTextField textField_;
		protected boolean updating_;
	}

	//
	// Static inner classes
	//
	/**
	 * Represents a list of the four font styles: plain, bold, italic, and bold italic
	 */
	protected static class FontStyleList extends JList
	{
		/**
		 * Construct a new FontStyleList, using the supplied values for style display names
		 * 
		 * @param styleDisplayNames
		 *            must contain exactly four members. The members of this array represent the
		 *            following styles, in order: Font.PLAIN, Font.BOLD, Font.ITALIC, and
		 *            Font.BOLD+Font.ITALIC
		 * @exception IllegalArgumentException
		 *                thrown if styleDisplayNames does not contain exactly four String values
		 */
		public FontStyleList(String[] styleDisplayNames)
		{
<span class="nc" id="L548">			super(validateStyleDisplayNames(styleDisplayNames));</span>
<span class="nc" id="L549">		}</span>

		private static String[] validateStyleDisplayNames(String[] styleDisplayNames)
		{
<span class="nc bnc" id="L553" title="All 2 branches missed.">			if (styleDisplayNames == null)</span>
			{
<span class="nc" id="L555">				throw new IllegalArgumentException(&quot;String[] styleDisplayNames may not be null&quot;);</span>
			}
<span class="nc bnc" id="L557" title="All 2 branches missed.">			if (styleDisplayNames.length != 4)</span>
			{
<span class="nc" id="L559">				throw new IllegalArgumentException(</span>
						&quot;String[] styleDisplayNames must have a length of 4&quot;);
			}
<span class="nc bnc" id="L562" title="All 2 branches missed.">			for (int i = 0; i &lt; styleDisplayNames.length; i++)</span>
			{
<span class="nc bnc" id="L564" title="All 2 branches missed.">				if (styleDisplayNames[i] == null)</span>
				{
<span class="nc" id="L566">					throw new IllegalArgumentException(</span>
							&quot;No member of String[] styleDisplayNames may be null&quot;);
				}
			}
<span class="nc" id="L570">			return styleDisplayNames;</span>
		}

		/**
		 * @return currently selected font style
		 * @exception NoFontStyleSelectedException
		 *                thrown if no font style is currently selected
		 */
		public int getSelectedStyle() throws NoFontStyleSelectedException
		{
<span class="nc bnc" id="L580" title="All 5 branches missed.">			switch (this.getSelectedIndex())</span>
			{
				case 0:
<span class="nc" id="L583">					return Font.PLAIN;</span>
				case 1:
<span class="nc" id="L585">					return Font.BOLD;</span>
				case 2:
<span class="nc" id="L587">					return Font.ITALIC;</span>
				case 3:
<span class="nc" id="L589">					return Font.BOLD + Font.ITALIC;</span>
				default:
<span class="nc" id="L591">					throw new NoFontStyleSelectedException(&quot;No font style is currently selected&quot;);</span>
			}
		}

		/**
		 * Change the currently selected style in this FontStyleList
		 * 
		 * @param style
		 *            new selected style for this FontStyleList
		 * @exception IllegalArgumentException
		 *                thrown if style is not one of Font.PLAIN, Font.BOLD, Font.ITALIC, or
		 *                Font.BOLD+Font.ITALIC
		 */
		public void setSelectedStyle(int style)
		{
<span class="nc bnc" id="L606" title="All 5 branches missed.">			switch (style)</span>
			{
				case Font.PLAIN:
<span class="nc" id="L609">					this.setSelectedIndex(0);</span>
<span class="nc" id="L610">					break;</span>
				case Font.BOLD:
<span class="nc" id="L612">					this.setSelectedIndex(1);</span>
<span class="nc" id="L613">					break;</span>
				case Font.ITALIC:
<span class="nc" id="L615">					this.setSelectedIndex(2);</span>
<span class="nc" id="L616">					break;</span>
				case Font.BOLD + Font.ITALIC:
<span class="nc" id="L618">					this.setSelectedIndex(3);</span>
<span class="nc" id="L619">					break;</span>
				default:
<span class="nc" id="L621">					throw new IllegalArgumentException(&quot;int style must come from java.awt.Font&quot;);</span>
			}
<span class="nc" id="L623">		}</span>
	}

	/**
	 * An implementation of {@link javax.swing.ListCellRenderer} which right justifies all cells.
	 */
<span class="nc" id="L629">	protected static class ListCellRenderer extends DefaultListCellRenderer</span>
	{
		public Component getListCellRendererComponent(JList list, Object value, int index,
				boolean isSelected, boolean cellHasFocus)
		{
<span class="nc" id="L634">			JLabel label = (JLabel) super.getListCellRendererComponent(list, value, index,</span>
					isSelected, cellHasFocus);
<span class="nc" id="L636">			label.setHorizontalAlignment(JLabel.RIGHT);</span>
<span class="nc" id="L637">			return label;</span>
		}
	}

	/**
	 * Subclass of {@link java.util.Observable} which allows &lt;tt&gt;public&lt;/tt&gt; access to the
	 * setChanged() method.
	 */
<span class="nc" id="L645">	protected static class PublicChangeObservable extends Observable</span>
	{
		/** @see java.util.Observable#setChanged() */
		public void setChanged()
		{
<span class="nc" id="L650">			super.setChanged();</span>
<span class="nc" id="L651">		}</span>
	}

	/**
	 * Component for displaying a &quot;phrase&quot; (a brief, one or two word String) using a particular font &amp;
	 * a particular color.
	 */
	static class PhraseCanvas extends Canvas
	{
		/**
		 * Constructs a new PhraseCanvas with the supplied phrase, font, and color.
		 * 
		 * @param phrase
		 *            phrase to be displayed in this PhraseCanvas
		 * @param font
		 *            Font to use when rendering the phrase
		 * @param color
		 *            Color to use when rendering the phrase
		 */
		public PhraseCanvas(String phrase, Font font, Color color)
<span class="nc" id="L671">		{</span>
<span class="nc" id="L672">			phrase_ = phrase;</span>
<span class="nc" id="L673">			font_ = font;</span>
<span class="nc" id="L674">			color_ = color;</span>
<span class="nc" id="L675">		}</span>

		/** @see java.awt.Canvas#paint(java.awt.Graphics) */
		public void paint(Graphics g)
		{
			// Workaround for bug in Font.createGlyphVector(), in review by
			// Sun with review id 108400.
<span class="nc" id="L682">			Font dummyFont = new Font(font_.getFamily(), font_.getStyle(), font_.getSize() + 1);</span>
<span class="nc" id="L683">			dummyFont.createGlyphVector(new FontRenderContext(null, antialiasOn_, false), phrase_);</span>

<span class="nc" id="L685">			GlyphVector glyphVector = font_.createGlyphVector(new FontRenderContext(null,</span>
					antialiasOn_, false), phrase_);
			// Use precedent set by applications like MS Word to place
			// glyph vector in the canvas:
			// 1. If the total width of the glyph vector is less than the
			// width of the canvas, the glyph vector will be horizontally
			// centered
			// in the canvas; else the glyph vector will be left-aligned
			// 2. If the total height of the glyph vector is less than the
			// height of
			// the canvas, the glyph vector will be vertically centered in the
			// canvas; else the glyph vector will be bottom-aligned
<span class="nc" id="L697">			Rectangle2D logicalBounds = glyphVector.getLogicalBounds();</span>
			double x;
<span class="nc bnc" id="L699" title="All 2 branches missed.">			if (logicalBounds.getWidth() &lt; this.getWidth())</span>
			{
<span class="nc" id="L701">				x = (this.getWidth() / 2) - (logicalBounds.getWidth() / 2);</span>
			}
			else
			{
<span class="nc" id="L705">				x = 0;</span>
			}
			double y;
<span class="nc bnc" id="L708" title="All 2 branches missed.">			if (logicalBounds.getHeight() &lt; this.getHeight())</span>
			{
<span class="nc" id="L710">				y = (this.getHeight() / 2) + (logicalBounds.getHeight() / 2);</span>
			}
			else
			{
<span class="nc" id="L714">				y = this.getHeight();</span>
			}
<span class="nc" id="L716">			g.setColor(color_);</span>
<span class="nc" id="L717">			Graphics2D g2d = (Graphics2D) g;</span>
<span class="nc" id="L718">			g2d.drawGlyphVector(glyphVector, (float) x, (float) y);</span>
<span class="nc" id="L719">		}</span>

		/**
		 * Returns the phrase to be rendered by this PhraseCanvas.
		 * 
		 * @return phrase to be rendered by this PhraseCanvas
		 */
		public String getPhrase()
		{
<span class="nc" id="L728">			return phrase_;</span>
		}

		/**
		 * Sets the phrase to be rendered by this PhraseCanvas.
		 * 
		 * @param phrase
		 *            new phrase to be rendered by this PhraseCanvas; this new value will be
		 *            rendered the next time {@link #paint(java.awt.Graphics)} is called
		 */
		public void setPhrase(String phrase)
		{
<span class="nc" id="L740">			phrase_ = phrase;</span>
<span class="nc" id="L741">		}</span>

		protected String phrase_;

		/**
		 * Returns the font to use when rendering the phrase.
		 * 
		 * @return font to use when rendering the phrase
		 */
		public Font getFont()
		{
<span class="nc" id="L752">			return font_;</span>
		}

		/**
		 * Sets the font to use when rendering the phrase.
		 * 
		 * @param font
		 *            new font to use when rendering the phrase; this new value will be used to
		 *            render the phrase the next time {@link #paint(java.awt.Graphics)} is called
		 */
		public void setFont(Font font)
		{
<span class="nc" id="L764">			font_ = font;</span>
<span class="nc" id="L765">		}</span>

		protected Font font_;

		/**
		 * Returns the color to use when rendering the phrase.
		 * 
		 * @return color to use when rendering the phrase
		 */
		public Color getColor()
		{
<span class="nc" id="L776">			return color_;</span>
		}

		/**
		 * Sets the color to use when rendering the phrase.
		 * 
		 * @param color
		 *            new color to use when rendering the phrase; this new value will be used to
		 *            render the phrase the next time {@link #paint(java.awt.Graphics)} is called
		 */
		public void setColor(Color color)
		{
<span class="nc" id="L788">			color_ = color;</span>
<span class="nc" id="L789">		}</span>

		protected Color color_;

		/**
		 * Returns true iff anti-aliasing is used when rendering the phrase.
		 * 
		 * @return whether or not anti-aliasing is used when rendering the phrase
		 */
		public boolean isAntialiasOn()
		{
<span class="nc" id="L800">			return antialiasOn_;</span>
		}

		/**
		 * Turn anti-aliasing on or off.
		 * 
		 * @param antialiasOn
		 *            whether or not to use anti-aliasing when rendering the phrase this new value
		 *            will be used to render the phrase the next time
		 *            {@link #paint(java.awt.Graphics)} is called
		 */
		public void setAntialiasOn(boolean antialiasOn)
		{
<span class="nc" id="L813">			antialiasOn_ = antialiasOn;</span>
<span class="nc" id="L814">		}</span>

		protected boolean antialiasOn_;
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>