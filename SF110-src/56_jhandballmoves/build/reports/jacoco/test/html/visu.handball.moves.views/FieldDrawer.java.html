<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>FieldDrawer.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">56_jhandballmoves</a> &gt; <a href="index.source.html" class="el_package">visu.handball.moves.views</a> &gt; <span class="el_source">FieldDrawer.java</span></div><h1>FieldDrawer.java</h1><pre class="source lang-java linenums">/*
 * Created on 02.10.2006
 * Created by Richard Doerfler, Thomas Halm
 * Copyright (C) 2006  Richard Doerfler, Thomas Halm
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
 */
package visu.handball.moves.views;

import java.awt.BasicStroke;
import java.awt.Color;
import java.awt.Graphics2D;
import java.awt.Point;
import java.awt.Stroke;
import java.awt.geom.Arc2D;
import java.awt.geom.Line2D;
import java.awt.geom.Point2D;
import java.awt.geom.Rectangle2D;
import java.util.ArrayList;
import java.util.List;

import visu.handball.moves.model.ColorModel;

public class FieldDrawer{

	/*
	 * absolute Groesse des Panels
	 */
	public static final int PANEL_WIDTH = 500;

	public static final int PANEL_HEIGHT = 550;

	/*
	 * Ma√üe einer Handball-Spielfeld-Haelfte (relativ)
	 */
	private static final int FIELD_WIDTH = 20;

	private static final int GOAL_WIDTH = 3;

	private static final int SIX_METER = 6;

	private static final int NINE_METER = 9;

	private static final int SPACE = 40;

	private static final int LINE_THICKNESS = 10;

	private List&lt;ColoredShape&gt; fieldLinesShapes;

	private ColoredShape background;
	
	private Rectangle2D goal;

	private Point2D linkerPfosten;

	private Point2D rechterPfosten;

	private double sixMeterPixel;
	
<span class="nc" id="L72">	public FieldDrawer(ColorModel colorModel) {</span>
<span class="nc" id="L73">		createFieldShapes(colorModel);</span>
<span class="nc" id="L74">	}</span>

	private void createFieldShapes(ColorModel colorModel) {
<span class="nc" id="L77">		Color fieldColor = colorModel.getFieldColor();</span>
<span class="nc" id="L78">		Color lineColor = colorModel.getLineColor();</span>
		
<span class="nc" id="L80">		fieldLinesShapes = new ArrayList&lt;ColoredShape&gt;();</span>

		// Spielfeld-Hintergrund
<span class="nc" id="L83">		Rectangle2D bg = new Rectangle2D.Double(0, 0, PANEL_WIDTH,</span>
				PANEL_HEIGHT);
<span class="nc" id="L85">		background = new ColoredShape(bg, fieldColor, true);</span>

		// Spielfeld-Linien
<span class="nc" id="L88">		BasicStroke lineStroke = new BasicStroke(LINE_THICKNESS);</span>

<span class="nc" id="L90">		int fieldWidth = PANEL_WIDTH - 2 * SPACE;</span>

<span class="nc" id="L92">		Rectangle2D aussen = new Rectangle2D.Double(SPACE, SPACE, fieldWidth,</span>
				fieldWidth);
<span class="nc" id="L94">		fieldLinesShapes.add(new ColoredShape(aussen, lineColor, false, lineStroke));</span>

<span class="nc" id="L96">		Line2D aussenLinie = new Line2D.Double(SPACE, fieldWidth + SPACE,</span>
				SPACE, PANEL_HEIGHT);
<span class="nc" id="L98">		fieldLinesShapes.add(new ColoredShape(aussenLinie, lineColor, false,</span>
				lineStroke));
<span class="nc" id="L100">		aussenLinie = new Line2D.Double(PANEL_WIDTH - SPACE,</span>
				fieldWidth + SPACE, PANEL_WIDTH - SPACE, PANEL_HEIGHT);
<span class="nc" id="L102">		fieldLinesShapes.add(new ColoredShape(aussenLinie, lineColor, false,</span>
				lineStroke));

<span class="nc" id="L105">		int x_center = (PANEL_WIDTH) / 2;</span>
		// Relative Torbreite berechnen
<span class="nc" id="L107">		float relation = (float) GOAL_WIDTH / FIELD_WIDTH;</span>
<span class="nc" id="L108">		int goalWidth = (int) ((fieldWidth) * relation);</span>
<span class="nc" id="L109">		int x_goalStart = x_center - goalWidth / 2;</span>

<span class="nc" id="L111">		goal = new Rectangle2D.Double(x_goalStart, 10, goalWidth, 30);</span>
<span class="nc" id="L112">		rechterPfosten = new Point2D.Double(x_goalStart, SPACE);</span>
<span class="nc" id="L113">		linkerPfosten = new Point2D.Double(x_goalStart + goalWidth, SPACE);</span>
<span class="nc" id="L114">		fieldLinesShapes.add(new ColoredShape(goal, lineColor, false, lineStroke));</span>

		// 6-Meter zeichnen
<span class="nc" id="L117">		relation = (float) SIX_METER / FIELD_WIDTH;</span>
<span class="nc" id="L118">		int radius = (int) ((fieldWidth) * relation);</span>
<span class="nc" id="L119">		sixMeterPixel = radius;</span>
<span class="nc" id="L120">		Arc2D viertel = new Arc2D.Double(x_goalStart - radius, -radius + SPACE,</span>
				2 * radius, 2 * radius, 180, 90, Arc2D.OPEN);
<span class="nc" id="L122">		fieldLinesShapes</span>
<span class="nc" id="L123">				.add(new ColoredShape(viertel, lineColor, false, lineStroke));</span>
<span class="nc" id="L124">		Line2D line = new Line2D.Double(x_goalStart, SPACE + radius,</span>
				x_goalStart + goalWidth, SPACE + radius);
<span class="nc" id="L126">		fieldLinesShapes.add(new ColoredShape(line, lineColor, false, lineStroke));</span>

<span class="nc" id="L128">		viertel = new Arc2D.Double(x_goalStart + goalWidth - radius, -radius</span>
				+ SPACE, 2 * radius, 2 * radius, 270, 90, Arc2D.OPEN);
<span class="nc" id="L130">		fieldLinesShapes</span>
<span class="nc" id="L131">				.add(new ColoredShape(viertel, lineColor, false, lineStroke));</span>

		// 9-Meter zeichen
<span class="nc" id="L134">		float dash[] = { 10.0f };</span>
<span class="nc" id="L135">		BasicStroke dashed = new BasicStroke(3.0f, BasicStroke.CAP_BUTT,</span>
				BasicStroke.JOIN_MITER, 10.0f, dash, 0.0f);

<span class="nc" id="L138">		relation = (float) NINE_METER / FIELD_WIDTH;</span>
<span class="nc" id="L139">		radius = (int) ((fieldWidth) * relation);</span>
		// Neun-Meter wird keine 90 Grad gezeichent
<span class="nc" id="L141">		double diff = Math.acos((fieldWidth / 2 - goalWidth / 2)</span>
				/ (float) radius);
<span class="nc" id="L143">		double degress = Math.toDegrees(diff);</span>
<span class="nc" id="L144">		viertel = new Arc2D.Double(x_goalStart - radius, -radius + SPACE,</span>
				2 * radius, 2 * radius, 180 + degress, 90 - degress, Arc2D.OPEN);
<span class="nc" id="L146">		fieldLinesShapes.add(new ColoredShape(viertel, lineColor, false, dashed));</span>

<span class="nc" id="L148">		line = new Line2D.Double(x_goalStart, SPACE + radius, x_goalStart</span>
				+ goalWidth, SPACE + radius);
<span class="nc" id="L150">		fieldLinesShapes.add(new ColoredShape(line, lineColor, false, dashed));</span>

<span class="nc" id="L152">		viertel = new Arc2D.Double(x_goalStart + goalWidth - radius, -radius</span>
				+ SPACE, 2 * radius, 2 * radius, 270, 90 - degress, Arc2D.OPEN);
<span class="nc" id="L154">		fieldLinesShapes.add(new ColoredShape(viertel, lineColor, false, dashed));</span>
<span class="nc" id="L155">	}</span>

	public void draw(Graphics2D g2d) {
<span class="nc" id="L158">		Color tempColor = g2d.getColor();</span>
<span class="nc" id="L159">		Stroke tempStroke = g2d.getStroke();</span>

<span class="nc" id="L161">		background.drawShape(g2d);</span>
		
<span class="nc bnc" id="L163" title="All 2 branches missed.">		for (ColoredShape shape : fieldLinesShapes) {</span>
<span class="nc" id="L164">			shape.drawShape(g2d);</span>
<span class="nc" id="L165">		}</span>

<span class="nc" id="L167">		g2d.setColor(tempColor);</span>
<span class="nc" id="L168">		g2d.setStroke(tempStroke);</span>
<span class="nc" id="L169">	}</span>
	
	public void updateColors(ColorModel colorModel) {
<span class="nc" id="L172">		background.setColor(colorModel.getFieldColor());</span>
<span class="nc bnc" id="L173" title="All 2 branches missed.">		for (ColoredShape shape : fieldLinesShapes) {</span>
<span class="nc" id="L174">			shape.setColor(colorModel.getLineColor());</span>
<span class="nc" id="L175">		}</span>
<span class="nc" id="L176">	}</span>
	
	
	public boolean insideGoal(int x, int y) {
<span class="nc" id="L180">		return goal.contains(x, y);</span>
	}

	public Point getGoalMiddle() {
<span class="nc" id="L184">		return new Point((int) goal.getCenterX(), (int) goal.getCenterY());</span>
	}

	public boolean insideSixMeter(int x, int y) {
<span class="nc bnc" id="L188" title="All 2 branches missed.">		if (linkerPfosten.distance(x, y) &lt; sixMeterPixel</span>
<span class="nc bnc" id="L189" title="All 2 branches missed.">				|| rechterPfosten.distance(x, y) &lt; sixMeterPixel) {</span>
<span class="nc" id="L190">			return true;</span>
		} else {
<span class="nc" id="L192">			return false;</span>
		}
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>